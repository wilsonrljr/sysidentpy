<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="From Classical Approaches to Neural Networks"><meta name=author content="Wilson Rocha"><link href=https://sysidentpy.org/user-guide/API/basis-function/ rel=canonical><link href=../ofr-base/ rel=prev><link href=../frols/ rel=next><link rel=icon href=../../../en/assets/img/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.6"><title>Basis Functions - SysIdentPy</title><link rel=stylesheet href=../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../overrides/assets/css/extra.css><link rel=stylesheet href=../../../overrides/assets/css/feature-grid.css><link rel=stylesheet href=../../../overrides/assets/css/fontsize.css><link rel=stylesheet href=../../../overrides/assets/css/card-container.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css><link rel=stylesheet href=../../../overrides/assets/vendor/css/prism.css><link rel=stylesheet href=../../../overrides/assets/css/style.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-16K3SQT164"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-16K3SQT164",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-16K3SQT164",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#documentation-for-basis-functions class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://github.com/sponsors/wilsonrljr> Sponsor <strong>SysIdentPy</strong> on <span class="twemoji github"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </span> <strong>Github</strong> </a> </div> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=SysIdentPy class="md-header__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SysIdentPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Basis Functions </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label="Select language"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=./ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=../../../pt/user-guide/API/basis-function/ hreflang=pt class=md-select__link> PortuguÃªs (Brasil) </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../getting-started/getting-started/ class=md-tabs__link> Getting started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../overview/ class=md-tabs__link> User guide </a> </li> <li class=md-tabs__item> <a href=../../../book/0-Preface/ class=md-tabs__link> Companion Book </a> </li> <li class=md-tabs__item> <a href=../../../developer-guide/contribute/ class=md-tabs__link> Developer guide </a> </li> <li class=md-tabs__item> <a href=../../../community-support/community-overview/ class=md-tabs__link> Community & Support </a> </li> <li class=md-tabs__item> <a href=../../../landing-page/about-us/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../changelog/changelog/ class=md-tabs__link> Changelog </a> </li> <li class=md-tabs__item> <a href=../../../landing-page/sponsor/ class=md-tabs__link> Sponsors </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=SysIdentPy class="md-nav__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> SysIdentPy </label> <div class=md-nav__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../getting-started/getting-started/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../getting-started/quickstart-guide/ class=md-nav__link> <span class=md-ellipsis> Quickstart Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../getting-started/narmax-intro/ class=md-nav__link> <span class=md-ellipsis> Introduction to NARMAX </span> </a> </li> <li class=md-nav__item> <a href=../../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> User guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_1> <label class=md-nav__link for=__nav_3_2_1 id=__nav_3_2_1_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/your-first-model/ class=md-nav__link> <span class=md-ellipsis> Your First Model </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/model-with-multiple-inputs/ class=md-nav__link> <span class=md-ellipsis> Model with Multiple Inputs </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/basis-function-overview/ class=md-nav__link> <span class=md-ellipsis> Basis Function - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/information-criteria-overview/ class=md-nav__link> <span class=md-ellipsis> Information Criteria - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/general-NARX-models/ class=md-nav__link> <span class=md-ellipsis> General NARX Models - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/fourier-NARX-overview/ class=md-nav__link> <span class=md-ellipsis> Fourier NARX - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/aols-overview/ class=md-nav__link> <span class=md-ellipsis> AOLS - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/NFIR-model-overview/ class=md-nav__link> <span class=md-ellipsis> NFIR - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/importance-of-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Importance of Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2 id=__nav_3_2_2_label tabindex=0> <span class=md-ellipsis> Electrical and Mechanical Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Electrical and Mechanical Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/modeling-a-magneto-rheological-damper-device/ class=md-nav__link> <span class=md-ellipsis> Modeling a Magneto-Rheological Damper Device </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/silver-box-system/ class=md-nav__link> <span class=md-ellipsis> Silver Box System </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/coupled-eletric-device/ class=md-nav__link> <span class=md-ellipsis> Coupled Electric Device </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/wiener-hammerstein-system/ class=md-nav__link> <span class=md-ellipsis> Wiener-Hammerstein System </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/f-16-aircraft/ class=md-nav__link> <span class=md-ellipsis> F-16 Aircraft </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/f-16-aircraft-n-steps-ahead-prediction/ class=md-nav__link> <span class=md-ellipsis> F-16 Aircraft - N-Steps Ahead Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/electromechanical-system-identification-overview/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/electromechanical-system-identification-metamss/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/electromechanical-system-identification-entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/multiobjective-parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation - Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3 id=__nav_3_2_3_label tabindex=0> <span class=md-ellipsis> Industrial and Corporate </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Industrial and Corporate </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/m4-benchmark/ class=md-nav__link> <span class=md-ellipsis> M4 Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/air-passenger-benchmark/ class=md-nav__link> <span class=md-ellipsis> Air Passenger Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/load-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Load Forecasting Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/PV-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> PV Forecasting Benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4 id=__nav_3_2_4_label tabindex=0> <span class=md-ellipsis> Chaotic Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Chaotic Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/chaotic-systems/lorenz-system/ class=md-nav__link> <span class=md-ellipsis> Lorenz System </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/chaotic-systems/logistic-map/ class=md-nav__link> <span class=md-ellipsis> Logistic Map </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> How to </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> How to </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../how-to/create-a-narx-neural-network/ class=md-nav__link> <span class=md-ellipsis> Create a Neural NARX Network </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/save-and-load-models/ class=md-nav__link> <span class=md-ellipsis> Save and Load Models </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/set-specific-lags/ class=md-nav__link> <span class=md-ellipsis> Set Specific Lags </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/simulating-existing-models/ class=md-nav__link> <span class=md-ellipsis> Simulating Existing Models </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/use-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Use Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4 checked> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=true> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../narmax-base/ class=md-nav__link> <span class=md-ellipsis> NARMAX Base </span> </a> </li> <li class=md-nav__item> <a href=../ofr-base/ class=md-nav__link> <span class=md-ellipsis> OFR Base </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Basis Functions </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Basis Functions </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bernstein class=md-nav__link> <span class=md-ellipsis> _bernstein </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bernstein.Bernstein class=md-nav__link> <span class=md-ellipsis> Bernstein </span> </a> <nav class=md-nav aria-label=Bernstein> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bernstein.Bernstein.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear class=md-nav__link> <span class=md-ellipsis> _bilinear </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear.Bilinear class=md-nav__link> <span class=md-ellipsis> Bilinear </span> </a> <nav class=md-nav aria-label=Bilinear> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear.Bilinear.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear.Bilinear.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier class=md-nav__link> <span class=md-ellipsis> _fourier </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier.Fourier class=md-nav__link> <span class=md-ellipsis> Fourier </span> </a> <nav class=md-nav aria-label=Fourier> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier.Fourier.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier.Fourier.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._legendre class=md-nav__link> <span class=md-ellipsis> _legendre </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._legendre.Legendre class=md-nav__link> <span class=md-ellipsis> Legendre </span> </a> <nav class=md-nav aria-label=Legendre> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._legendre.Legendre.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial class=md-nav__link> <span class=md-ellipsis> _polynomial </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial.Polynomial class=md-nav__link> <span class=md-ellipsis> Polynomial </span> </a> <nav class=md-nav aria-label=Polynomial> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial.Polynomial.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial.Polynomial.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite class=md-nav__link> <span class=md-ellipsis> _hermite </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite.Hermite class=md-nav__link> <span class=md-ellipsis> Hermite </span> </a> <nav class=md-nav aria-label=Hermite> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite.Hermite.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite_normalized class=md-nav__link> <span class=md-ellipsis> _hermite_normalized </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite_normalized.HermiteNormalized class=md-nav__link> <span class=md-ellipsis> HermiteNormalized </span> </a> <nav class=md-nav aria-label=HermiteNormalized> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite_normalized.HermiteNormalized.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._laguerre class=md-nav__link> <span class=md-ellipsis> _laguerre </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._laguerre.Laguerre class=md-nav__link> <span class=md-ellipsis> Laguerre </span> </a> <nav class=md-nav aria-label=Laguerre> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._laguerre.Laguerre.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../frols/ class=md-nav__link> <span class=md-ellipsis> FROLS </span> </a> </li> <li class=md-nav__item> <a href=../metamss/ class=md-nav__link> <span class=md-ellipsis> MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../aols/ class=md-nav__link> <span class=md-ellipsis> AOLS </span> </a> </li> <li class=md-nav__item> <a href=../uofr/ class=md-nav__link> <span class=md-ellipsis> UOFR </span> </a> </li> <li class=md-nav__item> <a href=../entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../neural-narx/ class=md-nav__link> <span class=md-ellipsis> Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../general-estimators/ class=md-nav__link> <span class=md-ellipsis> General Estimators </span> </a> </li> <li class=md-nav__item> <a href=../parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../multiobjective-parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../simulation/ class=md-nav__link> <span class=md-ellipsis> Simulation </span> </a> </li> <li class=md-nav__item> <a href=../residues/ class=md-nav__link> <span class=md-ellipsis> Residual Analysis </span> </a> </li> <li class=md-nav__item> <a href=../metaheuristics/ class=md-nav__link> <span class=md-ellipsis> Metaheuristics </span> </a> </li> <li class=md-nav__item> <a href=../metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=../utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Companion Book </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Companion Book </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../book/0-Preface/ class=md-nav__link> <span class=md-ellipsis> Preface </span> </a> </li> <li class=md-nav__item> <a href=../../../book/0.1-Contents/ class=md-nav__link> <span class=md-ellipsis> Contents </span> </a> </li> <li class=md-nav__item> <a href=../../../book/1-Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../book/2-NARMAX-Model-Representation/ class=md-nav__link> <span class=md-ellipsis> 2. NARMAX Model Representation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/3-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 3. Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/4-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 4. Model Structure Selection </span> </a> </li> <li class=md-nav__item> <a href=../../../book/5-Multiobjective-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 5. Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/6-Multiobjective-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 6. Multiobjective Model Structure Selection </span> </a> </li> <li class=md-nav__item> <a href=../../../book/7-NARX-Neural-Network/ class=md-nav__link> <span class=md-ellipsis> 7. NARX Neural Network </span> </a> </li> <li class=md-nav__item> <a href=../../../book/8-Severely-Nonlinear-System-Identification/ class=md-nav__link> <span class=md-ellipsis> 8. Severely Nonlinear System Identification </span> </a> </li> <li class=md-nav__item> <a href=../../../book/9-Validation/ class=md-nav__link> <span class=md-ellipsis> 9. Validation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/10-Case-Studies/ class=md-nav__link> <span class=md-ellipsis> 10. Case Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Developer guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Developer guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../developer-guide/contribute/ class=md-nav__link> <span class=md-ellipsis> How to contribute </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../developer-guide/documentation-overview/ class=md-nav__link> <span class=md-ellipsis> Documentation Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../developer-guide/how-to-write-a-tutorial/ class=md-nav__link> <span class=md-ellipsis> How To Write a Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../../developer-guide/how-to-write-a-how-to-guide/ class=md-nav__link> <span class=md-ellipsis> How To Write a How-to Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../developer-guide/how-to-add-a-translation/ class=md-nav__link> <span class=md-ellipsis> How to Add a Translation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Community & Support </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Community & Support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../community-support/community-overview/ class=md-nav__link> <span class=md-ellipsis> community-overview </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/get-help/ class=md-nav__link> <span class=md-ellipsis> Get Help </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Meetups </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Meetups </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../community-support/meetups/ai-networks-meetup/ class=md-nav__link> <span class=md-ellipsis> AI Networks Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/nubank-meetup/ class=md-nav__link> <span class=md-ellipsis> Nubank Timeseries Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/nubank-meetup-open-source/ class=md-nav__link> <span class=md-ellipsis> Nubank Open Source Talk </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/gcom-meetup/ class=md-nav__link> <span class=md-ellipsis> GCoM Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/estatidados/ class=md-nav__link> <span class=md-ellipsis> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../landing-page/about-us/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../../../changelog/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../../landing-page/sponsor/ class=md-nav__link> <span class=md-ellipsis> Sponsors </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bernstein class=md-nav__link> <span class=md-ellipsis> _bernstein </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bernstein.Bernstein class=md-nav__link> <span class=md-ellipsis> Bernstein </span> </a> <nav class=md-nav aria-label=Bernstein> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bernstein.Bernstein.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear class=md-nav__link> <span class=md-ellipsis> _bilinear </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear.Bilinear class=md-nav__link> <span class=md-ellipsis> Bilinear </span> </a> <nav class=md-nav aria-label=Bilinear> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear.Bilinear.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._bilinear.Bilinear.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier class=md-nav__link> <span class=md-ellipsis> _fourier </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier.Fourier class=md-nav__link> <span class=md-ellipsis> Fourier </span> </a> <nav class=md-nav aria-label=Fourier> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier.Fourier.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._fourier.Fourier.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._legendre class=md-nav__link> <span class=md-ellipsis> _legendre </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._legendre.Legendre class=md-nav__link> <span class=md-ellipsis> Legendre </span> </a> <nav class=md-nav aria-label=Legendre> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._legendre.Legendre.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial class=md-nav__link> <span class=md-ellipsis> _polynomial </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial.Polynomial class=md-nav__link> <span class=md-ellipsis> Polynomial </span> </a> <nav class=md-nav aria-label=Polynomial> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial.Polynomial.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._polynomial.Polynomial.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite class=md-nav__link> <span class=md-ellipsis> _hermite </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite.Hermite class=md-nav__link> <span class=md-ellipsis> Hermite </span> </a> <nav class=md-nav aria-label=Hermite> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite.Hermite.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite_normalized class=md-nav__link> <span class=md-ellipsis> _hermite_normalized </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite_normalized.HermiteNormalized class=md-nav__link> <span class=md-ellipsis> HermiteNormalized </span> </a> <nav class=md-nav aria-label=HermiteNormalized> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._hermite_normalized.HermiteNormalized.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._laguerre class=md-nav__link> <span class=md-ellipsis> _laguerre </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.basis_function._laguerre.Laguerre class=md-nav__link> <span class=md-ellipsis> Laguerre </span> </a> <nav class=md-nav aria-label=Laguerre> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.basis_function._laguerre.Laguerre.transform class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/wilsonrljr/sysidentpy/edit/main/docs/en/user-guide/API/basis-function.md title=edit.link.title class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://raw.githubusercontent.com/wilsonrljr/sysidentpy/main/docs/en/user-guide/API/basis-function.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=documentation-for-basis-functions>Documentation for <code>Basis Functions</code><a class=headerlink href=#documentation-for-basis-functions title="Permanent link">&para;</a></h1> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._bernstein></a> <div class="doc doc-contents first"> <p>Bersntein Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._bernstein.Bernstein class="doc doc-heading"> <code>Bernstein</code> <a href=#sysidentpy.basis_function._bernstein.Bernstein class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build Bersntein basis function.</p> <p>Generate Bernstein basis functions.</p> <p>This class constructs a new feature matrix consisting of Bernstein basis functions for a given degree. Bernstein polynomials are useful in numerical analysis, curve fitting, and approximation theory due to their smoothness and the ability to approximate any continuous function on a closed interval.</p> <p>The Bernstein polynomial of degree <span class=arithmatex>\(n\)</span> for a variable <span class=arithmatex>\(x\)</span> is defined as:</p> <div class=arithmatex>\[ B_{i,n}(x) = \binom{n}{i} x^i (1 - x)^{n - i} \quad \text{for} \quad i = 0, 1, \ldots, n \]</div> <p>where <span class=arithmatex>\(\binom{n}{i}\)</span> is the binomial coefficient, given by:</p> <div class=arithmatex>\[ \binom{n}{i} = \frac{n!}{i! (n - i)!} \]</div> <p>Bernstein polynomials form a basis for the space of polynomials of degree at most <span class=arithmatex>\(n\)</span>. They are particularly useful in approximation theory because they can approximate any continuous function on the interval <span class=arithmatex>\([0, 1]\)</span> as <span class=arithmatex>\(n\)</span> increases.</p> <p>Be aware that the number of features in the output array scales significantly with the number of inputs, the maximum lag of the input, and the polynomial degree.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span>(<span title=max_degree>max_degree</span>)</code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the polynomial features.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>bias</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include the bias (constant) term in the output feature matrix. deprecated in v.0.5.0 <code>bias</code> is deprecated in 0.5.0 and will be removed in 0.6.0. Use <code>include_bias</code> instead.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>n</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the bersntein polynomial features. deprecated in v.0.5.0 <code>n</code> is deprecated in 0.5.0 and will be removed in 0.6.0. Use <code>degree</code> instead.</p> </div> </td> <td> <code>1</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Be aware that the number of features in the output array scales significantly as the number of inputs, the max lag of the input and output.</p> </details> <details class=references open> <summary>References</summary> <ul> <li>Blog: this method is based on the content provided by Alex Shtoff in his blog. The content is easy to follow and every user is referred to is blog to check not only the Bersntein method, but also different topics that Alex discuss there! <a href=https://alexshtf.github.io/2024/01/21/Bernstein.html>https://alexshtf.github.io/2024/01/21/Bernstein.html</a></li> <li>Wikipedia: Bernstein polynomial <a href=https://en.wikipedia.org/wiki/Bernstein_polynomial>https://en.wikipedia.org/wiki/Bernstein_polynomial</a></li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_bernstein.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=nd>@deprecated</span><span class=p>(</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=n>version</span><span class=o>=</span><span class=s2>&quot;v0.5.0&quot;</span><span class=p>,</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>future_version</span><span class=o>=</span><span class=s2>&quot;v1.0.0&quot;</span><span class=p>,</span>
<a id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>message</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a>        <span class=s2>&quot; `bias` and `n` are deprecated in 0.5.0 and will be removed in 1.0.0.&quot;</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a>        <span class=s2>&quot; Use `include_bias` and `degree`, respectively, instead.&quot;</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=p>),</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=p>)</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=k>class</span><span class=w> </span><span class=nc>Bernstein</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build Bersntein basis function.</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    Generate Bernstein basis functions.</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    This class constructs a new feature matrix consisting of Bernstein basis functions</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    for a given degree. Bernstein polynomials are useful in numerical analysis, curve</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>    fitting, and approximation theory due to their smoothness and the ability to</span>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    approximate any continuous function on a closed interval.</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    The Bernstein polynomial of degree \(n\) for a variable \(x\) is defined as:</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    $$</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>        B_{i,n}(x) = \binom{n}{i} x^i (1 - x)^{n - i} \quad \text{for} \quad i = 0, 1,</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>        \ldots, n</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    $$</span>
<a id=__codelineno-0-35 name=__codelineno-0-35></a>
<a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>    where \(\binom{n}{i}\) is the binomial coefficient, given by:</span>
<a id=__codelineno-0-37 name=__codelineno-0-37></a>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    $$</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>        \binom{n}{i} = \frac{n!}{i! (n - i)!}</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>    $$</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>    Bernstein polynomials form a basis for the space of polynomials of degree at most</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    \(n\). They are particularly useful in approximation theory because they can</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    approximate any continuous function on the interval \([0, 1]\) as \(n\) increases.</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>    Be aware that the number of features in the output array scales significantly with</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>    the number of inputs, the maximum lag of the input, and the polynomial degree.</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>    ----------</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    degree : int (max_degree), default=1</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>        The maximum degree of the polynomial features.</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    bias : bool, default=True</span>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>        Whether to include the bias (constant) term in the output feature matrix.</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>        deprecated in v.0.5.0</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>           `bias` is deprecated in 0.5.0 and will be removed in 0.6.0.</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>           Use `include_bias` instead.</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>    n : int, default=1</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>        The maximum degree of the bersntein polynomial features.</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>        deprecated in v.0.5.0</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>           `n` is deprecated in 0.5.0 and will be removed in 0.6.0.</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>           Use `degree` instead.</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>    Notes</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>    -----</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>    Be aware that the number of features in the output array scales</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>    significantly as the number of inputs, the max lag of the input and output.</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>    References</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>    ----------</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>    - Blog: this method is based on the content provided by Alex Shtoff in his blog.</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        The content is easy to follow and every user is referred to is blog to check</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        not only the Bersntein method, but also different topics that Alex discuss</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        there!</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        https://alexshtf.github.io/2024/01/21/Bernstein.html</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    - Wikipedia: Bernstein polynomial</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        https://en.wikipedia.org/wiki/Bernstein_polynomial</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>n</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=n>bias</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=n>include_bias</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>ensemble</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>    <span class=p>):</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>        <span class=k>if</span> <span class=n>n</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>            <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>n</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=k>if</span> <span class=n>bias</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span> <span class=o>=</span> <span class=n>bias</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span> <span class=o>=</span> <span class=n>include_bias</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span> <span class=o>=</span> <span class=n>ensemble</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>    <span class=k>def</span><span class=w> </span><span class=nf>_bernstein_expansion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=n>k</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=n>base</span> <span class=o>=</span> <span class=n>binom</span><span class=o>.</span><span class=n>pmf</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>,</span> <span class=n>data</span><span class=p>[:,</span> <span class=kc>None</span><span class=p>])</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=k>return</span> <span class=n>base</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=p>):</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=c1># remove intercept (because the data always have the intercept)</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=n>n_features</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_bernstein_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>])</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_features</span><span class=p>)]</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=n>basis</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span> <span class=k>for</span> <span class=n>basis</span> <span class=ow>in</span> <span class=n>psi</span><span class=p>]</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span><span class=n>psi</span><span class=p>)</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>psi</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span><span class=p>:</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=n>bias_column</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>psi</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_column</span><span class=p>,</span> <span class=n>psi</span><span class=p>))</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>
<a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a>
<a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>
<a id=__codelineno-0-135 name=__codelineno-0-135></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=p>):</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>        ----------</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        Returns</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>        -------</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        X_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._bernstein.Bernstein.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._bernstein.Bernstein.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Bersntein Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>X_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_bernstein.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=p>):</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>    ----------</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>    Returns</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>    -------</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>    X_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._bilinear></a> <div class="doc doc-contents first"> <p>Bilinear Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._bilinear.Bilinear class="doc doc-heading"> <code>Bilinear</code> <a href=#sysidentpy.basis_function._bilinear.Bilinear class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build Bilinear basis function.</p> <p>A general bilinear input-output model takes the form</p> <div class=arithmatex>\[ y(k) = a_0 + \sum_{i=1}^{n_y} a_i y(k-i) + \sum_{i=1}^{n_u} b_i u(k-i) + \sum_{i=1}^{n_y} \sum_{j=1}^{n_u} c_{ij} y(k-i) u(k-j) \]</div> <p>This is a special case of the Polynomial NARMAX model.</p> <p>Bilinear system theory has been widely studied and it plays an important role in the context of continuous-time systems. This is because, roughly speaking, the set of bilinear systems is dense in the space of continuous-time systems and any continuous causal functional can be arbitrarily well approximated by bilinear systems within any bounded time interval (see for example Fliess and Normand-Cyrot 1982). Moreover, many real continuous-time processes are naturally in bilinear form. A few examples are distillation columns (EspaÃ±a and Landau 1978), nuclear and thermal control processes (Mohler 1973).</p> <p>Sampling the continuous-time bilinear system, however, produces a NARMAX model which is more complex than a discrete-time bilinear model.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span>(<span title=max_degree>max_degree</span>)</code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the polynomial features.</p> </div> </td> <td> <code>2</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Be aware that the number of features in the output array scales significantly as the number of inputs, the max lag of the input and output, and degree increases. High degrees can cause overfitting.</p> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_bilinear.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=k>class</span><span class=w> </span><span class=nc>Bilinear</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build Bilinear basis function.</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    A general bilinear input-output model takes the form</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    $$</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>        y(k) = a_0 + \sum_{i=1}^{n_y} a_i y(k-i) + \sum_{i=1}^{n_u} b_i u(k-i) +</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>        \sum_{i=1}^{n_y} \sum_{j=1}^{n_u} c_{ij} y(k-i) u(k-j)</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    $$</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    This is a special case of the Polynomial NARMAX model.</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>    Bilinear system theory has been widely studied and it plays an important role in the</span>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    context of continuous-time systems.  This is because, roughly speaking, the set of</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    bilinear systems is dense in the space of continuous-time systems and any continuous</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    causal functional can be arbitrarily well approximated by bilinear systems within</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    any bounded time interval (see for example Fliess and Normand-Cyrot 1982). Moreover,</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    many real continuous-time processes are naturally in bilinear form. A few examples</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    are distillation columns (EspaÃ±a and Landau 1978), nuclear and thermal control</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    processes (Mohler 1973).</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    Sampling the continuous-time bilinear system, however, produces a NARMAX model</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>    which is more complex than a discrete-time bilinear model.</span>
<a id=__codelineno-0-37 name=__codelineno-0-37></a>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>    ----------</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>    degree : int (max_degree), default=2</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>        The maximum degree of the polynomial features.</span>
<a id=__codelineno-0-42 name=__codelineno-0-42></a>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    Notes</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    -----</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    Be aware that the number of features in the output array scales</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>    significantly as the number of inputs, the max lag of the input and output, and</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>    degree increases. High degrees can cause overfitting.</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a>
<a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=p>):</span>
<a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a>
<a id=__codelineno-0-56 name=__codelineno-0-56></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=p>):</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build the Bilinear information matrix.</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>        Each column of the information matrix represents a candidate</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>        regressor. The set of candidate regressors are based on xlag,</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>        ylag, and degree defined by the user.</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        ----------</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>            Target data used on training phase.</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>        predefined_regressors : ndarray of int</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>            The index of the selected regressors by the Model Structure</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>            Selection algorithm.</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>        Returns</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        -------</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>        psi = ndarray of floats</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>            The lagged matrix built in respect with each lag and column.</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=c1># Create combinations of all columns based on its index</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=n>iterable_list</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=n>combination_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=n>combinations_with_replacement</span><span class=p>(</span><span class=n>iterable_list</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=p>)</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>                <span class=s2>&quot;You choose a bilinear basis function and nonlinear degree = 1.&quot;</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>                <span class=s2>&quot;In this case, you have a linear polynomial model.&quot;</span><span class=p>,</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>                <span class=n>stacklevel</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=p>)</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=n>ny</span> <span class=o>=</span> <span class=n>get_max_ylag</span><span class=p>(</span><span class=n>ylag</span><span class=p>)</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=n>combination_ylag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=n>combinations_with_replacement</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)),</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=p>)</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>xlag</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=n>xlag</span><span class=p>]</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>combination_xlag</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>ni</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=k>for</span> <span class=n>lag</span> <span class=ow>in</span> <span class=n>xlag</span><span class=p>:</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>            <span class=n>nx</span> <span class=o>=</span> <span class=n>get_max_xlag</span><span class=p>(</span><span class=n>lag</span><span class=p>)</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=n>combination_lag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>                <span class=n>combinations_with_replacement</span><span class=p>(</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>                    <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>ni</span><span class=p>,</span> <span class=n>nx</span> <span class=o>+</span> <span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>ni</span><span class=p>)),</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>                <span class=p>)</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=p>)</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=n>combination_xlag</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>combination_lag</span><span class=p>)</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=n>ni</span> <span class=o>+=</span> <span class=n>nx</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=n>combination_xlag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>chain</span><span class=o>.</span><span class=n>from_iterable</span><span class=p>(</span><span class=n>combination_xlag</span><span class=p>))</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=n>combinations_xy</span> <span class=o>=</span> <span class=n>combination_xlag</span> <span class=o>+</span> <span class=n>combination_ylag</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=n>combination_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>combination_list</span><span class=p>)</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=n>combinations_xy</span><span class=p>))</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>            <span class=n>combination_list</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a>                <span class=n>combination_list</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=k>for</span> <span class=n>index</span> <span class=ow>in</span> <span class=n>predefined_regressors</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=p>]</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a>
<a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=p>[</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a>                <span class=n>np</span><span class=o>.</span><span class=n>prod</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>combination_list</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>combination_list</span><span class=p>))</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a>            <span class=p>]</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=p>)</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=p>:]</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a>
<a id=__codelineno-0-142 name=__codelineno-0-142></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-146 name=__codelineno-0-146></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a>    <span class=p>):</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Polynomial Basis Functions.</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>        ----------</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a>
<a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>        Returns</span>
<a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>        -------</span>
<a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-172 name=__codelineno-0-172></a>
<a id=__codelineno-0-173 name=__codelineno-0-173></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._bilinear.Bilinear.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._bilinear.Bilinear.fit class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build the Bilinear information matrix.</p> <p>Each column of the information matrix represents a candidate regressor. The set of candidate regressors are based on xlag, ylag, and degree defined by the user.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Target data used on training phase.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The index of the selected regressors by the Model Structure Selection algorithm.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>psi = ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built in respect with each lag and column.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_bilinear.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=p>):</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build the Bilinear information matrix.</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>    Each column of the information matrix represents a candidate</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>    regressor. The set of candidate regressors are based on xlag,</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>    ylag, and degree defined by the user.</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>    ----------</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        Target data used on training phase.</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>    predefined_regressors : ndarray of int</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>        The index of the selected regressors by the Model Structure</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>        Selection algorithm.</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>    Returns</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>    -------</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    psi = ndarray of floats</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>        The lagged matrix built in respect with each lag and column.</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=c1># Create combinations of all columns based on its index</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>    <span class=n>iterable_list</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=n>combination_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=n>combinations_with_replacement</span><span class=p>(</span><span class=n>iterable_list</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=p>)</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=s2>&quot;You choose a bilinear basis function and nonlinear degree = 1.&quot;</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=s2>&quot;In this case, you have a linear polynomial model.&quot;</span><span class=p>,</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=n>stacklevel</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=p>)</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=n>ny</span> <span class=o>=</span> <span class=n>get_max_ylag</span><span class=p>(</span><span class=n>ylag</span><span class=p>)</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=n>combination_ylag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=n>combinations_with_replacement</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)),</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=p>)</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>xlag</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=n>xlag</span><span class=p>]</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=n>combination_xlag</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>    <span class=n>ni</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=k>for</span> <span class=n>lag</span> <span class=ow>in</span> <span class=n>xlag</span><span class=p>:</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=n>nx</span> <span class=o>=</span> <span class=n>get_max_xlag</span><span class=p>(</span><span class=n>lag</span><span class=p>)</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=n>combination_lag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=n>combinations_with_replacement</span><span class=p>(</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>                <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>ni</span><span class=p>,</span> <span class=n>nx</span> <span class=o>+</span> <span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>ni</span><span class=p>)),</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=p>)</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=p>)</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>combination_xlag</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>combination_lag</span><span class=p>)</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=n>ni</span> <span class=o>+=</span> <span class=n>nx</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>    <span class=n>combination_xlag</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>chain</span><span class=o>.</span><span class=n>from_iterable</span><span class=p>(</span><span class=n>combination_xlag</span><span class=p>))</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=n>combinations_xy</span> <span class=o>=</span> <span class=n>combination_xlag</span> <span class=o>+</span> <span class=n>combination_ylag</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a>    <span class=n>combination_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>combination_list</span><span class=p>)</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=n>combinations_xy</span><span class=p>))</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a>    <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=n>combination_list</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a>            <span class=n>combination_list</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=k>for</span> <span class=n>index</span> <span class=ow>in</span> <span class=n>predefined_regressors</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=p>]</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a>
<a id=__codelineno-0-133 name=__codelineno-0-133></a>    <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=p>[</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a>            <span class=n>np</span><span class=o>.</span><span class=n>prod</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>combination_list</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>combination_list</span><span class=p>))</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=p>]</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=p>)</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=p>:]</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=k>return</span> <span class=n>psi</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._bilinear.Bilinear.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._bilinear.Bilinear.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Polynomial Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_bilinear.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-146 name=__codelineno-0-146></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=p>):</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Polynomial Basis Functions.</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>    ----------</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a>
<a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>    Returns</span>
<a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>    -------</span>
<a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-172 name=__codelineno-0-172></a>
<a id=__codelineno-0-173 name=__codelineno-0-173></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-174 name=__codelineno-0-174></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._fourier></a> <div class="doc doc-contents first"> <p>Fourier Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._fourier.Fourier class="doc doc-heading"> <code>Fourier</code> <a href=#sysidentpy.basis_function._fourier.Fourier class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build Fourier basis function.</p> <p>Generate a new feature matrix consisting of all Fourier features with respect to the number of harmonics.</p> <p>The Fourier expansion is given by:</p> <p>If you set <span class=arithmatex>\(\mathcal{F}\)</span> as the Fourier extension</p> <div class=arithmatex>\[ \mathcal{F}(x) = [\cos(\pi x), \sin(\pi x), \cos(2\pi x), \sin(2\pi x), \ldots, \cos(N\pi x), \sin(N\pi x)] \]</div> <p>In this case, the Fourier ARX representation will be:</p> <div class=arithmatex>\[\begin{aligned} y_k = &amp;\Big[ \cos(\pi y_{k-1}), \sin(\pi y_{k-1}), \cos(2\pi y_{k-1}), \sin(2\pi y_{k-1}), \ldots, \cos(N\pi y_{k-1}), \sin(N\pi y_{k-1}), \\ &amp;\ \ \cos(\pi y_{k-2}), \sin(\pi y_{k-2}), \ldots, \cos(N\pi y_{k-n_y}), \sin(N\pi y_{k-n_y}), \\ &amp;\ \ \cos(\pi x_{k-1}), \sin(\pi x_{k-1}), \cos(2\pi x_{k-1}), \sin(2\pi x_{k-1}), \ldots, \cos(N\pi x_{k-n_x}), \sin(N\pi x_{k-n_x}) \Big] \\ &amp;\ \ + e_k \end{aligned}\]</div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span>(<span title=max_degree>max_degree</span>)</code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the polynomial features.</p> </div> </td> <td> <code>2</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Be aware that the number of features in the output array scales significantly as the number of inputs, the max lag of the input and output.</p> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_fourier.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-10> 10</a></span>
<span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=k>class</span><span class=w> </span><span class=nc>Fourier</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build Fourier basis function.</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a>
<a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=sd>    Generate a new feature matrix consisting of all Fourier features</span>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    with respect to the number of harmonics.</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    The Fourier expansion is given by:</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>    If you set $\mathcal{F}$ as the Fourier extension</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    $$</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    \mathcal{F}(x) = [\cos(\pi x), \sin(\pi x), \cos(2\pi x), \sin(2\pi x), \ldots,</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    \cos(N\pi x), \sin(N\pi x)]</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    $$</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    In this case, the Fourier ARX representation will be:</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    \begin{aligned}</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    y_k = &amp;\Big[ \cos(\pi y_{k-1}), \sin(\pi y_{k-1}), \cos(2\pi y_{k-1}),</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    \sin(2\pi y_{k-1}), \ldots, \cos(N\pi y_{k-1}), \sin(N\pi y_{k-1}), \\</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    &amp;\ \ \cos(\pi y_{k-2}), \sin(\pi y_{k-2}), \ldots, \cos(N\pi y_{k-n_y}),</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    \sin(N\pi y_{k-n_y}), \\</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    &amp;\ \ \cos(\pi x_{k-1}), \sin(\pi x_{k-1}), \cos(2\pi x_{k-1}), \sin(2\pi x_{k-1}),</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    \ldots, \cos(N\pi x_{k-n_x}), \sin(N\pi x_{k-n_x}) \Big] \\</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    &amp;\ \ + e_k</span>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    \end{aligned}</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a>
<a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    ----------</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>    degree : int (max_degree), default=2</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>        The maximum degree of the polynomial features.</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>    Notes</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    -----</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    Be aware that the number of features in the output array scales</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    significantly as the number of inputs, the max lag of the input and output.</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a>
<a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a>
<a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>,</span> <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>ensemble</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=p>):</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=n>n</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>=</span> <span class=n>p</span>
<a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span> <span class=o>=</span> <span class=n>ensemble</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a>
<a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=k>def</span><span class=w> </span><span class=nf>_fourier_expansion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=n>base</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a>            <span class=p>[</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a>                <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>data</span> <span class=o>*</span> <span class=n>n</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>),</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a>                <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>data</span> <span class=o>*</span> <span class=n>n</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>),</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=p>]</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=p>)</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=k>return</span> <span class=n>base</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=p>):</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build the Polynomial information matrix.</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        Each column of the information matrix represents a candidate</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>        regressor. The set of candidate regressors are based on xlag,</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>        ylag, and degree defined by the user.</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>        ----------</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>            Target data used on training phase.</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>        predefined_regressors : ndarray of int</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=sd>            The index of the selected regressors by the Model Structure</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=sd>            Selection algorithm.</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>
<a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>        Returns</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>        -------</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>        psi = ndarray of floats</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=sd>            The lagged matrix built in respect with each lag and column.</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>
<a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=c1># remove intercept (because the data always have the intercept)</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>                <span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=p>)</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>columns</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>harmonics</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>([</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=n>base_col</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>                <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_fourier_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>],</span> <span class=n>h</span><span class=p>)</span> <span class=k>for</span> <span class=n>h</span> <span class=ow>in</span> <span class=n>harmonics</span><span class=p>]</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=p>)</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>psi</span><span class=p>,</span> <span class=n>base_col</span><span class=p>])</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>            <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a>
<a id=__codelineno-0-133 name=__codelineno-0-133></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=p>):</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Fourier Basis Functions.</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>        ----------</span>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>        Returns</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>        -------</span>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._fourier.Fourier.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._fourier.Fourier.fit class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build the Polynomial information matrix.</p> <p>Each column of the information matrix represents a candidate regressor. The set of candidate regressors are based on xlag, ylag, and degree defined by the user.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Target data used on training phase.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The index of the selected regressors by the Model Structure Selection algorithm.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>psi = ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built in respect with each lag and column.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_fourier.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=p>):</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build the Polynomial information matrix.</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>    Each column of the information matrix represents a candidate</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>    regressor. The set of candidate regressors are based on xlag,</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    ylag, and degree defined by the user.</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>    ----------</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>        Target data used on training phase.</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>    predefined_regressors : ndarray of int</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=sd>        The index of the selected regressors by the Model Structure</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=sd>        Selection algorithm.</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>
<a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>    Returns</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>    -------</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>    psi = ndarray of floats</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=sd>        The lagged matrix built in respect with each lag and column.</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>
<a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>    <span class=c1># remove intercept (because the data always have the intercept)</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>            <span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=p>)</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=n>columns</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>    <span class=n>harmonics</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>([</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=n>base_col</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_fourier_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>],</span> <span class=n>h</span><span class=p>)</span> <span class=k>for</span> <span class=n>h</span> <span class=ow>in</span> <span class=n>harmonics</span><span class=p>]</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=p>)</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>psi</span><span class=p>,</span> <span class=n>base_col</span><span class=p>])</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a>    <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>    <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._fourier.Fourier.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._fourier.Fourier.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Fourier Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_fourier.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=p>):</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Fourier Basis Functions.</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>    ----------</span>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>    Returns</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>    -------</span>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._legendre></a> <div class="doc doc-contents first"> <p>Legendre Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._legendre.Legendre class="doc doc-heading"> <code>Legendre</code> <a href=#sysidentpy.basis_function._legendre.Legendre class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build Legendre basis function expansion.</p> <p>This class constructs a feature matrix consisting of Legendre polynomial basis functions up to a specified degree. Legendre polynomials, denoted by <span class=arithmatex>\(P_n(x)\)</span>, are orthogonal polynomials over the interval <span class=arithmatex>\([-1, 1]\)</span> with respect to the uniform weight function <span class=arithmatex>\(w(x) = 1\)</span>. They are widely used in numerical analysis, curve fitting, and approximation theory.</p> <p>The Legendre polynomial <span class=arithmatex>\(P_n(x)\)</span> of degree <span class=arithmatex>\(n\)</span> is defined by the following recurrence relation:</p> <div class=arithmatex>\[ P_0(x) = 1 \]</div> <div class=arithmatex>\[ P_1(x) = x \]</div> <div class=arithmatex>\[ (n+1) P_{n+1}(x) = (2n + 1)x P_n(x) - n P_{n-1}(x) \]</div> <p>where <span class=arithmatex>\(P_n(x)\)</span> represents the Legendre polynomial of degree <span class=arithmatex>\(n\)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the Legendre polynomial basis functions to be generated.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>include_bias</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include the bias (constant) term in the output feature matrix.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>ensemble</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If True, the original data is concatenated with the polynomial features.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The number of features in the output matrix increases as the degree of the polynomial increases, which can lead to a high-dimensional feature space. Consider using dimensionality reduction techniques if overfitting becomes an issue.</p> </details> <details class=references open> <summary>References</summary> <ul> <li>Wikipedia: Legendre polynomial <a href=https://en.wikipedia.org/wiki/Legendre_polynomials>https://en.wikipedia.org/wiki/Legendre_polynomials</a></li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_legendre.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=k>class</span><span class=w> </span><span class=nc>Legendre</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build Legendre basis function expansion.</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    This class constructs a feature matrix consisting of Legendre polynomial basis</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>    functions up to a specified degree. Legendre polynomials, denoted by $P_n(x)$,</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    are orthogonal polynomials over the interval $[-1, 1]$ with respect to the</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    uniform weight function $w(x) = 1$. They are widely used in numerical analysis,</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>    curve fitting, and approximation theory.</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    The Legendre polynomial $P_n(x)$ of degree $n$ is defined by the following</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    recurrence relation:</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    $$</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    P_0(x) = 1</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    $$</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    $$</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    P_1(x) = x</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    $$</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    $$</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    (n+1) P_{n+1}(x) = (2n + 1)x P_n(x) - n P_{n-1}(x)</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    $$</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    where $P_n(x)$ represents the Legendre polynomial of degree $n$.</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a>
<a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    ----------</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>    degree : int, default=2</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>        The maximum degree of the Legendre polynomial basis functions to be generated.</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>    include_bias : bool, default=True</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>        Whether to include the bias (constant) term in the output feature matrix.</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    ensemble : bool, default=False</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>        If True, the original data is concatenated with the polynomial features.</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a>
<a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>    Notes</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    -----</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>    The number of features in the output matrix increases as the degree of the</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    polynomial increases, which can lead to a high-dimensional feature space.</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>    Consider using dimensionality reduction techniques if overfitting becomes an issue.</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    References</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    ----------</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>    - Wikipedia: Legendre polynomial</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>        https://en.wikipedia.org/wiki/Legendre_polynomials</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a>
<a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a>
<a id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=n>include_bias</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=n>ensemble</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=p>):</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span> <span class=o>=</span> <span class=n>include_bias</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span> <span class=o>=</span> <span class=n>ensemble</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>
<a id=__codelineno-0-71 name=__codelineno-0-71></a>    <span class=k>def</span><span class=w> </span><span class=nf>_legendre_expansion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=n>num_samples</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=n>basis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>num_samples</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a>            <span class=n>basis</span><span class=p>[:,</span> <span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>eval_legendre</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=k>return</span> <span class=n>basis</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>    <span class=p>):</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=c1># remove intercept (because data always have the intercept)</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=n>n_features</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_legendre_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>])</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_features</span><span class=p>)]</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=c1># remove P0(x) = 1 from every column expansion</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=n>basis</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span> <span class=k>for</span> <span class=n>basis</span> <span class=ow>in</span> <span class=n>psi</span><span class=p>]</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span><span class=n>psi</span><span class=p>)</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>psi</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span><span class=p>:</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=n>bias_column</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>psi</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_column</span><span class=p>,</span> <span class=n>psi</span><span class=p>))</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=p>):</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>        ----------</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>        Returns</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        -------</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._legendre.Legendre.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._legendre.Legendre.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Bersntein Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_legendre.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=p>):</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>    ----------</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>    Returns</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>    -------</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._polynomial></a> <div class="doc doc-contents first"> <p>Polynomial Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._polynomial.Polynomial class="doc doc-heading"> <code>Polynomial</code> <a href=#sysidentpy.basis_function._polynomial.Polynomial class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build polynomial basis function.</p> <p>Generate a new feature matrix consisting of all polynomial combinations of the features with degree less than or equal to the specified degree.</p> <div class=arithmatex>\[ y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}u_{k-j}^{b_i, j} \prod_{l=1}^{n_e}e_{k-l}^{d_i, l}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \]</div> <p>where <span class=arithmatex>\(p\)</span> is the number of regressors, <span class=arithmatex>\(\Theta_i\)</span> are the model parameters, and <span class=arithmatex>\(a_i, m, b_i, j\)</span> and <span class=arithmatex>\(d_i, l \in \mathbb{N}\)</span> are the exponents of the output, input and noise terms, respectively.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span>(<span title=max_degree>max_degree</span>)</code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the polynomial features.</p> </div> </td> <td> <code>2</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>Be aware that the number of features in the output array scales significantly as the number of inputs, the max lag of the input and output, and degree increases. High degrees can cause overfitting.</p> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_polynomial.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-10> 10</a></span>
<span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=k>class</span><span class=w> </span><span class=nc>Polynomial</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build polynomial basis function.</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a>
<a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=sd>    Generate a new feature matrix consisting of all polynomial combinations</span>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    of the features with degree less than or equal to the specified degree.</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    $$</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>        y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}u_{k-j}^{b_i, j}</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>        \prod_{l=1}^{n_e}e_{k-l}^{d_i, l}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m}</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    $$</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    where $p$ is the number of regressors, $\Theta_i$ are the</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    model parameters, and $a_i, m, b_i, j$ and $d_i, l \in \mathbb{N}$</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    are the exponents of the output, input and noise terms, respectively.</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>    ----------</span>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    degree : int (max_degree), default=2</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>        The maximum degree of the polynomial features.</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    Notes</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    -----</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    Be aware that the number of features in the output array scales</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    significantly as the number of inputs, the max lag of the input and output, and</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    degree increases. High degrees can cause overfitting.</span>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a>
<a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=p>):</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-42 name=__codelineno-0-42></a>
<a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=p>):</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build the Polynomial information matrix.</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>        Each columns of the information matrix represents a candidate</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>        regressor. The set of candidate regressors are based on xlag,</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>        ylag, and degree defined by the user.</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a>
<a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>        ----------</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>            Target data used on training phase.</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>        predefined_regressors : ndarray of int</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>            The index of the selected regressors by the Model Structure</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>            Selection algorithm.</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        Returns</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        -------</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        psi = ndarray of floats</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>            The lagged matrix built in respect with each lag and column.</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=c1># Create combinations of all columns based on its index</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=n>iterable_list</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=n>combination_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=n>combinations_with_replacement</span><span class=p>(</span><span class=n>iterable_list</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=p>)</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=n>combination_list</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>                <span class=n>combination_list</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=k>for</span> <span class=n>index</span> <span class=ow>in</span> <span class=n>predefined_regressors</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=p>]</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=p>[</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=n>np</span><span class=o>.</span><span class=n>prod</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>combination_list</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>combination_list</span><span class=p>))</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=p>]</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=p>)</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=p>:]</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>    <span class=p>):</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Polynomial Basis Functions.</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>
<a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>        ----------</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>        Returns</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        -------</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._polynomial.Polynomial.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._polynomial.Polynomial.fit class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build the Polynomial information matrix.</p> <p>Each columns of the information matrix represents a candidate regressor. The set of candidate regressors are based on xlag, ylag, and degree defined by the user.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Target data used on training phase.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The index of the selected regressors by the Model Structure Selection algorithm.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>psi = ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built in respect with each lag and column.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_polynomial.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span>
<span class=normal><a href=#__codelineno-0-94>94</a></span>
<span class=normal><a href=#__codelineno-0-95>95</a></span>
<span class=normal><a href=#__codelineno-0-96>96</a></span>
<span class=normal><a href=#__codelineno-0-97>97</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=p>):</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build the Polynomial information matrix.</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    Each columns of the information matrix represents a candidate</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    regressor. The set of candidate regressors are based on xlag,</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>    ylag, and degree defined by the user.</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a>
<a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>    ----------</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>        Target data used on training phase.</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>    predefined_regressors : ndarray of int</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        The index of the selected regressors by the Model Structure</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        Selection algorithm.</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>    Returns</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>    -------</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    psi = ndarray of floats</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        The lagged matrix built in respect with each lag and column.</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=c1># Create combinations of all columns based on its index</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=n>iterable_list</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=n>combination_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>combinations_with_replacement</span><span class=p>(</span><span class=n>iterable_list</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>    <span class=p>)</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>    <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=n>combination_list</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=n>combination_list</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=k>for</span> <span class=n>index</span> <span class=ow>in</span> <span class=n>predefined_regressors</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=p>]</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>(</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=p>[</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=n>np</span><span class=o>.</span><span class=n>prod</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>combination_list</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>combination_list</span><span class=p>))</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=p>]</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=p>)</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>    <span class=n>psi</span> <span class=o>=</span> <span class=n>psi</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=p>:]</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=k>return</span> <span class=n>psi</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._polynomial.Polynomial.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._polynomial.Polynomial.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Polynomial Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_polynomial.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=p>):</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Polynomial Basis Functions.</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>
<a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>    ----------</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>    Returns</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>    -------</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._hermite></a> <div class="doc doc-contents first"> <p>Hermite Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._hermite.Hermite class="doc doc-heading"> <code>Hermite</code> <a href=#sysidentpy.basis_function._hermite.Hermite class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build Hermite basis function expansion.</p> <p>This class constructs a feature matrix consisting of Hermite polynomial basis functions up to a specified degree. Hermite polynomials, denoted by <span class=arithmatex>\(H_n(x)\)</span>, are orthogonal polynomials over the interval <span class=arithmatex>\((-\infty, \infty)\)</span> with respect to the weight function <span class=arithmatex>\(w(x) = e^{-x^2}\)</span>. These polynomials are widely used in probability theory, quantum mechanics, and numerical analysis, particularly in solving the quantum harmonic oscillator and in the field of statistics.</p> <p><strong>Physicist's Hermite polynomials</strong> <span class=arithmatex>\(H_n(x)\)</span>, often used in physics: $$ H_n(x) = (-1)^n e<sup>{x</sup>2} \frac{d<sup>n}{dx</sup>n} e<sup>{-x</sup>2} $$</p> <p>The Hermite polynomial <span class=arithmatex>\(H_n(x)\)</span> of degree <span class=arithmatex>\(n\)</span> can be also defined by the following recurrence relation:</p> <div class=arithmatex>\[ H_0(x) = 1 \]</div> <div class=arithmatex>\[ H_1(x) = 2x \]</div> <div class=arithmatex>\[ H_{n+1}(x) = 2x H_n(x) - 2n H_{n-1}(x) \]</div> <p>where <span class=arithmatex>\(H_n(x)\)</span> represents the Hermite polynomial of degree <span class=arithmatex>\(n\)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the Hermite polynomial basis functions to be generated.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>include_bias</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include the bias (constant) term in the output feature matrix.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>ensemble</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If True, the original data is concatenated with the polynomial features.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The number of features in the output matrix increases as the degree of the polynomial increases, which can lead to a high-dimensional feature space. Consider using dimensionality reduction techniques if overfitting becomes an issue.</p> </details> <details class=references open> <summary>References</summary> <ul> <li>Wikipedia: Hermite polynomial <a href=https://en.wikipedia.org/wiki/Hermite_polynomials>https://en.wikipedia.org/wiki/Hermite_polynomials</a></li> <li>Scipy: <a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_hermite.html>https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_hermite.html</a></li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_hermite.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=k>class</span><span class=w> </span><span class=nc>Hermite</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build Hermite basis function expansion.</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    This class constructs a feature matrix consisting of Hermite polynomial basis</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>    functions up to a specified degree. Hermite polynomials, denoted by $H_n(x)$,</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    are orthogonal polynomials over the interval $(-\infty, \infty)$ with respect</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    to the weight function $w(x) = e^{-x^2}$. These polynomials are widely used in</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>    probability theory, quantum mechanics, and numerical analysis, particularly in</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    solving the quantum harmonic oscillator and in the field of statistics.</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    **Physicist&#39;s Hermite polynomials** $H_n(x)$, often used in physics:</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    $$</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    H_n(x) = (-1)^n e^{x^2} \frac{d^n}{dx^n} e^{-x^2}</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    $$</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>    The Hermite polynomial $H_n(x)$ of degree $n$ can be also defined by the following</span>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    recurrence relation:</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    $$</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    H_0(x) = 1</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    $$</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    $$</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    H_1(x) = 2x</span>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    $$</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a>
<a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>    $$</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    H_{n+1}(x) = 2x H_n(x) - 2n H_{n-1}(x)</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>    $$</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a>
<a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>    where $H_n(x)$ represents the Hermite polynomial of degree $n$.</span>
<a id=__codelineno-0-42 name=__codelineno-0-42></a>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    ----------</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    degree : int, default=2</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>        The maximum degree of the Hermite polynomial basis functions to be generated.</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a>
<a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>    include_bias : bool, default=True</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>        Whether to include the bias (constant) term in the output feature matrix.</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    ensemble : bool, default=False</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>        If True, the original data is concatenated with the polynomial features.</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    Notes</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    -----</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>    The number of features in the output matrix increases as the degree of the</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>    polynomial increases, which can lead to a high-dimensional feature space.</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>    Consider using dimensionality reduction techniques if overfitting becomes an issue.</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a>
<a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>    References</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>    ----------</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>    - Wikipedia: Hermite polynomial</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>        https://en.wikipedia.org/wiki/Hermite_polynomials</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>    - Scipy: https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_hermite.html</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a>
<a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a>        <span class=n>include_bias</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=n>ensemble</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=p>):</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span> <span class=o>=</span> <span class=n>include_bias</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span> <span class=o>=</span> <span class=n>ensemble</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=k>def</span><span class=w> </span><span class=nf>_hermite_expansion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=n>num_samples</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=n>basis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>num_samples</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=n>basis</span><span class=p>[:,</span> <span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>eval_hermite</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=k>return</span> <span class=n>basis</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=p>):</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=c1># remove intercept (because data always have the intercept)</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=n>n_features</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_hermite_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>])</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_features</span><span class=p>)]</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=c1># remove P0(x) = 1 from every column expansion</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=n>basis</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span> <span class=k>for</span> <span class=n>basis</span> <span class=ow>in</span> <span class=n>psi</span><span class=p>]</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span><span class=n>psi</span><span class=p>)</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>psi</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span><span class=p>:</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=n>bias_column</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>psi</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_column</span><span class=p>,</span> <span class=n>psi</span><span class=p>))</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>            <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=p>):</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>        ----------</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>
<a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>        Returns</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>        -------</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._hermite.Hermite.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._hermite.Hermite.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Bersntein Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_hermite.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=p>):</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    ----------</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a>
<a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>    Returns</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>    -------</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._hermite_normalized></a> <div class="doc doc-contents first"> <p>Hermite Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._hermite_normalized.HermiteNormalized class="doc doc-heading"> <code>HermiteNormalized</code> <a href=#sysidentpy.basis_function._hermite_normalized.HermiteNormalized class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build probabilist's Normalized Hermite basis function expansion.</p> <p>This class constructs a feature matrix consisting of Hermite Normalized polynomial basis functions up to a specified degree. Hermite (normalized) polynomials, denoted by <span class=arithmatex>\(H_n(x)\)</span>, are orthogonal polynomials over the interval <span class=arithmatex>\((-\infty, \infty)\)</span> with respect to the weight function <span class=arithmatex>\(w(x) = e^{-x^2}\)</span>. These polynomials are widely used in probability theory, quantum mechanics, and numerical analysis, particularly in solving the quantum harmonic oscillator and in the field of statistics.</p> <p>Probabilist's Hermite polynomials <span class=arithmatex>\(He_n(x)\)</span>: $$ He_n(x) = (-1)^n e<sup>{x</sup>2/2} \frac{d<sup>n}{dx</sup>n} e<sup>{-x</sup>2/2} $$</p> <p>where <span class=arithmatex>\(He_n(x)\)</span> represents the probabilist's Normalized Hermite polynomial of degree <span class=arithmatex>\(n\)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the Hermite polynomial basis functions to be generated.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>include_bias</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include the bias (constant) term in the output feature matrix.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>ensemble</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If True, the original data is concatenated with the polynomial features.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The number of features in the output matrix increases as the degree of the polynomial increases, which can lead to a high-dimensional feature space. Consider using dimensionality reduction techniques if overfitting becomes an issue.</p> </details> <details class=references open> <summary>References</summary> <ul> <li>Wikipedia: Hermite polynomial <a href=https://en.wikipedia.org/wiki/Hermite_polynomials>https://en.wikipedia.org/wiki/Hermite_polynomials</a></li> <li>Scipy: <a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_hermitenorm.html>https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_hermitenorm.html</a></li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_hermite_normalized.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=k>class</span><span class=w> </span><span class=nc>HermiteNormalized</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build probabilist&#39;s Normalized Hermite basis function expansion.</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    This class constructs a feature matrix consisting of Hermite Normalized polynomial</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>    basis functions up to a specified degree. Hermite (normalized) polynomials,</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    denoted by $H_n(x)$, are orthogonal polynomials over the interval</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    $(-\infty, \infty)$ with respect to the weight function $w(x) = e^{-x^2}$.</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>    These polynomials are widely used in probability theory, quantum mechanics,</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    and numerical analysis, particularly in solving the quantum harmonic oscillator</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    and in the field of statistics.</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    Probabilist&#39;s Hermite polynomials $He_n(x)$:</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    $$</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    He_n(x) = (-1)^n e^{x^2/2} \frac{d^n}{dx^n} e^{-x^2/2}</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    $$</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    where $He_n(x)$ represents the probabilist&#39;s Normalized Hermite polynomial</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    of degree $n$.</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    ----------</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    degree : int, default=2</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>        The maximum degree of the Hermite polynomial basis functions to be generated.</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    include_bias : bool, default=True</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>        Whether to include the bias (constant) term in the output feature matrix.</span>
<a id=__codelineno-0-37 name=__codelineno-0-37></a>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    ensemble : bool, default=False</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>        If True, the original data is concatenated with the polynomial features.</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a>
<a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>    Notes</span>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>    -----</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    The number of features in the output matrix increases as the degree of the</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    polynomial increases, which can lead to a high-dimensional feature space.</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    Consider using dimensionality reduction techniques if overfitting becomes an issue.</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a>
<a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>    References</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>    ----------</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    - Wikipedia: Hermite polynomial</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>        https://en.wikipedia.org/wiki/Hermite_polynomials</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    - Scipy: https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_hermitenorm.html</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a>
<a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-54 name=__codelineno-0-54></a>
<a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=n>include_bias</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=n>ensemble</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=p>):</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span> <span class=o>=</span> <span class=n>include_bias</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span> <span class=o>=</span> <span class=n>ensemble</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a>
<a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=k>def</span><span class=w> </span><span class=nf>_hermitenorm_expansion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=n>num_samples</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>basis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>num_samples</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a>            <span class=n>basis</span><span class=p>[:,</span> <span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>eval_hermitenorm</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=k>return</span> <span class=n>basis</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a>
<a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=p>):</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=c1># remove intercept (because data always have the intercept)</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>n_features</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_hermitenorm_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>])</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_features</span><span class=p>)]</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=c1># remove P0(x) = 1 from every column expansion</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=n>basis</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span> <span class=k>for</span> <span class=n>basis</span> <span class=ow>in</span> <span class=n>psi</span><span class=p>]</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span><span class=n>psi</span><span class=p>)</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>psi</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span><span class=p>:</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=n>bias_column</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>psi</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_column</span><span class=p>,</span> <span class=n>psi</span><span class=p>))</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=p>):</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>        ----------</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>        Returns</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        -------</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._hermite_normalized.HermiteNormalized.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._hermite_normalized.HermiteNormalized.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Bersntein Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_hermite_normalized.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=p>):</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    ----------</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>    Returns</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>    -------</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <a id=sysidentpy.basis_function._laguerre></a> <div class="doc doc-contents first"> <p>Laguerre Basis Function for NARMAX models.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.basis_function._laguerre.Laguerre class="doc doc-heading"> <code>Laguerre</code> <a href=#sysidentpy.basis_function._laguerre.Laguerre class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=sysidentpy.basis_function.basis_function_base.BaseBasisFunction>BaseBasisFunction</span></code></p> <p>Build Laguerre basis function expansion.</p> <p>This class constructs a feature matrix consisting of Laguerre polynomial basis functions up to a specified degree. Laguerre polynomials, denoted by <span class=arithmatex>\(L_n(x)\)</span>, are orthogonal polynomials over the interval <span class=arithmatex>\([0, \infty)\)</span> with respect to the weight function <span class=arithmatex>\(w(x) = e^{-x}\)</span>. These polynomials are commonly used in physics, particularly in quantum mechanics, and in numerical analysis.</p> <p>The Laguerre polynomial <span class=arithmatex>\(L_n(x)\)</span> of degree <span class=arithmatex>\(n\)</span> is defined by the following recurrence relation:</p> <div class=arithmatex>\[ L_0(x) = 1 \]</div> <div class=arithmatex>\[ L_1(x) = 1 - x \]</div> <div class=arithmatex>\[ (n+1) L_{n+1}(x) = (2n + 1 - x) L_n(x) - n L_{n-1}(x) \]</div> <p>where <span class=arithmatex>\(L_n(x)\)</span> represents the Laguerre polynomial of degree <span class=arithmatex>\(n\)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>degree</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum degree of the Laguerre polynomial basis functions to be generated.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>include_bias</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include the bias (constant) term in the output feature matrix.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>ensemble</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If True, the original data is concatenated with the polynomial features.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=note open> <summary>Notes</summary> <p>The number of features in the output matrix increases as the degree of the polynomial increases, which can lead to a high-dimensional feature space. Consider using dimensionality reduction techniques if overfitting becomes an issue.</p> </details> <details class=references open> <summary>References</summary> <ul> <li>Wikipedia: Laguerre polynomial <a href=https://en.wikipedia.org/wiki/Laguerre_polynomials>https://en.wikipedia.org/wiki/Laguerre_polynomials</a></li> <li>Scipy: <a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_laguerre.html>https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_laguerre.html</a></li> <li>Milton Abramowitz and Irene A. Stegun, eds. Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables. New York: Dover, 1972.</li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_laguerre.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=k>class</span><span class=w> </span><span class=nc>Laguerre</span><span class=p>(</span><span class=n>BaseBasisFunction</span><span class=p>):</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Build Laguerre basis function expansion.</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    This class constructs a feature matrix consisting of Laguerre polynomial basis</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>    functions up to a specified degree. Laguerre polynomials, denoted by $L_n(x)$,</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    are orthogonal polynomials over the interval $[0, \infty)$ with respect to the</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    weight function $w(x) = e^{-x}$. These polynomials are commonly used in</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>    physics, particularly in quantum mechanics, and in numerical analysis.</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    The Laguerre polynomial $L_n(x)$ of degree $n$ is defined by the following</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    recurrence relation:</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    $$</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    L_0(x) = 1</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    $$</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    $$</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    L_1(x) = 1 - x</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    $$</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    $$</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    (n+1) L_{n+1}(x) = (2n + 1 - x) L_n(x) - n L_{n-1}(x)</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    $$</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    where $L_n(x)$ represents the Laguerre polynomial of degree $n$.</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a>
<a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    ----------</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>    degree : int, default=2</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>        The maximum degree of the Laguerre polynomial basis functions to be generated.</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>    include_bias : bool, default=True</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>        Whether to include the bias (constant) term in the output feature matrix.</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    ensemble : bool, default=False</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>        If True, the original data is concatenated with the polynomial features.</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a>
<a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>    Notes</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    -----</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>    The number of features in the output matrix increases as the degree of the</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    polynomial increases, which can lead to a high-dimensional feature space.</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>    Consider using dimensionality reduction techniques if overfitting becomes an issue.</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    References</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    ----------</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>    - Wikipedia: Laguerre polynomial</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>        https://en.wikipedia.org/wiki/Laguerre_polynomials</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>    - Scipy: https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.eval_laguerre.html</span>
<a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>    - Milton Abramowitz and Irene A. Stegun, eds. Handbook of Mathematical Functions</span>
<a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>    with Formulas, Graphs, and Mathematical Tables. New York: Dover, 1972.</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a>
<a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a>
<a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=n>degree</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>include_bias</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=n>ensemble</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=p>):</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>=</span> <span class=n>degree</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a>        <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span> <span class=o>=</span> <span class=n>include_bias</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span> <span class=o>=</span> <span class=n>ensemble</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>
<a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=k>def</span><span class=w> </span><span class=nf>_laguerre_expansion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=n>num_samples</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=n>basis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>num_samples</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=n>basis</span><span class=p>[:,</span> <span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>eval_laguerre</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=k>return</span> <span class=n>basis</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a>
<a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a>    <span class=p>):</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=c1># remove intercept (because data always have the intercept)</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>max_lag</span><span class=p>:,</span> <span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a>
<a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=n>n_features</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_laguerre_expansion</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span> <span class=n>col</span><span class=p>])</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_features</span><span class=p>)]</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=c1># remove P0(x) = 1 from every column expansion</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=n>psi</span> <span class=o>=</span> <span class=p>[</span><span class=n>basis</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span> <span class=k>for</span> <span class=n>basis</span> <span class=ow>in</span> <span class=n>psi</span><span class=p>]</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span><span class=n>psi</span><span class=p>)</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>psi</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_bias</span><span class=p>:</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=n>bias_column</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>psi</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>1</span><span class=p>))</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>bias_column</span><span class=p>,</span> <span class=n>psi</span><span class=p>))</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a>
<a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensemble</span><span class=p>:</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=n>psi</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>data</span><span class=p>,</span> <span class=n>psi</span><span class=p>])</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>
<a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=k>if</span> <span class=n>predefined_regressors</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=k>return</span> <span class=n>psi</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a>
<a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=k>return</span> <span class=n>psi</span><span class=p>[:,</span> <span class=n>predefined_regressors</span><span class=p>]</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a>
<a id=__codelineno-0-111 name=__codelineno-0-111></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a>    <span class=p>):</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        ----------</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>        data : ndarray of floats</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>            The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        max_lag : int</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>            Maximum lag of list of regressors.</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>        ylag : ndarray of int</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        xlag : ndarray of int</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>            The range of lags according to user definition.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        model_type : str</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>            The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>        predefined_regressors: ndarray</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>            Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>        Returns</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>        -------</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>        x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a><span class=sd>            Transformed array.</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.basis_function._laguerre.Laguerre.transform class="doc doc-heading"> <code class="highlight language-python"><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>ylag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;NARMAX&#39;</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.basis_function._laguerre.Laguerre.transform class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Build Bersntein Basis Functions.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The lagged matrix built with respect to each lag and column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>max_lag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Maximum lag of list of regressors.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The range of lags according to user definition.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The type of the model (NARMAX, NAR or NFIR).</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>predefined_regressors</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>Regressors to be filtered in the transformation.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>x_tr</code></td> <td> <code>{ndarray, sparse matrix} of shape (n_samples, n_features)</code> </td> <td> <div class=doc-md-description> <p>Transformed array.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/basis_function/_laguerre.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a>    <span class=n>data</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=n>max_lag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=n>ylag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=n>xlag</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=n>predefined_regressors</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=p>):</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build Bersntein Basis Functions.</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>    ----------</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>    data : ndarray of floats</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>        The lagged matrix built with respect to each lag and column.</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>    max_lag : int</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>        Maximum lag of list of regressors.</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>    ylag : ndarray of int</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    xlag : ndarray of int</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        The range of lags according to user definition.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>    model_type : str</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        The type of the model (NARMAX, NAR or NFIR).</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>    predefined_regressors: ndarray</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        Regressors to be filtered in the transformation.</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>    Returns</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>    -------</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>    x_tr : {ndarray, sparse matrix} of shape (n_samples, n_features)</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a><span class=sd>        Transformed array.</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>max_lag</span><span class=p>,</span> <span class=n>ylag</span><span class=p>,</span> <span class=n>xlag</span><span class=p>,</span> <span class=n>model_type</span><span class=p>,</span> <span class=n>predefined_regressors</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ofr-base/ class="md-footer__link md-footer__link--prev" aria-label="Previous: OFR Base"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> OFR Base </div> </div> </a> <a href=../frols/ class="md-footer__link md-footer__link--next" aria-label="Next: FROLS"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> FROLS </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2016 - 2025 Wilson Rocha </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/wilsonrljr target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/sysidentpy/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> <a href=https://twitter.com/wilsonrljr target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../../overrides/assets/js/katex.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js></script> <script src=../../../overrides/assets/vendor/js/prism.js></script> <script src=https://cdn.jsdelivr.net/npm/apexcharts></script> <script src=../../../overrides/assets/js/chart-example.js></script> <script src=../../../overrides/assets/js/scripts.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>