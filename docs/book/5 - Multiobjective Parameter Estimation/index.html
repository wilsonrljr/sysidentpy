<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="From Classical Approaches to Neural Networks" name="description"/><meta content="Wilson Rocha" name="author"/><link href="https://sysidentpy.org/book/5%20-%20Multiobjective%20Parameter%20Estimation/" rel="canonical"/><link href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/" rel="prev"/><link href="../6%20-%20Multiobjective%20Model%20Structure%20Selection/" rel="next"/><link href="../../overrides/assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.6.0, mkdocs-material-9.5.21" name="generator"/><title>5. Multiobjective Parameter Estimation - SysIdentPy</title><link href="../../assets/stylesheets/main.66ac8b77.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/_mkdocstrings.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }

                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="orange" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#multi-objective-optimization-problem"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="SysIdentPy" class="md-header__button md-logo" data-md-component="logo" href="../.." title="SysIdentPy"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> SysIdentPy </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> 5. Multiobjective Parameter Estimation </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="orange" data-md-color-media="" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/wilsonrljr/sysidentpy" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/getting-started/"> Getting started </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../examples/basic_steps/"> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../0%20-%20Preface/"> Companion Book </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../events/events/"> Blog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/about-us/"> About </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../changelog/changelog/"> Changelog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/sponsor/"> Sponsors </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../code/narmax-base/"> Code </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="SysIdentPy" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="SysIdentPy"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg> </a> SysIdentPy </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/wilsonrljr/sysidentpy" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> wilsonrljr/sysidentpy </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/getting-started/"> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/ch0-narmax-intro/"> <span class="md-ellipsis"> Introduction to NARMAX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/basic-usage/"> <span class="md-ellipsis"> Basic Usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/get-help/"> <span class="md-ellipsis"> Get Help </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/contribute/"> <span class="md-ellipsis"> How to contribute </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/license/"> <span class="md-ellipsis"> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0"> <span class="md-ellipsis"> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_1"> <span class="md-nav__icon md-icon"></span> Features </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/basic_steps/"> <span class="md-ellipsis"> Presenting main functionality </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/defining_lags/"> <span class="md-ellipsis"> Setting specific lags </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/multiple_inputs_example/"> <span class="md-ellipsis"> Multiple Inputs usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/parameter_estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/multiobjective_parameter_estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation for NARMAX models - An Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/extended_least_squares/"> <span class="md-ellipsis"> Extended Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/n_steps_ahead_prediction/"> <span class="md-ellipsis"> Example: N-steps-ahead prediction - F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/simulating_a_predefined_model/"> <span class="md-ellipsis"> Simulate a Predefined Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/save_and_load_models/"> <span class="md-ellipsis"> Saving and Loading models using .syspy extension </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/information_criteria_examples/"> <span class="md-ellipsis"> Information Criteria - Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/general_estimators/"> <span class="md-ellipsis"> Building NARX models using general estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/fourier_basis_function/"> <span class="md-ellipsis"> Fourier Basis Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/metamss/"> <span class="md-ellipsis"> Meta-Model Structure Selection (MetaMSS) algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/narx_neural_network/"> <span class="md-ellipsis"> Building NARX Neural Network using Sysidentpy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/aols/"> <span class="md-ellipsis"> Using the Accelerated Orthogonal Least-Squares algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/entropic_regression/"> <span class="md-ellipsis"> Identification of an electromechanical system using Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/NFIR/"> <span class="md-ellipsis"> NFIR Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0"> <span class="md-ellipsis"> Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> Cases </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/air_passenger_benchmark/"> <span class="md-ellipsis"> Air Passenger benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/f_16_benchmark/"> <span class="md-ellipsis"> Example: F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/identification_of_an_electromechanical_system/"> <span class="md-ellipsis"> Identification of an electromechanical system </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/load_forecasting_benchmark/"> <span class="md-ellipsis"> Load forecasting benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/PV_forecasting_benchmark/"> <span class="md-ellipsis"> PV forecasting benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0"> <span class="md-ellipsis"> V0.3.4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> V0.3.4 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0"> <span class="md-ellipsis"> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_1_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_3_1"> <span class="md-nav__icon md-icon"></span> Features </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/basic_steps/"> <span class="md-ellipsis"> Presenting main functionality </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/defining_lags/"> <span class="md-ellipsis"> Setting specific lags </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/multiple_inputs_example/"> <span class="md-ellipsis"> Multiple Inputs usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/parameter_estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/multiobjective_parameter_estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation for NARMAX models - An Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/extended_least_squares/"> <span class="md-ellipsis"> Extended Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/n_steps_ahead_prediction/"> <span class="md-ellipsis"> Example: N-steps-ahead prediction - F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/simulating_a_predefined_model/"> <span class="md-ellipsis"> Simulate a Predefined Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/save_and_load_models/"> <span class="md-ellipsis"> Saving and Loading models using .syspy extension </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/information_criteria_examples/"> <span class="md-ellipsis"> Information Criteria - Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/general_estimators/"> <span class="md-ellipsis"> Building NARX models using general estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/fourier_basis_function/"> <span class="md-ellipsis"> Fourier Basis Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/metamss/"> <span class="md-ellipsis"> Meta-Model Structure Selection (MetaMSS) algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/narx_neural_network/"> <span class="md-ellipsis"> Building NARX Neural Network using Sysidentpy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/aols/"> <span class="md-ellipsis"> Using the Accelerated Orthogonal Least-Squares algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/entropic_regression/"> <span class="md-ellipsis"> Identification of an electromechanical system using Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/NFIR/"> <span class="md-ellipsis"> NFIR Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0"> <span class="md-ellipsis"> Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_2_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_3_2"> <span class="md-nav__icon md-icon"></span> Cases </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/air_passenger_benchmark/"> <span class="md-ellipsis"> Air Passenger benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/f_16_benchmark/"> <span class="md-ellipsis"> Example: F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/identification_of_an_electromechanical_system/"> <span class="md-ellipsis"> Identification of an electromechanical system </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/load_forecasting_benchmark/"> <span class="md-ellipsis"> Load forecasting benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/PV_forecasting_benchmark/"> <span class="md-ellipsis"> PV forecasting benchmark </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex=""> <span class="md-ellipsis"> Companion Book </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Companion Book </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../0%20-%20Preface/"> <span class="md-ellipsis"> Preface </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../0.1%20-%20Contents/"> <span class="md-ellipsis"> Contents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../1%20-%20Introduction/"> <span class="md-ellipsis"> Introduction </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../2%20-%20NARMAX%20Model%20Representation/"> <span class="md-ellipsis"> 2. NARMAX Model Representation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../3%20-%20Parameter%20Estimation/"> <span class="md-ellipsis"> 3. Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/"> <span class="md-ellipsis"> 4. Model Structure Selection </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> 5. Multiobjective Parameter Estimation </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> 5. Multiobjective Parameter Estimation </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#multi-objective-optimization-problem"> <span class="md-ellipsis"> Multi-objective optimization problem </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pareto-optimal-definition-and-pareto-dominance"> <span class="md-ellipsis"> Pareto Optimal Definition and Pareto Dominance </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#affine-information-least-squares-algorithm"> <span class="md-ellipsis"> Affine Information Least Squares Algorithm </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#case-study-buck-converter"> <span class="md-ellipsis"> Case Study - Buck converter </span> </a> <nav aria-label="Case Study - Buck converter" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dynamic-behavior"> <span class="md-ellipsis"> Dynamic Behavior </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#buck-converter-static-function"> <span class="md-ellipsis"> Buck Converter Static Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#buck-converter-static-gain"> <span class="md-ellipsis"> Buck converter Static Gain </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#building-a-dynamic-model-using-the-mono-objective-approach"> <span class="md-ellipsis"> Building a dynamic model using the mono-objective approach </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#affine-information-least-squares-algorithm-ails"> <span class="md-ellipsis"> Affine Information Least Squares Algorithm (AILS) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#multiobjective-parameter-estimation-considering-3-different-objectives-the-prediction-error-the-static-function-and-the-static-gain"> <span class="md-ellipsis"> Multiobjective parameter estimation considering 3 different objectives: the prediction error, the static function and the static gain </span> </a> <nav aria-label="Multiobjective parameter estimation considering 3 different objectives: the prediction error, the static function and the static gain" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#the-dynamic-results-for-that-chosen-theta-is"> <span class="md-ellipsis"> The dynamic results for that chosen theta is </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#the-static-gain-result-is"> <span class="md-ellipsis"> The static gain result is </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#the-static-function-result-is"> <span class="md-ellipsis"> The static function result is </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#getting-the-best-weight-combination-based-on-the-norm-of-the-cost-function"> <span class="md-ellipsis"> Getting the best weight combination based on the norm of the cost function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#detailing-ails"> <span class="md-ellipsis"> Detailing AILS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#validation"> <span class="md-ellipsis"> Validation </span> </a> <nav aria-label="Validation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dynamic-results"> <span class="md-ellipsis"> Dynamic results </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#static-gain"> <span class="md-ellipsis"> Static gain </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#static-function"> <span class="md-ellipsis"> Static function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pareto-set-solutions"> <span class="md-ellipsis"> Pareto-set solutions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#biobjective-optimization"> <span class="md-ellipsis"> Biobjective optimization </span> </a> <nav aria-label="Biobjective optimization" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#an-use-case-applied-to-buck-converter-cc-cc-using-as-objectives-the-static-curve-information-and-the-prediction-error-dynamic"> <span class="md-ellipsis"> An use case applied to Buck converter CC-CC using as objectives the static curve information and the prediction error (dynamic) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#multiobjective-parameter-estimation"> <span class="md-ellipsis"> Multiobjective parameter estimation </span> </a> <nav aria-label="Multiobjective parameter estimation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#use-case-considering-2-different-objectives-the-prediction-error-and-the-static-gain"> <span class="md-ellipsis"> Use case considering 2 different objectives: the prediction error and the static gain </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#additional-information"> <span class="md-ellipsis"> Additional Information </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../6%20-%20Multiobjective%20Model%20Structure%20Selection/"> <span class="md-ellipsis"> 6. Multiobjective Model Structure Selection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../7%20-%20NARX%20Neural%20Network/"> <span class="md-ellipsis"> 7. NARX Neural Network </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../8%20-%20Severely%20Nonlinear%20System%20Identification/"> <span class="md-ellipsis"> 8. Severely Nonlinear System Identification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../9%20-%20Validation/"> <span class="md-ellipsis"> 9. Validation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../10%20-%20Case%20Studies/"> <span class="md-ellipsis"> 10. Case Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/events/"> <span class="md-ellipsis"> Events </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/> <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0"> <span class="md-ellipsis"> Meetups </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_2"> <span class="md-nav__icon md-icon"></span> Meetups </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/ai-networks-meetup/"> <span class="md-ellipsis"> AI Networks Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/nubank-meetup/"> <span class="md-ellipsis"> Nubank Timeseries Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/nubank-meetup-open-source.md"> <span class="md-ellipsis"> Nubank Open Source Talk </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/gcom-meetup/"> <span class="md-ellipsis"> GCoM Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/estatidados/"> <span class="md-ellipsis"> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> About </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/about-us/"> <span class="md-ellipsis"> About Us </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/attribute/"> <span class="md-ellipsis"> Attribute </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../changelog/changelog/"> <span class="md-ellipsis"> Changes in SysIdentPy </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/sponsor/"> <span class="md-ellipsis"> Sponsors </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0"> <span class="md-ellipsis"> Code </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Code </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/narmax-base/"> <span class="md-ellipsis"> NARMAX Base </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/basis-function/"> <span class="md-ellipsis"> Basis Functions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/frols/"> <span class="md-ellipsis"> FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metamss/"> <span class="md-ellipsis"> MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/aols/"> <span class="md-ellipsis"> AOLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/entropic-regression/"> <span class="md-ellipsis"> Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/neural-narx/"> <span class="md-ellipsis"> Neural NARX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/general-estimators/"> <span class="md-ellipsis"> General Estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/parameter-estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/multiobjective-parameter-estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/simulation/"> <span class="md-ellipsis"> Simulation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/residues/"> <span class="md-ellipsis"> Residual Analysis </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metaheuristics/"> <span class="md-ellipsis"> Metaheuristics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metrics/"> <span class="md-ellipsis"> Metrics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/utils/"> <span class="md-ellipsis"> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#multi-objective-optimization-problem"> <span class="md-ellipsis"> Multi-objective optimization problem </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pareto-optimal-definition-and-pareto-dominance"> <span class="md-ellipsis"> Pareto Optimal Definition and Pareto Dominance </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#affine-information-least-squares-algorithm"> <span class="md-ellipsis"> Affine Information Least Squares Algorithm </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#case-study-buck-converter"> <span class="md-ellipsis"> Case Study - Buck converter </span> </a> <nav aria-label="Case Study - Buck converter" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dynamic-behavior"> <span class="md-ellipsis"> Dynamic Behavior </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#buck-converter-static-function"> <span class="md-ellipsis"> Buck Converter Static Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#buck-converter-static-gain"> <span class="md-ellipsis"> Buck converter Static Gain </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#building-a-dynamic-model-using-the-mono-objective-approach"> <span class="md-ellipsis"> Building a dynamic model using the mono-objective approach </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#affine-information-least-squares-algorithm-ails"> <span class="md-ellipsis"> Affine Information Least Squares Algorithm (AILS) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#multiobjective-parameter-estimation-considering-3-different-objectives-the-prediction-error-the-static-function-and-the-static-gain"> <span class="md-ellipsis"> Multiobjective parameter estimation considering 3 different objectives: the prediction error, the static function and the static gain </span> </a> <nav aria-label="Multiobjective parameter estimation considering 3 different objectives: the prediction error, the static function and the static gain" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#the-dynamic-results-for-that-chosen-theta-is"> <span class="md-ellipsis"> The dynamic results for that chosen theta is </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#the-static-gain-result-is"> <span class="md-ellipsis"> The static gain result is </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#the-static-function-result-is"> <span class="md-ellipsis"> The static function result is </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#getting-the-best-weight-combination-based-on-the-norm-of-the-cost-function"> <span class="md-ellipsis"> Getting the best weight combination based on the norm of the cost function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#detailing-ails"> <span class="md-ellipsis"> Detailing AILS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#validation"> <span class="md-ellipsis"> Validation </span> </a> <nav aria-label="Validation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dynamic-results"> <span class="md-ellipsis"> Dynamic results </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#static-gain"> <span class="md-ellipsis"> Static gain </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#static-function"> <span class="md-ellipsis"> Static function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pareto-set-solutions"> <span class="md-ellipsis"> Pareto-set solutions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#biobjective-optimization"> <span class="md-ellipsis"> Biobjective optimization </span> </a> <nav aria-label="Biobjective optimization" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#an-use-case-applied-to-buck-converter-cc-cc-using-as-objectives-the-static-curve-information-and-the-prediction-error-dynamic"> <span class="md-ellipsis"> An use case applied to Buck converter CC-CC using as objectives the static curve information and the prediction error (dynamic) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#multiobjective-parameter-estimation"> <span class="md-ellipsis"> Multiobjective parameter estimation </span> </a> <nav aria-label="Multiobjective parameter estimation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#use-case-considering-2-different-objectives-the-prediction-error-and-the-static-gain"> <span class="md-ellipsis"> Use case considering 2 different objectives: the prediction error and the static gain </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#additional-information"> <span class="md-ellipsis"> Additional Information </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href="https://github.com/wilsonrljr/sysidentpy/edit/master/docs/book/5 - Multiobjective Parameter Estimation.md" title="Edit this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg> </a> <a class="md-content__button md-icon" href="https://github.com/wilsonrljr/sysidentpy/raw/master/docs/book/5 - Multiobjective Parameter Estimation.md" title="View source of this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"></path></svg> </a> <h1>5. Multiobjective Parameter Estimation</h1> <p>Multiobjective parameter estimation represents a fundamental paradigm shift in the way we approach the parameter tuning problem for NARMAX models. Instead of seeking a single set of parameter values that optimally fits the model to the data, multiobjective approaches aim to identify a set of parameter solutions, known as the Pareto front, that provide a trade-off between competing objectives. These objectives often encompass a spectrum of model performance criteria, such as goodness-of-fit, model complexity, and robustness.</p> <p>What does that mean? It means that when we are modeling a dynamical system we are, most of the time, building models that are only good to represent the dynamical behavior of the system under study. Well, that is valid most of the time because we are building dynamical models, so if it doesn't perform well in static scenarios, it won't be a problem. However, that's not always the case and we might build a model that is good in both dynamical and static behavior. In such cases, the methods for purely dynamical systems are not adequate and multiobjective algorithms can help us in such task.</p> <p>The main idea in multiobjective parameter estimation is the inclusion of the <em>affine information</em>. The affine information is an auxiliary information that can be defined <em>a priori</em> such as the static gain and the static function of the system. Formally, the affine information can be defined as <a href="https://www.researchgate.net/publication/216771768_Multiobjective_parameter_estimation_for_nonlinear_systems_Affine_information_and_least-squares_formulation">follows</a>:</p> <p>Let the parameter vector <span class="arithmatex">\(\Theta \in \mathbb{R}^{n_{\Theta}}\)</span>, a vector <span class="arithmatex">\(\mathrm{v}\in \mathbb{R}^p\)</span> and a matrix <span class="arithmatex">\(\mathrm{G}\in \mathbb{R}^{n_{\Theta}\times p}\)</span> where <span class="arithmatex">\(\mathrm{v}\)</span> and <span class="arithmatex">\(\mathrm{G}\)</span> are assumed to be accessible. Suppose <span class="arithmatex">\(\mathrm{G}\Theta\)</span> be an estimate of <span class="arithmatex">\(\mathrm{v}\)</span>. Hence <span class="arithmatex">\(\mathrm{v} = \mathrm{G}\Theta + \xi\)</span>. Then, <span class="arithmatex">\([\mathrm{v}, \mathrm{G}]\)</span> is a pair of affine information of the system.</p> <h2 id="multi-objective-optimization-problem">Multi-objective optimization problem<a class="headerlink" href="#multi-objective-optimization-problem" title="Permanent link"></a></h2> <p>Lets define what is a multiobjective problem. Given <span class="arithmatex">\(m\)</span> objective functions</p> <div class="arithmatex">\[ \begin{equation} \mathrm{J}(\hat{\Theta}) = [J_1(\hat{\Theta}), J_2(\hat{\Theta}), \cdots, J_m(\hat{\Theta})]^\top, \end{equation} \tag{5.1} \]</div> <p>where <span class="arithmatex">\(\mathrm{J}(\cdot):\mathbb{R}^n \mapsto \mathbb{R}^m\)</span>, a multi-objective optimization problem can be generally stated as (<a href="https://www.tandfonline.com/doi/abs/10.1080/03052159908941394">A. Baykasoglu, S. Owen, e N. Gindy</a>)</p> <div class="arithmatex">\[ \begin{equation} \begin{aligned} &amp; \underset{\Theta}{\text{minimize}} &amp; &amp; \mathrm{J}(\Theta) \\ &amp; \text{subject to} &amp; &amp; \Theta \in \mathrm{S} = \left\{\Theta \mid \Theta \in \mathrm{A}^n, g_i(\Theta) \leq a_i, h_j(\Theta) = b_j \right\}, \\ &amp; &amp; &amp; i = 1, \ldots, m, \quad j = 1, \ldots, n \end{aligned} \end{equation} \tag{5.2} \]</div> <p>where <span class="arithmatex">\(\Theta\)</span> is an <span class="arithmatex">\(n\)</span>-dimensional vector of the decision variables, <span class="arithmatex">\(\mathrm{S}\)</span> is the set of feasible solutions bounded by <span class="arithmatex">\(m\)</span> inequality constraints (<span class="arithmatex">\(g_i\)</span>) and <span class="arithmatex">\(n\)</span> equality constraints (<span class="arithmatex">\(h_j\)</span>), and <span class="arithmatex">\(a_i\)</span> and <span class="arithmatex">\(b_j\)</span> are constants. For continuous variables <span class="arithmatex">\(A = \mathbb{R}\)</span> while <span class="arithmatex">\(A\)</span> contains the set of permissible values for discrete variables.</p> <blockquote> <p>Usually problems with <span class="arithmatex">\(1 &lt; m &lt; 4\)</span> are <em>called multiobjective optimization problems</em>. When there are more objectives (<span class="arithmatex">\(m\geq 4\)</span>), it is referred as <em>many-objective optimization problems</em>, a emergence class of multi-objective problems for solving complex modern real-world tasks. More details can be found in <a href="[Many-Objective Optimization: An Engineering Design Perspective](https://www.researchgate.net/publication/216300612_Many-Objective_Optimization_An_Engineering_Design_Perspective)">Fleming, P. J. and Purshouse, R. C. and Lygoe, R. J.</a>, <a href="[A survey on multi-objective evolutionary algorithms for many-objective problems](https://link.springer.com/article/10.1007/s10589-014-9644-1)">Li, B. and Li, J. and Tang, K. and Yao, X.</a>.</p> </blockquote> <h2 id="pareto-optimal-definition-and-pareto-dominance">Pareto Optimal Definition and Pareto Dominance<a class="headerlink" href="#pareto-optimal-definition-and-pareto-dominance" title="Permanent link"></a></h2> <blockquote> <p>Consider <span class="arithmatex">\([y^{(1)}, y^{(2)}] \in \mathbb{R}^m\)</span> two vectors in the objective space. If and only if <span class="arithmatex">\(\forall \in \{1, \ldots, m \}: y_i^{(1)}\leq y_i^{(2)}\)</span> and <span class="arithmatex">\(\exists j \in \{1, \ldots, m \}: y_j^{(1)} &lt; y_j^{(2)}\)</span> one can said <span class="arithmatex">\(y^{(1)} \prec y^{(2)}\)</span> (<a href="[Cone convexity, cone extreme points, and nondominated solutions in decision problems with multiobjectives](https://link.springer.com/article/10.1007/BF00932614)">P. L. Yu</a>).</p> </blockquote> <p>The concept of Pareto optimality is generally used to describe the trade-off among the minimization of different objectives. Following the pareto definition: the pareto optimal is any parameter vector representing an efficient solution where no objective function can be improved without making at least one objective function worse off will be referred to as a Pareto-model.</p> <p>In the system identification field, that means to find a model where you can't get a better dynamic performance without making the static performance worse.</p> <p>A hypothetical Pareto set is shown in Figure 1.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/pareto_example.png"><img alt="" src="../assets/pareto_example.png"/></a></p> <blockquote> <p>Figure 1. The figure illustrates the concept of Pareto optimality, where each point in the objective space represents a solution. The Pareto front is depicted as a curve, demonstrating the trade-off between two conflicting objectives. Points on the front cannot be improved in one objective without worsening the other, highlighting the balance in optimal solutions.</p> </blockquote> <p>In this case the model structure is assumed to be known and therefore there is a one-to-one correspondence between each parameter vector on the Pareto optimal solution and a model (<a href="[Multiobjective parameter estimation for non-linear systems: affine information and least-squares formulation](https://www.tandfonline.com/doi/abs/10.1080/00207170601185053)">Nepomuceno, E. G. and Takahashi, R. H. C. and Aguirre, L. A.</a>). One can build a Pareto set by applying the Weighted Sum Method, where a set of objectives are scalarized into a single objective by adding each objective multiplied by a user supplied weight. Consider</p> <div class="arithmatex">\[ \begin{equation} \mathrm{W} = \Bigg\{ w|w \in \mathbb{R}^m, w_j\geq 0 \quad \textrm{and} \quad \sum^{m}_{j=1}w_j=1 \Bigg\} \end{equation} \tag{5.3} \]</div> <p>as non-negative weights. Then, the convex optimization problem can be stated as</p> <div class="arithmatex">\[ \begin{equation} \begin{aligned} \Theta^* &amp;= \underset{\Theta}{\text{argmin}} \, \langle w, \mathrm{J}(\Theta) \rangle \end{aligned} \end{equation} \tag{5.4} \]</div> <p>where <span class="arithmatex">\(w\)</span> is a combination of weights to the different objectives functions. Therefore the Pareto-set is associated to the set of realizations of <span class="arithmatex">\(w \in \mathrm{W}\)</span>. An efficient single-step computational strategy was presented by (<a href="[Multiobjective parameter estimation for non-linear systems: affine information and least-squares formulation](https://www.tandfonline.com/doi/abs/10.1080/00207170601185053)">Nepomuceno, E. G. and Takahashi, R. H. C. and Aguirre, L. A.</a>) for solving Equation 5.4 by means of a Least Squares formulation, which is presented in the following section.</p> <h2 id="affine-information-least-squares-algorithm">Affine Information Least Squares Algorithm<a class="headerlink" href="#affine-information-least-squares-algorithm" title="Permanent link"></a></h2> <p>Consider the <span class="arithmatex">\(m\)</span> affine information pairs <span class="arithmatex">\([\mathrm{v}_i \in \mathbb{R}^{pi}, \mathrm{G}_i \mathbb{R}^{pi\times n}]\)</span> with <span class="arithmatex">\(i = 1, \ldots, m\)</span>. Assume there is exist a full column rank <span class="arithmatex">\(\mathrm{G}_i\)</span> and let <span class="arithmatex">\(M\)</span> be a model of the form</p> <div class="arithmatex">\[ y = \Psi\Theta + \epsilon. \tag{5.5} \]</div> <p>Then the <span class="arithmatex">\(m\)</span> affine information pairs can be considered in the parameter estimation by solving</p> <div class="arithmatex">\[ \begin{equation} \begin{aligned} \Theta^* &amp;= \underset{\Theta}{\text{argmin}} \sum_{i=1}^{m} w_i (\mathrm{v}_i - \mathrm{G}_i \Theta)^\top (\mathrm{v}_i - \mathrm{G}_i \Theta) \end{aligned} \end{equation} \tag{5.6} \]</div> <p>with <span class="arithmatex">\(w = [w_i, \ldots, w_m]^\top \in \mathrm{W}\)</span>. The solution of equation above is given by</p> <div class="arithmatex">\[ \begin{equation} \Theta^* = \left[\sum^{m}_{i=1}w_i\mathrm{G}_i^\top\mathrm{G}_i\right]^{-1} \left[\sum^{m}_{i=1}w_i\mathrm{G}_i^\top\mathrm{v}_i\right]. \end{equation} \tag{5.7} \]</div> <p>If there exists only one information, the problem reduces to the mono-objective Least Squares solution.</p> <p>To make things straightforward, lets check a detailed case study.</p> <h2 id="case-study-buck-converter">Case Study - Buck converter<a class="headerlink" href="#case-study-buck-converter" title="Permanent link"></a></h2> <p>A buck converter is a type of DC/DC converter that decreases the voltage (while increasing the current) from its input (power supply) to its output (load). It is similar to a boost converter (elevator) and is a type of switched-mode power supply (SMPS) that typically contains at least two semiconductors (a diode and a transistor, although modern buck converters replace the diode with a second transistor used for synchronous rectification) and at least one energy storage element, a capacitor, inductor or both combined.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.multiobjective_parameter_estimation</span> <span class="kn">import</span> <span class="n">AILS</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_relative_squared_error</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.narmax_tools</span> <span class="kn">import</span> <span class="n">set_weights</span>
</code></pre></div> <h3 id="dynamic-behavior">Dynamic Behavior<a class="headerlink" href="#dynamic-behavior" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"datasets/buck_id.csv"</span><span class="p">)</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">df_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"datasets/buck_valid.csv"</span><span class="p">)</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1"># Plotting the measured output (identification and validation data)</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Output"</span><span class="p">)</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">sampling_time</span><span class="p">,</span> <span class="n">df_train</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Identification"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_valid</span><span class="o">.</span><span class="n">sampling_time</span><span class="p">,</span> <span class="n">df_valid</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Validation"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Samples"</span><span class="p">)</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Voltage"</span><span class="p">)</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_data.png"><img alt="" src="../assets/buck_data.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1"># Plotting the measured input (identification and validation data)</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Input"</span><span class="p">)</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">sampling_time</span><span class="p">,</span> <span class="n">df_train</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Identification"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_valid</span><span class="o">.</span><span class="n">sampling_time</span><span class="p">,</span> <span class="n">df_valid</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Validation"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">)</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"u"</span><span class="p">)</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Samples"</span><span class="p">)</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_input_data.png"><img alt="" src="../assets/buck_input_data.png"/></a></p> <h3 id="buck-converter-static-function">Buck Converter Static Function<a class="headerlink" href="#buck-converter-static-function" title="Permanent link"></a></h3> <p>The duty cycle, represented by the symbol <span class="arithmatex">\(D\)</span>, is defined as the ratio of the time the system is on (<span class="arithmatex">\(T_{on}\)</span>) to the total operation cycle time (<span class="arithmatex">\(T\)</span>). Mathematically, this can be expressed as <span class="arithmatex">\(D=\frac{T_{on}}{T}\)</span>. The complement of the duty cycle, represented by <span class="arithmatex">\(D'\)</span>, is defined as the ratio of the time the system is off (<span class="arithmatex">\(T_{off}\)</span>) to the total operation cycle time (<span class="arithmatex">\(T\)</span>) and can be expressed as <span class="arithmatex">\(D'=\frac{T_{off}}{T}\)</span>.</p> <p>The load voltage (<span class="arithmatex">\(V_o\)</span>) is related to the source voltage (<span class="arithmatex">\(V_d\)</span>) by the equation <span class="arithmatex">\(V_o=DV_d=(1D)V_d\)</span>. For this particular converter, it is known that <span class="arithmatex">\(D=\frac{\bar{u}-1}{3}\)</span>, which means that the static function of this system can be derived from theory to be:</p> <div class="arithmatex">\[ V_o = \frac{4V_d}{3} - \frac{V_d}{3}\cdot \bar{u} \]</div> <p>If we assume that the source voltage <span class="arithmatex">\(V_d\)</span> is equal to 24 V, then we can rewrite the above expression as follows:</p> <div class="arithmatex">\[ V_o = (4 - \bar{u})\cdot 8 \]</div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># Static data</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="n">Vd</span> <span class="o">=</span> <span class="mi">24</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">Uo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="n">Yo</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="n">Uo</span><span class="p">)</span> <span class="o">*</span> <span class="n">Vd</span> <span class="o">/</span> <span class="mi">3</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">Uo</span> <span class="o">=</span> <span class="n">Uo</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="n">Yo</span> <span class="o">=</span> <span class="n">Yo</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Buck Converter Static Curve"</span><span class="p">)</span>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{y}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_data.png"><img alt="" src="../assets/buck_static_data.png"/></a></p> <h3 id="buck-converter-static-gain">Buck converter Static Gain<a class="headerlink" href="#buck-converter-static-gain" title="Permanent link"></a></h3> <p>The gain of a Buck converter is a measure of how its output voltage changes in response to changes in its input voltage. Mathematically, the gain can be calculated as the derivative of the converters static function, which describes the relationship between its input and output voltages.</p> <p>In this case, the static function of the Buck converter is given by the equation:</p> <div class="arithmatex">\[ V_o = (4 - \bar{u})\cdot 8 \]</div> <p>Taking the derivative of this equation with respect to <span class="arithmatex">\(\hat{u}\)</span>, we find that the gain of the Buck converter is equal to 8. In other words, for every unit increase in the input voltage <span class="arithmatex">\(\hat{u}\)</span>, the output voltage Vo will decrease by 8 units, so</p> <div class="arithmatex">\[ gain=V_o'=-8 \]</div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># Defining the gain</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="n">gain</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Uo</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Buck Converter Static Gain"</span><span class="p">)</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{gain}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"gain"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_gain.png"><img alt="" src="../assets/buck_static_gain.png"/></a></p> <h3 id="building-a-dynamic-model-using-the-mono-objective-approach">Building a dynamic model using the mono-objective approach<a class="headerlink" href="#building-a-dynamic-model-using-the-mono-objective-approach" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">x_valid</span> <span class="o">=</span> <span class="n">df_valid</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="n">y_valid</span> <span class="o">=</span> <span class="n">df_valid</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a>  <span class="n">extended_least_squares</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a>  <span class="n">estimator</span><span class="o">=</span><span class="s2">"least_squares"</span><span class="p">,</span>
<a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="p">)</span>
<a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>
<a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
</code></pre></div> <h3 id="affine-information-least-squares-algorithm-ails">Affine Information Least Squares Algorithm (AILS)<a class="headerlink" href="#affine-information-least-squares-algorithm-ails" title="Permanent link"></a></h3> <p>AILS is a multiobjective parameter estimation algorithm, based on a set of affine information pairs. The multiobjective approach proposed in the mentioned paper and implemented in SysIdentPy leads to a convex multiobjective optimization problem, which can be solved by AILS. AILS is a LeastSquares-type non-iterative scheme for finding the Pareto-set solutions for the multiobjective problem.</p> <p>So, with the model structure defined (we will be using the one built using the dynamic data above), one can estimate the parameters using the multiobjective approach.</p> <p>The information about static function and static gain, besides the usual dynamic input/output data, can be used to build the pair of affine information to estimate the parameters of the model. We can model the cost function as:</p> <div class="arithmatex">\[ \gamma(\hat\theta) = w_1\cdot J_{LS}(\hat{\theta})+w_2\cdot J_{SF}(\hat{\theta})+w_3\cdot J_{SG}(\hat{\theta}) \]</div> <h3 id="multiobjective-parameter-estimation-considering-3-different-objectives-the-prediction-error-the-static-function-and-the-static-gain">Multiobjective parameter estimation considering 3 different objectives: the prediction error, the static function and the static gain<a class="headerlink" href="#multiobjective-parameter-estimation-considering-3-different-objectives-the-prediction-error-the-static-function-and-the-static-gain" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1"># you can use any set of model structure you want in your use case, but in this notebook we will use the one obtained above the compare with other work</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">mo_estimator</span> <span class="o">=</span> <span class="n">AILS</span><span class="p">(</span><span class="n">final_model</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">)</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="c1"># setting the log-spaced weights of each objective function</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="n">w</span> <span class="o">=</span> <span class="n">set_weights</span><span class="p">(</span><span class="n">static_function</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">static_gain</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="c1"># you can also use something like</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="c1"># w = np.array(</span>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="c1">#   [</span>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="c1">#     [0.98, 0.7, 0.5, 0.35, 0.25, 0.01, 0.15, 0.01],</span>
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="c1">#     [0.01, 0.1, 0.3, 0.15, 0.25, 0.98, 0.35, 0.01],</span>
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="c1">#     [0.01, 0.2, 0.2, 0.50, 0.50, 0.01, 0.50, 0.98],</span>
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="c1">#   ]</span>
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="c1"># )</span>
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="c1"># to set the weights. Each row correspond to each objective</span>
</code></pre></div> <p>AILS has an <code>estimate</code> method that returns the cost functions (J), the Euclidean norm of the cost functions (E), the estimated parameters referring to each weight (theta), the regressor matrix of the gain and static_function affine information HR and QR, respectively.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">J</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">HR</span><span class="p">,</span> <span class="n">QR</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">mo_estimator</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span>
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>  <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="n">gain</span><span class="p">,</span> <span class="n">y_static</span><span class="o">=</span><span class="n">Yo</span><span class="p">,</span> <span class="n">X_static</span><span class="o">=</span><span class="n">Uo</span><span class="p">,</span> <span class="n">weighing_matrix</span><span class="o">=</span><span class="n">w</span>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="p">)</span>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a>  <span class="s2">"w1"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>  <span class="s2">"w2"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>  <span class="s2">"w3"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a>  <span class="s2">"J_ls"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>  <span class="s2">"J_sg"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a>  <span class="s2">"J_sf"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a>  <span class="s2">"||J||:"</span><span class="p">:</span> <span class="n">E</span><span class="p">,</span>
<a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="p">}</span>
<a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th>w1</th> <th>w2</th> <th>w3</th> <th>J_ls</th> <th>J_sg</th> <th>J_sf</th> <th><span class="arithmatex">\(\lVert J \rVert\)</span></th> </tr> </thead> <tbody> <tr> <td>0.006842</td> <td>0.003078</td> <td>0.990080</td> <td>0.999970</td> <td>1.095020e-05</td> <td>0.000013</td> <td>0.245244</td> </tr> <tr> <td>0.007573</td> <td>0.002347</td> <td>0.990080</td> <td>0.999938</td> <td>2.294665e-05</td> <td>0.000016</td> <td>0.245236</td> </tr> <tr> <td>0.008382</td> <td>0.001538</td> <td>0.990080</td> <td>0.999885</td> <td>6.504913e-05</td> <td>0.000018</td> <td>0.245223</td> </tr> <tr> <td>0.009277</td> <td>0.000642</td> <td>0.990080</td> <td>0.999717</td> <td>4.505541e-04</td> <td>0.000021</td> <td>0.245182</td> </tr> <tr> <td>0.006842</td> <td>0.098663</td> <td>0.894495</td> <td>1.000000</td> <td>7.393246e-08</td> <td>0.000015</td> <td>0.245251</td> </tr> <tr> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <td>0.659632</td> <td>0.333527</td> <td>0.006842</td> <td>0.995896</td> <td>3.965699e-04</td> <td>1.000000</td> <td>0.244489</td> </tr> <tr> <td>0.730119</td> <td>0.263039</td> <td>0.006842</td> <td>0.995632</td> <td>5.602981e-04</td> <td>0.972842</td> <td>0.244412</td> </tr> <tr> <td>0.808139</td> <td>0.185020</td> <td>0.006842</td> <td>0.995364</td> <td>8.321071e-04</td> <td>0.868299</td> <td>0.244300</td> </tr> <tr> <td>0.894495</td> <td>0.098663</td> <td>0.006842</td> <td>0.995100</td> <td>1.364999e-03</td> <td>0.660486</td> <td>0.244160</td> </tr> <tr> <td>0.990080</td> <td>0.003078</td> <td>0.006842</td> <td>0.992584</td> <td>9.825987e-02</td> <td>0.305492</td> <td>0.261455</td> </tr> </tbody> </table> <p>Now we can set theta related to any weight results</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">model</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="p">)</span> <span class="c1"># setting the theta estimated for the last combination of the weights</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="c1"># the model structure is exactly the same, but the order of the regressors is changed in estimate method. Thats why you have to change the model.final_model</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">model</span><span class="o">.</span><span class="n">final_model</span> <span class="o">=</span> <span class="n">mo_estimator</span><span class="o">.</span><span class="n">final_model</span>
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">)</span>
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>  <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a>    <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a>    <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a>    <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a>    <span class="n">err_precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a>    <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-8-18" id="__codelineno-8-18" name="__codelineno-8-18"></a>  <span class="p">),</span>
<a href="#__codelineno-8-19" id="__codelineno-8-19" name="__codelineno-8-19"></a>  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-8-20" id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="p">)</span>
<a href="#__codelineno-8-21" id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="n">r</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>2.2930E+00</td> <td>9.999E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.3307E-01</td> <td>2.042E-05</td> </tr> <tr> <td>y(k-2)</td> <td>6.3209E-01</td> <td>1.108E-06</td> </tr> <tr> <td>x1(k-1)</td> <td>-5.9333E-01</td> <td>4.688E-06</td> </tr> <tr> <td>y(k-1)^2</td> <td>2.7673E-01</td> <td>3.922E-07</td> </tr> <tr> <td>y(k-2)y(k-1)</td> <td>-5.3228E-01</td> <td>8.389E-07</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>1.6667E-02</td> <td>5.690E-07</td> </tr> <tr> <td>y(k-2)^2</td> <td>2.5766E-01</td> <td>3.827E-06</td> </tr> </tbody> </table> <h4 id="the-dynamic-results-for-that-chosen-theta-is">The dynamic results for that chosen theta is<a class="headerlink" href="#the-dynamic-results-for-that-chosen-theta-is" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_dynamic_results.png"><img alt="" src="../assets/buck_dynamic_results.png"/></a></p> <h4 id="the-static-gain-result-is">The static gain result is<a class="headerlink" href="#the-static-gain-result-is" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Gain"</span><span class="p">)</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>  <span class="n">gain</span><span class="p">,</span>
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span>
<a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"Buck converter static gain"</span><span class="p">,</span>
<a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="p">)</span>
<a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a>  <span class="n">HR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-10-15" id="__codelineno-10-15" name="__codelineno-10-15"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-10-16" id="__codelineno-10-16" name="__codelineno-10-16"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-10-17" id="__codelineno-10-17" name="__codelineno-10-17"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX model gain"</span><span class="p">,</span>
<a href="#__codelineno-10-18" id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="p">)</span>
<a href="#__codelineno-10-19" id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-10-20" id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{g}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-10-21" id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a href="#__codelineno-10-22" id="__codelineno-10-22" name="__codelineno-10-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-10-23" id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_gain_results.png"><img alt="" src="../assets/buck_static_gain_results.png"/></a></p> <h4 id="the-static-function-result-is">The static function result is<a class="headerlink" href="#the-static-function-result-is" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Static Curve"</span><span class="p">)</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Static curve"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a>  <span class="n">QR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX static representation"</span><span class="p">,</span>
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="p">)</span>
<a href="#__codelineno-11-12" id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-11-13" id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{y}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-11-14" id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-11-15" id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_function_results.png"><img alt="" src="../assets/buck_static_function_results.png"/></a></p> <h3 id="getting-the-best-weight-combination-based-on-the-norm-of-the-cost-function">Getting the best weight combination based on the norm of the cost function<a class="headerlink" href="#getting-the-best-weight-combination-based-on-the-norm-of-the-cost-function" title="Permanent link"></a></h3> <p>The variable <code>position</code> returned in <code>estimate</code> method give the position of the best weight combination. The model structure is exactly the same, but the order of the regressors is changed in estimate method. Thats why you have to change the model.final_model. The dynamic, static gain, and the static function results for that chosen theta is shown below.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">model</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">position</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="p">)</span> <span class="c1"># setting the theta estimated for the best combination of the weights</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="c1"># changing the model.final_model</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a>
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="n">model</span><span class="o">.</span><span class="n">final_model</span> <span class="o">=</span> <span class="n">mo_estimator</span><span class="o">.</span><span class="n">final_model</span>
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">)</span>
<a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
<a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a>  <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a>    <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a>    <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a>    <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a>    <span class="n">err_precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-12-17" id="__codelineno-12-17" name="__codelineno-12-17"></a>    <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-12-18" id="__codelineno-12-18" name="__codelineno-12-18"></a>  <span class="p">),</span>
<a href="#__codelineno-12-19" id="__codelineno-12-19" name="__codelineno-12-19"></a>  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-12-20" id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="p">)</span>
<a href="#__codelineno-12-21" id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a href="#__codelineno-12-22" id="__codelineno-12-22" name="__codelineno-12-22"></a>
<a href="#__codelineno-12-23" id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="c1"># dynamic results</span>
<a href="#__codelineno-12-24" id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<a href="#__codelineno-12-25" id="__codelineno-12-25" name="__codelineno-12-25"></a>
<a href="#__codelineno-12-26" id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="c1"># static gain</span>
<a href="#__codelineno-12-27" id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a href="#__codelineno-12-28" id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Gain"</span><span class="p">)</span>
<a href="#__codelineno-12-29" id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-12-30" id="__codelineno-12-30" name="__codelineno-12-30"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-12-31" id="__codelineno-12-31" name="__codelineno-12-31"></a>  <span class="n">gain</span><span class="p">,</span>
<a href="#__codelineno-12-32" id="__codelineno-12-32" name="__codelineno-12-32"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-12-33" id="__codelineno-12-33" name="__codelineno-12-33"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-12-34" id="__codelineno-12-34" name="__codelineno-12-34"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span>
<a href="#__codelineno-12-35" id="__codelineno-12-35" name="__codelineno-12-35"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"Buck converter static gain"</span><span class="p">,</span>
<a href="#__codelineno-12-36" id="__codelineno-12-36" name="__codelineno-12-36"></a><span class="p">)</span>
<a href="#__codelineno-12-37" id="__codelineno-12-37" name="__codelineno-12-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-12-38" id="__codelineno-12-38" name="__codelineno-12-38"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-12-39" id="__codelineno-12-39" name="__codelineno-12-39"></a>  <span class="n">HR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-12-40" id="__codelineno-12-40" name="__codelineno-12-40"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-12-41" id="__codelineno-12-41" name="__codelineno-12-41"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-12-42" id="__codelineno-12-42" name="__codelineno-12-42"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-12-43" id="__codelineno-12-43" name="__codelineno-12-43"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX model gain"</span><span class="p">,</span>
<a href="#__codelineno-12-44" id="__codelineno-12-44" name="__codelineno-12-44"></a><span class="p">)</span>
<a href="#__codelineno-12-45" id="__codelineno-12-45" name="__codelineno-12-45"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-12-46" id="__codelineno-12-46" name="__codelineno-12-46"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{g}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-12-47" id="__codelineno-12-47" name="__codelineno-12-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a href="#__codelineno-12-48" id="__codelineno-12-48" name="__codelineno-12-48"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-12-49" id="__codelineno-12-49" name="__codelineno-12-49"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-12-50" id="__codelineno-12-50" name="__codelineno-12-50"></a>
<a href="#__codelineno-12-51" id="__codelineno-12-51" name="__codelineno-12-51"></a><span class="c1"># static function</span>
<a href="#__codelineno-12-52" id="__codelineno-12-52" name="__codelineno-12-52"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a href="#__codelineno-12-53" id="__codelineno-12-53" name="__codelineno-12-53"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Static Curve"</span><span class="p">)</span>
<a href="#__codelineno-12-54" id="__codelineno-12-54" name="__codelineno-12-54"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Static curve"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-12-55" id="__codelineno-12-55" name="__codelineno-12-55"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-12-56" id="__codelineno-12-56" name="__codelineno-12-56"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-12-57" id="__codelineno-12-57" name="__codelineno-12-57"></a>  <span class="n">QR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-12-58" id="__codelineno-12-58" name="__codelineno-12-58"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-12-59" id="__codelineno-12-59" name="__codelineno-12-59"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX static representation"</span><span class="p">,</span>
<a href="#__codelineno-12-60" id="__codelineno-12-60" name="__codelineno-12-60"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-12-61" id="__codelineno-12-61" name="__codelineno-12-61"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-12-62" id="__codelineno-12-62" name="__codelineno-12-62"></a><span class="p">)</span>
<a href="#__codelineno-12-63" id="__codelineno-12-63" name="__codelineno-12-63"></a>
<a href="#__codelineno-12-64" id="__codelineno-12-64" name="__codelineno-12-64"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-12-65" id="__codelineno-12-65" name="__codelineno-12-65"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{y}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-12-66" id="__codelineno-12-66" name="__codelineno-12-66"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-12-67" id="__codelineno-12-67" name="__codelineno-12-67"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>1.5405E+00</td> <td>9.999E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.9687E-01</td> <td>2.042E-05</td> </tr> <tr> <td>y(k-2)</td> <td>6.4693E-01</td> <td>1.108E-06</td> </tr> <tr> <td>x1(k-1)</td> <td>-4.1302E-01</td> <td>4.688E-06</td> </tr> <tr> <td>y(k-1)^2</td> <td>2.7671E-01</td> <td>3.922E-07</td> </tr> <tr> <td>y(k-2)y(k-1)</td> <td>-5.3474E-01</td> <td>8.389E-07</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>4.0624E-03</td> <td>5.690E-07</td> </tr> <tr> <td>y(k-2)^2</td> <td>2.5832E-01</td> <td>3.827E-06</td> </tr> </tbody> </table> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_result_mo_1.png"><img alt="" src="../assets/buck_result_mo_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_mo_static_gain_1.png"><img alt="" src="../assets/buck_mo_static_gain_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_curve_mo_1.png"><img alt="" src="../assets/buck_static_curve_mo_1.png"/></a></p> <p>You can also plot the pareto-set solutions</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">"3d"</span><span class="p">)</span>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">J</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Pareto-set solutions"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"$J_</span><span class="si">{ls}</span><span class="s2">$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"$J_</span><span class="si">{sg}</span><span class="s2">$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">"$J_</span><span class="si">{sf}</span><span class="s2">$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/pareto_set_solutions_1.png"><img alt="" src="../assets/pareto_set_solutions_1.png"/></a></p> <h3 id="detailing-ails">Detailing AILS<a class="headerlink" href="#detailing-ails" title="Permanent link"></a></h3> <p>The polynomial NARX model built using the mono-objective approach has the following structure:</p> <div class="arithmatex">\[ y(k) = \theta_1 y(k-1) + \theta_2 y(k-2) + \theta_3 u(k-1) y(k-1) + \theta_4 + \theta_5 y(k-1)^2 + \theta_6 u(k-1) + \theta_7 y(k-2)y(k-1) + \theta_8 y(k-2)^2 \]</div> <p>The, the goal when using the static function and static gain information in the multiobjective scenario is to estimate the vector <span class="arithmatex">\(\hat{\theta}\)</span> based on:</p> <div class="arithmatex">\[ \theta = [w_1\Psi^T\Psi + w_2(HR)^T(HR) + w_3(QR)(QR)^T]^{-1} [w_1\Psi^T y + w_2(HR)^T\overline{g}+w_3(QR)^T\overline{y}] \]</div> <p>The <span class="arithmatex">\(\Psi\)</span> matrix is built using the usual mono-objective dynamic modeling approach in SysIdentPy. However, it is still necessary to find the Q, H and R matrices. AILS have the methods to compute all of those matrices. Basically, to do that, <span class="arithmatex">\(q_i^T\)</span> is first estimated:</p> <div class="arithmatex">\[ q_i^T = \begin{bmatrix} 1 &amp; \overline{y_i} &amp; \overline{u_1} &amp; \overline{y_i}^2 &amp; \cdots &amp; \overline{y_i}^l &amp; F_{yu} &amp; \overline{u_i}^2 &amp; \cdots &amp; \overline{u_i}^l \end{bmatrix} \]</div> <p>where <span class="arithmatex">\(F_{yu}\)</span> stands for all non-linear monomials in the model that are related to <span class="arithmatex">\(y(k)\)</span> and <span class="arithmatex">\(u(k)\)</span>, <span class="arithmatex">\(l\)</span> is the largest non-linearity in the model for input and output terms. For a model with a degree of nonlinearity equal to 2, we can obtain:</p> <div class="arithmatex">\[ q_i^T = \begin{bmatrix} 1 &amp; \overline{y_i} &amp; \overline{u_i} &amp; \overline{y_i}^2 &amp; \overline{u_i}\:\overline{y_i} &amp; \overline{u_i}^2 \end{bmatrix} \]</div> <p>It is possible to encode the <span class="arithmatex">\(q_i^T\)</span> matrix so that it follows the model encoding defined in SysIdentPy. To do this, 0 is considered as a constant, <span class="arithmatex">\(y_i\)</span> equal to 1 and <span class="arithmatex">\(u_i\)</span> equal to 2. The number of columns indicates the degree of nonlinearity of the system and the number of rows reflects the number of terms:</p> <div class="arithmatex">\[ q_i = \begin{bmatrix} 0 &amp; 0\\ 1 &amp; 0\\ 2 &amp; 0\\ 1 &amp; 1\\ 2 &amp; 1\\ 2 &amp; 2\\ \end{bmatrix} = \begin{bmatrix} 1 \\ \overline{y_i}\\ \overline{u_i}\\ \overline{y_i}^2\\ \overline{u_i}\:\overline{y_i}\\ \overline{u_i}^2\\ \end{bmatrix} \]</div> <p>Finally, the result can be easily obtained using the regressor_space method of SysIdentPy</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.narmax_base</span> <span class="kn">import</span> <span class="n">RegressorDictionary</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="n">object_qit</span> <span class="o">=</span> <span class="n">RegressorDictionary</span><span class="p">(</span><span class="n">xlag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ylag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="n">R_example</span> <span class="o">=</span> <span class="n">object_qit</span><span class="o">.</span><span class="n">regressor_space</span><span class="p">(</span><span class="n">n_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1000</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"R = </span><span class="si">{</span><span class="n">R_example</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <div class="arithmatex">\[ R = \begin{bmatrix} 0 &amp; 0 \\ 1 &amp; 0 \\ 2 &amp; 0 \\ 1 &amp; 1 \\ 2 &amp; 1 \\ 2 &amp; 2 \end{bmatrix} \]</div> <p>such that:</p> <div class="arithmatex">\[ \overline{y_i} = q_i^T R\theta \]</div> <p>and:</p> <div class="arithmatex">\[ \overline{g_i} = H R\theta \]</div> <p>where <span class="arithmatex">\(R\)</span> is the linear mapping of the static regressors represented by <span class="arithmatex">\(q_i^T\)</span>. In addition, the <span class="arithmatex">\(H\)</span> matrix holds affine information regarding <span class="arithmatex">\(\overline{g_i}\)</span>, which is equal to <span class="arithmatex">\(\overline{g_i} = \frac{d\overline{y}}{d\overline{u}}{\big |}_{(\overline{u_i}\:\overline{y_i})}\)</span>.</p> <p>From now on, we will begin to apply the parameter estimation in a multiobjective manner. This will be done with the NARX polynomial model of the BUCK converter in mind. In this context, <span class="arithmatex">\(q_i^T\)</span> will be generic and will assume a specific format for the problem at hand. For this task, the <span class="arithmatex">\(R_qit\)</span> method will be used, whose objective is to return the <span class="arithmatex">\(q_i^T\)</span> related to the model and the matrix of the linear mapping <span class="arithmatex">\(R\)</span>:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">R</span><span class="p">,</span> <span class="n">qit</span> <span class="o">=</span> <span class="n">mo_estimator</span><span class="o">.</span><span class="n">build_linear_mapping</span><span class="p">()</span>
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"R matrix:"</span><span class="p">)</span>
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"qit matrix:"</span><span class="p">)</span>
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">qit</span><span class="p">)</span>
</code></pre></div> <div class="arithmatex">\[ R = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ \end{bmatrix} \]</div> <p>and</p> <div class="arithmatex">\[ qit = \begin{bmatrix} 0 &amp; 0 \\ 1 &amp; 0 \\ 0 &amp; 1 \\ 2 &amp; 0 \\ 1 &amp; 1 \\ \end{bmatrix} \]</div> <p>So</p> <p>$$ q_i = \begin{bmatrix} 0 &amp; 0\ 1 &amp; 0\ 2 &amp; 0\ 1 &amp; 1\ 2 &amp; 1\ \end{bmatrix}</p> <p>=</p> <p>\begin{bmatrix} 1\ \overline{y}\ \overline{u}\ \overline{y^2}\ \overline{u}:\overline{y}\ \end{bmatrix} $$</p> <p>You can notice that the method produces outputs consistent with what is expected:</p> <div class="arithmatex">\[ y(k) = \theta_1 y(k-1) + \theta_2 y(k-2) + \theta_3 u(k-1) y(k-1) + \theta_4 + \theta_5 y(k-1)^2 + \theta_6 u(k-1) + \theta_7 y(k-2)y(k-1) + \theta_8 y(k-2)^2 \]</div> <p>and:</p> <div class="arithmatex">\[ R = \begin{bmatrix} term/\theta &amp; \theta_1 &amp; \theta_2 &amp; \theta_3 &amp; \theta_4 &amp; \theta_5 &amp; \theta_6 &amp; \theta_7 &amp; \theta_8\\ 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ \overline{y} &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ \overline{u} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\ \overline{y^2} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 1\\ \overline{y}\:\overline{u} &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ \end{bmatrix} \]</div> <h3 id="validation">Validation<a class="headerlink" href="#validation" title="Permanent link"></a></h3> <p>The following model structure will be used to validate the approach:</p> <div class="arithmatex">\[ y(k) = \theta_1 y(k-1) + \theta_2 y(k-2) + \theta_3 + \theta_4 u(k-1) + \theta_5 u(k-1)^2 + \theta_6 u(k-2)u(k-1)+\theta_7 u(k-2) + \theta_8 u(k-2)^2 \]</div> <div class="arithmatex">\[ \therefore \]</div> <div class="arithmatex">\[ final\_model = \begin{bmatrix} 1001 &amp; 0\\ 1002 &amp; 0\\ 0 &amp; 0\\ 2001 &amp; 0\\ 2001 &amp; 2001\\ 2002 &amp; 2001\\ 2002 &amp; 0\\ 2002 &amp; 2002 \end{bmatrix} \]</div> <p>defining in code:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">final_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>  <span class="p">[</span>
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>    <span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>    <span class="p">[</span><span class="mi">1002</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a>    <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a>    <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span>
<a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a>    <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span>
<a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a>    <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a>    <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2002</span><span class="p">],</span>
<a href="#__codelineno-16-11" id="__codelineno-16-11" name="__codelineno-16-11"></a>  <span class="p">]</span>
<a href="#__codelineno-16-12" id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="p">)</span>
<a href="#__codelineno-16-13" id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="n">final_model</span>
</code></pre></div> <table> <thead> <tr> <th>1001</th> <th>0</th> </tr> </thead> <tbody> <tr> <td>1002</td> <td>0</td> </tr> <tr> <td>0</td> <td>0</td> </tr> <tr> <td>2001</td> <td>0</td> </tr> <tr> <td>2001</td> <td>2001</td> </tr> <tr> <td>2002</td> <td>2001</td> </tr> <tr> <td>2002</td> <td>0</td> </tr> <tr> <td>2002</td> <td>2002</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">mult2</span> <span class="o">=</span> <span class="n">AILS</span><span class="p">(</span><span class="n">final_model</span><span class="o">=</span><span class="n">final_model</span><span class="p">)</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="k">def</span> <span class="nf">psi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a>  <span class="n">PSI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a>  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)):</span>
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
<a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a>    <span class="n">PSI</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a>  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">PSI</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div> <p>The value of theta with the lowest mean squared error obtained with the same code implemented in Scilab was:</p> <div class="arithmatex">\[ W_{LS} = 0.3612343 \]</div> <p>and:</p> <div class="arithmatex">\[ W_{SG} = 0.3548699 \]</div> <p>and:</p> <div class="arithmatex">\[ W_{SF} = 0.3548699 \]</div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="n">PSI</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.3612343</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2838959</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3548699</span><span class="p">]])</span>
<a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="n">J</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">HR</span><span class="p">,</span> <span class="n">QR</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">mult2</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span>
<a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a>  <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="n">gain</span><span class="p">,</span> <span class="n">y_static</span><span class="o">=</span><span class="n">Yo</span><span class="p">,</span> <span class="n">X_static</span><span class="o">=</span><span class="n">Uo</span><span class="p">,</span> <span class="n">weighing_matrix</span><span class="o">=</span><span class="n">w</span>
<a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="p">)</span>
<a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
<a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a>  <span class="s2">"w1"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a>  <span class="s2">"w2"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a>  <span class="s2">"w3"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a>  <span class="s2">"J_ls"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a>  <span class="s2">"J_sg"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-18-12" id="__codelineno-18-12" name="__codelineno-18-12"></a>  <span class="s2">"J_sf"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span>
<a href="#__codelineno-18-13" id="__codelineno-18-13" name="__codelineno-18-13"></a>  <span class="s2">"||J||:"</span><span class="p">:</span> <span class="n">E</span><span class="p">,</span>
<a href="#__codelineno-18-14" id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="p">}</span>
<a href="#__codelineno-18-15" id="__codelineno-18-15" name="__codelineno-18-15"></a>
<a href="#__codelineno-18-16" id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th>w1</th> <th>w2</th> <th>w3</th> <th>J_ls</th> <th>J_sg</th> <th>J_sf</th> <th><span class="arithmatex">\(\lVert J \rVert\)</span></th> </tr> </thead> <tbody> <tr> <td>0.361234</td> <td>0.35487</td> <td>0.283896</td> <td>1.0</td> <td>1.0</td> <td>1.0</td> <td>1.0</td> </tr> <tr> <td>The order of the weights is different because the way we implemented in Python, but the results are very close as expected.</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <h4 id="dynamic-results">Dynamic results<a class="headerlink" href="#dynamic-results" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="n">model</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">position</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="n">model</span><span class="o">.</span><span class="n">final_model</span> <span class="o">=</span> <span class="n">mult2</span><span class="o">.</span><span class="n">final_model</span>
<a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">)</span>
<a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
<a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a>  <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a>    <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-19-9" id="__codelineno-19-9" name="__codelineno-19-9"></a>    <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-19-10" id="__codelineno-19-10" name="__codelineno-19-10"></a>    <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-19-11" id="__codelineno-19-11" name="__codelineno-19-11"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-19-12" id="__codelineno-19-12" name="__codelineno-19-12"></a>    <span class="n">err_precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-19-13" id="__codelineno-19-13" name="__codelineno-19-13"></a>    <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-19-14" id="__codelineno-19-14" name="__codelineno-19-14"></a>  <span class="p">),</span>
<a href="#__codelineno-19-15" id="__codelineno-19-15" name="__codelineno-19-15"></a>  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-19-16" id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="p">)</span>
<a href="#__codelineno-19-17" id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="n">r</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>1.4287E+00</td> <td>9.999E-01</td> </tr> <tr> <td>y(k-1)</td> <td>5.5147E-01</td> <td>2.042E-05</td> </tr> <tr> <td>y(k-2)</td> <td>4.0449E-01</td> <td>1.108E-06</td> </tr> <tr> <td>x1(k-1)</td> <td>-1.2605E+01</td> <td>4.688E-06</td> </tr> <tr> <td>x1(k-2)</td> <td>1.2257E+01</td> <td>3.922E-07</td> </tr> <tr> <td>x1(k-1)^2</td> <td>8.3274E+00</td> <td>8.389E-07</td> </tr> <tr> <td>x1(k-2)x1(k-1)</td> <td>-1.1416E+01</td> <td>5.690E-07</td> </tr> <tr> <td>x1(k-2)^2</td> <td>3.0846E+00</td> <td>3.827E-06</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_mo_results_2.png"><img alt="" src="../assets/buck_mo_results_2.png"/></a></p> <h4 id="static-gain">Static gain<a class="headerlink" href="#static-gain" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Gain"</span><span class="p">)</span>
<a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a>  <span class="n">gain</span><span class="p">,</span>
<a href="#__codelineno-21-6" id="__codelineno-21-6" name="__codelineno-21-6"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-21-7" id="__codelineno-21-7" name="__codelineno-21-7"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-21-8" id="__codelineno-21-8" name="__codelineno-21-8"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span>
<a href="#__codelineno-21-9" id="__codelineno-21-9" name="__codelineno-21-9"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"Buck converter static gain"</span><span class="p">,</span>
<a href="#__codelineno-21-10" id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="p">)</span>
<a href="#__codelineno-21-11" id="__codelineno-21-11" name="__codelineno-21-11"></a>
<a href="#__codelineno-21-12" id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-21-13" id="__codelineno-21-13" name="__codelineno-21-13"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-21-14" id="__codelineno-21-14" name="__codelineno-21-14"></a>  <span class="n">HR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-21-15" id="__codelineno-21-15" name="__codelineno-21-15"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-21-16" id="__codelineno-21-16" name="__codelineno-21-16"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-21-17" id="__codelineno-21-17" name="__codelineno-21-17"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-21-18" id="__codelineno-21-18" name="__codelineno-21-18"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX model gain"</span><span class="p">,</span>
<a href="#__codelineno-21-19" id="__codelineno-21-19" name="__codelineno-21-19"></a><span class="p">)</span>
<a href="#__codelineno-21-20" id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-21-21" id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{g}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-21-22" id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a href="#__codelineno-21-23" id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-21-24" id="__codelineno-21-24" name="__codelineno-21-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_gain_mo_2.png"><img alt="" src="../assets/buck_static_gain_mo_2.png"/></a></p> <h4 id="static-function">Static function<a class="headerlink" href="#static-function" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Static Curve"</span><span class="p">)</span>
<a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Static curve"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-22-5" id="__codelineno-22-5" name="__codelineno-22-5"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-22-6" id="__codelineno-22-6" name="__codelineno-22-6"></a>  <span class="n">QR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-22-7" id="__codelineno-22-7" name="__codelineno-22-7"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-22-8" id="__codelineno-22-8" name="__codelineno-22-8"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX static representation"</span><span class="p">,</span>
<a href="#__codelineno-22-9" id="__codelineno-22-9" name="__codelineno-22-9"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-22-10" id="__codelineno-22-10" name="__codelineno-22-10"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-22-11" id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="p">)</span>
<a href="#__codelineno-22-12" id="__codelineno-22-12" name="__codelineno-22-12"></a>
<a href="#__codelineno-22-13" id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-22-14" id="__codelineno-22-14" name="__codelineno-22-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{y}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-22-15" id="__codelineno-22-15" name="__codelineno-22-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-22-16" id="__codelineno-22-16" name="__codelineno-22-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_curve_mo_2.png"><img alt="" src="../assets/buck_static_curve_mo_2.png"/></a></p> <h4 id="pareto-set-solutions">Pareto-set solutions<a class="headerlink" href="#pareto-set-solutions" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">"3d"</span><span class="p">)</span>
<a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">J</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Optimum pareto-curve"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"$J_</span><span class="si">{ls}</span><span class="s2">$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"$J_</span><span class="si">{sg}</span><span class="s2">$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">"$J_</span><span class="si">{sf}</span><span class="s2">$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-23-8" id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_pareto_2.png"><img alt="" src="../assets/buck_pareto_2.png"/></a></p> <p>The following table show the results reported in IniciacaoCientifica2007 and the ones obtained with SysIdentPy implementation</p> <table> <thead> <tr> <th>Theta</th> <th>SysIdentPy</th> <th>IniciacaoCientifica2007</th> </tr> </thead> <tbody> <tr> <td><span class="arithmatex">\(\theta_1\)</span></td> <td>0.5514725</td> <td>0.549144</td> </tr> <tr> <td><span class="arithmatex">\(\theta_2\)</span></td> <td>0.40449005</td> <td>0.408028</td> </tr> <tr> <td><span class="arithmatex">\(\theta_3\)</span></td> <td>1.42867821</td> <td>1.45097</td> </tr> <tr> <td><span class="arithmatex">\(\theta_4\)</span></td> <td>-12.60548863</td> <td>-12.55788</td> </tr> <tr> <td><span class="arithmatex">\(\theta_5\)</span></td> <td>8.32740057</td> <td>8.1516315</td> </tr> <tr> <td><span class="arithmatex">\(\theta_6\)</span></td> <td>-11.41574116</td> <td>-11.09728</td> </tr> <tr> <td><span class="arithmatex">\(\theta_7\)</span></td> <td>12.25729955</td> <td>12.215782</td> </tr> <tr> <td><span class="arithmatex">\(\theta_8\)</span></td> <td>3.08461195</td> <td>2.9319577</td> </tr> </tbody> </table> <p>where:</p> <div class="arithmatex">\[ E_{Scilab} =  17.426613 \]</div> <p>and:</p> <div class="arithmatex">\[ E_{Python} = 17.474865 \]</div> <p>Note: as mentioned before, the order of the regressors in the model change, but it is the same structure. The tables shows the respective regressor parameter concerning <code>SysIdentPy</code> and <code>IniciacaoCientifica2007</code>, but the order <span class="arithmatex">\(\Theta_1\)</span>, <span class="arithmatex">\(\Theta_2\)</span> and so on are not the same of the ones in <code>model.final_model</code></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="n">R</span><span class="p">,</span> <span class="n">qit</span> <span class="o">=</span> <span class="n">mult2</span><span class="o">.</span><span class="n">build_linear_mapping</span><span class="p">()</span>
<a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"R matrix:"</span><span class="p">)</span>
<a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"qit matrix:"</span><span class="p">)</span>
<a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">qit</span><span class="p">)</span>
</code></pre></div> <div class="arithmatex">\[ R = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 \\ \end{bmatrix} \]</div> <p>and</p> <div class="arithmatex">\[ qit = \begin{bmatrix} 0 &amp; 0 \\ 1 &amp; 0 \\ 0 &amp; 1 \\ 0 &amp; 2 \\ \end{bmatrix} \]</div> <p>model's structure that will be utilized (IniciacaoCientifica2007):</p> <div class="arithmatex">\[ y(k) = \theta_1 y(k-1) + \theta_2 y(k-2) + \theta_3 + \theta_4 u(k-1) + \theta_5 u(k-1)^2 + \theta_6 u(k-2)u(k-1)+\theta_7 u(k-2) + \theta_8 u(k-2)^2 \]</div> <p>$$ q_i = \begin{bmatrix} 0 &amp; 0\ 1 &amp; 0\ 2 &amp; 0\ 2 &amp; 2\ \end{bmatrix} =</p> <p>\begin{bmatrix} 1\ \overline{y}\ \overline{u}\ \overline{u^2} \end{bmatrix} $$</p> <h3 id="biobjective-optimization">Biobjective optimization<a class="headerlink" href="#biobjective-optimization" title="Permanent link"></a></h3> <h4 id="an-use-case-applied-to-buck-converter-cc-cc-using-as-objectives-the-static-curve-information-and-the-prediction-error-dynamic">An use case applied to Buck converter CC-CC using as objectives the static curve information and the prediction error (dynamic)<a class="headerlink" href="#an-use-case-applied-to-buck-converter-cc-cc-using-as-objectives-the-static-curve-information-and-the-prediction-error-dynamic" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="n">bi_objective</span> <span class="o">=</span> <span class="n">AILS</span><span class="p">(</span>
<a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a>  <span class="n">static_function</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">static_gain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">final_model</span><span class="o">=</span><span class="n">final_model</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span>
<a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="p">)</span>
</code></pre></div> <p>the value of theta with the lowest mean squared error obtained through the routine in Scilab was:</p> <div class="arithmatex">\[ W_{LS} = 0.9931126 \]</div> <p>and:</p> <div class="arithmatex">\[ W_{SF} = 0.0068874 \]</div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>
<a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mf">2.71</span><span class="p">)</span>
<a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="n">J</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">HR</span><span class="p">,</span> <span class="n">QR</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">bi_objective</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span>
<a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a>  <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_static</span><span class="o">=</span><span class="n">Yo</span><span class="p">,</span> <span class="n">X_static</span><span class="o">=</span><span class="n">Uo</span><span class="p">,</span> <span class="n">weighing_matrix</span><span class="o">=</span><span class="n">w</span>
<a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="p">)</span>
<a href="#__codelineno-26-7" id="__codelineno-26-7" name="__codelineno-26-7"></a>
<a href="#__codelineno-26-8" id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"w1"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"w2"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"J_ls"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"J_sg"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"||J||:"</span><span class="p">:</span> <span class="n">E</span><span class="p">}</span>
<a href="#__codelineno-26-9" id="__codelineno-26-9" name="__codelineno-26-9"></a>
<a href="#__codelineno-26-10" id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th>w1</th> <th>w2</th> <th>J_ls</th> <th>J_sg</th> <th><span class="arithmatex">\(\lVert J \rVert\)</span></th> </tr> </thead> <tbody> <tr> <td>0.990080</td> <td>0.009920</td> <td>0.990863</td> <td>1.000000</td> <td>0.990939</td> </tr> <tr> <td>0.987127</td> <td>0.012873</td> <td>0.990865</td> <td>0.987032</td> <td>0.990939</td> </tr> <tr> <td>0.984182</td> <td>0.015818</td> <td>0.990867</td> <td>0.974307</td> <td>0.990939</td> </tr> <tr> <td>0.981247</td> <td>0.018753</td> <td>0.990870</td> <td>0.961803</td> <td>0.990940</td> </tr> <tr> <td>0.978320</td> <td>0.021680</td> <td>0.990873</td> <td>0.949509</td> <td>0.990941</td> </tr> <tr> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <td>0.002555</td> <td>0.997445</td> <td>0.999993</td> <td>0.000072</td> <td>0.999993</td> </tr> <tr> <td>0.002547</td> <td>0.997453</td> <td>0.999994</td> <td>0.000072</td> <td>0.999994</td> </tr> <tr> <td>0.002540</td> <td>0.997460</td> <td>0.999996</td> <td>0.000071</td> <td>0.999996</td> </tr> <tr> <td>0.002532</td> <td>0.997468</td> <td>0.999998</td> <td>0.000071</td> <td>0.999998</td> </tr> <tr> <td>0.002525</td> <td>0.997475</td> <td>1.000000</td> <td>0.000070</td> <td>1.000000</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="n">model</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">position</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="n">model</span><span class="o">.</span><span class="n">final_model</span> <span class="o">=</span> <span class="n">bi_objective</span><span class="o">.</span><span class="n">final_model</span>
<a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">)</span>
<a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
<a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a>  <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-27-7" id="__codelineno-27-7" name="__codelineno-27-7"></a>    <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-27-8" id="__codelineno-27-8" name="__codelineno-27-8"></a>    <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-27-9" id="__codelineno-27-9" name="__codelineno-27-9"></a>    <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-27-10" id="__codelineno-27-10" name="__codelineno-27-10"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-27-11" id="__codelineno-27-11" name="__codelineno-27-11"></a>    <span class="n">err_precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-27-12" id="__codelineno-27-12" name="__codelineno-27-12"></a>    <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-27-13" id="__codelineno-27-13" name="__codelineno-27-13"></a>  <span class="p">),</span>
<a href="#__codelineno-27-14" id="__codelineno-27-14" name="__codelineno-27-14"></a>  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-27-15" id="__codelineno-27-15" name="__codelineno-27-15"></a><span class="p">)</span>
<a href="#__codelineno-27-16" id="__codelineno-27-16" name="__codelineno-27-16"></a>
<a href="#__codelineno-27-17" id="__codelineno-27-17" name="__codelineno-27-17"></a><span class="n">r</span>
</code></pre></div> <table> <thead> <tr> <th></th> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>1</td> <td>1.3873E+00</td> <td>9.999E-01</td> </tr> <tr> <td>1</td> <td>y(k-1)</td> <td>5.4941E-01</td> <td>2.042E-05</td> </tr> <tr> <td>2</td> <td>y(k-2)</td> <td>4.0804E-01</td> <td>1.108E-06</td> </tr> <tr> <td>3</td> <td>x1(k-1)</td> <td>-1.2515E+01</td> <td>4.688E-06</td> </tr> <tr> <td>4</td> <td>x1(k-2)</td> <td>1.2227E+01</td> <td>3.922E-07</td> </tr> <tr> <td>5</td> <td>x1(k-1)^2</td> <td>8.1171E+00</td> <td>8.389E-07</td> </tr> <tr> <td>6</td> <td>x1(k-2)x1(k-1)</td> <td>-1.1047E+01</td> <td>5.690E-07</td> </tr> <tr> <td>7</td> <td>x1(k-2)^2</td> <td>2.9043E+00</td> <td>3.827E-06</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_mo_3.png"><img alt="" src="../assets/buck_mo_3.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Static Curve"</span><span class="p">)</span>
<a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Static curve"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-29-4" id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-29-5" id="__codelineno-29-5" name="__codelineno-29-5"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-29-6" id="__codelineno-29-6" name="__codelineno-29-6"></a>  <span class="n">QR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-29-7" id="__codelineno-29-7" name="__codelineno-29-7"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-29-8" id="__codelineno-29-8" name="__codelineno-29-8"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX static representation"</span><span class="p">,</span>
<a href="#__codelineno-29-9" id="__codelineno-29-9" name="__codelineno-29-9"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-29-10" id="__codelineno-29-10" name="__codelineno-29-10"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-29-11" id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="p">)</span>
<a href="#__codelineno-29-12" id="__codelineno-29-12" name="__codelineno-29-12"></a>
<a href="#__codelineno-29-13" id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-29-14" id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{y}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-29-15" id="__codelineno-29-15" name="__codelineno-29-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-29-16" id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Costs Functions"</span><span class="p">)</span>
<a href="#__codelineno-30-3" id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-30-4" id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Static Curve Information"</span><span class="p">)</span>
<a href="#__codelineno-30-5" id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Prediction Error"</span><span class="p">)</span>
<a href="#__codelineno-30-6" id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_pareto_mo_3.png"><img alt="" src="../assets/buck_pareto_mo_3.png"/></a></p> <p>where the best estimated <span class="arithmatex">\(\Theta\)</span> is</p> <table> <thead> <tr> <th>Theta</th> <th>SysIdentPy</th> <th>IniciacaoCientifica2007</th> </tr> </thead> <tbody> <tr> <td><span class="arithmatex">\(\theta_1\)</span></td> <td>0.54940883</td> <td>0.5494135</td> </tr> <tr> <td><span class="arithmatex">\(\theta_2\)</span></td> <td>0.40803995</td> <td>0.4080312</td> </tr> <tr> <td><span class="arithmatex">\(\theta_3\)</span></td> <td>1.38725684</td> <td>3.3857601</td> </tr> <tr> <td><span class="arithmatex">\(\theta_4\)</span></td> <td>-12.51466378</td> <td>-12.513688</td> </tr> <tr> <td><span class="arithmatex">\(\theta_5\)</span></td> <td>8.11712897</td> <td>8.116575</td> </tr> <tr> <td><span class="arithmatex">\(\theta_6\)</span></td> <td>-11.04664789</td> <td>-11.04592</td> </tr> <tr> <td><span class="arithmatex">\(\theta_7\)</span></td> <td>12.22693907</td> <td>12.227184</td> </tr> <tr> <td><span class="arithmatex">\(\theta_8\)</span></td> <td>2.90425844</td> <td>2.9038468</td> </tr> </tbody> </table> <p>where:</p> <div class="arithmatex">\[ E_{Scilab} = 17.408934 \]</div> <p>and:</p> <div class="arithmatex">\[ E_{Python} = 17.408947 \]</div> <h3 id="multiobjective-parameter-estimation">Multiobjective parameter estimation<a class="headerlink" href="#multiobjective-parameter-estimation" title="Permanent link"></a></h3> <h4 id="use-case-considering-2-different-objectives-the-prediction-error-and-the-static-gain">Use case considering 2 different objectives: the prediction error and the static gain<a class="headerlink" href="#use-case-considering-2-different-objectives-the-prediction-error-and-the-static-gain" title="Permanent link"></a></h4> <div class="highlight"><pre><span></span><code><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="n">bi_objective_gain</span> <span class="o">=</span> <span class="n">AILS</span><span class="p">(</span>
<a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a>  <span class="n">static_function</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">static_gain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">final_model</span><span class="o">=</span><span class="n">final_model</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-31-3" id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="p">)</span>
</code></pre></div> <p>the value of theta with the lowest mean squared error obtained through the routine in Scilab was:</p> <div class="arithmatex">\[ W_{LS} = 0.9931126 \]</div> <p>and:</p> <div class="arithmatex">\[ W_{SF} = 0.0068874 \]</div> <div class="highlight"><pre><span></span><code><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>
<a href="#__codelineno-32-2" id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mf">2.71</span><span class="p">)</span>
<a href="#__codelineno-32-3" id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a href="#__codelineno-32-4" id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="n">J</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">HR</span><span class="p">,</span> <span class="n">QR</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">bi_objective_gain</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span>
<a href="#__codelineno-32-5" id="__codelineno-32-5" name="__codelineno-32-5"></a>  <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="n">gain</span><span class="p">,</span> <span class="n">y_static</span><span class="o">=</span><span class="n">Yo</span><span class="p">,</span> <span class="n">X_static</span><span class="o">=</span><span class="n">Uo</span><span class="p">,</span> <span class="n">weighing_matrix</span><span class="o">=</span><span class="n">w</span>
<a href="#__codelineno-32-6" id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="p">)</span>
<a href="#__codelineno-32-7" id="__codelineno-32-7" name="__codelineno-32-7"></a>
<a href="#__codelineno-32-8" id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"w1"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"w2"</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"J_ls"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"J_sg"</span><span class="p">:</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"||J||:"</span><span class="p">:</span> <span class="n">E</span><span class="p">}</span>
<a href="#__codelineno-32-9" id="__codelineno-32-9" name="__codelineno-32-9"></a>
<a href="#__codelineno-32-10" id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th>w1</th> <th>w2</th> <th>J_ls</th> <th>J_sg</th> <th><span class="arithmatex">\(\lVert J \rVert\)</span></th> </tr> </thead> <tbody> <tr> <td>1.000000</td> <td>0.000000</td> <td>17.407256</td> <td>3.579461e+01</td> <td>39.802849</td> </tr> <tr> <td>0.997012</td> <td>0.002988</td> <td>17.407528</td> <td>2.109260e-01</td> <td>17.408806</td> </tr> <tr> <td>0.994033</td> <td>0.005967</td> <td>17.407540</td> <td>2.082067e-01</td> <td>17.408785</td> </tr> <tr> <td>0.991063</td> <td>0.008937</td> <td>17.407559</td> <td>2.056636e-01</td> <td>17.408774</td> </tr> <tr> <td>0.988102</td> <td>0.011898</td> <td>17.407585</td> <td>2.031788e-01</td> <td>17.408771</td> </tr> <tr> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <td>0.002555</td> <td>0.997445</td> <td>17.511596</td> <td>3.340081e-07</td> <td>17.511596</td> </tr> <tr> <td>0.002547</td> <td>0.997453</td> <td>17.511596</td> <td>3.320125e-07</td> <td>17.511596</td> </tr> <tr> <td>0.002540</td> <td>0.997460</td> <td>17.511597</td> <td>3.300289e-07</td> <td>17.511597</td> </tr> <tr> <td>0.002532</td> <td>0.997468</td> <td>17.511598</td> <td>3.280571e-07</td> <td>17.511598</td> </tr> <tr> <td>0.002525</td> <td>0.997475</td> <td>17.511599</td> <td>3.260972e-07</td> <td>17.511599</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="c1"># Writing the results</span>
<a href="#__codelineno-33-2" id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="n">model</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">position</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-33-3" id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="n">model</span><span class="o">.</span><span class="n">final_model</span> <span class="o">=</span> <span class="n">bi_objective_gain</span><span class="o">.</span><span class="n">final_model</span>
<a href="#__codelineno-33-4" id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">)</span>
<a href="#__codelineno-33-5" id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
<a href="#__codelineno-33-6" id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-33-7" id="__codelineno-33-7" name="__codelineno-33-7"></a>  <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-33-8" id="__codelineno-33-8" name="__codelineno-33-8"></a>    <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-33-9" id="__codelineno-33-9" name="__codelineno-33-9"></a>    <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-33-10" id="__codelineno-33-10" name="__codelineno-33-10"></a>    <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-33-11" id="__codelineno-33-11" name="__codelineno-33-11"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-33-12" id="__codelineno-33-12" name="__codelineno-33-12"></a>    <span class="n">err_precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-33-13" id="__codelineno-33-13" name="__codelineno-33-13"></a>    <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-33-14" id="__codelineno-33-14" name="__codelineno-33-14"></a>  <span class="p">),</span>
<a href="#__codelineno-33-15" id="__codelineno-33-15" name="__codelineno-33-15"></a>  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-33-16" id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="p">)</span>
<a href="#__codelineno-33-17" id="__codelineno-33-17" name="__codelineno-33-17"></a>
<a href="#__codelineno-33-18" id="__codelineno-33-18" name="__codelineno-33-18"></a><span class="n">r</span>
</code></pre></div> <table> <thead> <tr> <th></th> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>1</td> <td>1.4853E+00</td> <td>9.999E-01</td> </tr> <tr> <td>1</td> <td>y(k-1)</td> <td>5.4940E-01</td> <td>2.042E-05</td> </tr> <tr> <td>2</td> <td>y(k-2)</td> <td>4.0806E-01</td> <td>1.108E-06</td> </tr> <tr> <td>3</td> <td>x1(k-1)</td> <td>-1.2581E+01</td> <td>4.688E-06</td> </tr> <tr> <td>4</td> <td>x1(k-2)</td> <td>1.2210E+01</td> <td>3.922E-07</td> </tr> <tr> <td>5</td> <td>x1(k-1)^2</td> <td>8.1686E+00</td> <td>8.389E-07</td> </tr> <tr> <td>6</td> <td>x1(k-2)x1(k-1)</td> <td>-1.1122E+01</td> <td>5.690E-07</td> </tr> <tr> <td>7</td> <td>x1(k-2)^2</td> <td>2.9455E+00</td> <td>3.827E-06</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_mo_4.png"><img alt="" src="../assets/buck_mo_4.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a href="#__codelineno-35-2" id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Gain"</span><span class="p">)</span>
<a href="#__codelineno-35-3" id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-35-4" id="__codelineno-35-4" name="__codelineno-35-4"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-35-5" id="__codelineno-35-5" name="__codelineno-35-5"></a>  <span class="n">gain</span><span class="p">,</span>
<a href="#__codelineno-35-6" id="__codelineno-35-6" name="__codelineno-35-6"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-35-7" id="__codelineno-35-7" name="__codelineno-35-7"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-35-8" id="__codelineno-35-8" name="__codelineno-35-8"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span>
<a href="#__codelineno-35-9" id="__codelineno-35-9" name="__codelineno-35-9"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"Buck converter static gain"</span><span class="p">,</span>
<a href="#__codelineno-35-10" id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="p">)</span>
<a href="#__codelineno-35-11" id="__codelineno-35-11" name="__codelineno-35-11"></a>
<a href="#__codelineno-35-12" id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a href="#__codelineno-35-13" id="__codelineno-35-13" name="__codelineno-35-13"></a>  <span class="n">Uo</span><span class="p">,</span>
<a href="#__codelineno-35-14" id="__codelineno-35-14" name="__codelineno-35-14"></a>  <span class="n">HR</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span>
<a href="#__codelineno-35-15" id="__codelineno-35-15" name="__codelineno-35-15"></a>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
<a href="#__codelineno-35-16" id="__codelineno-35-16" name="__codelineno-35-16"></a>  <span class="n">marker</span><span class="o">=</span><span class="s2">"^"</span><span class="p">,</span>
<a href="#__codelineno-35-17" id="__codelineno-35-17" name="__codelineno-35-17"></a>  <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a href="#__codelineno-35-18" id="__codelineno-35-18" name="__codelineno-35-18"></a>  <span class="n">label</span><span class="o">=</span><span class="s2">"NARX model gain"</span><span class="p">,</span>
<a href="#__codelineno-35-19" id="__codelineno-35-19" name="__codelineno-35-19"></a><span class="p">)</span>
<a href="#__codelineno-35-20" id="__codelineno-35-20" name="__codelineno-35-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{u}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-35-21" id="__codelineno-35-21" name="__codelineno-35-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">bar</span><span class="si">{g}</span><span class="s2">$"</span><span class="p">)</span>
<a href="#__codelineno-35-22" id="__codelineno-35-22" name="__codelineno-35-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-35-23" id="__codelineno-35-23" name="__codelineno-35-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_static_gain_mo_4.png"><img alt="" src="../assets/buck_static_gain_mo_4.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-36-1" id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a href="#__codelineno-36-2" id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Costs Functions"</span><span class="p">)</span>
<a href="#__codelineno-36-3" id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">"o"</span><span class="p">)</span>
<a href="#__codelineno-36-4" id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Gain Information"</span><span class="p">)</span>
<a href="#__codelineno-36-5" id="__codelineno-36-5" name="__codelineno-36-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Prediction Error"</span><span class="p">)</span>
<a href="#__codelineno-36-6" id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/buck_pareto_mo_4.png"><img alt="" src="../assets/buck_pareto_mo_4.png"/></a></p> <p>being the selected <span class="arithmatex">\(\theta\)</span>:</p> <table> <thead> <tr> <th>Theta</th> <th>SysIdentPy</th> <th>IniciacaoCientifica2007</th> </tr> </thead> <tbody> <tr> <td><span class="arithmatex">\(\theta_1\)</span></td> <td>0.54939785</td> <td>0.54937289</td> </tr> <tr> <td><span class="arithmatex">\(\theta_2\)</span></td> <td>0.40805603</td> <td>0.40810168</td> </tr> <tr> <td><span class="arithmatex">\(\theta_3\)</span></td> <td>1.48525190</td> <td>1.48663719</td> </tr> <tr> <td><span class="arithmatex">\(\theta_4\)</span></td> <td>-12.58066084</td> <td>-12.58127183</td> </tr> <tr> <td><span class="arithmatex">\(\theta_5\)</span></td> <td>8.16862622</td> <td>8.16780294</td> </tr> <tr> <td><span class="arithmatex">\(\theta_6\)</span></td> <td>-11.12171897</td> <td>-11.11998621</td> </tr> <tr> <td><span class="arithmatex">\(\theta_7\)</span></td> <td>12.20954849</td> <td>12.20927355</td> </tr> <tr> <td><span class="arithmatex">\(\theta_8\)</span></td> <td>2.94548501</td> <td>2.9446532</td> </tr> </tbody> </table> <p>where:</p> <div class="arithmatex">\[ E_{Scilab} = 17.408997 \]</div> <p>and:</p> <div class="arithmatex">\[ E_{Python} = 17.408781 \]</div> <h2 id="additional-information">Additional Information<a class="headerlink" href="#additional-information" title="Permanent link"></a></h2> <p>You can also access the matrix Q and H using the following methods</p> <p>Matrix Q:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-37-1" id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="n">bi_objective_gain</span><span class="o">.</span><span class="n">build_static_function_information</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div> <p>Matrix H+R:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-38-1" id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="n">bi_objective_gain</span><span class="o">.</span><span class="n">build_static_gain_information</span><span class="p">(</span><span class="n">Uo</span><span class="p">,</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">gain</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: 4. Model Structure Selection" class="md-footer__link md-footer__link--prev" href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> 4. Model Structure Selection </div> </div> </a> <a aria-label="Next: 6. Multiobjective Model Structure Selection" class="md-footer__link md-footer__link--next" href="../6%20-%20Multiobjective%20Model%20Structure%20Selection/"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> 6. Multiobjective Model Structure Selection </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright  2016 - 2022 Wilson Rocha </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/wilsonrljr" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class="md-social__link" href="https://pypi.org/project/sysidentpy/" rel="noopener" target="_blank" title="pypi.org"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"></path></svg> </a> <a class="md-social__link" href="https://twitter.com/wilsonrljr" rel="noopener" target="_blank" title="twitter.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src="../../assets/javascripts/bundle.a7c05c9e.min.js"></script> <script src="../../overrides/assets/extra.js"></script> <script src="../../overrides/assets/javascripts/mathjax.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>