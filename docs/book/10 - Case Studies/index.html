<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="From Classical Approaches to Neural Networks" name="description"/><meta content="Wilson Rocha" name="author"/><link href="https://sysidentpy.org/book/10%20-%20Case%20Studies/" rel="canonical"/><link href="../9%20-%20Validation/" rel="prev"/><link href="../../events/events/" rel="next"/><link href="../../overrides/assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.6.0, mkdocs-material-9.5.21" name="generator"/><title>10. Case Studies - SysIdentPy</title><link href="../../assets/stylesheets/main.66ac8b77.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/_mkdocstrings.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }

                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="orange" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#m4-dataset"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="SysIdentPy" class="md-header__button md-logo" data-md-component="logo" href="../.." title="SysIdentPy"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> SysIdentPy </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> 10. Case Studies </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="orange" data-md-color-media="" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/wilsonrljr/sysidentpy" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/getting-started/"> Getting started </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../examples/basic_steps/"> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../0%20-%20Preface/"> Companion Book </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../events/events/"> Blog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/about-us/"> About </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../changelog/changelog/"> Changelog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/sponsor/"> Sponsors </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../code/narmax-base/"> Code </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="SysIdentPy" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="SysIdentPy"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg> </a> SysIdentPy </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/wilsonrljr/sysidentpy" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> wilsonrljr/sysidentpy </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/getting-started/"> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/ch0-narmax-intro/"> <span class="md-ellipsis"> Introduction to NARMAX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/basic-usage/"> <span class="md-ellipsis"> Basic Usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/get-help/"> <span class="md-ellipsis"> Get Help </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/contribute/"> <span class="md-ellipsis"> How to contribute </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/license/"> <span class="md-ellipsis"> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0"> <span class="md-ellipsis"> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_1"> <span class="md-nav__icon md-icon"></span> Features </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/basic_steps/"> <span class="md-ellipsis"> Presenting main functionality </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/defining_lags/"> <span class="md-ellipsis"> Setting specific lags </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/multiple_inputs_example/"> <span class="md-ellipsis"> Multiple Inputs usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/parameter_estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/multiobjective_parameter_estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation for NARMAX models - An Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/extended_least_squares/"> <span class="md-ellipsis"> Extended Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/n_steps_ahead_prediction/"> <span class="md-ellipsis"> Example: N-steps-ahead prediction - F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/simulating_a_predefined_model/"> <span class="md-ellipsis"> Simulate a Predefined Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/save_and_load_models/"> <span class="md-ellipsis"> Saving and Loading models using .syspy extension </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/information_criteria_examples/"> <span class="md-ellipsis"> Information Criteria - Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/general_estimators/"> <span class="md-ellipsis"> Building NARX models using general estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/fourier_basis_function/"> <span class="md-ellipsis"> Fourier Basis Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/metamss/"> <span class="md-ellipsis"> Meta-Model Structure Selection (MetaMSS) algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/narx_neural_network/"> <span class="md-ellipsis"> Building NARX Neural Network using Sysidentpy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/aols/"> <span class="md-ellipsis"> Using the Accelerated Orthogonal Least-Squares algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/entropic_regression/"> <span class="md-ellipsis"> Identification of an electromechanical system using Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/NFIR/"> <span class="md-ellipsis"> NFIR Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0"> <span class="md-ellipsis"> Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> Cases </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/air_passenger_benchmark/"> <span class="md-ellipsis"> Air Passenger benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/f_16_benchmark/"> <span class="md-ellipsis"> Example: F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/identification_of_an_electromechanical_system/"> <span class="md-ellipsis"> Identification of an electromechanical system </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/load_forecasting_benchmark/"> <span class="md-ellipsis"> Load forecasting benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/PV_forecasting_benchmark/"> <span class="md-ellipsis"> PV forecasting benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0"> <span class="md-ellipsis"> V0.3.4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> V0.3.4 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0"> <span class="md-ellipsis"> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_1_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_3_1"> <span class="md-nav__icon md-icon"></span> Features </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/basic_steps/"> <span class="md-ellipsis"> Presenting main functionality </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/defining_lags/"> <span class="md-ellipsis"> Setting specific lags </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/multiple_inputs_example/"> <span class="md-ellipsis"> Multiple Inputs usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/parameter_estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/multiobjective_parameter_estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation for NARMAX models - An Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/extended_least_squares/"> <span class="md-ellipsis"> Extended Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/n_steps_ahead_prediction/"> <span class="md-ellipsis"> Example: N-steps-ahead prediction - F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/simulating_a_predefined_model/"> <span class="md-ellipsis"> Simulate a Predefined Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/save_and_load_models/"> <span class="md-ellipsis"> Saving and Loading models using .syspy extension </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/information_criteria_examples/"> <span class="md-ellipsis"> Information Criteria - Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/general_estimators/"> <span class="md-ellipsis"> Building NARX models using general estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/fourier_basis_function/"> <span class="md-ellipsis"> Fourier Basis Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/metamss/"> <span class="md-ellipsis"> Meta-Model Structure Selection (MetaMSS) algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/narx_neural_network/"> <span class="md-ellipsis"> Building NARX Neural Network using Sysidentpy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/aols/"> <span class="md-ellipsis"> Using the Accelerated Orthogonal Least-Squares algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/entropic_regression/"> <span class="md-ellipsis"> Identification of an electromechanical system using Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/NFIR/"> <span class="md-ellipsis"> NFIR Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0"> <span class="md-ellipsis"> Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_2_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_3_2"> <span class="md-nav__icon md-icon"></span> Cases </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/air_passenger_benchmark/"> <span class="md-ellipsis"> Air Passenger benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/f_16_benchmark/"> <span class="md-ellipsis"> Example: F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/identification_of_an_electromechanical_system/"> <span class="md-ellipsis"> Identification of an electromechanical system </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/load_forecasting_benchmark/"> <span class="md-ellipsis"> Load forecasting benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/PV_forecasting_benchmark/"> <span class="md-ellipsis"> PV forecasting benchmark </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex=""> <span class="md-ellipsis"> Companion Book </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Companion Book </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../0%20-%20Preface/"> <span class="md-ellipsis"> Preface </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../0.1%20-%20Contents/"> <span class="md-ellipsis"> Contents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../1%20-%20Introduction/"> <span class="md-ellipsis"> Introduction </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../2%20-%20NARMAX%20Model%20Representation/"> <span class="md-ellipsis"> 2. NARMAX Model Representation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../3%20-%20Parameter%20Estimation/"> <span class="md-ellipsis"> 3. Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/"> <span class="md-ellipsis"> 4. Model Structure Selection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../5%20-%20Multiobjective%20Parameter%20Estimation/"> <span class="md-ellipsis"> 5. Multiobjective Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../6%20-%20Multiobjective%20Model%20Structure%20Selection/"> <span class="md-ellipsis"> 6. Multiobjective Model Structure Selection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../7%20-%20NARX%20Neural%20Network/"> <span class="md-ellipsis"> 7. NARX Neural Network </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../8%20-%20Severely%20Nonlinear%20System%20Identification/"> <span class="md-ellipsis"> 8. Severely Nonlinear System Identification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../9%20-%20Validation/"> <span class="md-ellipsis"> 9. Validation </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> 10. Case Studies </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> 10. Case Studies </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#m4-dataset"> <span class="md-ellipsis"> M4 Dataset </span> </a> <nav aria-label="M4 Dataset" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#coupled-eletric-device"> <span class="md-ellipsis"> Coupled Eletric Device </span> </a> <nav aria-label="Coupled Eletric Device" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#system-overview"> <span class="md-ellipsis"> System Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sensor-and-filtering"> <span class="md-ellipsis"> Sensor and Filtering </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sota-results"> <span class="md-ellipsis"> SOTA Results </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_1"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_1"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results"> <span class="md-ellipsis"> Results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#wiener-hammerstein"> <span class="md-ellipsis"> Wiener-Hammerstein </span> </a> <nav aria-label="Wiener-Hammerstein" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_2"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_2"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results_1"> <span class="md-ellipsis"> Results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#air-passenger-demand-forecasting-a-benchmarking"> <span class="md-ellipsis"> Air Passenger Demand Forecasting - A Benchmarking </span> </a> <nav aria-label="Air Passenger Demand Forecasting - A Benchmarking" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dataset-overview"> <span class="md-ellipsis"> Dataset Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#comparison-with-other-libraries"> <span class="md-ellipsis"> Comparison with Other Libraries </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#objective"> <span class="md-ellipsis"> Objective </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_3"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results_2"> <span class="md-ellipsis"> Results </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-frols"> <span class="md-ellipsis"> SysIdentPy: FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-aols"> <span class="md-ellipsis"> SysIdentPy: AOLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-metamss"> <span class="md-ellipsis"> SysIdentPy: MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-neural-narx"> <span class="md-ellipsis"> SysIdentPy: Neural NARX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-models"> <span class="md-ellipsis"> sktime models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-exponential-smoothing"> <span class="md-ellipsis"> sktime: Exponential Smoothing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-autoets"> <span class="md-ellipsis"> sktime: AutoETS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-autoarima"> <span class="md-ellipsis"> sktime: AutoArima </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-arima"> <span class="md-ellipsis"> sktime: Arima </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-bats"> <span class="md-ellipsis"> sktime: BATS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-tbats"> <span class="md-ellipsis"> sktime: TBATS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-prophet"> <span class="md-ellipsis"> sktime: Prophet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#neural-prophet"> <span class="md-ellipsis"> Neural Prophet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#system-with-hysteresis-modeling-a-magneto-rheological-damper-device"> <span class="md-ellipsis"> System With Hysteresis - Modeling a Magneto-rheological Damper Device </span> </a> <nav aria-label="System With Hysteresis - Modeling a Magneto-rheological Damper Device" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#a-brief-description-of-the-bouc-wen-model-of-magneto-rheological-damper-device"> <span class="md-ellipsis"> A Brief description of the Bouc-Wen model of magneto-rheological damper device </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_4"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_3"> <span class="md-ellipsis"> SysIdentPy Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#silver-box"> <span class="md-ellipsis"> Silver box </span> </a> <nav aria-label="Silver box" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_5"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_4"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results_3"> <span class="md-ellipsis"> Results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#f-16-ground-vibration-test-benchmark"> <span class="md-ellipsis"> F-16 Ground Vibration Test Benchmark </span> </a> <nav aria-label="F-16 Ground Vibration Test Benchmark" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#benchmark-overview"> <span class="md-ellipsis"> Benchmark Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_6"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_5"> <span class="md-ellipsis"> SysIdentPy Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#procedure"> <span class="md-ellipsis"> Procedure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pv-forecasting"> <span class="md-ellipsis"> PV Forecasting </span> </a> <nav aria-label="PV Forecasting" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dataset-overview_1"> <span class="md-ellipsis"> Dataset Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#comparison-with-other-libraries_1"> <span class="md-ellipsis"> Comparison with Other Libraries </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#objective_1"> <span class="md-ellipsis"> Objective </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_7"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#procedure_1"> <span class="md-ellipsis"> Procedure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#neural-prophet_1"> <span class="md-ellipsis"> Neural Prophet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#frols"> <span class="md-ellipsis"> FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#metamss"> <span class="md-ellipsis"> MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#aols"> <span class="md-ellipsis"> AOLS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/events/"> <span class="md-ellipsis"> Events </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/> <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0"> <span class="md-ellipsis"> Meetups </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_2"> <span class="md-nav__icon md-icon"></span> Meetups </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/ai-networks-meetup/"> <span class="md-ellipsis"> AI Networks Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/nubank-meetup/"> <span class="md-ellipsis"> Nubank Timeseries Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/nubank-meetup-open-source.md"> <span class="md-ellipsis"> Nubank Open Source Talk </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/gcom-meetup/"> <span class="md-ellipsis"> GCoM Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/estatidados/"> <span class="md-ellipsis"> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> About </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/about-us/"> <span class="md-ellipsis"> About Us </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/attribute/"> <span class="md-ellipsis"> Attribute </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../changelog/changelog/"> <span class="md-ellipsis"> Changes in SysIdentPy </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/sponsor/"> <span class="md-ellipsis"> Sponsors </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0"> <span class="md-ellipsis"> Code </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Code </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/narmax-base/"> <span class="md-ellipsis"> NARMAX Base </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/basis-function/"> <span class="md-ellipsis"> Basis Functions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/frols/"> <span class="md-ellipsis"> FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metamss/"> <span class="md-ellipsis"> MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/aols/"> <span class="md-ellipsis"> AOLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/entropic-regression/"> <span class="md-ellipsis"> Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/neural-narx/"> <span class="md-ellipsis"> Neural NARX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/general-estimators/"> <span class="md-ellipsis"> General Estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/parameter-estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/multiobjective-parameter-estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/simulation/"> <span class="md-ellipsis"> Simulation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/residues/"> <span class="md-ellipsis"> Residual Analysis </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metaheuristics/"> <span class="md-ellipsis"> Metaheuristics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metrics/"> <span class="md-ellipsis"> Metrics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/utils/"> <span class="md-ellipsis"> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#m4-dataset"> <span class="md-ellipsis"> M4 Dataset </span> </a> <nav aria-label="M4 Dataset" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#coupled-eletric-device"> <span class="md-ellipsis"> Coupled Eletric Device </span> </a> <nav aria-label="Coupled Eletric Device" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#system-overview"> <span class="md-ellipsis"> System Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sensor-and-filtering"> <span class="md-ellipsis"> Sensor and Filtering </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sota-results"> <span class="md-ellipsis"> SOTA Results </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_1"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_1"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results"> <span class="md-ellipsis"> Results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#wiener-hammerstein"> <span class="md-ellipsis"> Wiener-Hammerstein </span> </a> <nav aria-label="Wiener-Hammerstein" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_2"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_2"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results_1"> <span class="md-ellipsis"> Results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#air-passenger-demand-forecasting-a-benchmarking"> <span class="md-ellipsis"> Air Passenger Demand Forecasting - A Benchmarking </span> </a> <nav aria-label="Air Passenger Demand Forecasting - A Benchmarking" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dataset-overview"> <span class="md-ellipsis"> Dataset Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#comparison-with-other-libraries"> <span class="md-ellipsis"> Comparison with Other Libraries </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#objective"> <span class="md-ellipsis"> Objective </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_3"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results_2"> <span class="md-ellipsis"> Results </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-frols"> <span class="md-ellipsis"> SysIdentPy: FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-aols"> <span class="md-ellipsis"> SysIdentPy: AOLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-metamss"> <span class="md-ellipsis"> SysIdentPy: MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-neural-narx"> <span class="md-ellipsis"> SysIdentPy: Neural NARX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-models"> <span class="md-ellipsis"> sktime models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-exponential-smoothing"> <span class="md-ellipsis"> sktime: Exponential Smoothing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-autoets"> <span class="md-ellipsis"> sktime: AutoETS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-autoarima"> <span class="md-ellipsis"> sktime: AutoArima </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-arima"> <span class="md-ellipsis"> sktime: Arima </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-bats"> <span class="md-ellipsis"> sktime: BATS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-tbats"> <span class="md-ellipsis"> sktime: TBATS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sktime-prophet"> <span class="md-ellipsis"> sktime: Prophet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#neural-prophet"> <span class="md-ellipsis"> Neural Prophet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#system-with-hysteresis-modeling-a-magneto-rheological-damper-device"> <span class="md-ellipsis"> System With Hysteresis - Modeling a Magneto-rheological Damper Device </span> </a> <nav aria-label="System With Hysteresis - Modeling a Magneto-rheological Damper Device" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#a-brief-description-of-the-bouc-wen-model-of-magneto-rheological-damper-device"> <span class="md-ellipsis"> A Brief description of the Bouc-Wen model of magneto-rheological damper device </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_4"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_3"> <span class="md-ellipsis"> SysIdentPy Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#silver-box"> <span class="md-ellipsis"> Silver box </span> </a> <nav aria-label="Silver box" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_5"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_4"> <span class="md-ellipsis"> SysIdentPy configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#results_3"> <span class="md-ellipsis"> Results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#f-16-ground-vibration-test-benchmark"> <span class="md-ellipsis"> F-16 Ground Vibration Test Benchmark </span> </a> <nav aria-label="F-16 Ground Vibration Test Benchmark" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#benchmark-overview"> <span class="md-ellipsis"> Benchmark Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_6"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sysidentpy-configuration_5"> <span class="md-ellipsis"> SysIdentPy Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#procedure"> <span class="md-ellipsis"> Procedure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pv-forecasting"> <span class="md-ellipsis"> PV Forecasting </span> </a> <nav aria-label="PV Forecasting" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dataset-overview_1"> <span class="md-ellipsis"> Dataset Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#comparison-with-other-libraries_1"> <span class="md-ellipsis"> Comparison with Other Libraries </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#objective_1"> <span class="md-ellipsis"> Objective </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#required-packages-and-versions_7"> <span class="md-ellipsis"> Required Packages and Versions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#procedure_1"> <span class="md-ellipsis"> Procedure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#neural-prophet_1"> <span class="md-ellipsis"> Neural Prophet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#frols"> <span class="md-ellipsis"> FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#metamss"> <span class="md-ellipsis"> MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#aols"> <span class="md-ellipsis"> AOLS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href="https://github.com/wilsonrljr/sysidentpy/edit/master/docs/book/10 - Case Studies.md" title="Edit this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg> </a> <a class="md-content__button md-icon" href="https://github.com/wilsonrljr/sysidentpy/raw/master/docs/book/10 - Case Studies.md" title="View source of this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"></path></svg> </a> <h1>10. Case Studies</h1> <h2 id="m4-dataset">M4 Dataset<a class="headerlink" href="#m4-dataset" title="Permanent link"></a></h2> <p>The M4 dataset is a well known resource for time series forecasting, offering a wide range of data series used to test and improve forecasting methods. Created for the M4 competition organized by Spyros Makridakis, this dataset has driven many advancements in forecasting techniques.</p> <p>The M4 dataset includes 100,000 time series from various fields such as demographics, finance, industry, macroeconomics, and microeconomics, which were selected randomly from the ForeDeCk database. The series come in different frequencies (yearly, quarterly, monthly, weekly, daily, and hourly), making it a comprehensive collection for testing forecasting methods.</p> <p>In this case study, we will focus on the hourly subset of the M4 dataset. This subset consists of time series data recorded hourly, providing a detailed and high-frequency look at changes over time. Hourly data presents unique challenges due to its granularity and the potential for capturing short-term fluctuations and patterns.</p> <p>The M4 dataset provides a standard benchmark to compare different forecasting methods, allowing researchers and practitioners to evaluate their models consistently. With series from various domains and frequencies, the M4 dataset represents real-world forecasting challenges, making it valuable for developing robust forecasting techniques. The competition and the dataset itself have led to the creation of new algorithms and methods, significantly improving forecasting accuracy and reliability.</p> <p>We will present a end to end walkthrough using the M4 hourly dataset to demonstrate the capabilities of SysIdentPy. SysIdentPy offers a range of tools and techniques designed to effectively handle the complexities of time series data, but we will focus on fast and easy setup for this case. We will cover model selection and evaluation metrics specific to the hourly dataset.</p> <p>By the end of this case study, you will have a solid understanding of how to use SysIdentPy for forecasting with the M4 hourly dataset, preparing you to tackle similar forecasting challenges in real-world scenarios.</p> <h3 id="required-packages-and-versions">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>datasetsforecast==0.0.8
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>pandas==2.2.2
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>numpy==1.26.0
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>matplotlib==3.8.4
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>s3fs==2024.6.1
</code></pre></div> <p>Then, install the packages using: <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>pip install -r requirements.txt
</code></pre></div></p> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="sysidentpy-configuration">SysIdentPy configuration<a class="headerlink" href="#sysidentpy-configuration" title="Permanent link"></a></h3> <p>In this section, we will demonstrate the application of SysIdentPy to the Silver box dataset. The following code will guide you through the process of loading the dataset, configuring the SysIdentPy parameters, and building a model for mentioned system.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">warnings</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="kn">from</span> <span class="nn">pandas.errors</span> <span class="kn">import</span> <span class="n">SettingWithCopyWarning</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span><span class="p">,</span> <span class="n">AOLS</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_relative_squared_error</span><span class="p">,</span> <span class="n">symmetric_mean_absolute_percentage_error</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="kn">from</span> <span class="nn">datasetsforecast.m4</span> <span class="kn">import</span> <span class="n">M4</span><span class="p">,</span> <span class="n">M4Evaluation</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">SettingWithCopyWarning</span><span class="p">)</span>
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'https://auto-arima-results.s3.amazonaws.com/M4-Hourly.csv'</span><span class="p">)</span>
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'https://auto-arima-results.s3.amazonaws.com/M4-Hourly-test.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'y'</span><span class="p">:</span> <span class="s1">'y_test'</span><span class="p">})</span>
</code></pre></div> <p>The following plots provide a visualization of the training data for a small subset of the time series. The plot shows the raw data, giving you an insight into the patterns and behaviors inherent in each series.</p> <p>By observing the data, you can get a sense of the variety and complexity of the time series we are working with. The plots can reveal important characteristics such as trends, seasonal patterns, and potential anomalies within the time series. Understanding these elements is crucial for the development of accurate forecasting models.</p> <p>However, when dealing with a large number of different time series, it is common to start with broad assumptions rather than detailed individual analysis. In this context, we will adopt a similar approach. Instead of going into the specifics of each dataset, we will make some general assumptions and see how SysIdentPy handles them.</p> <p>This approach provides a practical starting point, demonstrating how SysIdentPy can manage different types of time series data without too much work. As you become more familiar with the tool, you can refine your models with more detailed insights. For now, let's focus on using SysIdentPy to create the forecasts based on these initial assumptions.</p> <p>Our first assumption is that there is a 24-hour seasonal pattern in the series. By examining the plots below, this seems reasonable. Therefore, we'll begin building our models with <code>ylag=24</code>.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">]</span><span class="o">==</span><span class="s2">"H10"</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">"H10"</span><span class="p">)</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="n">xcoords</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">24</span><span class="p">)]</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xcoords</span><span class="p">:</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>  <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h10_1.png"><img alt="" src="../assets/c10_m4_h10_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h100_1.png"><img alt="" src="../assets/c10_m4_h100_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h20_1.png"><img alt="" src="../assets/c10_m4_h20_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h150_1.png"><img alt="" src="../assets/c10_m4_h150_1.png"/></a></p> <p>Lets check build a model for the <code>H20</code> group before we extrapolate the settings for every group. Because there are no input features, we will be using a <code>NAR</code> model type in SysIdentPy. To keep things simple and fast, we will start with Polynomial basis function with degree <span class="arithmatex">\(1\)</span>.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">unique_id</span> <span class="o">=</span> <span class="s2">"H20"</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="n">y_id</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">]</span><span class="o">==</span><span class="n">unique_id</span><span class="p">][</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">y_val</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">]</span><span class="o">==</span><span class="n">unique_id</span><span class="p">][</span><span class="s2">"y_test"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>    <span class="n">order_selection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>    <span class="n">ylag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>    <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>    <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>    <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span>
<a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="p">)</span>
<a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>
<a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_id</span><span class="p">)</span>
<a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="n">y_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_id</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_val</span><span class="p">])</span>
<a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>
<a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="n">smape</span> <span class="o">=</span> <span class="n">symmetric_mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::],</span> <span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::])</span>
<a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a>
<a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Group: </span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2"> - SMAPE </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">smape</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h20_r1.png"><img alt="" src="../assets/c10_m4_h20_r1.png"/></a></p> <p>Probably, the result are not optimal and will not work for every group. However, let's check how this setting performs against the winner model <a href="https://www.researchgate.net/publication/325901666_The_M4_Competition_Results_findings_conclusion_and_way_forward">M4 time series competition</a>: the Exponential Smoothing with Recurrent Neural Networks (<a href="https://www.sciencedirect.com/science/article/abs/pii/S0169207019301153">ESRNN</a>).</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">esrnn_url</span> <span class="o">=</span> <span class="s1">'https://github.com/Nixtla/m4-forecasts/raw/master/forecasts/submission-118.zip'</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="n">esrnn_forecasts</span> <span class="o">=</span> <span class="n">M4Evaluation</span><span class="o">.</span><span class="n">load_benchmark</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="s1">'Hourly'</span><span class="p">,</span> <span class="n">esrnn_url</span><span class="p">)</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">esrnn_evaluation</span> <span class="o">=</span> <span class="n">M4Evaluation</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="s1">'Hourly'</span><span class="p">,</span> <span class="n">esrnn_forecasts</span><span class="p">)</span>
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="n">esrnn_evaluation</span>
</code></pre></div> <table> <thead> <tr> <th></th> <th>SMAPE</th> <th>MASE</th> <th>OWA</th> </tr> </thead> <tbody> <tr> <td>Hourly</td> <td>9.328</td> <td>0.893</td> <td>0.440</td> </tr> <tr> <td>&gt; Table 1. ESRNN SOTA results</td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>The following code took only 49 seconds to run on my machine (AMD Ryzen 5 5600x processor, 32GB RAM at 3600MHz). Because of its efficiency, I didn't create a parallel version. By the end of this use case, you will see how SysIdentPy can be both fast and effective, delivering good results without too much optimization.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">ds_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">701</span><span class="p">,</span> <span class="mi">749</span><span class="p">))</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="k">for</span> <span class="n">u_id</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">],</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>  <span class="n">y_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a>  <span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>  <span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a>        <span class="n">ylag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>        <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>        <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>        <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span>
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a>        <span class="n">n_info_values</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a>    <span class="p">)</span>
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>  <span class="k">try</span><span class="p">:</span>
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_id</span><span class="p">)</span>
<a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a>    <span class="n">y_val</span> <span class="o">=</span> <span class="n">y_id</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a>    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>
<a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a>    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a>      <span class="p">[</span>
<a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a>        <span class="n">u_id</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::]),</span>
<a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a>        <span class="n">ds_test</span><span class="p">,</span>
<a href="#__codelineno-6-21" id="__codelineno-6-21" name="__codelineno-6-21"></a>        <span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a href="#__codelineno-6-22" id="__codelineno-6-22" name="__codelineno-6-22"></a>      <span class="p">]</span>
<a href="#__codelineno-6-23" id="__codelineno-6-23" name="__codelineno-6-23"></a>    <span class="p">)</span>
<a href="#__codelineno-6-24" id="__codelineno-6-24" name="__codelineno-6-24"></a>  <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a href="#__codelineno-6-25" id="__codelineno-6-25" name="__codelineno-6-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Problem with </span><span class="si">{</span><span class="n">u_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-6-26" id="__codelineno-6-26" name="__codelineno-6-26"></a>
<a href="#__codelineno-6-27" id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="n">results_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">,</span> <span class="s2">"ds"</span><span class="p">,</span> <span class="s2">"NARMAX_1"</span><span class="p">])</span><span class="o">.</span><span class="n">explode</span><span class="p">([</span><span class="s1">'unique_id'</span><span class="p">,</span> <span class="s1">'ds'</span><span class="p">,</span> <span class="s1">'NARMAX_1'</span><span class="p">])</span>
<a href="#__codelineno-6-28" id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="n">results_1</span><span class="p">[</span><span class="s2">"NARMAX_1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_1</span><span class="p">[</span><span class="s2">"NARMAX_1"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="c1">#.clip(lower=10)</span>
<a href="#__codelineno-6-29" id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="n">pivot_df</span> <span class="o">=</span> <span class="n">results_1</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'unique_id'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'ds'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'NARMAX_1'</span><span class="p">)</span>
<a href="#__codelineno-6-30" id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="n">results</span> <span class="o">=</span> <span class="n">pivot_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a href="#__codelineno-6-31" id="__codelineno-6-31" name="__codelineno-6-31"></a>
<a href="#__codelineno-6-32" id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="n">M4Evaluation</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="s1">'Hourly'</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th></th> <th>SMAPE</th> <th>MASE</th> <th>OWA</th> </tr> </thead> <tbody> <tr> <td>Hourly</td> <td>16.034196</td> <td>0.958083</td> <td>0.636132</td> </tr> <tr> <td>Table 2. First test with SysIdentPy</td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>The initial results are reasonable, but they don't quite match the performance of <code>ESRNN</code>. These results are based solely on our first assumption. To better understand the performance, lets examine the groups with the worst results.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h147_r1.png"><img alt="" src="../assets/c10_m4_h147_r1.png"/></a></p> <p>The following plot illustrates two such groups, <code>H147</code> and <code>H136</code>. Both exhibit a 24-hour seasonal pattern.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_seasonal_h147_1.png"><img alt="" src="../assets/c10_m4_seasonal_h147_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h136_seasonal_1.png"><img alt="" src="../assets/c10_m4_h136_seasonal_1.png"/></a></p> <p>However, a closer look reveals an additional insight: in addition to the daily pattern, these series also show a weekly pattern. Observe how the data looks like when we split the series into weekly segments.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h147_seasonal_1.png"><img alt="" src="../assets/c10_m4_h147_seasonal_1.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">xcoords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">168</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="mi">168</span><span class="p">))</span>
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="n">filtered_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"H147"</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xcoords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>  <span class="n">end</span> <span class="o">=</span> <span class="n">xcoords</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a>  <span class="n">filtered_train</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'H147 -&gt; Slice </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: Hour </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a>
<a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h147_part_seasonal.png"><img alt="" src="../assets/c10_m4_h147_part_seasonal.png"/></a></p> <p>Therefore, we will build models setting <code>ylag=168</code>.</p> <blockquote> <p>Note that this is a very high number for lags, so be careful if you want to try it with higher polynomial degrees because the time to run the models can increase significantly. I tried some configurations with polynomial degree equal to 2 and only took <span class="arithmatex">\(6\)</span> minutes to run (even less, using <code>AOLS</code>), without making the code run in parallel. As you can see, SysIdentPy can be very fast and you can make it faster by applying parallelization.</p> </blockquote> <div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># this took 2min to run on my computer.</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">ds_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">701</span><span class="p">,</span> <span class="mi">749</span><span class="p">))</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="k">for</span> <span class="n">u_id</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">],</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>  <span class="n">y_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>  <span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a>  <span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>      <span class="n">ylag</span><span class="o">=</span><span class="mi">168</span><span class="p">,</span>
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>      <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>      <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>      <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span>
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a>    <span class="p">)</span>
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a>  <span class="k">try</span><span class="p">:</span>
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_id</span><span class="p">)</span>
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>    <span class="n">y_val</span> <span class="o">=</span> <span class="n">y_id</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a>    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>
<a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a>    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a href="#__codelineno-8-18" id="__codelineno-8-18" name="__codelineno-8-18"></a>      <span class="p">[</span>
<a href="#__codelineno-8-19" id="__codelineno-8-19" name="__codelineno-8-19"></a>        <span class="n">u_id</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::]),</span>
<a href="#__codelineno-8-20" id="__codelineno-8-20" name="__codelineno-8-20"></a>        <span class="n">ds_test</span><span class="p">,</span>
<a href="#__codelineno-8-21" id="__codelineno-8-21" name="__codelineno-8-21"></a>        <span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a href="#__codelineno-8-22" id="__codelineno-8-22" name="__codelineno-8-22"></a>      <span class="p">]</span>
<a href="#__codelineno-8-23" id="__codelineno-8-23" name="__codelineno-8-23"></a>    <span class="p">)</span>
<a href="#__codelineno-8-24" id="__codelineno-8-24" name="__codelineno-8-24"></a>  <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a href="#__codelineno-8-25" id="__codelineno-8-25" name="__codelineno-8-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Problema no id </span><span class="si">{</span><span class="n">u_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-8-26" id="__codelineno-8-26" name="__codelineno-8-26"></a>
<a href="#__codelineno-8-27" id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="n">results_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">,</span> <span class="s2">"ds"</span><span class="p">,</span> <span class="s2">"NARMAX_1"</span><span class="p">])</span><span class="o">.</span><span class="n">explode</span><span class="p">([</span><span class="s1">'unique_id'</span><span class="p">,</span> <span class="s1">'ds'</span><span class="p">,</span> <span class="s1">'NARMAX_1'</span><span class="p">])</span>
<a href="#__codelineno-8-28" id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="n">results_1</span><span class="p">[</span><span class="s2">"NARMAX_1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_1</span><span class="p">[</span><span class="s2">"NARMAX_1"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="c1">#.clip(lower=10)</span>
<a href="#__codelineno-8-29" id="__codelineno-8-29" name="__codelineno-8-29"></a><span class="n">pivot_df</span> <span class="o">=</span> <span class="n">results_1</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'unique_id'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'ds'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'NARMAX_1'</span><span class="p">)</span>
<a href="#__codelineno-8-30" id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="n">results</span> <span class="o">=</span> <span class="n">pivot_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a href="#__codelineno-8-31" id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="n">M4Evaluation</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="s1">'Hourly'</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th></th> <th>SMAPE</th> <th>MASE</th> <th>OWA</th> </tr> </thead> <tbody> <tr> <td>Hourly</td> <td>10.475998</td> <td>0.773749</td> <td>0.446471</td> </tr> <tr> <td>&gt; Table 3. Improved results using SysIdentPy</td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>Now, the results are much closer to those of the <code>ESRNN</code> model! While the Symmetric Mean Absolute Percentage Error (<code>SMAPE</code>) is slightly worse, the Mean Absolute Scaled Error (<code>MASE</code>) is better when comparing against <code>ESRNN</code>, leading to a very similar Overall Weighted Average (<code>OWA</code>) metric. Remarkably, these results are achieved using only simple <code>AR</code> models. Next, let's see if the <code>AOLS</code> method can provide even better results.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">ds_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">701</span><span class="p">,</span> <span class="mi">749</span><span class="p">))</span>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="k">for</span> <span class="n">u_id</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">],</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>  <span class="n">y_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>  <span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>  <span class="n">model</span> <span class="o">=</span> <span class="n">AOLS</span><span class="p">(</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a>        <span class="n">ylag</span><span class="o">=</span><span class="mi">168</span><span class="p">,</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>        <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>        <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a>        <span class="c1"># due to high lag settings, k was increased to 6 as an initial guess</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>        <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>    <span class="p">)</span>
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>  <span class="k">try</span><span class="p">:</span>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_id</span><span class="p">)</span>
<a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a>    <span class="n">y_val</span> <span class="o">=</span> <span class="n">y_id</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a>    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>
<a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a>    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a>      <span class="p">[</span>
<a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a>        <span class="n">u_id</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::]),</span>
<a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a>        <span class="n">ds_test</span><span class="p">,</span>
<a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a>        <span class="n">y_hat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">::]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a>      <span class="p">]</span>
<a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a>    <span class="p">)</span>
<a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a>  <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a href="#__codelineno-9-25" id="__codelineno-9-25" name="__codelineno-9-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Problema no id </span><span class="si">{</span><span class="n">u_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-9-26" id="__codelineno-9-26" name="__codelineno-9-26"></a>
<a href="#__codelineno-9-27" id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="n">results_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"unique_id"</span><span class="p">,</span> <span class="s2">"ds"</span><span class="p">,</span> <span class="s2">"NARMAX_1"</span><span class="p">])</span><span class="o">.</span><span class="n">explode</span><span class="p">([</span><span class="s1">'unique_id'</span><span class="p">,</span> <span class="s1">'ds'</span><span class="p">,</span> <span class="s1">'NARMAX_1'</span><span class="p">])</span>
<a href="#__codelineno-9-28" id="__codelineno-9-28" name="__codelineno-9-28"></a><span class="n">results_1</span><span class="p">[</span><span class="s2">"NARMAX_1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_1</span><span class="p">[</span><span class="s2">"NARMAX_1"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="c1">#.clip(lower=10)</span>
<a href="#__codelineno-9-29" id="__codelineno-9-29" name="__codelineno-9-29"></a><span class="n">pivot_df</span> <span class="o">=</span> <span class="n">results_1</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">'unique_id'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'ds'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'NARMAX_1'</span><span class="p">)</span>
<a href="#__codelineno-9-30" id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="n">results</span> <span class="o">=</span> <span class="n">pivot_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a href="#__codelineno-9-31" id="__codelineno-9-31" name="__codelineno-9-31"></a><span class="n">M4Evaluation</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="s1">'Hourly'</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th></th> <th>SMAPE</th> <th>MASE</th> <th>OWA</th> </tr> </thead> <tbody> <tr> <td>Hourly</td> <td>9.951141</td> <td>0.809965</td> <td>0.439755</td> </tr> <tr> <td>&gt; Table 4. SysIdentPy results using AOLS algorithm</td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>The Overall Weighted Average (<code>OWA</code>) is even better than that of the <code>ESRNN</code> model! Additionally, the <code>AOLS</code> method was incredibly efficient, taking only <strong>6 seconds to run</strong>. This combination of high performance and rapid execution makes <code>AOLS</code> a compelling alternative for time series forecasting in cases with multiple series.</p> <p>Before we finish, let's verify how the performance of the <code>H147</code> model has improved with the <code>ylag=168</code> setting.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/c10_m4_h147_r2.png"><img alt="" src="../assets/c10_m4_h147_r2.png"/></a></p> <p>We could achieve even better performance with small adjustments in the model configuration. However, I'll let suck alternative as a task for the user.</p> <blockquote> <p>Based on the M4 benchmark paper, we could also clip the predictions lower than 10 to 10 and the results would be slightly better. But this is left to the user.</p> </blockquote> <p>We could achieve even better performance with some fine-tuning of the model configuration. However, Ill leave exploring these alternative adjustments as an exercise for the user. However, keep in mind that experimenting with different settings does not always guarantee improved results. A deeper theoretical knowledge can often lead you to better configurations and, hence, better results.</p> <h2 id="coupled-eletric-device">Coupled Eletric Device<a class="headerlink" href="#coupled-eletric-device" title="Permanent link"></a></h2> <p>The CE8 coupled electric drives <a href="[Nonlinear Benchmark](https://www.nonlinearbenchmark.org/benchmarks)">dataset</a> presents a compelling use case for demonstrating the performance of SysIdentPy. This system involves two electric motors driving a pulley with a flexible belt, creating a dynamic environment ideal for testing system identification tools.</p> <blockquote> <p>The <a href="([Nonlinear Benchmark](https://www.nonlinearbenchmark.org/benchmarks))">nonlinear benchmark website</a> stands as a significant contribution to the system identification and machine learning community. The users are encouraged to explore all the papers referenced on the site.</p> </blockquote> <h3 id="system-overview">System Overview<a class="headerlink" href="#system-overview" title="Permanent link"></a></h3> <p>The CE8 system, illustrated in Figure 1, features: - <strong>Two Electric Motors</strong>: These motors independently control the tension and speed of the belt, providing symmetrical control around zero. This enables both clockwise and counterclockwise movements. - <strong>Pulley Mechanism</strong>: The pulley is supported by a spring, introducing a lightly damped dynamic mode that adds complexity to the system. - <strong>Speed Control Focus</strong>: The primary focus is on the speed control system. The pulleys angular speed is measured using a pulse counter, which is insensitive to the direction of the velocity.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_design.png"><img alt="" src="../assets/ce8_design.png"/></a></p> <blockquote> <p>Figure 1. CE8 system design.</p> </blockquote> <h3 id="sensor-and-filtering">Sensor and Filtering<a class="headerlink" href="#sensor-and-filtering" title="Permanent link"></a></h3> <p>The measurement process involves: - <strong>Pulse Counter</strong>: This sensor measures the angular speed of the pulley without regard to the direction. - <strong>Analogue Low Pass Filtering</strong>: This reduces high-frequency noise, followed by anti-aliasing filtering to prepare the signal for digital processing. The dynamic effects are mainly influenced by the electric drive time constants and the spring, with the low pass filtering having a minimal impact on the output.</p> <h3 id="sota-results">SOTA Results<a class="headerlink" href="#sota-results" title="Permanent link"></a></h3> <p>SysIdentPy can be used to build robust models for identifying and modeling the complex dynamics of the CE8 system. The performance will be compared against a benchmark provided by <a href="https://arxiv.org/pdf/2405.10779">Max D. Champneys, Gerben I. Beintema, Roland Tth, Maarten Schoukens, and Timothy J. Rogers -Baselines for Nonlinear Benchmarks,Workshop on Nonlinear System Identification Benchmarks, 2024.</a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_sota.png"><img alt="" src="../assets/ce8_sota.png"/></a></p> <p>The benchmark evaluate the average metric between the two experiments. That's why the SOTA method do not have the better metric for <code>test 1</code>, but it is still the best overall. The goal of this case study is not only to showcase the robustness of SysIdentPy but also provides valuable insights into its practical applications in real-world dynamic systems.</p> <h3 id="required-packages-and-versions_1">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_1" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>pandas==2.2.2
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>numpy==1.26.0
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>matplotlib==3.8.4
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>nonlinear_benchmarks==0.1.2
</code></pre></div> <p>Then, install the packages using: <div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>pip install -r requirements.txt
</code></pre></div></p> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="sysidentpy-configuration_1">SysIdentPy configuration<a class="headerlink" href="#sysidentpy-configuration_1" title="Permanent link"></a></h3> <p>In this section, we will demonstrate the application of SysIdentPy to the CE8 coupled electric drives dataset. This example showcases the robust performance of SysIdentPy in modeling and identifying complex dynamic systems. The following code will guide you through the process of loading the dataset, configuring the SysIdentPy parameters, and building a model for CE8 system.</p> <p>This practical example will help users understand how to effectively utilize SysIdentPy for their own system identification tasks, leveraging its advanced features to handle the complexities of real-world dynamic systems. Let's dive into the code and explore the capabilities of SysIdentPy.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span><span class="p">,</span> <span class="n">Fourier</span>
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_mean_squared_error</span>
<a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a>
<a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="kn">import</span> <span class="nn">nonlinear_benchmarks</span>
<a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a>
<a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="n">train_val</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">nonlinear_benchmarks</span><span class="o">.</span><span class="n">CED</span><span class="p">(</span><span class="n">atleast_2d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="n">data_train_1</span><span class="p">,</span> <span class="n">data_train_2</span> <span class="o">=</span> <span class="n">train_val</span>
<a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="n">data_test_1</span><span class="p">,</span> <span class="n">data_test_2</span>  <span class="o">=</span> <span class="n">test</span>
</code></pre></div> <p>We used the <code>nonlinear_benchmarks</code> package to load the data. The user is referred to the <a href="[GerbenBeintema/nonlinear_benchmarks: The official dataload for http://www.nonlinearbenchmark.org/ (github.com)](https://github.com/GerbenBeintema/nonlinear_benchmarks/tree/master)">package documentation</a> to check the details of how to use it.</p> <p>The following plot detail the training and testing data of both experiments. Here we are trying to get two models, one for each experiment, that have a better performance than the mentioned baselines.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_train_1</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_train_1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 1: training data"</span><span class="p">)</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_test_1</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_test_1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 1: testing data"</span><span class="p">)</span>
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>
<a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_train_2</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_train_2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 2: training data"</span><span class="p">)</span>
<a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a>
<a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_test_2</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<a href="#__codelineno-13-17" id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_test_2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<a href="#__codelineno-13-18" id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 2: testing data"</span><span class="p">)</span>
<a href="#__codelineno-13-19" id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_data_1.png"><img alt="" src="../assets/ce8_data_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_test_data.png"><img alt="" src="../assets/ce8_test_data.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_training_data.png"><img alt="" src="../assets/ce8_training_data.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_2_experiment_testing_data.png"><img alt="" src="../assets/ce8_2_experiment_testing_data.png"/></a></p> <h3 id="results">Results<a class="headerlink" href="#results" title="Permanent link"></a></h3> <p>First, we will set the exactly same configuration to built models for both experiments. We can have better models by optimizing the configurations individually, but we will start simple.</p> <p>A basic configuration of FROLS using a polynomial basis function with degree equal 2 is defined. The information criteria will be the default one, the <code>aic</code>. The <code>xlag</code> and <code>ylag</code> are set to <span class="arithmatex">\(7\)</span> in this first example.</p> <p>Model for experiment 1:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train_1</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">data_train_1</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="n">n</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a>
<a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">120</span>
<a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="p">)</span>
<a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a>
<a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-14-20" id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-14-21" id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-14-22" id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-14-23" id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model 1 -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_e1_r1.png"><img alt="" src="../assets/ce8_e1_r1.png"/></a></p> <p>Model for experiment 2: <div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train_2</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">data_train_2</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a>
<a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="n">n</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a>
<a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-15-9" id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-15-10" id="__codelineno-15-10" name="__codelineno-15-10"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-15-11" id="__codelineno-15-11" name="__codelineno-15-11"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-15-12" id="__codelineno-15-12" name="__codelineno-15-12"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-15-13" id="__codelineno-15-13" name="__codelineno-15-13"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-15-14" id="__codelineno-15-14" name="__codelineno-15-14"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-15-15" id="__codelineno-15-15" name="__codelineno-15-15"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">120</span>
<a href="#__codelineno-15-16" id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="p">)</span>
<a href="#__codelineno-15-17" id="__codelineno-15-17" name="__codelineno-15-17"></a>
<a href="#__codelineno-15-18" id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-15-19" id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-15-20" id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-15-21" id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-15-22" id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-15-23" id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model 2 -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_ex2_r1.png"><img alt="" src="../assets/ce8_ex2_r1.png"/></a></p> <p>The first configuration for experiment 1 is already better than the <strong>LTI ARX</strong>, <strong>LTI SS</strong>, <strong>GRU</strong>, <strong>LSTM</strong>, <strong>MLP NARX</strong>, <strong>MLP FIR</strong>, <strong>OLSTM</strong>, and the <strong>SOTA</strong> models shown in the benchmark table. Better than 8 out 11 models shown in the benchmark. For experiment 2, its better than <strong>LTI ARX</strong>, <strong>LTI SS</strong>, <strong>GRU</strong>, <strong>RNN</strong>, <strong>LSTM</strong>, <strong>OLSTM</strong>, and <strong>pNARX</strong> (7 out 11). It's a good start, but let's check if the performance improves if we set a higher lag for both <code>xlag</code> and <code>ylag</code>.</p> <p>The average metric is <span class="arithmatex">\((0.1131 + 0.1059)/2 = 0.1095\)</span>, which is very good, but worse than the SOTA (<span class="arithmatex">\(0.0945\)</span>). We will now increase the lags for <code>x</code> and <code>y</code> to check if we get a better model. Before increasing the lags, the information criteria is shown:</p> <p><div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">n_info_values</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">info_values</span><span class="p">)</span>
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"n_terms"</span><span class="p">)</span>
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Information Criteria"</span><span class="p">)</span>
</code></pre></div> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_aic.png"><img alt="" src="../assets/ce8_aic.png"/></a></p> <p>It can be observed that after 22 regressors, adding new regressors do not improve the model performance (considering the configuration defined for that model). Because we want to try models with higher lags and higher nonlinearity degree, the stopping criteria will be changed to <code>err_tol</code> instead of information criteria. This will made the algorithm runs considerably faster.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1"># experiment 1</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train_1</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">data_train_1</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a>
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="n">n</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a>
<a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.9996</span><span class="p">,</span>
<a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
<a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="p">)</span>
<a href="#__codelineno-17-19" id="__codelineno-17-19" name="__codelineno-17-19"></a>
<a href="#__codelineno-17-20" id="__codelineno-17-20" name="__codelineno-17-20"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-17-21" id="__codelineno-17-21" name="__codelineno-17-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<a href="#__codelineno-17-22" id="__codelineno-17-22" name="__codelineno-17-22"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-17-23" id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-17-24" id="__codelineno-17-24" name="__codelineno-17-24"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-17-25" id="__codelineno-17-25" name="__codelineno-17-25"></a>
<a href="#__codelineno-17-26" id="__codelineno-17-26" name="__codelineno-17-26"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-17-27" id="__codelineno-17-27" name="__codelineno-17-27"></a>
<a href="#__codelineno-17-28" id="__codelineno-17-28" name="__codelineno-17-28"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model 1 -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_e1_r2.png"><img alt="" src="../assets/ce8_e1_r2.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1"># experiment 2</span>
<a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train_2</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">data_train_2</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a>
<a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="n">n</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a>
<a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-18-12" id="__codelineno-18-12" name="__codelineno-18-12"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-18-13" id="__codelineno-18-13" name="__codelineno-18-13"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-18-14" id="__codelineno-18-14" name="__codelineno-18-14"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-18-15" id="__codelineno-18-15" name="__codelineno-18-15"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aicc"</span><span class="p">,</span>
<a href="#__codelineno-18-16" id="__codelineno-18-16" name="__codelineno-18-16"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.9996</span><span class="p">,</span>
<a href="#__codelineno-18-17" id="__codelineno-18-17" name="__codelineno-18-17"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
<a href="#__codelineno-18-18" id="__codelineno-18-18" name="__codelineno-18-18"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-18-19" id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="p">)</span>
<a href="#__codelineno-18-20" id="__codelineno-18-20" name="__codelineno-18-20"></a>
<a href="#__codelineno-18-21" id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-18-22" id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-18-23" id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-18-24" id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-18-25" id="__codelineno-18-25" name="__codelineno-18-25"></a>
<a href="#__codelineno-18-26" id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-18-27" id="__codelineno-18-27" name="__codelineno-18-27"></a>
<a href="#__codelineno-18-28" id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model 2 -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_ex2_r2.png"><img alt="" src="../assets/ce8_ex2_r2.png"/></a></p> <p>In the first experiment, the model showed a slight improvement, while the performance of the second experiment experienced a minor decline. Increasing the lag settings with these configurations did not result in significant changes. Therefore, let's set the polynomial degree to <span class="arithmatex">\(3\)</span> and increase the number of terms to build the model to <code>n_terms=40</code> if the <code>err_tol</code> is not reached. It's important to note that these values are chosen empirically. We could also adjust the parameter estimation technique, the <code>err_tol</code>, the model structure selection algorithm, and the basis function, among other factors. Users are encouraged to employ hyperparameter tuning techniques to find the optimal combinations of hyperparameters.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># experiment 1</span>
<a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train_1</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">data_train_1</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a>
<a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="n">n</span> <span class="o">=</span> <span class="n">data_test_1</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a>
<a href="#__codelineno-19-9" id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-19-10" id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-19-11" id="__codelineno-19-11" name="__codelineno-19-11"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-19-12" id="__codelineno-19-12" name="__codelineno-19-12"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-19-13" id="__codelineno-19-13" name="__codelineno-19-13"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-19-14" id="__codelineno-19-14" name="__codelineno-19-14"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-19-15" id="__codelineno-19-15" name="__codelineno-19-15"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.9996</span><span class="p">,</span>
<a href="#__codelineno-19-16" id="__codelineno-19-16" name="__codelineno-19-16"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<a href="#__codelineno-19-17" id="__codelineno-19-17" name="__codelineno-19-17"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-19-18" id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="p">)</span>
<a href="#__codelineno-19-19" id="__codelineno-19-19" name="__codelineno-19-19"></a>
<a href="#__codelineno-19-20" id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-19-21" id="__codelineno-19-21" name="__codelineno-19-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<a href="#__codelineno-19-22" id="__codelineno-19-22" name="__codelineno-19-22"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-19-23" id="__codelineno-19-23" name="__codelineno-19-23"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-19-24" id="__codelineno-19-24" name="__codelineno-19-24"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-19-25" id="__codelineno-19-25" name="__codelineno-19-25"></a>
<a href="#__codelineno-19-26" id="__codelineno-19-26" name="__codelineno-19-26"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-19-27" id="__codelineno-19-27" name="__codelineno-19-27"></a>
<a href="#__codelineno-19-28" id="__codelineno-19-28" name="__codelineno-19-28"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model 1 -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_ex1_r3.png"><img alt="" src="../assets/ce8_ex1_r3.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># experiment 2</span>
<a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train_2</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">data_train_2</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">u</span>
<a href="#__codelineno-20-6" id="__codelineno-20-6" name="__codelineno-20-6"></a>
<a href="#__codelineno-20-7" id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="n">n</span> <span class="o">=</span> <span class="n">data_test_2</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-20-8" id="__codelineno-20-8" name="__codelineno-20-8"></a>
<a href="#__codelineno-20-9" id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-20-10" id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-20-11" id="__codelineno-20-11" name="__codelineno-20-11"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-20-12" id="__codelineno-20-12" name="__codelineno-20-12"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-20-13" id="__codelineno-20-13" name="__codelineno-20-13"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-20-14" id="__codelineno-20-14" name="__codelineno-20-14"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-20-15" id="__codelineno-20-15" name="__codelineno-20-15"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aicc"</span><span class="p">,</span>
<a href="#__codelineno-20-16" id="__codelineno-20-16" name="__codelineno-20-16"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.9996</span><span class="p">,</span>
<a href="#__codelineno-20-17" id="__codelineno-20-17" name="__codelineno-20-17"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<a href="#__codelineno-20-18" id="__codelineno-20-18" name="__codelineno-20-18"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-20-19" id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="p">)</span>
<a href="#__codelineno-20-20" id="__codelineno-20-20" name="__codelineno-20-20"></a>
<a href="#__codelineno-20-21" id="__codelineno-20-21" name="__codelineno-20-21"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-20-22" id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-20-23" id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-20-24" id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-20-25" id="__codelineno-20-25" name="__codelineno-20-25"></a>
<a href="#__codelineno-20-26" id="__codelineno-20-26" name="__codelineno-20-26"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-20-27" id="__codelineno-20-27" name="__codelineno-20-27"></a>
<a href="#__codelineno-20-28" id="__codelineno-20-28" name="__codelineno-20-28"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model 2 -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ce8_ex2_r3.png"><img alt="" src="../assets/ce8_ex2_r3.png"/></a></p> <p>As shown in the plot, we have surpassed the state-of-the-art (SOTA) results with an average metric of <span class="arithmatex">\((0.0969 + 0.0731)/2 = 0.0849\)</span>. Additionally, the metric for the first experiment matches the best model in the benchmark, and the metric for the second experiment slightly exceeds the benchmark's best model. Using the same configuration for both models, we achieved the best overall results!</p> <h2 id="wiener-hammerstein">Wiener-Hammerstein<a class="headerlink" href="#wiener-hammerstein" title="Permanent link"></a></h2> <p>The description content primarily derives from the <a href="[Nonlinear Benchmark](https://www.nonlinearbenchmark.org/benchmarks)">benchmark website</a> and <a href="[Wiener-Hammerstein benchmark with process noise (dataset) (4tu.nl)](https://data.4tu.nl/articles/_/12952124)">associated paper</a>. For a detailed description, readers are referred to the linked references.</p> <blockquote> <p>The nonlinear benchmark website stands as a significant contribution to the system identification and machine learning community. The users are encouraged to explore all the papers referenced on the site.</p> </blockquote> <p>This benchmark focuses on a Wiener-Hammerstein electronic circuit where process noise plays a significant role in distorting the output signal.</p> <p>The Wiener-Hammerstein structure is a well-known block-oriented system which contains a static nonlinearity sandwiched between two Linear Time-Invariant (LTI) blocks (Figure 2). This arrangement presents a challenging identification problem due to the presence of these LTI blocks.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_system.png"><img alt="" src="../assets/wh_system.png"/></a></p> <blockquote> <p>Figure 2: the Wiener-Hammerstein system</p> </blockquote> <p>In Figure 2, the Wiener-Hammerstein system is illustrated with process noise <span class="arithmatex">\(e_x(t)\)</span> entering before the static nonlinearity <span class="arithmatex">\(f(x)\)</span>, sandwiched between LTI blocks represented by <span class="arithmatex">\(R(s)\)</span> and <span class="arithmatex">\(S(s)\)</span> at the input and output, respectively. Additionally, small, negligible noise sources <span class="arithmatex">\(e_u(t)\)</span> and <span class="arithmatex">\(e_y(t)\)</span> affect the measurement channels. The measured input and output signals are denoted as <span class="arithmatex">\(u_m(t)\)</span> and <span class="arithmatex">\(y_m(t)\)</span>.</p> <p>The first LTI block <span class="arithmatex">\(R(s)\)</span> is effectively modeled as a third-order lowpass filter. The second LTI subsystem <span class="arithmatex">\(S(s)\)</span> is configured as an inverse Chebyshev filter with a stop-band attenuation of <span class="arithmatex">\(40 dB\)</span> and a cutoff frequency of <span class="arithmatex">\(5 kHz\)</span>. Notably, <span class="arithmatex">\(S(s)\)</span> includes a transmission zero within the operational frequency range, complicating its inversion.</p> <p>The static nonlinearity <span class="arithmatex">\(f(x)\)</span> is implemented using a diode-resistor network, resulting in saturation nonlinearity. Process noise <span class="arithmatex">\(e_x(t)\)</span> is introduced as filtered white Gaussian noise, generated from a discrete-time third-order lowpass Butterworth filter followed by zero-order hold and analog low-pass reconstruction filtering with a cutoff of <span class="arithmatex">\(20 kHz\)</span>.</p> <p>Measurement noise sources <span class="arithmatex">\(e_u(t)\)</span> and <span class="arithmatex">\(e_y(t)\)</span> are minimal compared to <span class="arithmatex">\(e_x(t)\)</span>. The system's inputs and process noise are generated using an Arbitrary Waveform Generator (AWG), specifically the Agilent/HP E1445A, sampling at <span class="arithmatex">\(78125 Hz\)</span>, synchronized with an acquisition system (Agilent/HP E1430A) to ensure phase coherence and prevent leakage errors. Buffering between the acquisition cards and the system's inputs and outputs minimizes measurement equipment distortion.</p> <p>The benchmark provides two standard test signals through the benchmarking website: a random phase multisine and a sine-sweep signal. Both signals have an <span class="arithmatex">\(rms\)</span> value of <span class="arithmatex">\(0.71 Vrms\)</span> and cover frequencies from DC to <span class="arithmatex">\(15 kHz\)</span> (excluding DC). The sine-sweep spans this frequency range at a rate of <span class="arithmatex">\(4.29 MHz/min\)</span>. These test sets serve as targets for evaluating the model's performance, emphasizing accurate representation under varied conditions.</p> <p>The Wiener-Hammerstein benchmark highlights three primary nonlinear system identification challenges:</p> <ol> <li><strong>Process Noise:</strong> Significant in the system, influencing output fidelity.</li> <li><strong>Static Nonlinearity:</strong> Indirectly accessible from measured data, posing identification challenges.</li> <li><strong>Output Dynamics:</strong> Complex inversion due to transmission zero presence in <span class="arithmatex">\(S(s)\)</span>.</li> </ol> <p>The goal of this benchmark is to develop and validate robust models using separate estimation data, ensuring accurate characterization of the Wiener-Hammerstein system's behavior.</p> <h3 id="required-packages-and-versions_2">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_2" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a>pandas==2.2.2
<a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a>numpy==1.26.0
<a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a>matplotlib==3.8.4
<a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a>nonlinear_benchmarks==0.1.2
</code></pre></div> <p>Then, install the packages using: <div class="highlight"><pre><span></span><code><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a>pip install -r requirements.txt
</code></pre></div></p> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="sysidentpy-configuration_2">SysIdentPy configuration<a class="headerlink" href="#sysidentpy-configuration_2" title="Permanent link"></a></h3> <p>In this section, we will demonstrate the application of SysIdentPy to the Wiener-Hammerstein system dataset. The following code will guide you through the process of loading the dataset, configuring the SysIdentPy parameters, and building a model for Wiener-Hammerstein system.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a>
<a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span><span class="p">,</span> <span class="n">AOLS</span><span class="p">,</span> <span class="n">MetaMSS</span>
<a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span><span class="p">,</span> <span class="n">Fourier</span>
<a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-23-8" id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span><span class="p">,</span> <span class="n">BoundedVariableLeastSquares</span><span class="p">,</span> <span class="n">NonNegativeLeastSquares</span><span class="p">,</span> <span class="n">LeastSquaresMinimalResidual</span>
<a href="#__codelineno-23-9" id="__codelineno-23-9" name="__codelineno-23-9"></a>
<a href="#__codelineno-23-10" id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_mean_squared_error</span>
<a href="#__codelineno-23-11" id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-23-12" id="__codelineno-23-12" name="__codelineno-23-12"></a>
<a href="#__codelineno-23-13" id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="kn">import</span> <span class="nn">nonlinear_benchmarks</span>
<a href="#__codelineno-23-14" id="__codelineno-23-14" name="__codelineno-23-14"></a>
<a href="#__codelineno-23-15" id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="n">train_val</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">nonlinear_benchmarks</span><span class="o">.</span><span class="n">WienerHammerBenchMark</span><span class="p">(</span><span class="n">atleast_2d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-23-16" id="__codelineno-23-16" name="__codelineno-23-16"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_val</span>
<a href="#__codelineno-23-17" id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test</span>
</code></pre></div> <p>We used the <code>nonlinear_benchmarks</code> package to load the data. The user is referred to the <a href="[GerbenBeintema/nonlinear_benchmarks: The official dataload for http://www.nonlinearbenchmark.org/ (github.com)](https://github.com/GerbenBeintema/nonlinear_benchmarks/tree/master)">package documentation</a> to check the details of how to use it.</p> <p>The following plot detail the training and testing data of the experiment.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="n">plot_n</span> <span class="o">=</span> <span class="mi">800</span>
<a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a>
<a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:</span><span class="n">plot_n</span><span class="p">])</span>
<a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_train</span><span class="p">[:</span><span class="n">plot_n</span><span class="p">])</span>
<a href="#__codelineno-24-6" id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment: training data"</span><span class="p">)</span>
<a href="#__codelineno-24-7" id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"x_train"</span><span class="p">,</span> <span class="s2">"y_train"</span><span class="p">])</span>
<a href="#__codelineno-24-8" id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-24-9" id="__codelineno-24-9" name="__codelineno-24-9"></a>
<a href="#__codelineno-24-10" id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a href="#__codelineno-24-11" id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">[:</span><span class="n">plot_n</span><span class="p">])</span>
<a href="#__codelineno-24-12" id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:</span><span class="n">plot_n</span><span class="p">])</span>
<a href="#__codelineno-24-13" id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment: testing data"</span><span class="p">)</span>
<a href="#__codelineno-24-14" id="__codelineno-24-14" name="__codelineno-24-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"x_test"</span><span class="p">,</span> <span class="s2">"y_test"</span><span class="p">])</span>
<a href="#__codelineno-24-15" id="__codelineno-24-15" name="__codelineno-24-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_training_data.png"><img alt="" src="../assets/wh_training_data.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_testing_data.png"><img alt="" src="../assets/wh_testing_data.png"/></a></p> <p>The goal of this benchmark it to get a model that have a better performance than the SOTA model provided in the benchmarking paper.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_sota_results.png"><img alt="" src="../assets/wh_sota_results.png"/></a></p> <blockquote> <p>State of the art results presented in the <a href="[2405.10779 (arxiv.org)](https://arxiv.org/pdf/2405.10779)">benchmarking paper</a>. In this section we are only working with the Wiener-Hammerstein results, which are presented in the <span class="arithmatex">\(W-H\)</span> column.</p> </blockquote> <h3 id="results_1">Results<a class="headerlink" href="#results_1" title="Permanent link"></a></h3> <p>We will start with a basic configuration of FROLS using a polynomial basis function with degree equal 2. The <code>xlag</code> and <code>ylag</code> are set to <span class="arithmatex">\(7\)</span> in this first example. Because the dataset is considerably large, we will start with <code>n_info_values=50</code>. This means the FROLS algorithm will not include all regressors when calculating the information criteria used to determine the model order. While this approach might result in a sub-optimal model, it is a reasonable starting point for our first attempt.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="n">n</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a>
<a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-25-4" id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-25-5" id="__codelineno-25-5" name="__codelineno-25-5"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-25-6" id="__codelineno-25-6" name="__codelineno-25-6"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-25-7" id="__codelineno-25-7" name="__codelineno-25-7"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-25-8" id="__codelineno-25-8" name="__codelineno-25-8"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(</span><span class="n">unbiased</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<a href="#__codelineno-25-9" id="__codelineno-25-9" name="__codelineno-25-9"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a href="#__codelineno-25-10" id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="p">)</span>
<a href="#__codelineno-25-11" id="__codelineno-25-11" name="__codelineno-25-11"></a>
<a href="#__codelineno-25-12" id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-25-13" id="__codelineno-25-13" name="__codelineno-25-13"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-25-14" id="__codelineno-25-14" name="__codelineno-25-14"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-25-15" id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-25-16" id="__codelineno-25-16" name="__codelineno-25-16"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-25-17" id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="n">rmse_sota</span> <span class="o">=</span> <span class="n">rmse</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a href="#__codelineno-25-18" id="__codelineno-25-18" name="__codelineno-25-18"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"SysIdentPy -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">, NRMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_sota</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_r1.png"><img alt="" src="../assets/wh_r1.png"/></a></p> <p>The first configuration is already better than the <strong>SOTA</strong> models shown in the benchmark table! We started using <code>xlag=ylag=7</code> to have an idea of how well SysIdentPy would handle this dataset, but the results are pretty good already! However, the benchmarking paper indicates that they used higher lags for their models. Let's check what happens if we set <code>xlag=ylag=10</code>.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_val</span>
<a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test</span>
<a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a>
<a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="n">n</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a>
<a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-26-7" id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-26-8" id="__codelineno-26-8" name="__codelineno-26-8"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a href="#__codelineno-26-9" id="__codelineno-26-9" name="__codelineno-26-9"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a href="#__codelineno-26-10" id="__codelineno-26-10" name="__codelineno-26-10"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-26-11" id="__codelineno-26-11" name="__codelineno-26-11"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(</span><span class="n">unbiased</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<a href="#__codelineno-26-12" id="__codelineno-26-12" name="__codelineno-26-12"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a href="#__codelineno-26-13" id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="p">)</span>
<a href="#__codelineno-26-14" id="__codelineno-26-14" name="__codelineno-26-14"></a>
<a href="#__codelineno-26-15" id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-26-16" id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-26-17" id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-26-18" id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-26-19" id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-26-20" id="__codelineno-26-20" name="__codelineno-26-20"></a><span class="n">rmse_sota</span> <span class="o">=</span> <span class="n">rmse</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a href="#__codelineno-26-21" id="__codelineno-26-21" name="__codelineno-26-21"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"SysIdentPy -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">, NRMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_sota</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_r2.png"><img alt="" src="../assets/wh_r2.png"/></a></p> <p>The performance is even better now! For now, we are not worried about the model complexity (even in this case where we are comparing to a deep state neural network...). However, if we check the model order and the <code>AIC</code> plot, we see that the model have 50 regressors , but the <code>AIC</code> values do not change much after each added regression.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">info_values</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_aic.png"><img alt="" src="../assets/wh_aic.png"/></a></p> <p>So, what happens if we set a model with half of the regressors?</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_val</span>
<a href="#__codelineno-28-2" id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test</span>
<a href="#__codelineno-28-3" id="__codelineno-28-3" name="__codelineno-28-3"></a>
<a href="#__codelineno-28-4" id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="n">n</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-28-5" id="__codelineno-28-5" name="__codelineno-28-5"></a>
<a href="#__codelineno-28-6" id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-28-7" id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-28-8" id="__codelineno-28-8" name="__codelineno-28-8"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a href="#__codelineno-28-9" id="__codelineno-28-9" name="__codelineno-28-9"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a href="#__codelineno-28-10" id="__codelineno-28-10" name="__codelineno-28-10"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-28-11" id="__codelineno-28-11" name="__codelineno-28-11"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(</span><span class="n">unbiased</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<a href="#__codelineno-28-12" id="__codelineno-28-12" name="__codelineno-28-12"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a href="#__codelineno-28-13" id="__codelineno-28-13" name="__codelineno-28-13"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
<a href="#__codelineno-28-14" id="__codelineno-28-14" name="__codelineno-28-14"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-28-15" id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="p">)</span>
<a href="#__codelineno-28-16" id="__codelineno-28-16" name="__codelineno-28-16"></a>
<a href="#__codelineno-28-17" id="__codelineno-28-17" name="__codelineno-28-17"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-28-18" id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-28-19" id="__codelineno-28-19" name="__codelineno-28-19"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-28-20" id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-28-21" id="__codelineno-28-21" name="__codelineno-28-21"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-28-22" id="__codelineno-28-22" name="__codelineno-28-22"></a><span class="n">rmse_sota</span> <span class="o">=</span> <span class="n">rmse</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a href="#__codelineno-28-23" id="__codelineno-28-23" name="__codelineno-28-23"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"SysIdentPy -&gt; RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">, NRMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_sota</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/wh_r3.png"><img alt="" src="../assets/wh_r3.png"/></a></p> <p>As shown in the figure above, the results still outperform the SOTA models presented in the benchmarking paper. The SOTA results from the paper could likely be improved as well. Users are encouraged to explore the <a href="https://github.com/AlexandraBaier/deepsysid">deepsysid package</a>, which can be used to build deep state neural networks.</p> <p>This basic configuration can serve as a starting point for users to develop even better models using SysIdentPy. Give it a try!</p> <h2 id="air-passenger-demand-forecasting-a-benchmarking">Air Passenger Demand Forecasting - A Benchmarking<a class="headerlink" href="#air-passenger-demand-forecasting-a-benchmarking" title="Permanent link"></a></h2> <p>In this case study, we explore the capabilities of SysIdentPy by applying it to the Air Passenger dataset, a classic time series dataset widely used for evaluating time series forecasting methods. The primary goal of this analysis is to demonstrate that SysIdentPy can serve as a strong alternative for time series modeling, rather than to assert that one library is superior to another.</p> <h3 id="dataset-overview">Dataset Overview<a class="headerlink" href="#dataset-overview" title="Permanent link"></a></h3> <p>The Air Passenger dataset consists of monthly totals of international airline passengers from 1949 to 1960. This dataset is characterized by its strong seasonal patterns, trend components, and variability, making it an ideal benchmark for evaluating various time series forecasting methods. Specifically, the dataset includes:</p> <ul> <li><strong>Total Monthly Passengers</strong>: The number of passengers (in thousands) for each month.</li> <li><strong>Time Period</strong>: From January 1949 to December 1960, providing 144 data points.</li> </ul> <p>The dataset exhibits clear seasonal fluctuations and a trend, which poses a significant challenge for forecasting methods. It serves as a well-known benchmark for assessing the performance of different time series models due to its inherent complexity and well-documented behavior.</p> <h3 id="comparison-with-other-libraries">Comparison with Other Libraries<a class="headerlink" href="#comparison-with-other-libraries" title="Permanent link"></a></h3> <p>We will compare the performance of SysIdentPy with other popular time series modeling libraries, focusing on the following tools:</p> <ul> <li><strong>sktime</strong>: An extensive library for time series analysis in Python, offering various modeling techniques. For this case study, we will use:</li> <li><code>AutoARIMA</code>: Automatically selects the best ARIMA model based on the data.</li> <li><code>BATS</code> (Bayesian Structural Time Series): A model that captures complex seasonal patterns and trends.</li> <li><code>TBATS</code> (Trigonometric, Box-Cox, ARMA, Trend, and Seasonal): A model designed to handle multiple seasonal patterns.</li> <li><code>Exponential Smoothing</code>: A method that applies weighted averages to forecast future values.</li> <li><code>Prophet</code>: Developed by Facebook, it is particularly effective for capturing seasonality and holiday effects.</li> <li> <p><code>AutoETS</code> (Automatic Exponential Smoothing): Selects the best exponential smoothing model for the data.</p> </li> <li> <p><strong>SysIdentPy</strong>: A library designed for system identification and time series modeling. We will focus on:</p> </li> <li><code>MetaMSS</code> (Meta-heuristic Model Structure Selection): Uses metaheuristic algorithms to select the best model structure.</li> <li><code>AOLS</code> (Accelerated Orthogonal Least Squares): A method for selecting relevant regressors in a model.</li> <li><code>FROLS</code> (Forward Regression with Orthogonal Least Squares, using polynomial base functions): A regression technique for model structure selection with polynomial terms.</li> <li><code>NARXNN</code> (Nonlinear Auto-Regressive model with Exogenous Inputs using Neural Networks): A flexible method for modeling nonlinear time series with external inputs.</li> </ul> <h3 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link"></a></h3> <p>The objective of this case study is to evaluate and compare the performance of these methods on the Air Passenger dataset. We aim to assess how well each library handles the complex seasonal and trend components of the data and to showcase SysIdentPy as a viable option for time series forecasting.</p> <h3 id="required-packages-and-versions_3">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_3" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a>pystan==2.19.1.1
<a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a>holidays==0.11.2
<a href="#__codelineno-29-4" id="__codelineno-29-4" name="__codelineno-29-4"></a>fbprophet==0.7.1
<a href="#__codelineno-29-5" id="__codelineno-29-5" name="__codelineno-29-5"></a>neuralprophet==0.2.7
<a href="#__codelineno-29-6" id="__codelineno-29-6" name="__codelineno-29-6"></a>pandas==1.3.2
<a href="#__codelineno-29-7" id="__codelineno-29-7" name="__codelineno-29-7"></a>numpy==1.23.3
<a href="#__codelineno-29-8" id="__codelineno-29-8" name="__codelineno-29-8"></a>matplotlib==3.8.4
<a href="#__codelineno-29-9" id="__codelineno-29-9" name="__codelineno-29-9"></a>pmdarima==1.8.3
<a href="#__codelineno-29-10" id="__codelineno-29-10" name="__codelineno-29-10"></a>scikit-learn==0.24.2
<a href="#__codelineno-29-11" id="__codelineno-29-11" name="__codelineno-29-11"></a>scipy==1.9.1
<a href="#__codelineno-29-12" id="__codelineno-29-12" name="__codelineno-29-12"></a>sktime==0.8.0
<a href="#__codelineno-29-13" id="__codelineno-29-13" name="__codelineno-29-13"></a>statsmodels==0.12.2
<a href="#__codelineno-29-14" id="__codelineno-29-14" name="__codelineno-29-14"></a>tbats==1.1.0
<a href="#__codelineno-29-15" id="__codelineno-29-15" name="__codelineno-29-15"></a>torch==1.12.1
</code></pre></div> <p>Then, install the packages using: <div class="highlight"><pre><span></span><code><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a>pip install -r requirements.txt
</code></pre></div></p> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions. This practice isolates your projects dependencies and prevents version conflicts with other projects or system-wide packages. Additionally, be aware that some packages, such as <code>sktime</code> and <code>neuralprophet</code>, may install several dependencies automatically during their installation. Setting up a virtual environment helps manage these dependencies more effectively and keeps your project environment clean and reproducible.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <p>Let's begin by importing the necessary packages and setting up the environment for this analysis.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">simplefilter</span>
<a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-31-3" id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-31-4" id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-31-5" id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="kn">import</span> <span class="nn">scipy.signal.signaltools</span>
<a href="#__codelineno-31-6" id="__codelineno-31-6" name="__codelineno-31-6"></a>
<a href="#__codelineno-31-7" id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="k">def</span> <span class="nf">_centered</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">newsize</span><span class="p">):</span>
<a href="#__codelineno-31-8" id="__codelineno-31-8" name="__codelineno-31-8"></a>  <span class="c1"># Return the center newsize portion of the array.</span>
<a href="#__codelineno-31-9" id="__codelineno-31-9" name="__codelineno-31-9"></a>  <span class="c1"># this is needed due a conflict error using the versions of the packages defined</span>
<a href="#__codelineno-31-10" id="__codelineno-31-10" name="__codelineno-31-10"></a>  <span class="c1"># for this example</span>
<a href="#__codelineno-31-11" id="__codelineno-31-11" name="__codelineno-31-11"></a>  <span class="n">newsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">newsize</span><span class="p">)</span>
<a href="#__codelineno-31-12" id="__codelineno-31-12" name="__codelineno-31-12"></a>  <span class="n">currsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a href="#__codelineno-31-13" id="__codelineno-31-13" name="__codelineno-31-13"></a>  <span class="n">startind</span> <span class="o">=</span> <span class="p">(</span><span class="n">currsize</span> <span class="o">-</span> <span class="n">newsize</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a href="#__codelineno-31-14" id="__codelineno-31-14" name="__codelineno-31-14"></a>  <span class="n">endind</span> <span class="o">=</span> <span class="n">startind</span> <span class="o">+</span> <span class="n">newsize</span>
<a href="#__codelineno-31-15" id="__codelineno-31-15" name="__codelineno-31-15"></a>  <span class="n">myslice</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">startind</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">endind</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">endind</span><span class="p">))]</span>
<a href="#__codelineno-31-16" id="__codelineno-31-16" name="__codelineno-31-16"></a>  <span class="k">return</span> <span class="n">arr</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">myslice</span><span class="p">)]</span>
<a href="#__codelineno-31-17" id="__codelineno-31-17" name="__codelineno-31-17"></a>
<a href="#__codelineno-31-18" id="__codelineno-31-18" name="__codelineno-31-18"></a>
<a href="#__codelineno-31-19" id="__codelineno-31-19" name="__codelineno-31-19"></a><span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">signaltools</span><span class="o">.</span><span class="n">_centered</span> <span class="o">=</span> <span class="n">_centered</span>
<a href="#__codelineno-31-20" id="__codelineno-31-20" name="__codelineno-31-20"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-31-21" id="__codelineno-31-21" name="__codelineno-31-21"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">AOLS</span>
<a href="#__codelineno-31-22" id="__codelineno-31-22" name="__codelineno-31-22"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">MetaMSS</span>
<a href="#__codelineno-31-23" id="__codelineno-31-23" name="__codelineno-31-23"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-31-24" id="__codelineno-31-24" name="__codelineno-31-24"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-31-25" id="__codelineno-31-25" name="__codelineno-31-25"></a><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<a href="#__codelineno-31-26" id="__codelineno-31-26" name="__codelineno-31-26"></a><span class="kn">from</span> <span class="nn">sysidentpy.neural_network</span> <span class="kn">import</span> <span class="n">NARXNN</span>
<a href="#__codelineno-31-27" id="__codelineno-31-27" name="__codelineno-31-27"></a>
<a href="#__codelineno-31-28" id="__codelineno-31-28" name="__codelineno-31-28"></a><span class="kn">from</span> <span class="nn">sktime.datasets</span> <span class="kn">import</span> <span class="n">load_airline</span>
<a href="#__codelineno-31-29" id="__codelineno-31-29" name="__codelineno-31-29"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.ets</span> <span class="kn">import</span> <span class="n">AutoETS</span>
<a href="#__codelineno-31-30" id="__codelineno-31-30" name="__codelineno-31-30"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.arima</span> <span class="kn">import</span> <span class="n">ARIMA</span><span class="p">,</span> <span class="n">AutoARIMA</span>
<a href="#__codelineno-31-31" id="__codelineno-31-31" name="__codelineno-31-31"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.base</span> <span class="kn">import</span> <span class="n">ForecastingHorizon</span>
<a href="#__codelineno-31-32" id="__codelineno-31-32" name="__codelineno-31-32"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.exp_smoothing</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<a href="#__codelineno-31-33" id="__codelineno-31-33" name="__codelineno-31-33"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.fbprophet</span> <span class="kn">import</span> <span class="n">Prophet</span>
<a href="#__codelineno-31-34" id="__codelineno-31-34" name="__codelineno-31-34"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.tbats</span> <span class="kn">import</span> <span class="n">TBATS</span>
<a href="#__codelineno-31-35" id="__codelineno-31-35" name="__codelineno-31-35"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.bats</span> <span class="kn">import</span> <span class="n">BATS</span>
<a href="#__codelineno-31-36" id="__codelineno-31-36" name="__codelineno-31-36"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.model_selection</span> <span class="kn">import</span> <span class="n">temporal_train_test_split</span>
<a href="#__codelineno-31-37" id="__codelineno-31-37" name="__codelineno-31-37"></a><span class="kn">from</span> <span class="nn">sktime.performance_metrics.forecasting</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<a href="#__codelineno-31-38" id="__codelineno-31-38" name="__codelineno-31-38"></a><span class="kn">from</span> <span class="nn">sktime.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_series</span>
<a href="#__codelineno-31-39" id="__codelineno-31-39" name="__codelineno-31-39"></a>
<a href="#__codelineno-31-40" id="__codelineno-31-40" name="__codelineno-31-40"></a><span class="kn">from</span> <span class="nn">neuralprophet</span> <span class="kn">import</span> <span class="n">NeuralProphet</span>
<a href="#__codelineno-31-41" id="__codelineno-31-41" name="__codelineno-31-41"></a><span class="kn">from</span> <span class="nn">neuralprophet</span> <span class="kn">import</span> <span class="n">set_random_seed</span>
<a href="#__codelineno-31-42" id="__codelineno-31-42" name="__codelineno-31-42"></a>
<a href="#__codelineno-31-43" id="__codelineno-31-43" name="__codelineno-31-43"></a><span class="n">simplefilter</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
<a href="#__codelineno-31-44" id="__codelineno-31-44" name="__codelineno-31-44"></a><span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">"ignore"</span><span class="p">)</span>
<a href="#__codelineno-31-45" id="__codelineno-31-45" name="__codelineno-31-45"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a href="#__codelineno-31-46" id="__codelineno-31-46" name="__codelineno-31-46"></a><span class="n">loss</span> <span class="o">=</span> <span class="n">mean_squared_error</span>
</code></pre></div> <p>We use the <code>sktime</code> method to load the data. Besides, 23 samples is used as test data, following the definitions in the <code>sktime</code> examples.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-32-2" id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span> <span class="c1"># 23 samples for testing</span>
<a href="#__codelineno-32-3" id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_train"</span><span class="p">,</span> <span class="s2">"y_test"</span><span class="p">])</span>
<a href="#__codelineno-32-4" id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="#__codelineno-32-5" id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div> <p>The following image shows the data of the system to be modeled.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_dataset.png"><img alt="" src="../assets/ap_dataset.png"/></a></p> <h2 id="results_2">Results<a class="headerlink" href="#results_2" title="Permanent link"></a></h2> <p>Because we have several different models to test, the results are summarized in the following table. The user you will see that no hyperparameter tuning was made for SysIdentPy model. The idea here is to show how simple it can be to build good models in SysIdentPy.</p> <table> <thead> <tr> <th>No.</th> <th>Package</th> <th>Mean Squared Error</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>SysIdentPy (Neural Model)</td> <td>316.54</td> </tr> <tr> <td>2</td> <td>SysIdentPy (MetaMSS)</td> <td>450.99</td> </tr> <tr> <td>3</td> <td>SysIdentPy (AOLS)</td> <td>476.64</td> </tr> <tr> <td>4</td> <td>NeuralProphet</td> <td>501.24</td> </tr> <tr> <td>5</td> <td>SysIdentPy (FROLS)</td> <td>805.95</td> </tr> <tr> <td>6</td> <td>Exponential Smoothing</td> <td>910.52</td> </tr> <tr> <td>7</td> <td>Prophet</td> <td>1186.00</td> </tr> <tr> <td>8</td> <td>AutoArima</td> <td>1714.47</td> </tr> <tr> <td>9</td> <td>Manual Arima</td> <td>2085.42</td> </tr> <tr> <td>10</td> <td>ETS</td> <td>2590.05</td> </tr> <tr> <td>11</td> <td>BATS</td> <td>7286.64</td> </tr> <tr> <td>12</td> <td>TBATS</td> <td>7448.43</td> </tr> </tbody> </table> <h2 id="sysidentpy-frols">SysIdentPy: FROLS<a class="headerlink" href="#sysidentpy-frols" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-33-2" id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-33-3" id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-33-4" id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-33-5" id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-33-6" id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="n">sysidentpy</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-33-7" id="__codelineno-33-7" name="__codelineno-33-7"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a href="#__codelineno-33-8" id="__codelineno-33-8" name="__codelineno-33-8"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="c1"># the lags for all models will be 13</span>
<a href="#__codelineno-33-9" id="__codelineno-33-9" name="__codelineno-33-9"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-33-10" id="__codelineno-33-10" name="__codelineno-33-10"></a>  <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span>
<a href="#__codelineno-33-11" id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="p">)</span>
<a href="#__codelineno-33-12" id="__codelineno-33-12" name="__codelineno-33-12"></a>
<a href="#__codelineno-33-13" id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="n">sysidentpy</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-33-14" id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-33-15" id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">sysidentpy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-33-16" id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="n">frols_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-33-17" id="__codelineno-33-17" name="__codelineno-33-17"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-33-18" id="__codelineno-33-18" name="__codelineno-33-18"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-33-19" id="__codelineno-33-19" name="__codelineno-33-19"></a><span class="p">)</span>
<a href="#__codelineno-33-20" id="__codelineno-33-20" name="__codelineno-33-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">frols_loss</span><span class="p">)</span>
<a href="#__codelineno-33-21" id="__codelineno-33-21" name="__codelineno-33-21"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
<a href="#__codelineno-33-22" id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">805.95</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_frols.png"><img alt="" src="../assets/ap_frols.png"/></a></p> <h2 id="sysidentpy-aols">SysIdentPy: AOLS<a class="headerlink" href="#sysidentpy-aols" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-34-2" id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-34-3" id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-34-4" id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-34-5" id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-34-6" id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="n">df_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<a href="#__codelineno-34-7" id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="n">df_train</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"ds"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">]</span>
<a href="#__codelineno-34-8" id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="n">df_train</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
<a href="#__codelineno-34-9" id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="n">df_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<a href="#__codelineno-34-10" id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="n">df_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"ds"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">]</span>
<a href="#__codelineno-34-11" id="__codelineno-34-11" name="__codelineno-34-11"></a><span class="n">df_test</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
<a href="#__codelineno-34-12" id="__codelineno-34-12" name="__codelineno-34-12"></a>
<a href="#__codelineno-34-13" id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="n">sysidentpy_AOLS</span> <span class="o">=</span> <span class="n">AOLS</span><span class="p">(</span>
<a href="#__codelineno-34-14" id="__codelineno-34-14" name="__codelineno-34-14"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span> <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span>
<a href="#__codelineno-34-15" id="__codelineno-34-15" name="__codelineno-34-15"></a><span class="p">)</span>
<a href="#__codelineno-34-16" id="__codelineno-34-16" name="__codelineno-34-16"></a>
<a href="#__codelineno-34-17" id="__codelineno-34-17" name="__codelineno-34-17"></a><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-34-18" id="__codelineno-34-18" name="__codelineno-34-18"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-34-19" id="__codelineno-34-19" name="__codelineno-34-19"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-34-20" id="__codelineno-34-20" name="__codelineno-34-20"></a>
<a href="#__codelineno-34-21" id="__codelineno-34-21" name="__codelineno-34-21"></a><span class="n">aols_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-34-22" id="__codelineno-34-22" name="__codelineno-34-22"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-34-23" id="__codelineno-34-23" name="__codelineno-34-23"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-34-24" id="__codelineno-34-24" name="__codelineno-34-24"></a><span class="p">)</span>
<a href="#__codelineno-34-25" id="__codelineno-34-25" name="__codelineno-34-25"></a>
<a href="#__codelineno-34-26" id="__codelineno-34-26" name="__codelineno-34-26"></a><span class="nb">print</span><span class="p">(</span><span class="n">aols_loss</span><span class="p">)</span>
<a href="#__codelineno-34-27" id="__codelineno-34-27" name="__codelineno-34-27"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
<a href="#__codelineno-34-28" id="__codelineno-34-28" name="__codelineno-34-28"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">476.64</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_aols.png"><img alt="" src="../assets/ap_aols.png"/></a></p> <h2 id="sysidentpy-metamss">SysIdentPy: MetaMSS<a class="headerlink" href="#sysidentpy-metamss" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-35-2" id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-35-3" id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-35-4" id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-35-5" id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-35-6" id="__codelineno-35-6" name="__codelineno-35-6"></a>
<a href="#__codelineno-35-7" id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="n">sysidentpy_metamss</span> <span class="o">=</span> <span class="n">MetaMSS</span><span class="p">(</span>
<a href="#__codelineno-35-8" id="__codelineno-35-8" name="__codelineno-35-8"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span> <span class="n">ylag</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.17</span>
<a href="#__codelineno-35-9" id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="p">)</span>
<a href="#__codelineno-35-10" id="__codelineno-35-10" name="__codelineno-35-10"></a>
<a href="#__codelineno-35-11" id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-35-12" id="__codelineno-35-12" name="__codelineno-35-12"></a>
<a href="#__codelineno-35-13" id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-35-14" id="__codelineno-35-14" name="__codelineno-35-14"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-35-15" id="__codelineno-35-15" name="__codelineno-35-15"></a>
<a href="#__codelineno-35-16" id="__codelineno-35-16" name="__codelineno-35-16"></a><span class="n">metamss_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-35-17" id="__codelineno-35-17" name="__codelineno-35-17"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-35-18" id="__codelineno-35-18" name="__codelineno-35-18"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-35-19" id="__codelineno-35-19" name="__codelineno-35-19"></a><span class="p">)</span>
<a href="#__codelineno-35-20" id="__codelineno-35-20" name="__codelineno-35-20"></a>
<a href="#__codelineno-35-21" id="__codelineno-35-21" name="__codelineno-35-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">metamss_loss</span><span class="p">)</span>
<a href="#__codelineno-35-22" id="__codelineno-35-22" name="__codelineno-35-22"></a><span class="n">plot_results</span><span class="p">(</span>
<a href="#__codelineno-35-23" id="__codelineno-35-23" name="__codelineno-35-23"></a>  <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]</span>
<a href="#__codelineno-35-24" id="__codelineno-35-24" name="__codelineno-35-24"></a><span class="p">)</span>
<a href="#__codelineno-35-25" id="__codelineno-35-25" name="__codelineno-35-25"></a>
<a href="#__codelineno-35-26" id="__codelineno-35-26" name="__codelineno-35-26"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">450.99</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_metamss.png"><img alt="" src="../assets/ap_metamss.png"/></a></p> <h2 id="sysidentpy-neural-narx">SysIdentPy: Neural NARX<a class="headerlink" href="#sysidentpy-neural-narx" title="Permanent link"></a></h2> <p>The network architecture is just the same as the one used in to show how to build a Neural NARX model in SysIdentPy docs.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-36-1" id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="kn">import</span> <span class="nn">torch</span>
<a href="#__codelineno-36-2" id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-36-3" id="__codelineno-36-3" name="__codelineno-36-3"></a>
<a href="#__codelineno-36-4" id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-36-5" id="__codelineno-36-5" name="__codelineno-36-5"></a><span class="c1"># the split here will use 36 as test size just because the network will use the first values as initial conditions. It could be done like the others methods by concatenating the values</span>
<a href="#__codelineno-36-6" id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
<a href="#__codelineno-36-7" id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-36-8" id="__codelineno-36-8" name="__codelineno-36-8"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-36-9" id="__codelineno-36-9" name="__codelineno-36-9"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-36-10" id="__codelineno-36-10" name="__codelineno-36-10"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<a href="#__codelineno-36-11" id="__codelineno-36-11" name="__codelineno-36-11"></a>
<a href="#__codelineno-36-12" id="__codelineno-36-12" name="__codelineno-36-12"></a><span class="k">class</span> <span class="nc">NARX</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a href="#__codelineno-36-13" id="__codelineno-36-13" name="__codelineno-36-13"></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-36-14" id="__codelineno-36-14" name="__codelineno-36-14"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a href="#__codelineno-36-15" id="__codelineno-36-15" name="__codelineno-36-15"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a href="#__codelineno-36-16" id="__codelineno-36-16" name="__codelineno-36-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a href="#__codelineno-36-17" id="__codelineno-36-17" name="__codelineno-36-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">lin3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a href="#__codelineno-36-18" id="__codelineno-36-18" name="__codelineno-36-18"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">lin4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-36-19" id="__codelineno-36-19" name="__codelineno-36-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
<a href="#__codelineno-36-20" id="__codelineno-36-20" name="__codelineno-36-20"></a>
<a href="#__codelineno-36-21" id="__codelineno-36-21" name="__codelineno-36-21"></a>
<a href="#__codelineno-36-22" id="__codelineno-36-22" name="__codelineno-36-22"></a>  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xb</span><span class="p">):</span>
<a href="#__codelineno-36-23" id="__codelineno-36-23" name="__codelineno-36-23"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
<a href="#__codelineno-36-24" id="__codelineno-36-24" name="__codelineno-36-24"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a href="#__codelineno-36-25" id="__codelineno-36-25" name="__codelineno-36-25"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a href="#__codelineno-36-26" id="__codelineno-36-26" name="__codelineno-36-26"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a href="#__codelineno-36-27" id="__codelineno-36-27" name="__codelineno-36-27"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin3</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a href="#__codelineno-36-28" id="__codelineno-36-28" name="__codelineno-36-28"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a href="#__codelineno-36-29" id="__codelineno-36-29" name="__codelineno-36-29"></a>    <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin4</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a href="#__codelineno-36-30" id="__codelineno-36-30" name="__codelineno-36-30"></a>    <span class="k">return</span> <span class="n">z</span>
<a href="#__codelineno-36-31" id="__codelineno-36-31" name="__codelineno-36-31"></a>
<a href="#__codelineno-36-32" id="__codelineno-36-32" name="__codelineno-36-32"></a><span class="n">narx_net</span> <span class="o">=</span> <span class="n">NARXNN</span><span class="p">(</span>
<a href="#__codelineno-36-33" id="__codelineno-36-33" name="__codelineno-36-33"></a>  <span class="n">net</span><span class="o">=</span><span class="n">NARX</span><span class="p">(),</span>
<a href="#__codelineno-36-34" id="__codelineno-36-34" name="__codelineno-36-34"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
<a href="#__codelineno-36-35" id="__codelineno-36-35" name="__codelineno-36-35"></a>  <span class="n">model_type</span><span class="o">=</span><span class="s2">"NAR"</span><span class="p">,</span>
<a href="#__codelineno-36-36" id="__codelineno-36-36" name="__codelineno-36-36"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a href="#__codelineno-36-37" id="__codelineno-36-37" name="__codelineno-36-37"></a>  <span class="n">epochs</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
<a href="#__codelineno-36-38" id="__codelineno-36-38" name="__codelineno-36-38"></a>  <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a href="#__codelineno-36-39" id="__codelineno-36-39" name="__codelineno-36-39"></a>  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">2.5e-02</span><span class="p">,</span>
<a href="#__codelineno-36-40" id="__codelineno-36-40" name="__codelineno-36-40"></a>  <span class="n">optim_params</span><span class="o">=</span><span class="p">{},</span> <span class="c1"># optional parameters of the optimizer</span>
<a href="#__codelineno-36-41" id="__codelineno-36-41" name="__codelineno-36-41"></a><span class="p">)</span>
<a href="#__codelineno-36-42" id="__codelineno-36-42" name="__codelineno-36-42"></a>
<a href="#__codelineno-36-43" id="__codelineno-36-43" name="__codelineno-36-43"></a><span class="n">narx_net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-36-44" id="__codelineno-36-44" name="__codelineno-36-44"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">narx_net</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">forecast_horizon</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-36-45" id="__codelineno-36-45" name="__codelineno-36-45"></a>
<a href="#__codelineno-36-46" id="__codelineno-36-46" name="__codelineno-36-46"></a><span class="n">narxnet_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-36-47" id="__codelineno-36-47" name="__codelineno-36-47"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">narx_net</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-36-48" id="__codelineno-36-48" name="__codelineno-36-48"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">narx_net</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-36-49" id="__codelineno-36-49" name="__codelineno-36-49"></a><span class="p">)</span>
<a href="#__codelineno-36-50" id="__codelineno-36-50" name="__codelineno-36-50"></a>
<a href="#__codelineno-36-51" id="__codelineno-36-51" name="__codelineno-36-51"></a><span class="nb">print</span><span class="p">(</span><span class="n">narxnet_loss</span><span class="p">)</span>
<a href="#__codelineno-36-52" id="__codelineno-36-52" name="__codelineno-36-52"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">narx_net</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">narx_net</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_neural_narx.png"><img alt="" src="../assets/ap_neural_narx.png"/></a></p> <h2 id="sktime-models">sktime models<a class="headerlink" href="#sktime-models" title="Permanent link"></a></h2> <p>The following models are the ones available in the <strong>sktime</strong> package.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-37-1" id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-37-2" id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span> <span class="c1"># 23 samples for testing</span>
<a href="#__codelineno-37-3" id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_train"</span><span class="p">,</span> <span class="s2">"y_test"</span><span class="p">])</span>
<a href="#__codelineno-37-4" id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="n">fh</span> <span class="o">=</span> <span class="n">ForecastingHorizon</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_relative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div> <h2 id="sktime-exponential-smoothing">sktime: Exponential Smoothing<a class="headerlink" href="#sktime-exponential-smoothing" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-38-1" id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="n">es</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">"add"</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s2">"multiplicative"</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a href="#__codelineno-38-2" id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-38-3" id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-38-4" id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="n">es</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-38-5" id="__codelineno-38-5" name="__codelineno-38-5"></a><span class="n">y_pred_es</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<a href="#__codelineno-38-6" id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_es</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-38-7" id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="n">es_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_es</span><span class="p">)</span>
<a href="#__codelineno-38-8" id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="n">es_loss</span>
<a href="#__codelineno-38-9" id="__codelineno-38-9" name="__codelineno-38-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">910.46</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_es.png"><img alt="" src="../assets/ap_es.png"/></a></p> <h2 id="sktime-autoets">sktime: AutoETS<a class="headerlink" href="#sktime-autoets" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-39-1" id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-39-2" id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-39-3" id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="n">ets</span> <span class="o">=</span> <span class="n">AutoETS</span><span class="p">(</span><span class="n">auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-39-4" id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="n">ets</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-39-5" id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="n">y_pred_ets</span> <span class="o">=</span> <span class="n">ets</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<a href="#__codelineno-39-6" id="__codelineno-39-6" name="__codelineno-39-6"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ets</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-39-7" id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="n">ets_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ets</span><span class="p">)</span>
<a href="#__codelineno-39-8" id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="n">ets_loss</span>
<a href="#__codelineno-39-9" id="__codelineno-39-9" name="__codelineno-39-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">1739.11</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_ets.png"><img alt="" src="../assets/ap_ets.png"/></a></p> <h2 id="sktime-autoarima">sktime: AutoArima<a class="headerlink" href="#sktime-autoarima" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-40-1" id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-40-2" id="__codelineno-40-2" name="__codelineno-40-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-40-3" id="__codelineno-40-3" name="__codelineno-40-3"></a>
<a href="#__codelineno-40-4" id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="n">auto_arima</span> <span class="o">=</span> <span class="n">AutoARIMA</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-40-5" id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="n">auto_arima</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-40-6" id="__codelineno-40-6" name="__codelineno-40-6"></a><span class="n">y_pred_auto_arima</span> <span class="o">=</span> <span class="n">auto_arima</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<a href="#__codelineno-40-7" id="__codelineno-40-7" name="__codelineno-40-7"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_auto_arima</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-40-8" id="__codelineno-40-8" name="__codelineno-40-8"></a><span class="n">autoarima_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_auto_arima</span><span class="p">)</span>
<a href="#__codelineno-40-9" id="__codelineno-40-9" name="__codelineno-40-9"></a><span class="n">autoarima_loss</span>
<a href="#__codelineno-40-10" id="__codelineno-40-10" name="__codelineno-40-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">1714.47</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_autoarima.png"><img alt="" src="../assets/ap_autoarima.png"/></a></p> <h2 id="sktime-arima">sktime: Arima<a class="headerlink" href="#sktime-arima" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-41-1" id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-41-2" id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-41-3" id="__codelineno-41-3" name="__codelineno-41-3"></a><span class="n">manual_arima</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span>
<a href="#__codelineno-41-4" id="__codelineno-41-4" name="__codelineno-41-4"></a>  <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span>
<a href="#__codelineno-41-5" id="__codelineno-41-5" name="__codelineno-41-5"></a><span class="p">)</span> <span class="c1"># seasonal_order=(0, 1, 0, 12)</span>
<a href="#__codelineno-41-6" id="__codelineno-41-6" name="__codelineno-41-6"></a><span class="n">manual_arima</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-41-7" id="__codelineno-41-7" name="__codelineno-41-7"></a><span class="n">y_pred_manual_arima</span> <span class="o">=</span> <span class="n">manual_arima</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<a href="#__codelineno-41-8" id="__codelineno-41-8" name="__codelineno-41-8"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_manual_arima</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-41-9" id="__codelineno-41-9" name="__codelineno-41-9"></a><span class="n">manualarima_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_manual_arima</span><span class="p">)</span>
<a href="#__codelineno-41-10" id="__codelineno-41-10" name="__codelineno-41-10"></a><span class="n">manualarima_loss</span>
<a href="#__codelineno-41-11" id="__codelineno-41-11" name="__codelineno-41-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">2085.42</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_manual_arima.png"><img alt="" src="../assets/ap_manual_arima.png"/></a></p> <h2 id="sktime-bats">sktime: BATS<a class="headerlink" href="#sktime-bats" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-42-1" id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-42-2" id="__codelineno-42-2" name="__codelineno-42-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-42-3" id="__codelineno-42-3" name="__codelineno-42-3"></a><span class="n">bats</span> <span class="o">=</span> <span class="n">BATS</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">use_trend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_box_cox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="#__codelineno-42-4" id="__codelineno-42-4" name="__codelineno-42-4"></a><span class="n">bats</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-42-5" id="__codelineno-42-5" name="__codelineno-42-5"></a><span class="n">y_pred_bats</span> <span class="o">=</span> <span class="n">bats</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<a href="#__codelineno-42-6" id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bats</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-42-7" id="__codelineno-42-7" name="__codelineno-42-7"></a><span class="n">bats_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bats</span><span class="p">)</span>
<a href="#__codelineno-42-8" id="__codelineno-42-8" name="__codelineno-42-8"></a><span class="n">bats_loss</span>
<a href="#__codelineno-42-9" id="__codelineno-42-9" name="__codelineno-42-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">7286.64</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_bats.png"><img alt="" src="../assets/ap_bats.png"/></a></p> <h2 id="sktime-tbats">sktime: TBATS<a class="headerlink" href="#sktime-tbats" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-43-1" id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-43-2" id="__codelineno-43-2" name="__codelineno-43-2"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-43-3" id="__codelineno-43-3" name="__codelineno-43-3"></a><span class="n">tbats</span> <span class="o">=</span> <span class="n">TBATS</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">use_trend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_box_cox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="#__codelineno-43-4" id="__codelineno-43-4" name="__codelineno-43-4"></a><span class="n">tbats</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-43-5" id="__codelineno-43-5" name="__codelineno-43-5"></a><span class="n">y_pred_tbats</span> <span class="o">=</span> <span class="n">tbats</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<a href="#__codelineno-43-6" id="__codelineno-43-6" name="__codelineno-43-6"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tbats</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-43-7" id="__codelineno-43-7" name="__codelineno-43-7"></a><span class="n">tbats_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_tbats</span><span class="p">)</span>
<a href="#__codelineno-43-8" id="__codelineno-43-8" name="__codelineno-43-8"></a><span class="n">tbats_loss</span>
<a href="#__codelineno-43-9" id="__codelineno-43-9" name="__codelineno-43-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">7448.43</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_tbats.png"><img alt="" src="../assets/ap_tbats.png"/></a></p> <h2 id="sktime-prophet">sktime: Prophet<a class="headerlink" href="#sktime-prophet" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-44-1" id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-44-2" id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<a href="#__codelineno-44-3" id="__codelineno-44-3" name="__codelineno-44-3"></a><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-44-4" id="__codelineno-44-4" name="__codelineno-44-4"></a><span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="#__codelineno-44-5" id="__codelineno-44-5" name="__codelineno-44-5"></a><span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s2">"M"</span><span class="p">)</span>
<a href="#__codelineno-44-6" id="__codelineno-44-6" name="__codelineno-44-6"></a><span class="n">z_train</span><span class="p">,</span> <span class="n">z_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a href="#__codelineno-44-7" id="__codelineno-44-7" name="__codelineno-44-7"></a><span class="n">prophet</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span>
<a href="#__codelineno-44-8" id="__codelineno-44-8" name="__codelineno-44-8"></a>  <span class="n">seasonality_mode</span><span class="o">=</span><span class="s2">"multiplicative"</span><span class="p">,</span>
<a href="#__codelineno-44-9" id="__codelineno-44-9" name="__codelineno-44-9"></a>  <span class="n">n_changepoints</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">),</span>
<a href="#__codelineno-44-10" id="__codelineno-44-10" name="__codelineno-44-10"></a>  <span class="n">add_country_holidays</span><span class="o">=</span><span class="p">{</span><span class="s2">"country_name"</span><span class="p">:</span> <span class="s2">"Germany"</span><span class="p">},</span>
<a href="#__codelineno-44-11" id="__codelineno-44-11" name="__codelineno-44-11"></a>  <span class="n">yearly_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a href="#__codelineno-44-12" id="__codelineno-44-12" name="__codelineno-44-12"></a>  <span class="n">weekly_seasonality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a href="#__codelineno-44-13" id="__codelineno-44-13" name="__codelineno-44-13"></a>  <span class="n">daily_seasonality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a href="#__codelineno-44-14" id="__codelineno-44-14" name="__codelineno-44-14"></a><span class="p">)</span>
<a href="#__codelineno-44-15" id="__codelineno-44-15" name="__codelineno-44-15"></a><span class="n">prophet</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">z_train</span><span class="p">)</span>
<a href="#__codelineno-44-16" id="__codelineno-44-16" name="__codelineno-44-16"></a><span class="n">y_pred_prophet</span> <span class="o">=</span> <span class="n">prophet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">to_relative</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a href="#__codelineno-44-17" id="__codelineno-44-17" name="__codelineno-44-17"></a><span class="n">y_pred_prophet</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">index</span>
<a href="#__codelineno-44-18" id="__codelineno-44-18" name="__codelineno-44-18"></a><span class="n">plot_series</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_prophet</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">"y_test"</span><span class="p">,</span> <span class="s2">"y_pred"</span><span class="p">])</span>
<a href="#__codelineno-44-19" id="__codelineno-44-19" name="__codelineno-44-19"></a><span class="n">prophet_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_prophet</span><span class="p">)</span>
<a href="#__codelineno-44-20" id="__codelineno-44-20" name="__codelineno-44-20"></a><span class="n">prophet_loss</span>
<a href="#__codelineno-44-21" id="__codelineno-44-21" name="__codelineno-44-21"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">1186.00</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_prophet.png"><img alt="" src="../assets/ap_prophet.png"/></a></p> <h2 id="neural-prophet">Neural Prophet<a class="headerlink" href="#neural-prophet" title="Permanent link"></a></h2> <div class="highlight"><pre><span></span><code><a href="#__codelineno-45-1" id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-45-2" id="__codelineno-45-2" name="__codelineno-45-2"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">".\datasets\air_passengers.csv"</span><span class="p">)</span>
<a href="#__codelineno-45-3" id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="n">m</span> <span class="o">=</span> <span class="n">NeuralProphet</span><span class="p">(</span><span class="n">seasonality_mode</span><span class="o">=</span><span class="s2">"multiplicative"</span><span class="p">)</span>
<a href="#__codelineno-45-4" id="__codelineno-45-4" name="__codelineno-45-4"></a><span class="n">df_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="#__codelineno-45-5" id="__codelineno-45-5" name="__codelineno-45-5"></a><span class="n">df_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">23</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="#__codelineno-45-6" id="__codelineno-45-6" name="__codelineno-45-6"></a>
<a href="#__codelineno-45-7" id="__codelineno-45-7" name="__codelineno-45-7"></a><span class="n">m</span> <span class="o">=</span> <span class="n">NeuralProphet</span><span class="p">(</span><span class="n">seasonality_mode</span><span class="o">=</span><span class="s2">"multiplicative"</span><span class="p">)</span>
<a href="#__codelineno-45-8" id="__codelineno-45-8" name="__codelineno-45-8"></a><span class="n">metrics</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"MS"</span><span class="p">)</span>
<a href="#__codelineno-45-9" id="__codelineno-45-9" name="__codelineno-45-9"></a><span class="n">future</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span>
<a href="#__codelineno-45-10" id="__codelineno-45-10" name="__codelineno-45-10"></a>  <span class="n">df_train</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">n_historic_predictions</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
<a href="#__codelineno-45-11" id="__codelineno-45-11" name="__codelineno-45-11"></a><span class="p">)</span>
<a href="#__codelineno-45-12" id="__codelineno-45-12" name="__codelineno-45-12"></a><span class="n">forecast</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<a href="#__codelineno-45-13" id="__codelineno-45-13" name="__codelineno-45-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">[</span><span class="s2">"yhat1"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">23</span><span class="p">:])</span>
<a href="#__codelineno-45-14" id="__codelineno-45-14" name="__codelineno-45-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a href="#__codelineno-45-15" id="__codelineno-45-15" name="__codelineno-45-15"></a><span class="n">neuralprophet_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">forecast</span><span class="p">[</span><span class="s2">"yhat1"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">23</span><span class="p">:],</span> <span class="n">df_test</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a href="#__codelineno-45-16" id="__codelineno-45-16" name="__codelineno-45-16"></a><span class="n">neuralprophet_loss</span>
<a href="#__codelineno-45-17" id="__codelineno-45-17" name="__codelineno-45-17"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">501.24</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/ap_neuralprophet.png"><img alt="" src="../assets/ap_neuralprophet.png"/></a></p> <p>The final results can be summarized as follows, resulting in the table presented in the beginning of this case study:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-46-1" id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
<a href="#__codelineno-46-2" id="__codelineno-46-2" name="__codelineno-46-2"></a>  <span class="s2">"Exponential Smoothing"</span><span class="p">:</span> <span class="n">es_loss</span><span class="p">,</span>
<a href="#__codelineno-46-3" id="__codelineno-46-3" name="__codelineno-46-3"></a>  <span class="s2">"ETS"</span><span class="p">:</span> <span class="n">ets_loss</span><span class="p">,</span>
<a href="#__codelineno-46-4" id="__codelineno-46-4" name="__codelineno-46-4"></a>  <span class="s2">"AutoArima"</span><span class="p">:</span> <span class="n">autoarima_loss</span><span class="p">,</span>
<a href="#__codelineno-46-5" id="__codelineno-46-5" name="__codelineno-46-5"></a>  <span class="s2">"Manual Arima"</span><span class="p">:</span> <span class="n">manualarima_loss</span><span class="p">,</span>
<a href="#__codelineno-46-6" id="__codelineno-46-6" name="__codelineno-46-6"></a>  <span class="s2">"BATS"</span><span class="p">:</span> <span class="n">bats_loss</span><span class="p">,</span>
<a href="#__codelineno-46-7" id="__codelineno-46-7" name="__codelineno-46-7"></a>  <span class="s2">"TBATS"</span><span class="p">:</span> <span class="n">tbats_loss</span><span class="p">,</span>
<a href="#__codelineno-46-8" id="__codelineno-46-8" name="__codelineno-46-8"></a>  <span class="s2">"Prophet"</span><span class="p">:</span> <span class="n">prophet_loss</span><span class="p">,</span>
<a href="#__codelineno-46-9" id="__codelineno-46-9" name="__codelineno-46-9"></a>  <span class="s2">"SysIdentPy (Polynomial Model)"</span><span class="p">:</span> <span class="n">frols_loss</span><span class="p">,</span>
<a href="#__codelineno-46-10" id="__codelineno-46-10" name="__codelineno-46-10"></a>  <span class="s2">"SysIdentPy (Neural Model)"</span><span class="p">:</span> <span class="n">narxnet_loss</span><span class="p">,</span>
<a href="#__codelineno-46-11" id="__codelineno-46-11" name="__codelineno-46-11"></a>  <span class="s2">"SysIdentPy (AOLS)"</span><span class="p">:</span> <span class="n">aols_loss</span><span class="p">,</span>
<a href="#__codelineno-46-12" id="__codelineno-46-12" name="__codelineno-46-12"></a>  <span class="s2">"SysIdentPy (MetaMSS)"</span><span class="p">:</span> <span class="n">metamss_loss</span><span class="p">,</span>
<a href="#__codelineno-46-13" id="__codelineno-46-13" name="__codelineno-46-13"></a>  <span class="s2">"NeuralProphet"</span><span class="p">:</span> <span class="n">neuralprophet_loss</span><span class="p">,</span>
<a href="#__codelineno-46-14" id="__codelineno-46-14" name="__codelineno-46-14"></a><span class="p">}</span>
<a href="#__codelineno-46-15" id="__codelineno-46-15" name="__codelineno-46-15"></a><span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">result</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div> <h2 id="system-with-hysteresis-modeling-a-magneto-rheological-damper-device">System With Hysteresis - Modeling a Magneto-rheological Damper Device<a class="headerlink" href="#system-with-hysteresis-modeling-a-magneto-rheological-damper-device" title="Permanent link"></a></h2> <p>The memory effects between quasi-static input and output make the modeling of hysteretic systems very difficult. Physics-based models are often used to describe the hysteresis loops, but these models usually lack the simplicity and efficiency required in practical applications involving system characterization, identification, and control. As detailed in <a href="[Sufficient conditions for rate-independent hysteresis in autoregressive identified models - ScienceDirect](https://www.sciencedirect.com/science/article/abs/pii/S0888327015005968)">Martins, S. A. M. and Aguirre, L. A.</a>, NARX models have proven to be a feasible choice to describe the hysteresis loops. See Chapter 8 for a detailed background. However, even considering the sufficient conditions for rate independent hysteresis representation, classical structure selection algorithms fails to return a model with decent performance and the user needs to set a multi-valued function to ensure the occurrence of the bounding structure <span class="arithmatex">\(\mathcal{H}\)</span> (<a href="[Sufficient conditions for rate-independent hysteresis in autoregressive identified models - ScienceDirect](https://www.sciencedirect.com/science/article/abs/pii/S0888327015005968)">Martins, S. A. M. and Aguirre, L. A.</a>).</p> <p>Even though some progress has been made, previous work has been limited to models with a single equilibrium point. The present case study aims to present new prospects in the model structure selection of hysteretic systems regarding the cases where the models have multiple inputs and it is not restricted concerning the number of equilibrium points. For that, the MetaMSS algorithm will be used to build a model for a magneto-rheological damper (MRD) considering the mentioned sufficient conditions.</p> <h3 id="a-brief-description-of-the-bouc-wen-model-of-magneto-rheological-damper-device">A Brief description of the Bouc-Wen model of magneto-rheological damper device<a class="headerlink" href="#a-brief-description-of-the-bouc-wen-model-of-magneto-rheological-damper-device" title="Permanent link"></a></h3> <p>The data used in this study-case is the Bouc-Wen model (<a href="[R. Bouc, Forced Vibrations of a Mechanical System with Hysteresis, Proceedings of the 4th Conference on Non-linear Oscillations, Prague, 5-9 September 1967, pp. 315. - References - Scientific Research Publishing (scirp.org)](https://www.scirp.org/reference/referencespapers?referenceid=726819)">Bouc, R</a>, <a href="[Method for Random Vibration of Hysteretic Systems | Journal of the Engineering Mechanics Division | Vol 102, No 2 (ascelibrary.org)](https://ascelibrary.org/doi/10.1061/JMCEA3.0002106)">Wen, Y. X.</a>) of an MRD whose schematic diagram is shown in the figure below.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bouc_wen.png"><img alt="" src="../assets/bouc_wen.png"/></a></p> <blockquote> <p>The model for a magneto-rheological damper proposed by <a href="[Controlling buildings: a new frontier in feedback | IEEE Journals &amp; Magazine | IEEE Xplore](https://ieeexplore.ieee.org/document/642972)">Spencer, B. F. and Sain, M. K.</a>.</p> </blockquote> <p>The general form of the Bouc-Wen model can be described as (<a href="[Controlling buildings: a new frontier in feedback | IEEE Journals &amp; Magazine | IEEE Xplore](https://ieeexplore.ieee.org/document/642972)">Spencer, B. F. and Sain, M. K.</a>):</p> <div class="arithmatex">\[ \begin{equation} \dfrac{dz}{dt} = g\left[x,z,sign\left(\dfrac{dx}{dt}\right)\right]\dfrac{dx}{dt}, \end{equation} \]</div> <p>where <span class="arithmatex">\(z\)</span> is the hysteretic model output, <span class="arithmatex">\(x\)</span> the input and <span class="arithmatex">\(g[\cdot]\)</span> a nonlinear function of <span class="arithmatex">\(x\)</span>, <span class="arithmatex">\(z\)</span> and <span class="arithmatex">\(sign (dx/dt)\)</span>. <a href="[Controlling buildings: a new frontier in feedback | IEEE Journals &amp; Magazine | IEEE Xplore](https://ieeexplore.ieee.org/document/642972)">Spencer, B. F. and Sain, M. K.</a> proposed the following phenomenological model for the aforementioned device:</p> <div class="arithmatex">\[ \begin{align} f&amp;= c_1\dot{\rho}+k_1(x-x_0),\nonumber\\ \dot{\rho}&amp;=\dfrac{1}{c_0+c_1}[\alpha z+c_0\dot{x}+k_0(x-\rho)],\nonumber\\ \dot{z}&amp;=-\gamma|\dot{x}-\dot{\rho}|z|z|^{n-1}-\beta(\dot{x}-\dot{\rho})|z|^n+A(\dot{x}-\dot{\rho}),\nonumber\\ \alpha&amp;=\alpha_a+\alpha_bu_{bw},\nonumber\\ c_1&amp;=c_{1a}+c_{1b}u_{bw},\nonumber\\ c_0&amp;=c_{0a}+c_{0b}u_{bw},\nonumber\\ \dot{u}_{bw}&amp;=-\eta(u_{bw}-E). \end{align} \]</div> <p>where <span class="arithmatex">\(f\)</span> is the damping force, <span class="arithmatex">\(c_1\)</span> and <span class="arithmatex">\(c_0\)</span> represent the viscous coefficients, <span class="arithmatex">\(E\)</span> is the input voltage, <span class="arithmatex">\(x\)</span> is the displacement and <span class="arithmatex">\(\dot{x}\)</span> is the velocity of the model. The parameters of the system (see table below) were taken from <a href="[NARX-based technique for the modelling of magneto-rheological damping devices - IOPscience](https://iopscience.iop.org/article/10.1088/0964-1726/11/1/309)">Leva, A. and Piroddi, L.</a>.</p> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td><span class="arithmatex">\(c_{0_a}\)</span></td> <td><span class="arithmatex">\(20.2 \, N \, s/cm\)</span></td> <td><span class="arithmatex">\(\alpha_{a}\)</span></td> <td><span class="arithmatex">\(44.9 \, N/cm\)</span></td> </tr> <tr> <td><span class="arithmatex">\(c_{0_b}\)</span></td> <td><span class="arithmatex">\(2.68 \, N \, s/cm \, V\)</span></td> <td><span class="arithmatex">\(\alpha_{b}\)</span></td> <td><span class="arithmatex">\(638 \, N/cm\)</span></td> </tr> <tr> <td><span class="arithmatex">\(c_{1_a}\)</span></td> <td><span class="arithmatex">\(350 \, N \, s/cm\)</span></td> <td><span class="arithmatex">\(\gamma\)</span></td> <td><span class="arithmatex">\(39.3 \, cm^{-2}\)</span></td> </tr> <tr> <td><span class="arithmatex">\(c_{1_b}\)</span></td> <td><span class="arithmatex">\(70.7 \, N \, s/cm \, V\)</span></td> <td><span class="arithmatex">\(\beta\)</span></td> <td><span class="arithmatex">\(39.3 \, cm^{-2}\)</span></td> </tr> <tr> <td><span class="arithmatex">\(k_{0}\)</span></td> <td><span class="arithmatex">\(15 \, N/cm\)</span></td> <td><span class="arithmatex">\(n\)</span></td> <td><span class="arithmatex">\(2\)</span></td> </tr> <tr> <td><span class="arithmatex">\(k_{1}\)</span></td> <td><span class="arithmatex">\(5.37 \, N/cm\)</span></td> <td><span class="arithmatex">\(\eta\)</span></td> <td><span class="arithmatex">\(251 \, s^{-1}\)</span></td> </tr> <tr> <td><span class="arithmatex">\(x_{0}\)</span></td> <td><span class="arithmatex">\(0 \, cm\)</span></td> <td><span class="arithmatex">\(A\)</span></td> <td><span class="arithmatex">\(47.2\)</span></td> </tr> </tbody> </table> <p>For this particular study, both displacement and voltage inputs, <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(E\)</span>, respectively, were generated by filtering a white Gaussian noise sequence using a Blackman-Harris FIR filter with <span class="arithmatex">\(6\)</span>Hz cutoff frequency. The integration step-size was set to <span class="arithmatex">\(h = 0.002\)</span>, following the procedures described in <a href="[Sufficient conditions for rate-independent hysteresis in autoregressive identified models - ScienceDirect](https://www.sciencedirect.com/science/article/abs/pii/S0888327015005968)">Martins, S. A. M. and Aguirre, L. A.</a>. These procedures are for identification purposes only since the inputs of a MRD could have several different characteristics.</p> <p>The data used in this example is provided by the Professor Samir Angelo Milani Martins.</p> <p>The challenges are:</p> <ul> <li>it possesses a nonlinearity featuring memory, i.e. a dynamic nonlinearity;</li> <li>the nonlinearity is governed by an internal variable z(t), which is not measurable;</li> <li>the nonlinear functional form in the Bouc Wen equation is nonlinear in the parameter;</li> <li>the nonlinear functional form in the Bouc Wen equation does not admit a finite Taylor series expansion because of the presence of absolute values</li> </ul> <h3 id="required-packages-and-versions_4">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_4" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-47-1" id="__codelineno-47-1" name="__codelineno-47-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-47-2" id="__codelineno-47-2" name="__codelineno-47-2"></a>pandas==2.2.2
<a href="#__codelineno-47-3" id="__codelineno-47-3" name="__codelineno-47-3"></a>numpy==1.26.0
<a href="#__codelineno-47-4" id="__codelineno-47-4" name="__codelineno-47-4"></a>matplotlib==3.8.4
<a href="#__codelineno-47-5" id="__codelineno-47-5" name="__codelineno-47-5"></a>scikit-learn==1.4.2
</code></pre></div> <p>Then, install the packages using: <div class="highlight"><pre><span></span><code><a href="#__codelineno-48-1" id="__codelineno-48-1" name="__codelineno-48-1"></a>pip install -r requirements.txt
</code></pre></div></p> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="sysidentpy-configuration_3">SysIdentPy Configuration<a class="headerlink" href="#sysidentpy-configuration_3" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-49-1" id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-49-2" id="__codelineno-49-2" name="__codelineno-49-2"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MaxAbsScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<a href="#__codelineno-49-3" id="__codelineno-49-3" name="__codelineno-49-3"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-49-4" id="__codelineno-49-4" name="__codelineno-49-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-49-5" id="__codelineno-49-5" name="__codelineno-49-5"></a>
<a href="#__codelineno-49-6" id="__codelineno-49-6" name="__codelineno-49-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-49-7" id="__codelineno-49-7" name="__codelineno-49-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-49-8" id="__codelineno-49-8" name="__codelineno-49-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-49-9" id="__codelineno-49-9" name="__codelineno-49-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-49-10" id="__codelineno-49-10" name="__codelineno-49-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_relative_squared_error</span>
<a href="#__codelineno-49-11" id="__codelineno-49-11" name="__codelineno-49-11"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-49-12" id="__codelineno-49-12" name="__codelineno-49-12"></a>
<a href="#__codelineno-49-13" id="__codelineno-49-13" name="__codelineno-49-13"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"boucwen_histeretic_system.csv"</span><span class="p">)</span>
<a href="#__codelineno-49-14" id="__codelineno-49-14" name="__codelineno-49-14"></a><span class="n">scaler_x</span> <span class="o">=</span> <span class="n">MaxAbsScaler</span><span class="p">()</span>
<a href="#__codelineno-49-15" id="__codelineno-49-15" name="__codelineno-49-15"></a><span class="n">scaler_y</span> <span class="o">=</span> <span class="n">MaxAbsScaler</span><span class="p">()</span>
<a href="#__codelineno-49-16" id="__codelineno-49-16" name="__codelineno-49-16"></a>
<a href="#__codelineno-49-17" id="__codelineno-49-17" name="__codelineno-49-17"></a><span class="n">init</span> <span class="o">=</span> <span class="mi">400</span>
<a href="#__codelineno-49-18" id="__codelineno-49-18" name="__codelineno-49-18"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">"E"</span><span class="p">,</span> <span class="s2">"v"</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">init</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
<a href="#__codelineno-49-19" id="__codelineno-49-19" name="__codelineno-49-19"></a><span class="n">x_train</span><span class="p">[</span><span class="s2">"sign_v"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"v"</span><span class="p">])</span>
<a href="#__codelineno-49-20" id="__codelineno-49-20" name="__codelineno-49-20"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">scaler_x</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<a href="#__codelineno-49-21" id="__codelineno-49-21" name="__codelineno-49-21"></a>
<a href="#__codelineno-49-22" id="__codelineno-49-22" name="__codelineno-49-22"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">"E"</span><span class="p">,</span> <span class="s2">"v"</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">init</span><span class="p">,</span> <span class="p">:]</span>
<a href="#__codelineno-49-23" id="__codelineno-49-23" name="__codelineno-49-23"></a><span class="n">x_test</span><span class="p">[</span><span class="s2">"sign_v"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"v"</span><span class="p">])</span>
<a href="#__codelineno-49-24" id="__codelineno-49-24" name="__codelineno-49-24"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<a href="#__codelineno-49-25" id="__codelineno-49-25" name="__codelineno-49-25"></a>
<a href="#__codelineno-49-26" id="__codelineno-49-26" name="__codelineno-49-26"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">"f"</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">init</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-49-27" id="__codelineno-49-27" name="__codelineno-49-27"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-49-28" id="__codelineno-49-28" name="__codelineno-49-28"></a>
<a href="#__codelineno-49-29" id="__codelineno-49-29" name="__codelineno-49-29"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">"f"</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">init</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-49-30" id="__codelineno-49-30" name="__codelineno-49-30"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<a href="#__codelineno-49-31" id="__codelineno-49-31" name="__codelineno-49-31"></a>
<a href="#__codelineno-49-32" id="__codelineno-49-32" name="__codelineno-49-32"></a><span class="c1"># Plotting the data</span>
<a href="#__codelineno-49-33" id="__codelineno-49-33" name="__codelineno-49-33"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<a href="#__codelineno-49-34" id="__codelineno-49-34" name="__codelineno-49-34"></a><span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">'Identification (training) data'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a href="#__codelineno-49-35" id="__codelineno-49-35" name="__codelineno-49-35"></a>
<a href="#__codelineno-49-36" id="__codelineno-49-36" name="__codelineno-49-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<a href="#__codelineno-49-37" id="__codelineno-49-37" name="__codelineno-49-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">)</span>
<a href="#__codelineno-49-38" id="__codelineno-49-38" name="__codelineno-49-38"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Force - Output'</span><span class="p">)</span>
<a href="#__codelineno-49-39" id="__codelineno-49-39" name="__codelineno-49-39"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Samples'</span><span class="p">)</span>
<a href="#__codelineno-49-40" id="__codelineno-49-40" name="__codelineno-49-40"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'y'</span><span class="p">)</span>
<a href="#__codelineno-49-41" id="__codelineno-49-41" name="__codelineno-49-41"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a href="#__codelineno-49-42" id="__codelineno-49-42" name="__codelineno-49-42"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<a href="#__codelineno-49-43" id="__codelineno-49-43" name="__codelineno-49-43"></a>
<a href="#__codelineno-49-44" id="__codelineno-49-44" name="__codelineno-49-44"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<a href="#__codelineno-49-45" id="__codelineno-49-45" name="__codelineno-49-45"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>
<a href="#__codelineno-49-46" id="__codelineno-49-46" name="__codelineno-49-46"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Control Voltage'</span><span class="p">)</span>
<a href="#__codelineno-49-47" id="__codelineno-49-47" name="__codelineno-49-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Samples'</span><span class="p">)</span>
<a href="#__codelineno-49-48" id="__codelineno-49-48" name="__codelineno-49-48"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'x_1'</span><span class="p">)</span>
<a href="#__codelineno-49-49" id="__codelineno-49-49" name="__codelineno-49-49"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a href="#__codelineno-49-50" id="__codelineno-49-50" name="__codelineno-49-50"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a href="#__codelineno-49-51" id="__codelineno-49-51" name="__codelineno-49-51"></a>
<a href="#__codelineno-49-52" id="__codelineno-49-52" name="__codelineno-49-52"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<a href="#__codelineno-49-53" id="__codelineno-49-53" name="__codelineno-49-53"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>
<a href="#__codelineno-49-54" id="__codelineno-49-54" name="__codelineno-49-54"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Velocity'</span><span class="p">)</span>
<a href="#__codelineno-49-55" id="__codelineno-49-55" name="__codelineno-49-55"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Samples'</span><span class="p">)</span>
<a href="#__codelineno-49-56" id="__codelineno-49-56" name="__codelineno-49-56"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'x_2'</span><span class="p">)</span>
<a href="#__codelineno-49-57" id="__codelineno-49-57" name="__codelineno-49-57"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a href="#__codelineno-49-58" id="__codelineno-49-58" name="__codelineno-49-58"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<a href="#__codelineno-49-59" id="__codelineno-49-59" name="__codelineno-49-59"></a>
<a href="#__codelineno-49-60" id="__codelineno-49-60" name="__codelineno-49-60"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<a href="#__codelineno-49-61" id="__codelineno-49-61" name="__codelineno-49-61"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>
<a href="#__codelineno-49-62" id="__codelineno-49-62" name="__codelineno-49-62"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'sign(Velocity)'</span><span class="p">)</span>
<a href="#__codelineno-49-63" id="__codelineno-49-63" name="__codelineno-49-63"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Samples'</span><span class="p">)</span>
<a href="#__codelineno-49-64" id="__codelineno-49-64" name="__codelineno-49-64"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'x_3'</span><span class="p">)</span>
<a href="#__codelineno-49-65" id="__codelineno-49-65" name="__codelineno-49-65"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a href="#__codelineno-49-66" id="__codelineno-49-66" name="__codelineno-49-66"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<a href="#__codelineno-49-67" id="__codelineno-49-67" name="__codelineno-49-67"></a>
<a href="#__codelineno-49-68" id="__codelineno-49-68" name="__codelineno-49-68"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<a href="#__codelineno-49-69" id="__codelineno-49-69" name="__codelineno-49-69"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bouc_wen_data.png"><img alt="" src="../assets/bouc_wen_data.png"/></a></p> <p>Let's check how is the histeretic behavior considering each input: <div class="highlight"><pre><span></span><code><a href="#__codelineno-50-1" id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-50-2" id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x1 - Voltage"</span><span class="p">)</span>
<a href="#__codelineno-50-3" id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y - Force"</span><span class="p">)</span>
</code></pre></div></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_voltage.png"><img alt="" src="../assets/bw_voltage.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-51-1" id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-51-2" id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x2 - Velocity"</span><span class="p">)</span>
<a href="#__codelineno-51-3" id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y - Force"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_velocity.png"><img alt="" src="../assets/bw_velocity.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-52-1" id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-52-2" id="__codelineno-52-2" name="__codelineno-52-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"u3 - sign(Velocity)"</span><span class="p">)</span>
<a href="#__codelineno-52-3" id="__codelineno-52-3" name="__codelineno-52-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y - Force"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_sign.png"><img alt="" src="../assets/bw_sign.png"/></a></p> <p>Now, we can just build a NARX model:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-53-1" id="__codelineno-53-1" name="__codelineno-53-1"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-53-2" id="__codelineno-53-2" name="__codelineno-53-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-53-3" id="__codelineno-53-3" name="__codelineno-53-3"></a>  <span class="n">xlag</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
<a href="#__codelineno-53-4" id="__codelineno-53-4" name="__codelineno-53-4"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a href="#__codelineno-53-5" id="__codelineno-53-5" name="__codelineno-53-5"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-53-6" id="__codelineno-53-6" name="__codelineno-53-6"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-53-7" id="__codelineno-53-7" name="__codelineno-53-7"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-53-8" id="__codelineno-53-8" name="__codelineno-53-8"></a><span class="p">)</span>
<a href="#__codelineno-53-9" id="__codelineno-53-9" name="__codelineno-53-9"></a>
<a href="#__codelineno-53-10" id="__codelineno-53-10" name="__codelineno-53-10"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-53-11" id="__codelineno-53-11" name="__codelineno-53-11"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-53-12" id="__codelineno-53-12" name="__codelineno-53-12"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
<a href="#__codelineno-53-13" id="__codelineno-53-13" name="__codelineno-53-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">rrse</span><span class="p">)</span>
<a href="#__codelineno-53-14" id="__codelineno-53-14" name="__codelineno-53-14"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"FROLS: sign(v) and MaxAbsScaler"</span><span class="p">)</span>
<a href="#__codelineno-53-15" id="__codelineno-53-15" name="__codelineno-53-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">0.0450</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r1.png"><img alt="" src="../assets/bw_r1.png"/></a></p> <p>If we remove the <code>sign(v)</code> input and try to build a NARX model using the same configuration, the model diverge, as can be seen in the following figure:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-54-1" id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-54-2" id="__codelineno-54-2" name="__codelineno-54-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-54-3" id="__codelineno-54-3" name="__codelineno-54-3"></a>  <span class="n">xlag</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
<a href="#__codelineno-54-4" id="__codelineno-54-4" name="__codelineno-54-4"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a href="#__codelineno-54-5" id="__codelineno-54-5" name="__codelineno-54-5"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-54-6" id="__codelineno-54-6" name="__codelineno-54-6"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-54-7" id="__codelineno-54-7" name="__codelineno-54-7"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-54-8" id="__codelineno-54-8" name="__codelineno-54-8"></a><span class="p">)</span>
<a href="#__codelineno-54-9" id="__codelineno-54-9" name="__codelineno-54-9"></a>
<a href="#__codelineno-54-10" id="__codelineno-54-10" name="__codelineno-54-10"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-54-11" id="__codelineno-54-11" name="__codelineno-54-11"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-54-12" id="__codelineno-54-12" name="__codelineno-54-12"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
<a href="#__codelineno-54-13" id="__codelineno-54-13" name="__codelineno-54-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">rrse</span><span class="p">)</span>
<a href="#__codelineno-54-14" id="__codelineno-54-14" name="__codelineno-54-14"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"FROLS: MaxAbsScaler, discarding sign(v)"</span><span class="p">)</span>
<a href="#__codelineno-54-15" id="__codelineno-54-15" name="__codelineno-54-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">nan</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_divergent.png"><img alt="" src="../assets/bw_divergent.png"/></a></p> <p>If we use the <code>MetaMSS</code> algorithm instead, the results are better.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-55-1" id="__codelineno-55-1" name="__codelineno-55-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">MetaMSS</span>
<a href="#__codelineno-55-2" id="__codelineno-55-2" name="__codelineno-55-2"></a>
<a href="#__codelineno-55-3" id="__codelineno-55-3" name="__codelineno-55-3"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-55-4" id="__codelineno-55-4" name="__codelineno-55-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MetaMSS</span><span class="p">(</span>
<a href="#__codelineno-55-5" id="__codelineno-55-5" name="__codelineno-55-5"></a>  <span class="n">xlag</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
<a href="#__codelineno-55-6" id="__codelineno-55-6" name="__codelineno-55-6"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a href="#__codelineno-55-7" id="__codelineno-55-7" name="__codelineno-55-7"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-55-8" id="__codelineno-55-8" name="__codelineno-55-8"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-55-9" id="__codelineno-55-9" name="__codelineno-55-9"></a>  <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<a href="#__codelineno-55-10" id="__codelineno-55-10" name="__codelineno-55-10"></a><span class="p">)</span>
<a href="#__codelineno-55-11" id="__codelineno-55-11" name="__codelineno-55-11"></a>
<a href="#__codelineno-55-12" id="__codelineno-55-12" name="__codelineno-55-12"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-55-13" id="__codelineno-55-13" name="__codelineno-55-13"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-55-14" id="__codelineno-55-14" name="__codelineno-55-14"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
<a href="#__codelineno-55-15" id="__codelineno-55-15" name="__codelineno-55-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">rrse</span><span class="p">)</span>
<a href="#__codelineno-55-16" id="__codelineno-55-16" name="__codelineno-55-16"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"MetaMSS: MaxAbsScaler, discarding sign(v)"</span><span class="p">)</span>
<a href="#__codelineno-55-17" id="__codelineno-55-17" name="__codelineno-55-17"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">0.24</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r2.png"><img alt="" src="../assets/bw_r2.png"/></a></p> <p>However, when the output of the system reach its minimum value, the model oscillate</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-56-1" id="__codelineno-56-1" name="__codelineno-56-1"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="mi">1100</span> <span class="p">:</span> <span class="mi">1200</span><span class="p">],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="mi">1100</span> <span class="p">:</span> <span class="mi">1200</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Unstable region"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_unstable.png"><img alt="" src="../assets/bw_unstable.png"/></a></p> <p>If we add the <code>sign(v)</code> input again and use <code>MetaMSS</code>, the results are very close to the <code>FROLS</code> algorithm with all inputs</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-57-1" id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-57-2" id="__codelineno-57-2" name="__codelineno-57-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">MetaMSS</span><span class="p">(</span>
<a href="#__codelineno-57-3" id="__codelineno-57-3" name="__codelineno-57-3"></a>  <span class="n">xlag</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
<a href="#__codelineno-57-4" id="__codelineno-57-4" name="__codelineno-57-4"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a href="#__codelineno-57-5" id="__codelineno-57-5" name="__codelineno-57-5"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-57-6" id="__codelineno-57-6" name="__codelineno-57-6"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-57-7" id="__codelineno-57-7" name="__codelineno-57-7"></a>  <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<a href="#__codelineno-57-8" id="__codelineno-57-8" name="__codelineno-57-8"></a><span class="p">)</span>
<a href="#__codelineno-57-9" id="__codelineno-57-9" name="__codelineno-57-9"></a>
<a href="#__codelineno-57-10" id="__codelineno-57-10" name="__codelineno-57-10"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-57-11" id="__codelineno-57-11" name="__codelineno-57-11"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-57-12" id="__codelineno-57-12" name="__codelineno-57-12"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:])</span>
<a href="#__codelineno-57-13" id="__codelineno-57-13" name="__codelineno-57-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">rrse</span><span class="p">)</span>
<a href="#__codelineno-57-14" id="__codelineno-57-14" name="__codelineno-57-14"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"MetaMSS: sign(v) and MaxAbsScaler"</span><span class="p">)</span>
<a href="#__codelineno-57-15" id="__codelineno-57-15" name="__codelineno-57-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="mf">0.0554</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r3.png"><img alt="" src="../assets/bw_r3.png"/></a></p> <p>This case will also highlight the significance of data scaling. Previously, we used the <code>MaxAbsScaler</code> method, which resulted in great models when using the <code>sign(v)</code> inputs, but also resulted in unstable models when removing that input feature. When scaling is applied using <code>MinMaxScaler</code>, however, the overall stability of the results improves, and the model does not diverge, even when the <code>sign(v)</code> input is removed, using the <code>FROLS</code> algorithm.</p> <p>The user can get the results bellow by just changing the data scaling method using</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-58-1" id="__codelineno-58-1" name="__codelineno-58-1"></a><span class="n">scaler_x</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<a href="#__codelineno-58-2" id="__codelineno-58-2" name="__codelineno-58-2"></a><span class="n">scaler_y</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</code></pre></div> <p>and running the each model again. That is the only change to improve the results.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r4.png"><img alt="" src="../assets/bw_r4.png"/></a></p> <blockquote> <p>FROLS: with <code>sign(v)</code> and <code>MinMaxScaler</code>. RMSE: 0.1159</p> </blockquote> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r5.png"><img alt="" src="../assets/bw_r5.png"/></a> FROLS: discarding <code>sign(v)</code> and using <code>MinMaxScaler</code>. RMSE: 0.1639</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r6.png"><img alt="" src="../assets/bw_r6.png"/></a></p> <blockquote> <p>MetaMSS: discarding <code>sign(v)</code> and using <code>MinMaxScaler</code>. RMSE: 0.1762</p> </blockquote> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_r7.png"><img alt="" src="../assets/bw_r7.png"/></a></p> <blockquote> <p>MetaMSS: including <code>sign(v)</code> and using <code>MinMaxScaler</code>. RMSE: 0.0694</p> </blockquote> <p>In contrast, the MetaMSS method returned the best model overall, but not better than the best <code>FROLS</code> method using <code>MaxAbsScaler</code>.</p> <p>Here is the predicted histeretic loop: <div class="highlight"><pre><span></span><code><a href="#__codelineno-59-1" id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">yhat</span><span class="p">)</span>
</code></pre></div></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/bw_predicted_hystereis.png"><img alt="" src="../assets/bw_predicted_hystereis.png"/></a></p> <h2 id="silver-box">Silver box<a class="headerlink" href="#silver-box" title="Permanent link"></a></h2> <p>The description content mainly derives (copy and paste) from the <a href="[Three free data sets for development and benchmarking in nonlinear system identification | IEEE Conference Publication | IEEE Xplore](https://ieeexplore.ieee.org/document/6669201)">associated paper</a>. For a detailed description, readers are referred to the linked reference.</p> <blockquote> <p>The Silverbox system can be seen as an electronic implementation of the Duffing oscillator. It is build as a 2<sup>nd</sup> order linear time-invariant system with a 3<sup>rd</sup> degree polynomial static nonlinearity around it in feedback. This type of dynamics are, for instance, often encountered in mechanical systems. <a href="[Nonlinear Benchmark - Silverbox](https://www.nonlinearbenchmark.org/benchmarks/silverbox)">Nonlinear Benchmark</a></p> </blockquote> <p>In this case study, we will create a NARX model for the Silver box benchmark. The Silver box represents a simplified version of mechanical oscillating processes, which are a critical category of nonlinear dynamic systems. Examples include vehicle suspensions, where shock absorbers and progressive springs play vital roles. The data generated by the Silver box provides a simplified representation of such combined components. The electrical circuit generating this data closely approximates, but does not perfectly match, the idealized models described below.</p> <p>As described in the original paper, the system was excited using a general waveform generator (HPE1445A). The input signal begins as a discrete-time signal <span class="arithmatex">\(r(k)\)</span>, which is converted to an analog signal <span class="arithmatex">\(r_c(t)\)</span> using zero-order-hold reconstruction. The actual excitation signal <span class="arithmatex">\(u_0(t)\)</span> is then obtained by passing <span class="arithmatex">\(r_c(t)\)</span> through an analog low-pass filter <span class="arithmatex">\(G(p)\)</span> to eliminate high-frequency content around multiples of the sampling frequency. Here, <span class="arithmatex">\(p\)</span> denotes the differentiation operator. Thus, the input is given by:</p> <div class="arithmatex">\[ u_0(t) = G(p) r_c(t). \]</div> <p>The input and output signals were measured using HP1430A data acquisition cards, with synchronized clocks for the acquisition and generator cards. The sampling frequency was:</p> <div class="arithmatex">\[ f_s = \frac{10^7}{2^{14}} = 610.35 \, \text{Hz}. \]</div> <p>The silver box uses analog electrical circuitry to generate data representing a nonlinear mechanical resonating system with a moving mass <span class="arithmatex">\(m\)</span>, viscous damping <span class="arithmatex">\(d\)</span>, and a nonlinear spring <span class="arithmatex">\(k(y)\)</span>. The electrical circuit is designed to relate the displacement <span class="arithmatex">\(y(t)\)</span> (the output) to the force <span class="arithmatex">\(u(t)\)</span> (the input) by the following differential equation:</p> <div class="arithmatex">\[ m \frac{d^2 y(t)}{dt^2} + d \frac{d y(t)}{dt} + k(y(t)) y(t) = u(t). \]</div> <p>The nonlinear progressive spring is described by a static, position-dependent stiffness:</p> <div class="arithmatex">\[ k(y(t)) = a + b y^2(t). \]</div> <p>The signal-to-noise ratio is sufficiently high to model the system without accounting for measurement noise. However, measurement noise can be included by replacing <span class="arithmatex">\(y(t)\)</span> with the artificial variable <span class="arithmatex">\(x(t)\)</span> in the equation above, and introducing disturbances <span class="arithmatex">\(w(t)\)</span> and <span class="arithmatex">\(e(t)\)</span> as follows:</p> <div class="arithmatex">\[ \begin{align} &amp; m \frac{d^2 x(t)}{dt^2} + d \frac{d x(t)}{dt} + k(x(t)) x(t) = u(t) + w(t), \\ &amp; k(x(t)) = a + b x^2(t), \\ &amp; y(t) = x(t) + e(t). \end{align} \]</div> <h3 id="required-packages-and-versions_5">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_5" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-60-1" id="__codelineno-60-1" name="__codelineno-60-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-60-2" id="__codelineno-60-2" name="__codelineno-60-2"></a>pandas==2.2.2
<a href="#__codelineno-60-3" id="__codelineno-60-3" name="__codelineno-60-3"></a>numpy==1.26.0
<a href="#__codelineno-60-4" id="__codelineno-60-4" name="__codelineno-60-4"></a>matplotlib==3.8.4
<a href="#__codelineno-60-5" id="__codelineno-60-5" name="__codelineno-60-5"></a>nonlinear_benchmarks==0.1.2
</code></pre></div> <p>Then, install the packages using:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-61-1" id="__codelineno-61-1" name="__codelineno-61-1"></a>pip install -r requirements.txt
</code></pre></div> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="sysidentpy-configuration_4">SysIdentPy configuration<a class="headerlink" href="#sysidentpy-configuration_4" title="Permanent link"></a></h3> <p>In this section, we will demonstrate the application of SysIdentPy to the Silver box dataset. The following code will guide you through the process of loading the dataset, configuring the SysIdentPy parameters, and building a model for mentioned system.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-62-1" id="__codelineno-62-1" name="__codelineno-62-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-62-2" id="__codelineno-62-2" name="__codelineno-62-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-62-3" id="__codelineno-62-3" name="__codelineno-62-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-62-4" id="__codelineno-62-4" name="__codelineno-62-4"></a>
<a href="#__codelineno-62-5" id="__codelineno-62-5" name="__codelineno-62-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-62-6" id="__codelineno-62-6" name="__codelineno-62-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span><span class="p">,</span> <span class="n">Fourier</span>
<a href="#__codelineno-62-7" id="__codelineno-62-7" name="__codelineno-62-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-62-8" id="__codelineno-62-8" name="__codelineno-62-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_mean_squared_error</span>
<a href="#__codelineno-62-9" id="__codelineno-62-9" name="__codelineno-62-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-62-10" id="__codelineno-62-10" name="__codelineno-62-10"></a>
<a href="#__codelineno-62-11" id="__codelineno-62-11" name="__codelineno-62-11"></a><span class="kn">import</span> <span class="nn">nonlinear_benchmarks</span>
<a href="#__codelineno-62-12" id="__codelineno-62-12" name="__codelineno-62-12"></a>
<a href="#__codelineno-62-13" id="__codelineno-62-13" name="__codelineno-62-13"></a><span class="n">train_val</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">nonlinear_benchmarks</span><span class="o">.</span><span class="n">Silverbox</span><span class="p">(</span><span class="n">atleast_2d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div> <p>We used the <code>nonlinear_benchmarks</code> package to load the data. The user is referred to the <a href="[GerbenBeintema/nonlinear_benchmarks: The official dataload for http://www.nonlinearbenchmark.org/ (github.com)](https://github.com/GerbenBeintema/nonlinear_benchmarks/tree/master)">package documentation</a> to check the details of how to use it.</p> <p>The following plot detail the training and testing data of the experiment.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-63-1" id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<a href="#__codelineno-63-2" id="__codelineno-63-2" name="__codelineno-63-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a href="#__codelineno-63-3" id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 1: training data"</span><span class="p">)</span>
<a href="#__codelineno-63-4" id="__codelineno-63-4" name="__codelineno-63-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-63-5" id="__codelineno-63-5" name="__codelineno-63-5"></a>
<a href="#__codelineno-63-6" id="__codelineno-63-6" name="__codelineno-63-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<a href="#__codelineno-63-7" id="__codelineno-63-7" name="__codelineno-63-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a href="#__codelineno-63-8" id="__codelineno-63-8" name="__codelineno-63-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 1: testing data"</span><span class="p">)</span>
<a href="#__codelineno-63-9" id="__codelineno-63-9" name="__codelineno-63-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-63-10" id="__codelineno-63-10" name="__codelineno-63-10"></a>
<a href="#__codelineno-63-11" id="__codelineno-63-11" name="__codelineno-63-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_arrow_full</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<a href="#__codelineno-63-12" id="__codelineno-63-12" name="__codelineno-63-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_arrow_full</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a href="#__codelineno-63-13" id="__codelineno-63-13" name="__codelineno-63-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 2: training data"</span><span class="p">)</span>
<a href="#__codelineno-63-14" id="__codelineno-63-14" name="__codelineno-63-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a href="#__codelineno-63-15" id="__codelineno-63-15" name="__codelineno-63-15"></a>
<a href="#__codelineno-63-16" id="__codelineno-63-16" name="__codelineno-63-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_arrow_no_extrapolation</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
<a href="#__codelineno-63-17" id="__codelineno-63-17" name="__codelineno-63-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_arrow_no_extrapolation</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a href="#__codelineno-63-18" id="__codelineno-63-18" name="__codelineno-63-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Experiment 2: testing data"</span><span class="p">)</span>
<a href="#__codelineno-63-19" id="__codelineno-63-19" name="__codelineno-63-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_e1_training.png"><img alt="" src="../assets/silver_e1_training.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_e1_testing.png"><img alt="" src="../assets/silver_e1_testing.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_e2_training.png"><img alt="" src="../assets/silver_e2_training.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_e2_testing.png"><img alt="" src="../assets/silver_e2_testing.png"/></a></p> <blockquote> <p>Important Note</p> </blockquote> <p>The goal of this benchmark is to develop a model that outperforms the state-of-the-art (SOTA) model presented in the benchmarking paper. However, the results in the <a href="https://arxiv.org/pdf/2012.07697">paper</a> differ from those provided in the <a href="https://github.com/GerbenBeintema/SS-encoder-WH-Silver/blob/main/SS%20encoder%20Silverbox.ipynb">GitHub repository</a>.</p> <table> <thead> <tr> <th>nx</th> <th>Set</th> <th>NRMS</th> <th>RMS (mV)</th> </tr> </thead> <tbody> <tr> <td>2</td> <td>Train</td> <td>0.10653</td> <td>5.8103295</td> </tr> <tr> <td>2</td> <td>Validation</td> <td>0.11411</td> <td>6.1938068</td> </tr> <tr> <td>2</td> <td>Test</td> <td>0.19151</td> <td>10.2358533</td> </tr> <tr> <td>2</td> <td>Test (no extra)</td> <td>0.12284</td> <td>5.2789727</td> </tr> <tr> <td>4</td> <td>Train</td> <td>0.03571</td> <td>1.9478290</td> </tr> <tr> <td>4</td> <td>Validation</td> <td>0.03922</td> <td>2.1286373</td> </tr> <tr> <td>4</td> <td>Test</td> <td>0.12712</td> <td>6.7943448</td> </tr> <tr> <td>4</td> <td>Test (no extra)</td> <td>0.05204</td> <td>2.2365904</td> </tr> <tr> <td>8</td> <td>Train</td> <td>0.03430</td> <td>1.8707026</td> </tr> <tr> <td>8</td> <td>Validation</td> <td>0.03732</td> <td>2.0254112</td> </tr> <tr> <td>8</td> <td>Test</td> <td>0.10826</td> <td>5.7865255</td> </tr> <tr> <td>8</td> <td>Test (no extra)</td> <td>0.04743</td> <td>2.0382715</td> </tr> <tr> <td>&gt; Table: results presented in the github.</td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>It appears that the values shown in the paper actually represent the training time, not the error metrics. I will contact the authors to confirm this information. According to the Nonlinear Benchmark website, the information is as follows:</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_sota.png"><img alt="" src="../assets/silver_sota.png"/></a></p> <p>where the values in the "Training time" column matches the ones presented as error metrics in the paper.</p> <blockquote> <p>While we await confirmation of the correct values for this benchmark, we will demonstrate the performance of SysIdentPy. However, we will refrain from making any comparisons or attempting to improve the model at this stage.</p> </blockquote> <h3 id="results_3">Results<a class="headerlink" href="#results_3" title="Permanent link"></a></h3> <p>We will start (as we did in every other case study) with a basic configuration of FROLS using a polynomial basis function with degree equal 2. The <code>xlag</code> and <code>ylag</code> are set to <span class="arithmatex">\(7\)</span> in this first example. Because the dataset is considerably large, we will start with <code>n_info_values=40</code>. Because we dealing with a large training dataset, we will use the <code>err_tol</code> instead of information criteria to have a faster performance. We will also set <code>n_terms=40</code>, which means that the search will stop if the <code>err_tol</code> is reached or 40 regressors is tested in the <code>ERR</code> algorithm. While this approach might result in a sub-optimal model, it is a reasonable starting point for our first attempt. There are three different experiments: multisine, arrow (full), and arrow (no extrapolation).</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-64-1" id="__codelineno-64-1" name="__codelineno-64-1"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_val</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">train_val</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-64-2" id="__codelineno-64-2" name="__codelineno-64-2"></a><span class="n">test_multisine</span><span class="p">,</span> <span class="n">test_arrow_full</span><span class="p">,</span> <span class="n">test_arrow_no_extrapolation</span> <span class="o">=</span> <span class="n">test</span>
<a href="#__codelineno-64-3" id="__codelineno-64-3" name="__codelineno-64-3"></a><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test_multisine</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">test_multisine</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-64-4" id="__codelineno-64-4" name="__codelineno-64-4"></a>
<a href="#__codelineno-64-5" id="__codelineno-64-5" name="__codelineno-64-5"></a><span class="n">n</span> <span class="o">=</span> <span class="n">test_multisine</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-64-6" id="__codelineno-64-6" name="__codelineno-64-6"></a>
<a href="#__codelineno-64-7" id="__codelineno-64-7" name="__codelineno-64-7"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-64-8" id="__codelineno-64-8" name="__codelineno-64-8"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-64-9" id="__codelineno-64-9" name="__codelineno-64-9"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-64-10" id="__codelineno-64-10" name="__codelineno-64-10"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a href="#__codelineno-64-11" id="__codelineno-64-11" name="__codelineno-64-11"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-64-12" id="__codelineno-64-12" name="__codelineno-64-12"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-64-13" id="__codelineno-64-13" name="__codelineno-64-13"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
<a href="#__codelineno-64-14" id="__codelineno-64-14" name="__codelineno-64-14"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<a href="#__codelineno-64-15" id="__codelineno-64-15" name="__codelineno-64-15"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-64-16" id="__codelineno-64-16" name="__codelineno-64-16"></a><span class="p">)</span>
<a href="#__codelineno-64-17" id="__codelineno-64-17" name="__codelineno-64-17"></a>
<a href="#__codelineno-64-18" id="__codelineno-64-18" name="__codelineno-64-18"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-64-19" id="__codelineno-64-19" name="__codelineno-64-19"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-64-20" id="__codelineno-64-20" name="__codelineno-64-20"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-64-21" id="__codelineno-64-21" name="__codelineno-64-21"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-64-22" id="__codelineno-64-22" name="__codelineno-64-22"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-64-23" id="__codelineno-64-23" name="__codelineno-64-23"></a><span class="n">nrmse</span> <span class="o">=</span> <span class="n">rmse</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a href="#__codelineno-64-24" id="__codelineno-64-24" name="__codelineno-64-24"></a><span class="n">rmse_mv</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">rmse</span>
<a href="#__codelineno-64-25" id="__codelineno-64-25" name="__codelineno-64-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">nrmse</span><span class="p">,</span> <span class="n">rmse_mv</span><span class="p">)</span>
<a href="#__codelineno-64-26" id="__codelineno-64-26" name="__codelineno-64-26"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Multisine. Model -&gt; RMSE (x1000) mv: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_mv</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-64-27" id="__codelineno-64-27" name="__codelineno-64-27"></a>
<a href="#__codelineno-64-28" id="__codelineno-64-28" name="__codelineno-64-28"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Multisine. Model -&gt; RMSE (x1000) mv: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_mv</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-64-29" id="__codelineno-64-29" name="__codelineno-64-29"></a>
<a href="#__codelineno-64-30" id="__codelineno-64-30" name="__codelineno-64-30"></a><span class="o">&gt;</span> <span class="mf">0.1423804033714937</span>
<a href="#__codelineno-64-31" id="__codelineno-64-31" name="__codelineno-64-31"></a><span class="o">&gt;</span> <span class="mf">7.727682109791501</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_r1.png"><img alt="" src="../assets/silver_r1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_r1_zoom.png"><img alt="" src="../assets/silver_r1_zoom.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-65-1" id="__codelineno-65-1" name="__codelineno-65-1"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_val</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">train_val</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-65-2" id="__codelineno-65-2" name="__codelineno-65-2"></a><span class="n">test_multisine</span><span class="p">,</span> <span class="n">test_arrow_full</span><span class="p">,</span> <span class="n">test_arrow_no_extrapolation</span> <span class="o">=</span> <span class="n">test</span>
<a href="#__codelineno-65-3" id="__codelineno-65-3" name="__codelineno-65-3"></a><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test_arrow_full</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">test_arrow_full</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-65-4" id="__codelineno-65-4" name="__codelineno-65-4"></a>
<a href="#__codelineno-65-5" id="__codelineno-65-5" name="__codelineno-65-5"></a><span class="n">n</span> <span class="o">=</span> <span class="n">test_arrow_full</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-65-6" id="__codelineno-65-6" name="__codelineno-65-6"></a>
<a href="#__codelineno-65-7" id="__codelineno-65-7" name="__codelineno-65-7"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-65-8" id="__codelineno-65-8" name="__codelineno-65-8"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-65-9" id="__codelineno-65-9" name="__codelineno-65-9"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-65-10" id="__codelineno-65-10" name="__codelineno-65-10"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-65-11" id="__codelineno-65-11" name="__codelineno-65-11"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-65-12" id="__codelineno-65-12" name="__codelineno-65-12"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-65-13" id="__codelineno-65-13" name="__codelineno-65-13"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.9999</span><span class="p">,</span>
<a href="#__codelineno-65-14" id="__codelineno-65-14" name="__codelineno-65-14"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
<a href="#__codelineno-65-15" id="__codelineno-65-15" name="__codelineno-65-15"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-65-16" id="__codelineno-65-16" name="__codelineno-65-16"></a><span class="p">)</span>
<a href="#__codelineno-65-17" id="__codelineno-65-17" name="__codelineno-65-17"></a>
<a href="#__codelineno-65-18" id="__codelineno-65-18" name="__codelineno-65-18"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-65-19" id="__codelineno-65-19" name="__codelineno-65-19"></a><span class="c1"># we will not concatente the last values from train data to use as initial condition here because</span>
<a href="#__codelineno-65-20" id="__codelineno-65-20" name="__codelineno-65-20"></a><span class="c1"># this test data have a very different behavior.</span>
<a href="#__codelineno-65-21" id="__codelineno-65-21" name="__codelineno-65-21"></a><span class="c1"># However, if you want you can do that and you will see that the model will still perform</span>
<a href="#__codelineno-65-22" id="__codelineno-65-22" name="__codelineno-65-22"></a><span class="c1"># great after a few iterations</span>
<a href="#__codelineno-65-23" id="__codelineno-65-23" name="__codelineno-65-23"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-65-24" id="__codelineno-65-24" name="__codelineno-65-24"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-65-25" id="__codelineno-65-25" name="__codelineno-65-25"></a><span class="n">nrmse</span> <span class="o">=</span> <span class="n">rmse</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a href="#__codelineno-65-26" id="__codelineno-65-26" name="__codelineno-65-26"></a><span class="n">rmse_mv</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">rmse</span>
<a href="#__codelineno-65-27" id="__codelineno-65-27" name="__codelineno-65-27"></a>
<a href="#__codelineno-65-28" id="__codelineno-65-28" name="__codelineno-65-28"></a><span class="nb">print</span><span class="p">(</span><span class="n">nrmse</span><span class="p">,</span> <span class="n">rmse_mv</span><span class="p">)</span>
<a href="#__codelineno-65-29" id="__codelineno-65-29" name="__codelineno-65-29"></a>
<a href="#__codelineno-65-30" id="__codelineno-65-30" name="__codelineno-65-30"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Arrow (full). Model -&gt; RMSE (x1000) mv: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_mv</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-65-31" id="__codelineno-65-31" name="__codelineno-65-31"></a>
<a href="#__codelineno-65-32" id="__codelineno-65-32" name="__codelineno-65-32"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Arrow (full). Model -&gt; RMSE (x1000) mv: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_mv</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_r2.png"><img alt="" src="../assets/silver_r2.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_r2_zoom.png"><img alt="" src="../assets/silver_r2_zoom.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-66-1" id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_val</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">train_val</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-66-2" id="__codelineno-66-2" name="__codelineno-66-2"></a><span class="n">test_multisine</span><span class="p">,</span> <span class="n">test_arrow_full</span><span class="p">,</span> <span class="n">test_arrow_no_extrapolation</span> <span class="o">=</span> <span class="n">test</span>
<a href="#__codelineno-66-3" id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test_arrow_no_extrapolation</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">test_arrow_no_extrapolation</span><span class="o">.</span><span class="n">y</span>
<a href="#__codelineno-66-4" id="__codelineno-66-4" name="__codelineno-66-4"></a>
<a href="#__codelineno-66-5" id="__codelineno-66-5" name="__codelineno-66-5"></a><span class="n">n</span> <span class="o">=</span> <span class="n">test_arrow_no_extrapolation</span><span class="o">.</span><span class="n">state_initialization_window_length</span>
<a href="#__codelineno-66-6" id="__codelineno-66-6" name="__codelineno-66-6"></a>
<a href="#__codelineno-66-7" id="__codelineno-66-7" name="__codelineno-66-7"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="#__codelineno-66-8" id="__codelineno-66-8" name="__codelineno-66-8"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-66-9" id="__codelineno-66-9" name="__codelineno-66-9"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-66-10" id="__codelineno-66-10" name="__codelineno-66-10"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a href="#__codelineno-66-11" id="__codelineno-66-11" name="__codelineno-66-11"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-66-12" id="__codelineno-66-12" name="__codelineno-66-12"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-66-13" id="__codelineno-66-13" name="__codelineno-66-13"></a>  <span class="n">err_tol</span><span class="o">=</span><span class="mf">0.9999</span><span class="p">,</span>
<a href="#__codelineno-66-14" id="__codelineno-66-14" name="__codelineno-66-14"></a>  <span class="n">n_terms</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<a href="#__codelineno-66-15" id="__codelineno-66-15" name="__codelineno-66-15"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span>
<a href="#__codelineno-66-16" id="__codelineno-66-16" name="__codelineno-66-16"></a><span class="p">)</span>
<a href="#__codelineno-66-17" id="__codelineno-66-17" name="__codelineno-66-17"></a>
<a href="#__codelineno-66-18" id="__codelineno-66-18" name="__codelineno-66-18"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-66-19" id="__codelineno-66-19" name="__codelineno-66-19"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[:</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-66-20" id="__codelineno-66-20" name="__codelineno-66-20"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span> <span class="p">:],</span> <span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">+</span> <span class="n">n</span><span class="p">:])</span>
<a href="#__codelineno-66-21" id="__codelineno-66-21" name="__codelineno-66-21"></a><span class="n">nrmse</span> <span class="o">=</span> <span class="n">rmse</span><span class="o">/</span><span class="n">y_test</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a href="#__codelineno-66-22" id="__codelineno-66-22" name="__codelineno-66-22"></a><span class="n">rmse_mv</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">rmse</span>
<a href="#__codelineno-66-23" id="__codelineno-66-23" name="__codelineno-66-23"></a><span class="nb">print</span><span class="p">(</span><span class="n">nrmse</span><span class="p">,</span> <span class="n">rmse_mv</span><span class="p">)</span>
<a href="#__codelineno-66-24" id="__codelineno-66-24" name="__codelineno-66-24"></a>
<a href="#__codelineno-66-25" id="__codelineno-66-25" name="__codelineno-66-25"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Arrow (no extrapolation). Model -&gt; RMSE (x1000) mv: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_mv</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a href="#__codelineno-66-26" id="__codelineno-66-26" name="__codelineno-66-26"></a>
<a href="#__codelineno-66-27" id="__codelineno-66-27" name="__codelineno-66-27"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Free Run simulation. Model -&gt; RMSE (x1000) mv: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_mv</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_r3.png"><img alt="" src="../assets/silver_r3.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/silver_r3_zoom.png"><img alt="" src="../assets/silver_r3_zoom.png"/></a></p> <h2 id="f-16-ground-vibration-test-benchmark">F-16 Ground Vibration Test Benchmark<a class="headerlink" href="#f-16-ground-vibration-test-benchmark" title="Permanent link"></a></h2> <p>The following examples are intended to demonstrate the application of SysIdentPy on a real-world dataset. Please note that these examples are not aimed at replicating the results presented in the cited manuscripts. The model parameters, such as <code>ylag</code> and <code>xlag</code>, as well as the size of the identification and validation data sets, differ from those used in the original studies. Additionally, adjustments related to sampling rates and other data preparation steps are not covered in this notebook.</p> <p><strong>For a comprehensive reference regarding the F-16 Ground Vibration Test benchmark, please visit <a href="http://www.nonlinearbenchmark.org/#F16">the nonlinear benchmark website</a>.</strong></p> <blockquote> <p><strong>Note:</strong> This notebook serves as a preliminary demonstration of SysIdentPy's performance on the F-16 dataset. A more detailed analysis will be provided in a future publication. The nonlinear benchmark website offers valuable resources and references related to system identification and machine learning, and readers are encouraged to explore the papers and information available there.</p> </blockquote> <h3 id="benchmark-overview">Benchmark Overview<a class="headerlink" href="#benchmark-overview" title="Permanent link"></a></h3> <p>The F-16 Ground Vibration Test benchmark is a notable experiment in the field of system identification and nonlinear dynamics. It involves a high-order system with clearance and friction nonlinearities at the mounting interfaces of payloads on a full-scale F-16 aircraft.</p> <p><strong>Experiment Details:</strong> - <strong>Event:</strong> Siemens LMS Ground Vibration Testing Master Class - <strong>Date:</strong> September 2014 - <strong>Location:</strong> Saffraanberg military base, Sint-Truiden, Belgium</p> <p>During the test, two dummy payloads were mounted on the wing tips of the F-16 to simulate the mass and inertia of real devices typically equipped on the aircraft during flight. Accelerometers were installed on the aircraft structure to capture vibration data. A shaker was placed under the right wing to apply input signals. The key source of nonlinearity in the system was identified as the mounting interfaces of the payloads, particularly the right-wing-to-payload interface, which exhibited significant nonlinear distortions.</p> <p><strong>Data and Resources:</strong> - <strong>Data Availability:</strong> The dataset, including detailed system descriptions, estimation and test data sets, and setup images, is available for download in both .csv and .mat file formats. - <strong>Reference:</strong> For in-depth information on the F-16 benchmark, refer to: J.P. Nol and M. Schoukens, "F-16 aircraft benchmark based on ground vibration test data," 2017 Workshop on Nonlinear System Identification Benchmarks, pp. 19-23, Brussels, Belgium, April 24-26, 2017.</p> <p>The goal of this notebook is to illustrate how SysIdentPy can be applied to such complex datasets, showcasing its capabilities in modeling and analysis. For a thorough exploration of the benchmark and its methodologies, please consult the provided resources and references.</p> <h3 id="required-packages-and-versions_6">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_6" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-67-1" id="__codelineno-67-1" name="__codelineno-67-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-67-2" id="__codelineno-67-2" name="__codelineno-67-2"></a>pandas==2.2.2
<a href="#__codelineno-67-3" id="__codelineno-67-3" name="__codelineno-67-3"></a>numpy==1.26.0
<a href="#__codelineno-67-4" id="__codelineno-67-4" name="__codelineno-67-4"></a>matplotlib==3.8.4
</code></pre></div> <p>Then, install the packages using: <div class="highlight"><pre><span></span><code><a href="#__codelineno-68-1" id="__codelineno-68-1" name="__codelineno-68-1"></a>pip install -r requirements.txt
</code></pre></div></p> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="sysidentpy-configuration_5">SysIdentPy Configuration<a class="headerlink" href="#sysidentpy-configuration_5" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-69-1" id="__codelineno-69-1" name="__codelineno-69-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-69-2" id="__codelineno-69-2" name="__codelineno-69-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-69-3" id="__codelineno-69-3" name="__codelineno-69-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-69-4" id="__codelineno-69-4" name="__codelineno-69-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-69-5" id="__codelineno-69-5" name="__codelineno-69-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-69-6" id="__codelineno-69-6" name="__codelineno-69-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-69-7" id="__codelineno-69-7" name="__codelineno-69-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">root_relative_squared_error</span>
<a href="#__codelineno-69-8" id="__codelineno-69-8" name="__codelineno-69-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-69-9" id="__codelineno-69-9" name="__codelineno-69-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_residues_correlation</span><span class="p">,</span> <span class="n">plot_results</span>
<a href="#__codelineno-69-10" id="__codelineno-69-10" name="__codelineno-69-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.residues.residues_correlation</span> <span class="kn">import</span> <span class="p">(</span>
<a href="#__codelineno-69-11" id="__codelineno-69-11" name="__codelineno-69-11"></a>  <span class="n">compute_residues_autocorrelation</span><span class="p">,</span>
<a href="#__codelineno-69-12" id="__codelineno-69-12" name="__codelineno-69-12"></a>  <span class="n">compute_cross_correlation</span><span class="p">,</span>
<a href="#__codelineno-69-13" id="__codelineno-69-13" name="__codelineno-69-13"></a><span class="p">)</span>
</code></pre></div> <h2 id="procedure">Procedure<a class="headerlink" href="#procedure" title="Permanent link"></a></h2> <p><div class="highlight"><pre><span></span><code><a href="#__codelineno-70-1" id="__codelineno-70-1" name="__codelineno-70-1"></a><span class="n">f_16</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">"examples/datasets/f-16.txt"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">"x1"</span><span class="p">,</span> <span class="s2">"x2"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">])</span>
<a href="#__codelineno-70-2" id="__codelineno-70-2" name="__codelineno-70-2"></a><span class="n">f_16</span><span class="o">.</span><span class="n">shape</span>
<a href="#__codelineno-70-3" id="__codelineno-70-3" name="__codelineno-70-3"></a><span class="n">f_16</span><span class="p">[[</span><span class="s2">"x1"</span><span class="p">,</span> <span class="s2">"x2"</span><span class="p">]][</span><span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<a href="#__codelineno-70-4" id="__codelineno-70-4" name="__codelineno-70-4"></a>
<a href="#__codelineno-70-5" id="__codelineno-70-5" name="__codelineno-70-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">32768</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/f16_input.png"><img alt="" src="../assets/f16_input.png"/></a></p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-71-1" id="__codelineno-71-1" name="__codelineno-71-1"></a><span class="n">f_16</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2000</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/f16_output.png"><img alt="" src="../assets/f16_output.png"/></a></p> <p>The following code is to split the dataset into training and test sets</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-72-1" id="__codelineno-72-1" name="__codelineno-72-1"></a><span class="n">x1_id</span><span class="p">,</span> <span class="n">x1_val</span> <span class="o">=</span> <span class="n">f_16</span><span class="p">[</span><span class="s2">"x1"</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">16384</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">f_16</span><span class="p">[</span><span class="s2">"x1"</span><span class="p">][</span>
<a href="#__codelineno-72-2" id="__codelineno-72-2" name="__codelineno-72-2"></a>  <span class="mi">16384</span><span class="p">::</span>
<a href="#__codelineno-72-3" id="__codelineno-72-3" name="__codelineno-72-3"></a><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-72-4" id="__codelineno-72-4" name="__codelineno-72-4"></a><span class="n">x2_id</span><span class="p">,</span> <span class="n">x2_val</span> <span class="o">=</span> <span class="n">f_16</span><span class="p">[</span><span class="s2">"x2"</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">16384</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">f_16</span><span class="p">[</span><span class="s2">"x2"</span><span class="p">][</span>
<a href="#__codelineno-72-5" id="__codelineno-72-5" name="__codelineno-72-5"></a>  <span class="mi">16384</span><span class="p">::</span>
<a href="#__codelineno-72-6" id="__codelineno-72-6" name="__codelineno-72-6"></a><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-72-7" id="__codelineno-72-7" name="__codelineno-72-7"></a><span class="n">x_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1_id</span><span class="p">,</span> <span class="n">x2_id</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-72-8" id="__codelineno-72-8" name="__codelineno-72-8"></a><span class="n">x_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1_val</span><span class="p">,</span> <span class="n">x2_val</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-72-9" id="__codelineno-72-9" name="__codelineno-72-9"></a><span class="n">y_id</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">f_16</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">16384</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">f_16</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span>
<a href="#__codelineno-72-10" id="__codelineno-72-10" name="__codelineno-72-10"></a>  <span class="mi">16384</span><span class="p">::</span>
<a href="#__codelineno-72-11" id="__codelineno-72-11" name="__codelineno-72-11"></a><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div> <p>We will set the lags for both inputs as</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-73-1" id="__codelineno-73-1" name="__codelineno-73-1"></a><span class="n">x1lag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a href="#__codelineno-73-2" id="__codelineno-73-2" name="__codelineno-73-2"></a><span class="n">x2lag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</code></pre></div> <p>and build a NARX model as follows</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-74-1" id="__codelineno-74-1" name="__codelineno-74-1"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-74-2" id="__codelineno-74-2" name="__codelineno-74-2"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">()</span>
<a href="#__codelineno-74-3" id="__codelineno-74-3" name="__codelineno-74-3"></a>
<a href="#__codelineno-74-4" id="__codelineno-74-4" name="__codelineno-74-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-74-5" id="__codelineno-74-5" name="__codelineno-74-5"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a href="#__codelineno-74-6" id="__codelineno-74-6" name="__codelineno-74-6"></a>  <span class="n">n_info_values</span><span class="o">=</span><span class="mi">39</span><span class="p">,</span>
<a href="#__codelineno-74-7" id="__codelineno-74-7" name="__codelineno-74-7"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<a href="#__codelineno-74-8" id="__codelineno-74-8" name="__codelineno-74-8"></a>  <span class="n">xlag</span><span class="o">=</span><span class="p">[</span><span class="n">x1lag</span><span class="p">,</span> <span class="n">x2lag</span><span class="p">],</span>
<a href="#__codelineno-74-9" id="__codelineno-74-9" name="__codelineno-74-9"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"bic"</span><span class="p">,</span>
<a href="#__codelineno-74-10" id="__codelineno-74-10" name="__codelineno-74-10"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a href="#__codelineno-74-11" id="__codelineno-74-11" name="__codelineno-74-11"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-74-12" id="__codelineno-74-12" name="__codelineno-74-12"></a><span class="p">)</span>
<a href="#__codelineno-74-13" id="__codelineno-74-13" name="__codelineno-74-13"></a>
<a href="#__codelineno-74-14" id="__codelineno-74-14" name="__codelineno-74-14"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_id</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_id</span><span class="p">)</span>
<a href="#__codelineno-74-15" id="__codelineno-74-15" name="__codelineno-74-15"></a><span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">)</span>
<a href="#__codelineno-74-16" id="__codelineno-74-16" name="__codelineno-74-16"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">)</span>
<a href="#__codelineno-74-17" id="__codelineno-74-17" name="__codelineno-74-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">rrse</span><span class="p">)</span>
<a href="#__codelineno-74-18" id="__codelineno-74-18" name="__codelineno-74-18"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-74-19" id="__codelineno-74-19" name="__codelineno-74-19"></a>  <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-74-20" id="__codelineno-74-20" name="__codelineno-74-20"></a>    <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-74-21" id="__codelineno-74-21" name="__codelineno-74-21"></a>    <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-74-22" id="__codelineno-74-22" name="__codelineno-74-22"></a>    <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-74-23" id="__codelineno-74-23" name="__codelineno-74-23"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-74-24" id="__codelineno-74-24" name="__codelineno-74-24"></a>    <span class="n">err_precision</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a href="#__codelineno-74-25" id="__codelineno-74-25" name="__codelineno-74-25"></a>    <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-74-26" id="__codelineno-74-26" name="__codelineno-74-26"></a>  <span class="p">),</span>
<a href="#__codelineno-74-27" id="__codelineno-74-27" name="__codelineno-74-27"></a>  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-74-28" id="__codelineno-74-28" name="__codelineno-74-28"></a><span class="p">)</span>
<a href="#__codelineno-74-29" id="__codelineno-74-29" name="__codelineno-74-29"></a>
<a href="#__codelineno-74-30" id="__codelineno-74-30" name="__codelineno-74-30"></a><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div> <p>The RRSE is <span class="arithmatex">\(0.2910\)</span></p> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>y(k-1)</td> <td>1.8387E+00</td> <td>9.43378253E-01</td> </tr> <tr> <td>y(k-2)</td> <td>-1.8938E+00</td> <td>1.95167599E-02</td> </tr> <tr> <td>y(k-3)</td> <td>1.3337E+00</td> <td>1.02432261E-02</td> </tr> <tr> <td>y(k-6)</td> <td>-1.6038E+00</td> <td>8.03485985E-03</td> </tr> <tr> <td>y(k-9)</td> <td>2.6776E-01</td> <td>9.27874557E-04</td> </tr> <tr> <td>x2(k-7)</td> <td>-2.2385E+01</td> <td>3.76837313E-04</td> </tr> <tr> <td>x1(k-1)</td> <td>8.2709E+00</td> <td>6.81508210E-04</td> </tr> <tr> <td>x2(k-3)</td> <td>1.0587E+02</td> <td>1.57459800E-03</td> </tr> <tr> <td>x1(k-8)</td> <td>-3.7975E+00</td> <td>7.35086279E-04</td> </tr> <tr> <td>x2(k-1)</td> <td>8.5725E+01</td> <td>4.85358786E-04</td> </tr> <tr> <td>y(k-7)</td> <td>1.3955E+00</td> <td>2.77245281E-04</td> </tr> <tr> <td>y(k-5)</td> <td>1.3219E+00</td> <td>8.64120037E-04</td> </tr> <tr> <td>y(k-10)</td> <td>-2.9306E-01</td> <td>8.51717688E-04</td> </tr> <tr> <td>y(k-4)</td> <td>-9.5479E-01</td> <td>7.23623116E-04</td> </tr> <tr> <td>y(k-8)</td> <td>-7.1309E-01</td> <td>4.44988077E-04</td> </tr> <tr> <td>y(k-12)</td> <td>-3.0437E-01</td> <td>1.49743148E-04</td> </tr> <tr> <td>y(k-11)</td> <td>4.8602E-01</td> <td>3.34613282E-04</td> </tr> <tr> <td>y(k-13)</td> <td>-8.2442E-02</td> <td>1.43738964E-04</td> </tr> <tr> <td>y(k-15)</td> <td>-1.6762E-01</td> <td>1.25546584E-04</td> </tr> <tr> <td>x1(k-2)</td> <td>-8.9698E+00</td> <td>9.76699739E-05</td> </tr> <tr> <td>y(k-17)</td> <td>2.2036E-02</td> <td>4.55983807E-05</td> </tr> <tr> <td>y(k-14)</td> <td>2.4900E-01</td> <td>1.10314107E-04</td> </tr> <tr> <td>y(k-19)</td> <td>-6.8239E-03</td> <td>1.99734771E-05</td> </tr> <tr> <td>x2(k-9)</td> <td>-9.6265E+01</td> <td>2.98523208E-05</td> </tr> <tr> <td>x2(k-8)</td> <td>2.2620E+02</td> <td>2.34402543E-04</td> </tr> <tr> <td>x2(k-2)</td> <td>-2.3609E+02</td> <td>1.04172323E-04</td> </tr> <tr> <td>y(k-20)</td> <td>-5.4663E-02</td> <td>5.37895336E-05</td> </tr> <tr> <td>x2(k-6)</td> <td>-2.3651E+02</td> <td>2.11392628E-05</td> </tr> <tr> <td>x2(k-4)</td> <td>1.7378E+02</td> <td>2.18396315E-05</td> </tr> <tr> <td>x1(k-7)</td> <td>4.9862E+00</td> <td>2.03811842E-05</td> </tr> </tbody> </table> <div class="highlight"><pre><span></span><code><a href="#__codelineno-75-1" id="__codelineno-75-1" name="__codelineno-75-1"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">yhat</span><span class="o">=</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<a href="#__codelineno-75-2" id="__codelineno-75-2" name="__codelineno-75-2"></a><span class="n">ee</span> <span class="o">=</span> <span class="n">compute_residues_autocorrelation</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">)</span>
<a href="#__codelineno-75-3" id="__codelineno-75-3" name="__codelineno-75-3"></a><span class="n">plot_residues_correlation</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ee</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Residues"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"$e^2$"</span><span class="p">)</span>
<a href="#__codelineno-75-4" id="__codelineno-75-4" name="__codelineno-75-4"></a><span class="n">x1e</span> <span class="o">=</span> <span class="n">compute_cross_correlation</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">,</span> <span class="n">x_val</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<a href="#__codelineno-75-5" id="__codelineno-75-5" name="__codelineno-75-5"></a><span class="n">plot_residues_correlation</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x1e</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Residues"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"$x_1e$"</span><span class="p">)</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/f16_r1.png"><img alt="" src="../assets/f16_r1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/f16_ee_1.png"><img alt="" src="../assets/f16_ee_1.png"/></a></p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/f16_ex_1.png"><img alt="" src="../assets/f16_ex_1.png"/></a></p> <h2 id="pv-forecasting">PV Forecasting<a class="headerlink" href="#pv-forecasting" title="Permanent link"></a></h2> <p>In this case study, we evaluate SysIdentPy's capabilities for forecasting solar irradiance data, which can serve as a proxy for solar photovoltaic (PV) production. The objective is to demonstrate that SysIdentPy provides a competitive alternative for time series modeling, rather than claiming superiority over other libraries.</p> <h3 id="dataset-overview_1">Dataset Overview<a class="headerlink" href="#dataset-overview_1" title="Permanent link"></a></h3> <p>The dataset used in this analysis consists of solar irradiance measurements, which are crucial for predicting solar PV production. Solar irradiance refers to the power of solar radiation received per unit area at the Earth's surface, typically measured in watts per square meter (W/m). Accurate forecasting of solar irradiance is essential for optimizing energy production and managing grid stability in solar power systems.</p> <p><strong>Dataset Details:</strong> - <strong>Source:</strong> The dataset can be accessed from the NeuralProphet GitHub repository. - <strong>Time Frame:</strong> The dataset covers a continuous period with frequent measurements. - <strong>Variables:</strong> Solar irradiance values over time, which will be used to model and forecast future irradiance levels.</p> <h3 id="comparison-with-other-libraries_1">Comparison with Other Libraries<a class="headerlink" href="#comparison-with-other-libraries_1" title="Permanent link"></a></h3> <p>To assess the effectiveness of SysIdentPy, we will compare its performance with the NeuralProphet library. NeuralProphet is known for its flexibility and ability to capture complex seasonal patterns and trends, making it a suitable benchmark for this task.</p> <p>For the comparison, we will use the following methods:</p> <ul> <li><strong>NeuralProphet:</strong></li> <li> <p>The configuration for NeuralProphet models will be based on examples provided in the <a href="https://neuralprophet.com/html/example_links/energy_data_example.html">NeuralProphet documentation</a>. This library employs advanced techniques for capturing temporal patterns and forecasting.</p> </li> <li> <p><strong>SysIdentPy:</strong></p> </li> <li><strong>MetaMSS (Meta-heuristic Model Structure Selection):</strong> Utilizes metaheuristic algorithms to determine the optimal model structure.</li> <li><strong>AOLS (Accelerated Orthogonal Least Squares):</strong> A method designed for selecting relevant regressors in a model.</li> <li><strong>FROLS (Forward Regression with Orthogonal Least Squares, using polynomial base functions):</strong> A regression technique that incorporates polynomial terms to enhance model selection.</li> </ul> <h3 id="objective_1">Objective<a class="headerlink" href="#objective_1" title="Permanent link"></a></h3> <p>The goal of this case study is to compare the performance of SysIdentPy's forecasting methods with NeuralProphet. We will specifically focus on:</p> <ul> <li><strong>1-Step Ahead Forecasting:</strong> Evaluating the models' ability to predict the next time step in the series based on historical data.</li> </ul> <p>We will train our models on 80% of the dataset and reserve the remaining 20% for validation purposes. This setup ensures that we test the models' performance on unseen data.</p> <h3 id="required-packages-and-versions_7">Required Packages and Versions<a class="headerlink" href="#required-packages-and-versions_7" title="Permanent link"></a></h3> <p>To ensure that you can replicate this case study, it is essential to use specific versions of the required packages. Below is a list of the packages along with their respective versions needed for running the case studies effectively.</p> <p>To install all the required packages, you can create a <code>requirements.txt</code> file with the following content:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-76-1" id="__codelineno-76-1" name="__codelineno-76-1"></a>sysidentpy==0.4.0
<a href="#__codelineno-76-2" id="__codelineno-76-2" name="__codelineno-76-2"></a>pystan==2.19.1.1
<a href="#__codelineno-76-3" id="__codelineno-76-3" name="__codelineno-76-3"></a>holidays==0.11.2
<a href="#__codelineno-76-4" id="__codelineno-76-4" name="__codelineno-76-4"></a>fbprophet==0.7.1
<a href="#__codelineno-76-5" id="__codelineno-76-5" name="__codelineno-76-5"></a>neuralprophet==0.2.7
<a href="#__codelineno-76-6" id="__codelineno-76-6" name="__codelineno-76-6"></a>pandas==1.3.2
<a href="#__codelineno-76-7" id="__codelineno-76-7" name="__codelineno-76-7"></a>numpy==1.23.3
<a href="#__codelineno-76-8" id="__codelineno-76-8" name="__codelineno-76-8"></a>matplotlib==3.8.4
<a href="#__codelineno-76-9" id="__codelineno-76-9" name="__codelineno-76-9"></a>pmdarima==1.8.3
<a href="#__codelineno-76-10" id="__codelineno-76-10" name="__codelineno-76-10"></a>scikit-learn==0.24.2
<a href="#__codelineno-76-11" id="__codelineno-76-11" name="__codelineno-76-11"></a>scipy==1.9.1
<a href="#__codelineno-76-12" id="__codelineno-76-12" name="__codelineno-76-12"></a>sktime==0.8.0
<a href="#__codelineno-76-13" id="__codelineno-76-13" name="__codelineno-76-13"></a>statsmodels==0.12.2
<a href="#__codelineno-76-14" id="__codelineno-76-14" name="__codelineno-76-14"></a>tbats==1.1.0
<a href="#__codelineno-76-15" id="__codelineno-76-15" name="__codelineno-76-15"></a>torch==1.12.1
</code></pre></div> <p>Then, install the packages using:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-77-1" id="__codelineno-77-1" name="__codelineno-77-1"></a>pip install -r requirements.txt
</code></pre></div> <ul> <li>Ensure that you use a virtual environment to avoid conflicts between package versions. This practice isolates your projects dependencies and prevents version conflicts with other projects or system-wide packages. Additionally, be aware that some packages, such as <code>sktime</code> and <code>neuralprophet</code>, may install several dependencies automatically during their installation. Setting up a virtual environment helps manage these dependencies more effectively and keeps your project environment clean and reproducible.</li> <li>Versions specified are based on compatibility with the code examples provided. If you are using different versions, some adjustments in the code might be necessary.</li> </ul> <h3 id="procedure_1">Procedure<a class="headerlink" href="#procedure_1" title="Permanent link"></a></h3> <ol> <li><strong>Data Preparation:</strong> Load and preprocess the solar irradiance dataset.</li> <li><strong>Model Training:</strong> Apply the chosen methods from SysIdentPy and NeuralProphet to the training data.</li> <li><strong>Evaluation:</strong> Assess the forecasting accuracy of each model on the validation set.</li> </ol> <p>By comparing these approaches, we aim to showcase SysIdentPy as a viable option for time series forecasting, highlighting its strengths and versatility in practical applications.</p> <p>Lets start by importing the necessary libraries and setting up the environment for this analysis.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-78-1" id="__codelineno-78-1" name="__codelineno-78-1"></a><span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">simplefilter</span>
<a href="#__codelineno-78-2" id="__codelineno-78-2" name="__codelineno-78-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-78-3" id="__codelineno-78-3" name="__codelineno-78-3"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-78-4" id="__codelineno-78-4" name="__codelineno-78-4"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-78-5" id="__codelineno-78-5" name="__codelineno-78-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-78-6" id="__codelineno-78-6" name="__codelineno-78-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">AOLS</span>
<a href="#__codelineno-78-7" id="__codelineno-78-7" name="__codelineno-78-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">MetaMSS</span>
<a href="#__codelineno-78-8" id="__codelineno-78-8" name="__codelineno-78-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-78-9" id="__codelineno-78-9" name="__codelineno-78-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.plotting</span> <span class="kn">import</span> <span class="n">plot_results</span>
<a href="#__codelineno-78-10" id="__codelineno-78-10" name="__codelineno-78-10"></a><span class="kn">from</span> <span class="nn">sysidentpy.neural_network</span> <span class="kn">import</span> <span class="n">NARXNN</span>
<a href="#__codelineno-78-11" id="__codelineno-78-11" name="__codelineno-78-11"></a><span class="kn">from</span> <span class="nn">sysidentpy.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<a href="#__codelineno-78-12" id="__codelineno-78-12" name="__codelineno-78-12"></a><span class="kn">from</span> <span class="nn">neuralprophet</span> <span class="kn">import</span> <span class="n">NeuralProphet</span>
<a href="#__codelineno-78-13" id="__codelineno-78-13" name="__codelineno-78-13"></a><span class="kn">from</span> <span class="nn">neuralprophet</span> <span class="kn">import</span> <span class="n">set_random_seed</span>
<a href="#__codelineno-78-14" id="__codelineno-78-14" name="__codelineno-78-14"></a>
<a href="#__codelineno-78-15" id="__codelineno-78-15" name="__codelineno-78-15"></a><span class="n">simplefilter</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
<a href="#__codelineno-78-16" id="__codelineno-78-16" name="__codelineno-78-16"></a><span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">"ignore"</span><span class="p">)</span>
<a href="#__codelineno-78-17" id="__codelineno-78-17" name="__codelineno-78-17"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<a href="#__codelineno-78-18" id="__codelineno-78-18" name="__codelineno-78-18"></a>
<a href="#__codelineno-78-19" id="__codelineno-78-19" name="__codelineno-78-19"></a><span class="n">loss</span> <span class="o">=</span> <span class="n">mean_squared_error</span>
<a href="#__codelineno-78-20" id="__codelineno-78-20" name="__codelineno-78-20"></a><span class="n">data_location</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">".\datasets"</span>
</code></pre></div> <h3 id="neural-prophet_1">Neural Prophet<a class="headerlink" href="#neural-prophet_1" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-79-1" id="__codelineno-79-1" name="__codelineno-79-1"></a><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-79-2" id="__codelineno-79-2" name="__codelineno-79-2"></a><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"\SanFrancisco_PV_GHI.csv"</span><span class="p">,</span> <span class="s2">"\SanFrancisco_Hospital.csv"</span><span class="p">]</span>
<a href="#__codelineno-79-3" id="__codelineno-79-3" name="__codelineno-79-3"></a><span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="#__codelineno-79-4" id="__codelineno-79-4" name="__codelineno-79-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a href="#__codelineno-79-5" id="__codelineno-79-5" name="__codelineno-79-5"></a><span class="n">df</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">"1/1/2015 1:00:00"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"Min"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="p">(</span><span class="mi">8760</span><span class="p">))</span>
<a href="#__codelineno-79-6" id="__codelineno-79-6" name="__codelineno-79-6"></a><span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a href="#__codelineno-79-7" id="__codelineno-79-7" name="__codelineno-79-7"></a>
<a href="#__codelineno-79-8" id="__codelineno-79-8" name="__codelineno-79-8"></a><span class="n">m</span> <span class="o">=</span> <span class="n">NeuralProphet</span><span class="p">(</span>
<a href="#__codelineno-79-9" id="__codelineno-79-9" name="__codelineno-79-9"></a>  <span class="n">n_lags</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-79-10" id="__codelineno-79-10" name="__codelineno-79-10"></a>  <span class="n">ar_sparsity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<a href="#__codelineno-79-11" id="__codelineno-79-11" name="__codelineno-79-11"></a><span class="p">)</span>
<a href="#__codelineno-79-12" id="__codelineno-79-12" name="__codelineno-79-12"></a>
<a href="#__codelineno-79-13" id="__codelineno-79-13" name="__codelineno-79-13"></a><span class="n">metrics</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">"H"</span><span class="p">,</span> <span class="n">valid_p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a href="#__codelineno-79-14" id="__codelineno-79-14" name="__codelineno-79-14"></a><span class="n">df_train</span><span class="p">,</span> <span class="n">df_val</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">split_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">valid_p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a href="#__codelineno-79-15" id="__codelineno-79-15" name="__codelineno-79-15"></a><span class="n">m</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">df_val</span><span class="p">)</span>
<a href="#__codelineno-79-16" id="__codelineno-79-16" name="__codelineno-79-16"></a>
<a href="#__codelineno-79-17" id="__codelineno-79-17" name="__codelineno-79-17"></a><span class="n">future</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">df_val</span><span class="p">,</span> <span class="n">n_historic_predictions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-79-18" id="__codelineno-79-18" name="__codelineno-79-18"></a><span class="n">forecast</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<a href="#__codelineno-79-19" id="__codelineno-79-19" name="__codelineno-79-19"></a>
<a href="#__codelineno-79-20" id="__codelineno-79-20" name="__codelineno-79-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">(</span><span class="n">forecast</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span><span class="mi">24</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">forecast</span><span class="p">[</span><span class="s2">"yhat1"</span><span class="p">][</span><span class="mi">24</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a href="#__codelineno-79-21" id="__codelineno-79-21" name="__codelineno-79-21"></a>
<a href="#__codelineno-79-22" id="__codelineno-79-22" name="__codelineno-79-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span><span class="o">-</span><span class="mi">104</span><span class="p">:],</span> <span class="s2">"ro-"</span><span class="p">)</span>
<a href="#__codelineno-79-23" id="__codelineno-79-23" name="__codelineno-79-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">[</span><span class="s2">"yhat1"</span><span class="p">][</span><span class="o">-</span><span class="mi">104</span><span class="p">:],</span> <span class="s2">"k*-"</span><span class="p">)</span>
</code></pre></div> <p>The error is <span class="arithmatex">\(MSE=4642.23\)</span> and will be used as baseline in this case. Lets check how SysIdentPy methods handle this data.</p> <h3 id="frols">FROLS<a class="headerlink" href="#frols" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-80-1" id="__codelineno-80-1" name="__codelineno-80-1"></a><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"\SanFrancisco_PV_GHI.csv"</span><span class="p">,</span> <span class="s2">"\SanFrancisco_Hospital.csv"</span><span class="p">]</span>
<a href="#__codelineno-80-2" id="__codelineno-80-2" name="__codelineno-80-2"></a><span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="#__codelineno-80-3" id="__codelineno-80-3" name="__codelineno-80-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a href="#__codelineno-80-4" id="__codelineno-80-4" name="__codelineno-80-4"></a><span class="n">df</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">"1/1/2015 1:00:00"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"Min"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="p">(</span><span class="mi">8760</span><span class="p">))</span>
<a href="#__codelineno-80-5" id="__codelineno-80-5" name="__codelineno-80-5"></a><span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a href="#__codelineno-80-6" id="__codelineno-80-6" name="__codelineno-80-6"></a><span class="n">df_train</span><span class="p">,</span> <span class="n">df_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">7008</span><span class="p">,</span> <span class="p">:],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">7008</span><span class="p">:,</span> <span class="p">:]</span>
<a href="#__codelineno-80-7" id="__codelineno-80-7" name="__codelineno-80-7"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-8" id="__codelineno-80-8" name="__codelineno-80-8"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-9" id="__codelineno-80-9" name="__codelineno-80-9"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-10" id="__codelineno-80-10" name="__codelineno-80-10"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-11" id="__codelineno-80-11" name="__codelineno-80-11"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-12" id="__codelineno-80-12" name="__codelineno-80-12"></a>
<a href="#__codelineno-80-13" id="__codelineno-80-13" name="__codelineno-80-13"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-14" id="__codelineno-80-14" name="__codelineno-80-14"></a><span class="n">sysidentpy</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-80-15" id="__codelineno-80-15" name="__codelineno-80-15"></a>  <span class="n">order_selection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a href="#__codelineno-80-16" id="__codelineno-80-16" name="__codelineno-80-16"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-80-17" id="__codelineno-80-17" name="__codelineno-80-17"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-80-18" id="__codelineno-80-18" name="__codelineno-80-18"></a>  <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"bic"</span><span class="p">,</span>
<a href="#__codelineno-80-19" id="__codelineno-80-19" name="__codelineno-80-19"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-80-20" id="__codelineno-80-20" name="__codelineno-80-20"></a>  <span class="n">model_type</span><span class="o">=</span><span class="s2">"NARMAX"</span><span class="p">,</span>
<a href="#__codelineno-80-21" id="__codelineno-80-21" name="__codelineno-80-21"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">LeastSquares</span><span class="p">(),</span>
<a href="#__codelineno-80-22" id="__codelineno-80-22" name="__codelineno-80-22"></a><span class="p">)</span>
<a href="#__codelineno-80-23" id="__codelineno-80-23" name="__codelineno-80-23"></a>
<a href="#__codelineno-80-24" id="__codelineno-80-24" name="__codelineno-80-24"></a><span class="n">sysidentpy</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-80-25" id="__codelineno-80-25" name="__codelineno-80-25"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-80-26" id="__codelineno-80-26" name="__codelineno-80-26"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-80-27" id="__codelineno-80-27" name="__codelineno-80-27"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">sysidentpy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-80-28" id="__codelineno-80-28" name="__codelineno-80-28"></a><span class="n">sysidentpy_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-80-29" id="__codelineno-80-29" name="__codelineno-80-29"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-80-30" id="__codelineno-80-30" name="__codelineno-80-30"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-80-31" id="__codelineno-80-31" name="__codelineno-80-31"></a><span class="p">)</span>
<a href="#__codelineno-80-32" id="__codelineno-80-32" name="__codelineno-80-32"></a>
<a href="#__codelineno-80-33" id="__codelineno-80-33" name="__codelineno-80-33"></a><span class="nb">print</span><span class="p">(</span><span class="n">sysidentpy_loss</span><span class="p">)</span>
<a href="#__codelineno-80-34" id="__codelineno-80-34" name="__codelineno-80-34"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="o">-</span><span class="mi">104</span><span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="o">-</span><span class="mi">104</span><span class="p">:])</span>
</code></pre></div> <p>The <span class="arithmatex">\(MSE=3869.34\)</span> for this case.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/pv_r1.png"><img alt="" src="../assets/pv_r1.png"/></a></p> <h3 id="metamss">MetaMSS<a class="headerlink" href="#metamss" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-81-1" id="__codelineno-81-1" name="__codelineno-81-1"></a><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-81-2" id="__codelineno-81-2" name="__codelineno-81-2"></a><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"\SanFrancisco_PV_GHI.csv"</span><span class="p">,</span> <span class="s2">"\SanFrancisco_Hospital.csv"</span><span class="p">]</span>
<a href="#__codelineno-81-3" id="__codelineno-81-3" name="__codelineno-81-3"></a><span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="#__codelineno-81-4" id="__codelineno-81-4" name="__codelineno-81-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a href="#__codelineno-81-5" id="__codelineno-81-5" name="__codelineno-81-5"></a><span class="n">df</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">"1/1/2015 1:00:00"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"Min"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="p">(</span><span class="mi">8760</span><span class="p">))</span>
<a href="#__codelineno-81-6" id="__codelineno-81-6" name="__codelineno-81-6"></a><span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a href="#__codelineno-81-7" id="__codelineno-81-7" name="__codelineno-81-7"></a><span class="n">df_train</span><span class="p">,</span> <span class="n">df_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">7008</span><span class="p">,</span> <span class="p">:],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">7008</span><span class="p">:,</span> <span class="p">:]</span>
<a href="#__codelineno-81-8" id="__codelineno-81-8" name="__codelineno-81-8"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-9" id="__codelineno-81-9" name="__codelineno-81-9"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-10" id="__codelineno-81-10" name="__codelineno-81-10"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-11" id="__codelineno-81-11" name="__codelineno-81-11"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-12" id="__codelineno-81-12" name="__codelineno-81-12"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-13" id="__codelineno-81-13" name="__codelineno-81-13"></a>
<a href="#__codelineno-81-14" id="__codelineno-81-14" name="__codelineno-81-14"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-15" id="__codelineno-81-15" name="__codelineno-81-15"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">()</span>
<a href="#__codelineno-81-16" id="__codelineno-81-16" name="__codelineno-81-16"></a>
<a href="#__codelineno-81-17" id="__codelineno-81-17" name="__codelineno-81-17"></a><span class="n">sysidentpy_metamss</span> <span class="o">=</span> <span class="n">MetaMSS</span><span class="p">(</span>
<a href="#__codelineno-81-18" id="__codelineno-81-18" name="__codelineno-81-18"></a>  <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-81-19" id="__codelineno-81-19" name="__codelineno-81-19"></a>  <span class="n">xlag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-81-20" id="__codelineno-81-20" name="__codelineno-81-20"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<a href="#__codelineno-81-21" id="__codelineno-81-21" name="__codelineno-81-21"></a>  <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a href="#__codelineno-81-22" id="__codelineno-81-22" name="__codelineno-81-22"></a>  <span class="n">maxiter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a href="#__codelineno-81-23" id="__codelineno-81-23" name="__codelineno-81-23"></a>  <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a href="#__codelineno-81-24" id="__codelineno-81-24" name="__codelineno-81-24"></a>  <span class="n">n_agents</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
<a href="#__codelineno-81-25" id="__codelineno-81-25" name="__codelineno-81-25"></a>  <span class="n">loss_func</span><span class="o">=</span><span class="s2">"metamss_loss"</span><span class="p">,</span>
<a href="#__codelineno-81-26" id="__codelineno-81-26" name="__codelineno-81-26"></a>  <span class="n">model_type</span><span class="o">=</span><span class="s2">"NARMAX"</span><span class="p">,</span>
<a href="#__codelineno-81-27" id="__codelineno-81-27" name="__codelineno-81-27"></a>  <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<a href="#__codelineno-81-28" id="__codelineno-81-28" name="__codelineno-81-28"></a><span class="p">)</span>
<a href="#__codelineno-81-29" id="__codelineno-81-29" name="__codelineno-81-29"></a>
<a href="#__codelineno-81-30" id="__codelineno-81-30" name="__codelineno-81-30"></a><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-81-31" id="__codelineno-81-31" name="__codelineno-81-31"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-81-32" id="__codelineno-81-32" name="__codelineno-81-32"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-81-33" id="__codelineno-81-33" name="__codelineno-81-33"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-81-34" id="__codelineno-81-34" name="__codelineno-81-34"></a><span class="n">metamss_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-81-35" id="__codelineno-81-35" name="__codelineno-81-35"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-81-36" id="__codelineno-81-36" name="__codelineno-81-36"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_metamss</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-81-37" id="__codelineno-81-37" name="__codelineno-81-37"></a><span class="p">)</span>
<a href="#__codelineno-81-38" id="__codelineno-81-38" name="__codelineno-81-38"></a>
<a href="#__codelineno-81-39" id="__codelineno-81-39" name="__codelineno-81-39"></a><span class="nb">print</span><span class="p">(</span><span class="n">metamss_loss</span><span class="p">)</span>
<a href="#__codelineno-81-40" id="__codelineno-81-40" name="__codelineno-81-40"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="o">-</span><span class="mi">104</span><span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="o">-</span><span class="mi">104</span><span class="p">:])</span>
</code></pre></div> <p>The MetaMSS algorithm was able to select a better model in this case, as can be observed in the error metric, <span class="arithmatex">\(MSE=2157.77\)</span>.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/pv_r2.png"><img alt="" src="../assets/pv_r2.png"/></a></p> <h3 id="aols">AOLS<a class="headerlink" href="#aols" title="Permanent link"></a></h3> <div class="highlight"><pre><span></span><code><a href="#__codelineno-82-1" id="__codelineno-82-1" name="__codelineno-82-1"></a><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a href="#__codelineno-82-2" id="__codelineno-82-2" name="__codelineno-82-2"></a><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"\SanFrancisco_PV_GHI.csv"</span><span class="p">,</span> <span class="s2">"\SanFrancisco_Hospital.csv"</span><span class="p">]</span>
<a href="#__codelineno-82-3" id="__codelineno-82-3" name="__codelineno-82-3"></a><span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_location</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="#__codelineno-82-4" id="__codelineno-82-4" name="__codelineno-82-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a href="#__codelineno-82-5" id="__codelineno-82-5" name="__codelineno-82-5"></a><span class="n">df</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">"1/1/2015 1:00:00"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"Min"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="p">(</span><span class="mi">8760</span><span class="p">))</span>
<a href="#__codelineno-82-6" id="__codelineno-82-6" name="__codelineno-82-6"></a><span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a href="#__codelineno-82-7" id="__codelineno-82-7" name="__codelineno-82-7"></a><span class="n">df_train</span><span class="p">,</span> <span class="n">df_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">7008</span><span class="p">,</span> <span class="p">:],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">7008</span><span class="p">:,</span> <span class="p">:]</span>
<a href="#__codelineno-82-8" id="__codelineno-82-8" name="__codelineno-82-8"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-9" id="__codelineno-82-9" name="__codelineno-82-9"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-10" id="__codelineno-82-10" name="__codelineno-82-10"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-11" id="__codelineno-82-11" name="__codelineno-82-11"></a><span class="n">x_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-12" id="__codelineno-82-12" name="__codelineno-82-12"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="s2">"ds"</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-13" id="__codelineno-82-13" name="__codelineno-82-13"></a>
<a href="#__codelineno-82-14" id="__codelineno-82-14" name="__codelineno-82-14"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-15" id="__codelineno-82-15" name="__codelineno-82-15"></a><span class="n">sysidentpy_AOLS</span> <span class="o">=</span> <span class="n">AOLS</span><span class="p">(</span>
<a href="#__codelineno-82-16" id="__codelineno-82-16" name="__codelineno-82-16"></a>  <span class="n">ylag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">xlag</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s2">"NARMAX"</span><span class="p">,</span> <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span>
<a href="#__codelineno-82-17" id="__codelineno-82-17" name="__codelineno-82-17"></a><span class="p">)</span>
<a href="#__codelineno-82-18" id="__codelineno-82-18" name="__codelineno-82-18"></a>
<a href="#__codelineno-82-19" id="__codelineno-82-19" name="__codelineno-82-19"></a><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-82-20" id="__codelineno-82-20" name="__codelineno-82-20"></a><span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">x_test</span><span class="p">])</span>
<a href="#__codelineno-82-21" id="__codelineno-82-21" name="__codelineno-82-21"></a><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_train</span><span class="p">[</span><span class="o">-</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:],</span> <span class="n">y_test</span><span class="p">])</span>
<a href="#__codelineno-82-22" id="__codelineno-82-22" name="__codelineno-82-22"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-82-23" id="__codelineno-82-23" name="__codelineno-82-23"></a><span class="n">aols_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
<a href="#__codelineno-82-24" id="__codelineno-82-24" name="__codelineno-82-24"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-82-25" id="__codelineno-82-25" name="__codelineno-82-25"></a>  <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">yhat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">sysidentpy_AOLS</span><span class="o">.</span><span class="n">max_lag</span> <span class="p">:]),</span>
<a href="#__codelineno-82-26" id="__codelineno-82-26" name="__codelineno-82-26"></a><span class="p">)</span>
<a href="#__codelineno-82-27" id="__codelineno-82-27" name="__codelineno-82-27"></a><span class="nb">print</span><span class="p">(</span><span class="n">aols_loss</span><span class="p">)</span>
<a href="#__codelineno-82-28" id="__codelineno-82-28" name="__codelineno-82-28"></a><span class="n">plot_results</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_test</span><span class="p">[</span><span class="o">-</span><span class="mi">104</span><span class="p">:],</span> <span class="n">yhat</span><span class="o">=</span><span class="n">yhat</span><span class="p">[</span><span class="o">-</span><span class="mi">104</span><span class="p">:])</span>
</code></pre></div> <p>The error now is <span class="arithmatex">\(MSE=2361.56\)</span>.</p> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/pv_r3.png"><img alt="" src="../assets/pv_r3.png"/></a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: 9. Validation" class="md-footer__link md-footer__link--prev" href="../9%20-%20Validation/"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> 9. Validation </div> </div> </a> <a aria-label="Next: Events" class="md-footer__link md-footer__link--next" href="../../events/events/"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> Events </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright  2016 - 2022 Wilson Rocha </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/wilsonrljr" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class="md-social__link" href="https://pypi.org/project/sysidentpy/" rel="noopener" target="_blank" title="pypi.org"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"></path></svg> </a> <a class="md-social__link" href="https://twitter.com/wilsonrljr" rel="noopener" target="_blank" title="twitter.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src="../../assets/javascripts/bundle.a7c05c9e.min.js"></script> <script src="../../overrides/assets/extra.js"></script> <script src="../../overrides/assets/javascripts/mathjax.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>