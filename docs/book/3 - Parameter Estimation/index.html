<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="From Classical Approaches to Neural Networks" name="description"/><meta content="Wilson Rocha" name="author"/><link href="https://sysidentpy.org/book/3%20-%20Parameter%20Estimation/" rel="canonical"/><link href="../2%20-%20NARMAX%20Model%20Representation/" rel="prev"/><link href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/" rel="next"/><link href="../../overrides/assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.6.0, mkdocs-material-9.5.21" name="generator"/><title>3. Parameter Estimation - SysIdentPy</title><link href="../../assets/stylesheets/main.66ac8b77.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../assets/_mkdocstrings.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }

                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head> <body data-md-color-accent="orange" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#least-squares"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="SysIdentPy" class="md-header__button md-logo" data-md-component="logo" href="../.." title="SysIdentPy"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> SysIdentPy </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> 3. Parameter Estimation </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="orange" data-md-color-media="" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/wilsonrljr/sysidentpy" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/getting-started/"> Getting started </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../examples/basic_steps/"> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../0%20-%20Preface/"> Companion Book </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../events/events/"> Blog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/about-us/"> About </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../changelog/changelog/"> Changelog </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../landing-page/sponsor/"> Sponsors </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../code/narmax-base/"> Code </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="SysIdentPy" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="SysIdentPy"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg> </a> SysIdentPy </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/wilsonrljr/sysidentpy" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> wilsonrljr/sysidentpy </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/getting-started/"> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/ch0-narmax-intro/"> <span class="md-ellipsis"> Introduction to NARMAX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/basic-usage/"> <span class="md-ellipsis"> Basic Usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/get-help/"> <span class="md-ellipsis"> Get Help </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/contribute/"> <span class="md-ellipsis"> How to contribute </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/license/"> <span class="md-ellipsis"> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0"> <span class="md-ellipsis"> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_1"> <span class="md-nav__icon md-icon"></span> Features </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/basic_steps/"> <span class="md-ellipsis"> Presenting main functionality </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/defining_lags/"> <span class="md-ellipsis"> Setting specific lags </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/multiple_inputs_example/"> <span class="md-ellipsis"> Multiple Inputs usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/parameter_estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/multiobjective_parameter_estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation for NARMAX models - An Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/extended_least_squares/"> <span class="md-ellipsis"> Extended Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/n_steps_ahead_prediction/"> <span class="md-ellipsis"> Example: N-steps-ahead prediction - F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/simulating_a_predefined_model/"> <span class="md-ellipsis"> Simulate a Predefined Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/save_and_load_models/"> <span class="md-ellipsis"> Saving and Loading models using .syspy extension </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/information_criteria_examples/"> <span class="md-ellipsis"> Information Criteria - Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/general_estimators/"> <span class="md-ellipsis"> Building NARX models using general estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/fourier_basis_function/"> <span class="md-ellipsis"> Fourier Basis Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/metamss/"> <span class="md-ellipsis"> Meta-Model Structure Selection (MetaMSS) algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/narx_neural_network/"> <span class="md-ellipsis"> Building NARX Neural Network using Sysidentpy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/aols/"> <span class="md-ellipsis"> Using the Accelerated Orthogonal Least-Squares algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/entropic_regression/"> <span class="md-ellipsis"> Identification of an electromechanical system using Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/NFIR/"> <span class="md-ellipsis"> NFIR Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0"> <span class="md-ellipsis"> Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> Cases </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/air_passenger_benchmark/"> <span class="md-ellipsis"> Air Passenger benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/f_16_benchmark/"> <span class="md-ellipsis"> Example: F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/identification_of_an_electromechanical_system/"> <span class="md-ellipsis"> Identification of an electromechanical system </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/load_forecasting_benchmark/"> <span class="md-ellipsis"> Load forecasting benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/PV_forecasting_benchmark/"> <span class="md-ellipsis"> PV forecasting benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0"> <span class="md-ellipsis"> V0.3.4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> V0.3.4 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3_1" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0"> <span class="md-ellipsis"> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_1_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_3_1"> <span class="md-nav__icon md-icon"></span> Features </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/basic_steps/"> <span class="md-ellipsis"> Presenting main functionality </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/defining_lags/"> <span class="md-ellipsis"> Setting specific lags </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/multiple_inputs_example/"> <span class="md-ellipsis"> Multiple Inputs usage </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/parameter_estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/multiobjective_parameter_estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation for NARMAX models - An Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/extended_least_squares/"> <span class="md-ellipsis"> Extended Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/n_steps_ahead_prediction/"> <span class="md-ellipsis"> Example: N-steps-ahead prediction - F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/simulating_a_predefined_model/"> <span class="md-ellipsis"> Simulate a Predefined Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/save_and_load_models/"> <span class="md-ellipsis"> Saving and Loading models using .syspy extension </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/information_criteria_examples/"> <span class="md-ellipsis"> Information Criteria - Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/general_estimators/"> <span class="md-ellipsis"> Building NARX models using general estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/fourier_basis_function/"> <span class="md-ellipsis"> Fourier Basis Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/metamss/"> <span class="md-ellipsis"> Meta-Model Structure Selection (MetaMSS) algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/narx_neural_network/"> <span class="md-ellipsis"> Building NARX Neural Network using Sysidentpy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/aols/"> <span class="md-ellipsis"> Using the Accelerated Orthogonal Least-Squares algorithm for building Polynomial NARX models </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/entropic_regression/"> <span class="md-ellipsis"> Identification of an electromechanical system using Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/NFIR/"> <span class="md-ellipsis"> NFIR Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3_2" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0"> <span class="md-ellipsis"> Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_2_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_3_3_2"> <span class="md-nav__icon md-icon"></span> Cases </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/air_passenger_benchmark/"> <span class="md-ellipsis"> Air Passenger benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/f_16_benchmark/"> <span class="md-ellipsis"> Example: F-16 Ground Vibration Test benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/identification_of_an_electromechanical_system/"> <span class="md-ellipsis"> Identification of an electromechanical system </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/load_forecasting_benchmark/"> <span class="md-ellipsis"> Load forecasting benchmark </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../old_version/PV_forecasting_benchmark/"> <span class="md-ellipsis"> PV forecasting benchmark </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex=""> <span class="md-ellipsis"> Companion Book </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> Companion Book </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../0%20-%20Preface/"> <span class="md-ellipsis"> Preface </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../0.1%20-%20Contents/"> <span class="md-ellipsis"> Contents </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../1%20-%20Introduction/"> <span class="md-ellipsis"> Introduction </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../2%20-%20NARMAX%20Model%20Representation/"> <span class="md-ellipsis"> 2. NARMAX Model Representation </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> 3. Parameter Estimation </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> 3. Parameter Estimation </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#least-squares"> <span class="md-ellipsis"> Least Squares </span> </a> <nav aria-label="Least Squares" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#example"> <span class="md-ellipsis"> Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#total-least-squares"> <span class="md-ellipsis"> Total Least Squares </span> </a> <nav aria-label="Total Least Squares" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#objective-function"> <span class="md-ellipsis"> Objective Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#classical-solution"> <span class="md-ellipsis"> Classical Solution </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#recursive-least-squares"> <span class="md-ellipsis"> Recursive Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#least-mean-squares"> <span class="md-ellipsis"> Least Mean Squares </span> </a> <nav aria-label="Least Mean Squares" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#convergence-and-step-size"> <span class="md-ellipsis"> Convergence and Step-Size </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extended-least-squares-algorithm"> <span class="md-ellipsis"> Extended Least Squares Algorithm </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/"> <span class="md-ellipsis"> 4. Model Structure Selection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../5%20-%20Multiobjective%20Parameter%20Estimation/"> <span class="md-ellipsis"> 5. Multiobjective Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../6%20-%20Multiobjective%20Model%20Structure%20Selection/"> <span class="md-ellipsis"> 6. Multiobjective Model Structure Selection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../7%20-%20NARX%20Neural%20Network/"> <span class="md-ellipsis"> 7. NARX Neural Network </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../8%20-%20Severely%20Nonlinear%20System%20Identification/"> <span class="md-ellipsis"> 8. Severely Nonlinear System Identification </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../9%20-%20Validation/"> <span class="md-ellipsis"> 9. Validation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../10%20-%20Case%20Studies/"> <span class="md-ellipsis"> 10. Case Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/events/"> <span class="md-ellipsis"> Events </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/> <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0"> <span class="md-ellipsis"> Meetups </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_2"> <span class="md-nav__icon md-icon"></span> Meetups </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/ai-networks-meetup/"> <span class="md-ellipsis"> AI Networks Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/nubank-meetup/"> <span class="md-ellipsis"> Nubank Timeseries Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/nubank-meetup-open-source.md"> <span class="md-ellipsis"> Nubank Open Source Talk </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/gcom-meetup/"> <span class="md-ellipsis"> GCoM Meetup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../events/estatidados/"> <span class="md-ellipsis"> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> About </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/about-us/"> <span class="md-ellipsis"> About Us </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/attribute/"> <span class="md-ellipsis"> Attribute </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../changelog/changelog/"> <span class="md-ellipsis"> Changes in SysIdentPy </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../landing-page/sponsor/"> <span class="md-ellipsis"> Sponsors </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0"> <span class="md-ellipsis"> Code </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Code </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/narmax-base/"> <span class="md-ellipsis"> NARMAX Base </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/basis-function/"> <span class="md-ellipsis"> Basis Functions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/frols/"> <span class="md-ellipsis"> FROLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metamss/"> <span class="md-ellipsis"> MetaMSS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/aols/"> <span class="md-ellipsis"> AOLS </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/entropic-regression/"> <span class="md-ellipsis"> Entropic Regression </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/neural-narx/"> <span class="md-ellipsis"> Neural NARX </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/general-estimators/"> <span class="md-ellipsis"> General Estimators </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/parameter-estimation/"> <span class="md-ellipsis"> Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/multiobjective-parameter-estimation/"> <span class="md-ellipsis"> Multiobjective Parameter Estimation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/simulation/"> <span class="md-ellipsis"> Simulation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/residues/"> <span class="md-ellipsis"> Residual Analysis </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metaheuristics/"> <span class="md-ellipsis"> Metaheuristics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/metrics/"> <span class="md-ellipsis"> Metrics </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../code/utils/"> <span class="md-ellipsis"> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#least-squares"> <span class="md-ellipsis"> Least Squares </span> </a> <nav aria-label="Least Squares" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#example"> <span class="md-ellipsis"> Example </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#total-least-squares"> <span class="md-ellipsis"> Total Least Squares </span> </a> <nav aria-label="Total Least Squares" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#objective-function"> <span class="md-ellipsis"> Objective Function </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#classical-solution"> <span class="md-ellipsis"> Classical Solution </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#recursive-least-squares"> <span class="md-ellipsis"> Recursive Least Squares </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#least-mean-squares"> <span class="md-ellipsis"> Least Mean Squares </span> </a> <nav aria-label="Least Mean Squares" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#convergence-and-step-size"> <span class="md-ellipsis"> Convergence and Step-Size </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#extended-least-squares-algorithm"> <span class="md-ellipsis"> Extended Least Squares Algorithm </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href="https://github.com/wilsonrljr/sysidentpy/edit/master/docs/book/3 - Parameter Estimation.md" title="Edit this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg> </a> <a class="md-content__button md-icon" href="https://github.com/wilsonrljr/sysidentpy/raw/master/docs/book/3 - Parameter Estimation.md" title="View source of this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"></path></svg> </a> <h1>3. Parameter Estimation</h1> <h2 id="least-squares">Least Squares<a class="headerlink" href="#least-squares" title="Permanent link">¶</a></h2> <p>Consider the NARX model described in a generic form as</p> <div class="arithmatex">\[ \begin{equation} y_k = \psi^\top_{k-1}\hat{\Theta} + \xi_k, \end{equation} \tag{3.1} \]</div> <p>where <span class="arithmatex">\(\psi^\top_{k-1} \in \mathbb{R}^{n_r \times n}\)</span> is the information matrix, also known as the regressors matrix. The information matrix is the input and output transformation based in a basis function and <span class="arithmatex">\(\hat{\Theta}~\in \mathbb{R}^{n_{\Theta}}\)</span> the vector of estimated parameters. The model above can also be represented in a matrix form as:</p> <div class="arithmatex">\[ \begin{equation} y = \Psi\hat{\Theta} + \Xi, \end{equation} \tag{3.2} \]</div> <p>where</p> <div class="arithmatex">\[ \begin{align} Y = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}, \Psi = \begin{bmatrix} \psi_{{_1}} \\ \psi_{{_2}} \\ \vdots \\ \psi_{{_{n_{\Theta}}}} \end{bmatrix}^\top= \begin{bmatrix} \psi_{{_1}1} &amp; \psi_{{_2}1} &amp; \dots &amp; \psi_{{_{n_{\Theta}}}1} \\ \psi_{{_1}2} &amp; \psi_{{_2}2} &amp; \dots &amp; \psi_{{_{n_{\Theta}}}2} \\ \vdots &amp; \vdots &amp; &amp; \vdots \\ \psi_{{_1}n} &amp; \psi_{{_2}n} &amp; \dots &amp; \psi_{{_{n_{\Theta}}}n} \\ \end{bmatrix}, \hat{\Theta} = \begin{bmatrix} \hat{\Theta}_1 \\ \hat{\Theta}_2 \\ \vdots \\ \hat{\Theta}_{n_\Theta} \end{bmatrix}, \Xi = \begin{bmatrix} \xi_1 \\ \xi_2 \\ \vdots \\ \xi_n \end{bmatrix}. \end{align} \tag{3.3} \]</div> <blockquote> <p>We will consider the polynomial basis function to keep the examples straightforward, but the methods here will work for any other basis function.</p> </blockquote> <p>The parametric NARX model is linear in the parameters <span class="arithmatex">\(\Theta\)</span>, so we can use well known algorithms, like the linear Least Squares algorithm developed by Gauss in <span class="arithmatex">\(1795\)</span>, to estimate the model parameters. The idea is to find the parameter vector that minimizes the <span class="arithmatex">\(l2\)</span>-norm, also known as the residual sum of squares, described as</p> <div class="arithmatex">\[ \begin{equation} J_{\hat{\Theta}} = \Xi^\top \Xi = (y - \Psi\hat{\Theta})^\top(y - \Psi\hat{\Theta}) = \lVert y - \Psi\hat{\Theta} \rVert^2. \end{equation} \tag{3.4} \]</div> <p>In Equation 3.4 , <span class="arithmatex">\(\Psi\hat{\Theta}\)</span> is the one-step ahead prediction of <span class="arithmatex">\(y_k\)</span>, expressed as</p> <div class="arithmatex">\[ \begin{equation} \hat{y}_{1_k} = g(y_{k-1}, u_{k-1}\lvert ~\Theta), \end{equation} \tag{3.5} \]</div> <p>where <span class="arithmatex">\(g\)</span> is some unknown polynomial function. If the gradient of <span class="arithmatex">\(J_{\Theta}\)</span> with respect to <span class="arithmatex">\(\Theta\)</span> is equal to zero, then we have the normal equation and the Least Squares estimate is expressed as</p> <div class="arithmatex">\[ \begin{equation} \hat{\Theta} = (\Psi^\top\Psi)^{-1}\Psi^\top y, \end{equation} \tag{3.6} \]</div> <p>where <span class="arithmatex">\((\Psi^\top\Psi)^{-1}\Psi^\top\)</span> is called the pseudo-inverse of the matrix <span class="arithmatex">\(\Psi\)</span>, denoted <span class="arithmatex">\(\Psi^+ \in \mathbb{R}^{n \times n_r}\)</span>.</p> <p>In order to have a bias-free estimator, the following are the basic assumptions needed for the least-squares method: - A1 - There is no correlation between the error vector, <span class="arithmatex">\(\Xi\)</span>, and the matrix of regressors, <span class="arithmatex">\(\Psi\)</span>. Mathematically: - <span class="arithmatex">\(\mathrm{E}\{[(\Psi^\top\Psi)^{-1}\Psi^\top] \Xi\} = \mathrm{E}[(\Psi^\top\Psi)^{-1}\Psi^\top] \mathrm{E}[\Xi]; \tag{3.7}\)</span> - A2 - The error vector <span class="arithmatex">\(\Xi\)</span> is a zero mean white noise sequence: - <span class="arithmatex">\(\mathrm{E}[\Xi] = 0; \tag{3.8}\)</span> - A3 - The covariance matrix of the error vector is - <span class="arithmatex">\(\mathrm{Cov}[\hat{\Theta}] = \mathrm{E}[(\Theta - \hat{\Theta})(\Theta - \hat{\Theta})^\top] = \sigma^2(\Psi^\top\Psi); \tag{3.9}\)</span> - A4 - The matrix of regressors, <span class="arithmatex">\(\Psi\)</span>, is full rank.</p> <p>The aforementioned assumptions are needed to guarantee that the Least Squares algorithm produce a unbiased final model.</p> <h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">¶</a></h4> <p>Lets see a practical example. Consider the model</p> <div class="arithmatex">\[ y_k = 0.2y_{k-1} + 0.1y_{k-1}x_{k-1} + 0.9x_{k-2} + e_{k} \tag{3.10} \]</div> <p>We can generate the input <code>X</code> and output <code>y</code> using SysIdentPy. Before getting in the details, let run a simple model using SysIdentPy. Because we know a priori that the system we are trying to have is not linear (the simulated system have an interaction term <span class="arithmatex">\(0.1y_{k-1}x_{k-1}\)</span>) and the order is 2 (the maximum lag of the input and output), we will set the hyperparameters accordingly. Note that this a simulated scenario and you'll not have such information a priori in a real identification task. But don't worry, the idea, for now, is just show how things works and we will develop some real models along the book.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.generate_data</span> <span class="kn">import</span> <span class="n">get_siso_data</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="p">)</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">()</span>
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">n_info_values</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">ylag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="p">)</span>
<a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="c1"># print the identified model</span>
<a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span>
<a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="p">),</span>
<a href="#__codelineno-0-29" id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-0-30" id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="p">)</span>
<a href="#__codelineno-0-31" id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a href="#__codelineno-0-32" id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a href="#__codelineno-0-33" id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="n">Regressors</span>   <span class="n">Parameters</span>             <span class="n">ERR</span>
<a href="#__codelineno-0-34" id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="mi">0</span>        <span class="n">x1</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>  <span class="mf">9.0001E-01</span>  <span class="mf">9.56885108E-01</span>
<a href="#__codelineno-0-35" id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="mi">1</span>         <span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="mf">2.0000E-01</span>  <span class="mf">3.96313039E-02</span>
<a href="#__codelineno-0-36" id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="mi">2</span>  <span class="n">x1</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="mf">1.0001E-01</span>  <span class="mf">3.48355000E-03</span>
</code></pre></div> <p>As you can see, the final model have the same 3 regressors of the simulated system and the parameters are very close the ones used to simulate the system. This show us that the Least Squares performed well for this data.</p> <p>In this example, however, we are applying a Model Structure Selection algorithm (FROLS), which we will see in chapter 6. That's why the final model have only 3 regressors. The parameter estimation algorithm do not choose which terms to include in the model, so if we have a expanded basis function with 6 regressors, it will estimate the parameter for each one of the regressors.</p> <p>To check how this work, we can use SysIdentPy without Model Structure Selection by generating the information matrix and applying the parameter estimation algorithm directly.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.generate_data</span> <span class="kn">import</span> <span class="n">get_siso_data</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.narmax_base</span> <span class="kn">import</span> <span class="n">InformationMatrix</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="p">)</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="n">regressor_matrix</span> <span class="o">=</span> <span class="n">InformationMatrix</span><span class="p">(</span><span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build_input_output_matrix</span><span class="p">(</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="p">)</span>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="n">max_lag</span> <span class="o">=</span> <span class="mi">2</span>
<a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="c1"># apply the basis function</span>
<a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="n">psi</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">regressor_matrix</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">)</span>
<a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">()</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y_train</span><span class="p">[</span><span class="n">max_lag</span><span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="n">theta</span>
<a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a>
<a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="n">array</span><span class="p">([</span>
<a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">1.08377785e-05</span><span class="p">],</span>
<a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a>   <span class="p">[</span> <span class="mf">2.00002486e-01</span><span class="p">],</span>
<a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a>   <span class="p">[</span> <span class="mf">1.73422294e-05</span><span class="p">],</span>
<a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">3.50957931e-06</span><span class="p">],</span>
<a href="#__codelineno-1-25" id="__codelineno-1-25" name="__codelineno-1-25"></a>   <span class="p">[</span> <span class="mf">8.99927332e-01</span><span class="p">],</span>
<a href="#__codelineno-1-26" id="__codelineno-1-26" name="__codelineno-1-26"></a>   <span class="p">[</span> <span class="mf">2.04427279e-05</span><span class="p">],</span>
<a href="#__codelineno-1-27" id="__codelineno-1-27" name="__codelineno-1-27"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">1.47542408e-04</span><span class="p">],</span>
<a href="#__codelineno-1-28" id="__codelineno-1-28" name="__codelineno-1-28"></a>   <span class="p">[</span> <span class="mf">1.00062340e-01</span><span class="p">],</span>
<a href="#__codelineno-1-29" id="__codelineno-1-29" name="__codelineno-1-29"></a>   <span class="p">[</span> <span class="mf">4.53379771e-05</span><span class="p">],</span>
<a href="#__codelineno-1-30" id="__codelineno-1-30" name="__codelineno-1-30"></a>   <span class="p">[</span> <span class="mf">8.90006341e-05</span><span class="p">],</span>
<a href="#__codelineno-1-31" id="__codelineno-1-31" name="__codelineno-1-31"></a>   <span class="p">[</span> <span class="mf">1.15234873e-04</span><span class="p">],</span>
<a href="#__codelineno-1-32" id="__codelineno-1-32" name="__codelineno-1-32"></a>   <span class="p">[</span> <span class="mf">1.57770755e-04</span><span class="p">],</span>
<a href="#__codelineno-1-33" id="__codelineno-1-33" name="__codelineno-1-33"></a>   <span class="p">[</span> <span class="mf">1.58414037e-04</span><span class="p">],</span>
<a href="#__codelineno-1-34" id="__codelineno-1-34" name="__codelineno-1-34"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">3.09236444e-05</span><span class="p">],</span>
<a href="#__codelineno-1-35" id="__codelineno-1-35" name="__codelineno-1-35"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">1.60377753e-04</span><span class="p">]]</span>
<a href="#__codelineno-1-36" id="__codelineno-1-36" name="__codelineno-1-36"></a>   <span class="p">)</span>
</code></pre></div> <p>In this case, we have 15 model parameters. If we take a look in the basis function expansion where the degree of the polynomial is equal to 2 and the lags for <code>y</code> and <code>x</code> are set to 2, we have</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.narmax_tools</span> <span class="kn">import</span> <span class="n">regressor_code</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">regressors</span> <span class="o">=</span> <span class="n">regressor_code</span><span class="p">(</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>    <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="n">model_type</span><span class="o">=</span><span class="s2">"NARMAX"</span><span class="p">,</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="n">model_representation</span><span class="o">=</span><span class="s2">"Polynomial"</span><span class="p">,</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>    <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="p">)</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="n">regressors</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>   <span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>   <span class="p">[</span><span class="mi">1002</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>   <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>   <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>   <span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">1001</span><span class="p">],</span>
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a>   <span class="p">[</span><span class="mi">1002</span><span class="p">,</span> <span class="mi">1001</span><span class="p">],</span>
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a>   <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1001</span><span class="p">],</span>
<a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a>   <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">1001</span><span class="p">],</span>
<a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>   <span class="p">[</span><span class="mi">1002</span><span class="p">,</span> <span class="mi">1002</span><span class="p">],</span>
<a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a>   <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1002</span><span class="p">],</span>
<a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a>   <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">1002</span><span class="p">],</span>
<a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a>   <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span>
<a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a>   <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span>
<a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a>   <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2002</span><span class="p">]]</span>
<a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a>   <span class="p">)</span>
</code></pre></div> <p>The regressors is how SysIdentPy encode the polynomial basis function following this codification pattern:</p> <ul> <li><span class="arithmatex">\(0\)</span> is the constant term,\n",</li> <li><span class="arithmatex">\([1001] = y_{k-1}\)</span></li> <li><span class="arithmatex">\([100n] = y_{k-n}\)</span></li> <li><span class="arithmatex">\([200n] = x1_{k-n}\)</span></li> <li><span class="arithmatex">\([300n] = x2_{k-n}\)</span></li> <li><span class="arithmatex">\([1011, 1001] = y_{k-11} \\times y_{k-1}\)</span></li> <li><span class="arithmatex">\([100n, 100m] = y_{k-n} \times y_{k-m}\)</span></li> <li><span class="arithmatex">\([12001, 1003, 1001] = x11_{k-1} \times y_{k-3} \times y_{k-1}\)</span>,</li> <li>and so on</li> </ul> <p>So, if you take a look at the parameters, we can see that the Least Squares algorithm estimation for the terms that belongs to the simulated system are very close to the real values.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="mf">2.00002486e-01</span><span class="p">]</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="mf">8.99927332e-01</span><span class="p">]</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1001</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="mf">1.00062340e-01</span><span class="p">]</span>
</code></pre></div> <p>Moreover, the parameters estimated for the other regressors are considerably lower values than the ones estimated for the correct terms, indicating that the other might not be relevant to the model.</p> <p>You can start thinking that we only need to define a basis function and apply some parameter estimation technique to build NARMAX models. However, as mentioned before, the main goal of the NARMAX methods is to build the best model possible while keeping it simple. And that's true for the case where we applied the FROLS algorithm. Besides, when dealing with system identification we want to recover the dynamics of the system under study, so adding more terms than necessary can lead to unexpected behaviors, poor performance and unstable models. Remember, this is only a toy example, so in real cases the model structure selection is fundamental.</p> <p>You can implement Least Squares method as simple as</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="k">def</span> <span class="nf">simple_least_squares</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">psi</span><span class="p">)</span> <span class="o">@</span> <span class="n">psi</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="c1"># use the psi and y data created in previous examples or</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1"># create them again here to run the example.</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">simple_least_squares</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y_train</span><span class="p">[</span><span class="n">max_lag</span><span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="n">theta</span>
<a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="n">array</span><span class="p">(</span>
<a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>    <span class="p">[</span>
<a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a>       <span class="p">[</span><span class="o">-</span><span class="mf">1.08377785e-05</span><span class="p">],</span>
<a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a>       <span class="p">[</span> <span class="mf">2.00002486e-01</span><span class="p">],</span>
<a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a>       <span class="p">[</span> <span class="mf">1.73422294e-05</span><span class="p">],</span>
<a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a>       <span class="p">[</span><span class="o">-</span><span class="mf">3.50957931e-06</span><span class="p">],</span>
<a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a>       <span class="p">[</span> <span class="mf">8.99927332e-01</span><span class="p">],</span>
<a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a>       <span class="p">[</span> <span class="mf">2.04427279e-05</span><span class="p">],</span>
<a href="#__codelineno-4-20" id="__codelineno-4-20" name="__codelineno-4-20"></a>       <span class="p">[</span><span class="o">-</span><span class="mf">1.47542408e-04</span><span class="p">],</span>
<a href="#__codelineno-4-21" id="__codelineno-4-21" name="__codelineno-4-21"></a>       <span class="p">[</span> <span class="mf">1.00062340e-01</span><span class="p">],</span>
<a href="#__codelineno-4-22" id="__codelineno-4-22" name="__codelineno-4-22"></a>       <span class="p">[</span> <span class="mf">4.53379771e-05</span><span class="p">],</span>
<a href="#__codelineno-4-23" id="__codelineno-4-23" name="__codelineno-4-23"></a>       <span class="p">[</span> <span class="mf">8.90006341e-05</span><span class="p">],</span>
<a href="#__codelineno-4-24" id="__codelineno-4-24" name="__codelineno-4-24"></a>       <span class="p">[</span> <span class="mf">1.15234873e-04</span><span class="p">],</span>
<a href="#__codelineno-4-25" id="__codelineno-4-25" name="__codelineno-4-25"></a>       <span class="p">[</span> <span class="mf">1.57770755e-04</span><span class="p">],</span>
<a href="#__codelineno-4-26" id="__codelineno-4-26" name="__codelineno-4-26"></a>       <span class="p">[</span> <span class="mf">1.58414037e-04</span><span class="p">],</span>
<a href="#__codelineno-4-27" id="__codelineno-4-27" name="__codelineno-4-27"></a>       <span class="p">[</span><span class="o">-</span><span class="mf">3.09236444e-05</span><span class="p">],</span>
<a href="#__codelineno-4-28" id="__codelineno-4-28" name="__codelineno-4-28"></a>       <span class="p">[</span><span class="o">-</span><span class="mf">1.60377753e-04</span><span class="p">]</span>
<a href="#__codelineno-4-29" id="__codelineno-4-29" name="__codelineno-4-29"></a>    <span class="p">]</span>
<a href="#__codelineno-4-30" id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="p">)</span>
</code></pre></div> <p>As you can see, the estimated parameters are very close. However, be careful when using such approach in under-, well-, or over-determined systems. We recommend to use the numpy or scipy <code>lstsq</code> methods.</p> <h2 id="total-least-squares">Total Least Squares<a class="headerlink" href="#total-least-squares" title="Permanent link">¶</a></h2> <p>This section is based on the <a href="[Markovsky+VanHuffel-SP-2007.pdf (duke.edu)](https://people.duke.edu/~hpgavin/SystemID/References/Markovsky+VanHuffel-SP-2007.pdf)">Overview of total least squares methods paper</a> .</p> <p>The Total Least Squares (TLS) algorithm, is a statistical method used to find the best-fitting linear relationship between variables when both the input and output signals present white noise pertubation. Unlike ordinary least squares (OLS), which assumes that only the dependent variable is subject to error, TLS considers errors in all measured variables, providing a more robust solution in many practical applications. The algorithm was proposed by Golub and Van Loan.</p> <p>In TLS, we assume errors in both <span class="arithmatex">\(\mathbf{X}\)</span> and <span class="arithmatex">\(\mathbf{Y}\)</span>, denoted as <span class="arithmatex">\(\Delta \mathbf{X}\)</span> and <span class="arithmatex">\(\Delta \mathbf{Y}\)</span>, respectively. The true model becomes:</p> <div class="arithmatex">\[ \mathbf{Y} + \Delta \mathbf{Y} = (\mathbf{X} + \Delta \mathbf{X}) \mathbf{B} \tag{3.11} \]</div> <p>Rearranging, we get:</p> <div class="arithmatex">\[ \Delta \mathbf{Y} = \Delta \mathbf{X} \mathbf{B} \tag{3.12} \]</div> <h3 id="objective-function">Objective Function<a class="headerlink" href="#objective-function" title="Permanent link">¶</a></h3> <p>The TLS solution minimizes the Frobenius norm of the total perturbations in <span class="arithmatex">\(\mathbf{X}\)</span> and <span class="arithmatex">\(\mathbf{Y}\)</span>:</p> <div class="arithmatex">\[ \min_{\Delta \mathbf{X}, \Delta \mathbf{Y}} \|[\Delta \mathbf{X}, \Delta \mathbf{Y}]\|_F \tag{3.13} \]</div> <p>subject to:</p> <div class="arithmatex">\[ (\mathbf{X} + \Delta \mathbf{X}) \mathbf{B} = \mathbf{Y} + \Delta \mathbf{Y} \tag{3.14} \]</div> <p>where <span class="arithmatex">\(\| \cdot \|_F\)</span> denotes the Frobenius norm.</p> <h3 id="classical-solution">Classical Solution<a class="headerlink" href="#classical-solution" title="Permanent link">¶</a></h3> <p>The classical approach to solve the TLS problem is by using Singular Value Decomposition (SVD). The augmented matrix <span class="arithmatex">\([\mathbf{X}, \mathbf{Y}]\)</span> is decomposed as:</p> <div class="arithmatex">\[ [\mathbf{X}, \mathbf{Y}] = \mathbf{U} \mathbf{\Sigma} \mathbf{V}^T \tag{3.15} \]</div> <p>where <span class="arithmatex">\(\mathbf{U}\)</span> is an <span class="arithmatex">\(n \times n\)</span> orthogonal matrix, <span class="arithmatex">\(\Sigma=\operatorname{diag}\left(\sigma_1, \ldots, \sigma_{n+d}\right)\)</span> is a diagonal matrix of singular values; and <span class="arithmatex">\(\mathbf{V}\)</span> is an orthogonal matrix defined as</p> <div class="arithmatex">\[ V:=\left[\begin{array}{cc} V_{11} &amp; V_{12} \\ V_{21} &amp; V_{22} \end{array}\right] \quad \begin{aligned} \end{aligned} \quad \text { and } \quad \Sigma:=\left[\begin{array}{cc} \Sigma_1 &amp; 0 \\ 0 &amp; \Sigma_2 \end{array}\right] \begin{gathered} \end{gathered} . \tag{3.16} \]</div> <p>A total least squares solution exists if and only if <span class="arithmatex">\(V_{22}\)</span> is non-singular. In addition, it is unique if and only if <span class="arithmatex">\(\sigma_n \neq \sigma_{n+1}\)</span>. In the case when the total least squares solution exists and is unique, it is given by</p> <div class="arithmatex">\[ \widehat{X}_{\mathrm{tls}}=-V_{12} V_{22}^{-1} \tag{3.17} \]</div> <p>and the corresponding total least squares correction matrix is</p> <div class="arithmatex">\[ \Delta C_{\mathrm{tls}}:=\left[\begin{array}{ll} \Delta A_{\mathrm{tls}} &amp; \Delta B_{\mathrm{tls}} \end{array}\right]=-U \operatorname{diag}\left(0, \Sigma_2\right) V^{\top} . \tag{3.18} \]</div> <p>This is implemented in SysIdentPy as follows:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="sd">"""Estimate the model parameters using Total Least Squares method.</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="sd">    Parameters</span>
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="sd">    ----------</span>
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="sd">    psi : ndarray of floats</span>
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="sd">        The information matrix of the model.</span>
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="sd">    y : array-like of shape = y_training</span>
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="sd">        The data used to training the model.</span>
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a>
<a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="sd">    Returns</span>
<a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="sd">    -------</span>
<a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="sd">    theta : array-like of shape = number_of_model_elements</span>
<a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="sd">        The estimated parameters of the model.</span>
<a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a>
<a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="sd">    """</span>
<a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_check_linear_dependence_rows</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a>    <span class="n">full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<a href="#__codelineno-5-19" id="__codelineno-5-19" name="__codelineno-5-19"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a href="#__codelineno-5-20" id="__codelineno-5-20" name="__codelineno-5-20"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">full</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-5-21" id="__codelineno-5-21" name="__codelineno-5-21"></a>    <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">:]</span> <span class="o">/</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="p">:,</span> <span class="n">n</span><span class="p">:]</span>
<a href="#__codelineno-5-22" id="__codelineno-5-22" name="__codelineno-5-22"></a>    <span class="k">return</span> <span class="n">theta</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div> <p>To use it in the modeling task, just import it like we did in the Least Squares example.</p> <p>From now on the examples will not include the Model Structure Selection step. The goal here is to focus on the parameter estimation methods. However, we already provided an example including MSS in the Least Squares section, so you will not have any problem to test that with other parameter estimation algorithms.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.generate_data</span> <span class="kn">import</span> <span class="n">get_siso_data</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">TotalLeastSquares</span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.narmax_base</span> <span class="kn">import</span> <span class="n">InformationMatrix</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="p">)</span>
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="n">regressor_matrix</span> <span class="o">=</span> <span class="n">InformationMatrix</span><span class="p">(</span><span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build_input_output_matrix</span><span class="p">(</span>
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a>    <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span>
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="p">)</span>
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="n">max_lag</span> <span class="o">=</span> <span class="mi">2</span>
<a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="c1"># apply the basis function</span>
<a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="n">psi</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">regressor_matrix</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">)</span>
<a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">TotalLeastSquares</span><span class="p">()</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y_train</span><span class="p">[</span><span class="n">max_lag</span><span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="n">theta</span>
<a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a>
<a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="n">array</span><span class="p">([</span>
<a href="#__codelineno-6-21" id="__codelineno-6-21" name="__codelineno-6-21"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">4.29547026e-05</span><span class="p">],</span>
<a href="#__codelineno-6-22" id="__codelineno-6-22" name="__codelineno-6-22"></a>   <span class="p">[</span> <span class="mf">2.00085880e-01</span><span class="p">],</span>
<a href="#__codelineno-6-23" id="__codelineno-6-23" name="__codelineno-6-23"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">5.20210280e-05</span><span class="p">],</span>
<a href="#__codelineno-6-24" id="__codelineno-6-24" name="__codelineno-6-24"></a>   <span class="p">[</span> <span class="mf">4.03019271e-05</span><span class="p">],</span>
<a href="#__codelineno-6-25" id="__codelineno-6-25" name="__codelineno-6-25"></a>   <span class="p">[</span> <span class="mf">8.99982943e-01</span><span class="p">],</span>
<a href="#__codelineno-6-26" id="__codelineno-6-26" name="__codelineno-6-26"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">1.49492072e-05</span><span class="p">],</span>
<a href="#__codelineno-6-27" id="__codelineno-6-27" name="__codelineno-6-27"></a>   <span class="p">[</span> <span class="mf">9.72399351e-05</span><span class="p">],</span>
<a href="#__codelineno-6-28" id="__codelineno-6-28" name="__codelineno-6-28"></a>   <span class="p">[</span> <span class="mf">1.00072619e-01</span><span class="p">],</span>
<a href="#__codelineno-6-29" id="__codelineno-6-29" name="__codelineno-6-29"></a>   <span class="p">[</span> <span class="mf">7.25253323e-05</span><span class="p">],</span>
<a href="#__codelineno-6-30" id="__codelineno-6-30" name="__codelineno-6-30"></a>   <span class="p">[</span><span class="o">-</span><span class="mf">1.37338363e-04</span><span class="p">],</span>
<a href="#__codelineno-6-31" id="__codelineno-6-31" name="__codelineno-6-31"></a>   <span class="p">[</span> <span class="mf">1.37115512e-04</span><span class="p">],</span>
<a href="#__codelineno-6-32" id="__codelineno-6-32" name="__codelineno-6-32"></a>   <span class="p">[</span> <span class="mf">2.42269843e-04</span><span class="p">],</span>
<a href="#__codelineno-6-33" id="__codelineno-6-33" name="__codelineno-6-33"></a>   <span class="p">[</span> <span class="mf">1.20466767e-04</span><span class="p">],</span>
<a href="#__codelineno-6-34" id="__codelineno-6-34" name="__codelineno-6-34"></a>   <span class="p">[</span> <span class="mf">6.32937185e-05</span><span class="p">],</span>
<a href="#__codelineno-6-35" id="__codelineno-6-35" name="__codelineno-6-35"></a>   <span class="p">[</span> <span class="mf">1.36101591e-04</span><span class="p">]])</span>
</code></pre></div> <h2 id="recursive-least-squares">Recursive Least Squares<a class="headerlink" href="#recursive-least-squares" title="Permanent link">¶</a></h2> <p>Consider the regression model</p> <div class="arithmatex">\[ y_k = \mathbf{\Psi}_k^T \theta_k + \epsilon_k \tag{3.19}\]</div> <p>where: - <span class="arithmatex">\(y_k\)</span> is the observed output at time $ k $. - <span class="arithmatex">\(\mathbf{\Psi}_k\)</span> is the information matrix at time <span class="arithmatex">\(k\)</span>. - <span class="arithmatex">\(\theta_k\)</span> is the parameter vector to be estimated at time <span class="arithmatex">\(k\)</span>. - <span class="arithmatex">\(\epsilon_k\)</span> is the noise at time <span class="arithmatex">\(k\)</span>.</p> <p>The Recursive Least Squares (RLS) algorithm updates the parameter estimate <span class="arithmatex">\(\theta_k\)</span> recursively as new data points <span class="arithmatex">\((\mathbf{x}_k, y_k)\)</span> become available, minimizing a weighted linear least squares cost function relating to the information matrix in a sequencial manner. RLS is particularly useful in real-time applications where the data arrives sequentially and the model needs continuous updating or for modeling time varying systems (if the forgetting factor is included).</p> <p>Because its a recursive estimation, it is useful to relate <span class="arithmatex">\(\hat{\Theta}_k\)</span> to <span class="arithmatex">\(\hat{\Theta}_{k-1}\)</span>. In other words, the new <span class="arithmatex">\(\hat{\Theta}_k\)</span> depends on the last estimated value (k). Moreover, to estimate <span class="arithmatex">\(\hat{\Theta}_k\)</span>, we need to incorporate the current information present in <span class="arithmatex">\(y_k\)</span>.</p> <p>Aguirre BOOK defines the Recursive Least Squares estimator with forgetting factor <span class="arithmatex">\(\lambda\)</span> as</p> <div class="arithmatex">\[ \left\{\begin{array}{c} K_k= Q_k\psi_k = \frac{P_{k-1} \psi_k}{\psi_k^{\mathrm{T}} P_{k-1} \psi_k+\lambda} \\ \hat{\theta}_k=\hat{\theta}_{k-1}+K_k\left[y(k)-\psi_k^{\mathrm{T}} \hat{\theta}_{k-1}\right] \\ P_k=\frac{1}{\lambda}\left(P_{k-1}-\frac{P_{k-1} \psi_k \psi_k^{\mathrm{T}} P_{k-1}}{\psi_k^{\mathrm{T}} P_{k-1} \psi_k+\lambda}\right) \end{array}\right. \tag{3.20} \]</div> <p>where <span class="arithmatex">\(K_k\)</span> is the gain vector calculation (also known as Kalman gain), <span class="arithmatex">\(P_k\)</span> is the covariance matrix update, and <span class="arithmatex">\(y_k - \mathbf{\Psi}_k^T \theta_{k-1}\)</span> is the a priori estimation error. The forgetting factor <span class="arithmatex">\(\lambda\)</span> (<span class="arithmatex">\(0 &lt; \lambda \leq 1\)</span>) is usually defined between <span class="arithmatex">\(0.94\)</span> and <span class="arithmatex">\(0.99\)</span>. If you set <span class="arithmatex">\(\lambda = 1\)</span> you will be using the traditional recursive algorithm. The equation above consider that the regressor vector <span class="arithmatex">\(\psi(k-1)\)</span> has been rewritten as <span class="arithmatex">\(\psi_k\)</span>, since this vector is updated at iteration <span class="arithmatex">\(k\)</span> and contains information up to time instant <span class="arithmatex">\(k-1\)</span>. We can Initialize the parameter estimate <span class="arithmatex">\(\theta_0\)</span> as</p> <div class="arithmatex">\[ \theta_0 = \mathbf{0} \tag{3.21}\]</div> <p>and Initialize the inverse of the covariance matrix <span class="arithmatex">\(\mathbf{P}_0\)</span> with a large value:</p> <div class="arithmatex">\[ \mathbf{P}_0 = \frac{\mathbf{I}}{\delta} \tag{3.22}\]</div> <p>where <span class="arithmatex">\(\delta\)</span> is a small positive constant, and <span class="arithmatex">\(\mathbf{I}\)</span> is the identity matrix.</p> <p>The forgetting factor <span class="arithmatex">\(\lambda\)</span> controls how quickly the algorithm forgets past data: - <span class="arithmatex">\(\lambda = 1\)</span> means no forgetting, and all past data are equally weighted. - <span class="arithmatex">\(\lambda &lt; 1\)</span> means that when new data is available, all weights are multiplied by <span class="arithmatex">\(\lambda\)</span>, which can be interpreted as the ratio between consecutive weights for the same data.</p> <p>You can access the source code to check how SysIdentPy implements the RLS algorithm. The following example present how you can use it in SysIdentPy.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.generate_data</span> <span class="kn">import</span> <span class="n">get_siso_data</span>
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">RecursiveLeastSquares</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.narmax_base</span> <span class="kn">import</span> <span class="n">InformationMatrix</span>
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="p">)</span>
<a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a>
<a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="n">regressor_matrix</span> <span class="o">=</span> <span class="n">InformationMatrix</span><span class="p">(</span><span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build_input_output_matrix</span><span class="p">(</span>
<a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a>    <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span>
<a href="#__codelineno-7-14" id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="p">)</span>
<a href="#__codelineno-7-15" id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="n">max_lag</span> <span class="o">=</span> <span class="mi">2</span>
<a href="#__codelineno-7-16" id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="n">psi</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">regressor_matrix</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">)</span>
<a href="#__codelineno-7-17" id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">RecursiveLeastSquares</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
<a href="#__codelineno-7-18" id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y_train</span><span class="p">[</span><span class="n">max_lag</span><span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-7-19" id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="n">theta</span>
<a href="#__codelineno-7-20" id="__codelineno-7-20" name="__codelineno-7-20"></a>
<a href="#__codelineno-7-21" id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="n">array</span><span class="p">(</span>
<a href="#__codelineno-7-22" id="__codelineno-7-22" name="__codelineno-7-22"></a>  <span class="p">[</span>
<a href="#__codelineno-7-23" id="__codelineno-7-23" name="__codelineno-7-23"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">1.42674741e-04</span><span class="p">],</span>
<a href="#__codelineno-7-24" id="__codelineno-7-24" name="__codelineno-7-24"></a>  <span class="p">[</span> <span class="mf">2.00108231e-01</span><span class="p">],</span>
<a href="#__codelineno-7-25" id="__codelineno-7-25" name="__codelineno-7-25"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">7.15658788e-05</span><span class="p">],</span>
<a href="#__codelineno-7-26" id="__codelineno-7-26" name="__codelineno-7-26"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">2.63118243e-05</span><span class="p">],</span>
<a href="#__codelineno-7-27" id="__codelineno-7-27" name="__codelineno-7-27"></a>  <span class="p">[</span> <span class="mf">9.00023979e-01</span><span class="p">],</span>
<a href="#__codelineno-7-28" id="__codelineno-7-28" name="__codelineno-7-28"></a>  <span class="p">[</span> <span class="mf">3.38729072e-04</span><span class="p">],</span>
<a href="#__codelineno-7-29" id="__codelineno-7-29" name="__codelineno-7-29"></a>  <span class="p">[</span> <span class="mf">8.22835678e-07</span><span class="p">],</span>
<a href="#__codelineno-7-30" id="__codelineno-7-30" name="__codelineno-7-30"></a>  <span class="p">[</span> <span class="mf">9.95974120e-02</span><span class="p">],</span>
<a href="#__codelineno-7-31" id="__codelineno-7-31" name="__codelineno-7-31"></a>  <span class="p">[</span> <span class="mf">8.52966331e-05</span><span class="p">],</span>
<a href="#__codelineno-7-32" id="__codelineno-7-32" name="__codelineno-7-32"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">1.47007370e-04</span><span class="p">],</span>
<a href="#__codelineno-7-33" id="__codelineno-7-33" name="__codelineno-7-33"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">4.65885373e-04</span><span class="p">],</span>
<a href="#__codelineno-7-34" id="__codelineno-7-34" name="__codelineno-7-34"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">2.57612698e-04</span><span class="p">],</span>
<a href="#__codelineno-7-35" id="__codelineno-7-35" name="__codelineno-7-35"></a>  <span class="p">[</span><span class="o">-</span><span class="mf">2.61078457e-04</span><span class="p">],</span>
<a href="#__codelineno-7-36" id="__codelineno-7-36" name="__codelineno-7-36"></a>  <span class="p">[</span> <span class="mf">4.78599408e-04</span><span class="p">],</span>
<a href="#__codelineno-7-37" id="__codelineno-7-37" name="__codelineno-7-37"></a>  <span class="p">[</span> <span class="mf">3.50698606e-04</span><span class="p">]</span>
<a href="#__codelineno-7-38" id="__codelineno-7-38" name="__codelineno-7-38"></a>  <span class="p">]</span>
<a href="#__codelineno-7-39" id="__codelineno-7-39" name="__codelineno-7-39"></a>  <span class="p">)</span>
</code></pre></div> <p>You can plot the evolution of the estimated parameters over time by accessing the <code>theta_evolution</code> values <div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># plotting only the first 50 values</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">theta_evolution</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="p">:])</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"iterations"</span><span class="p">)</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"theta"</span><span class="p">)</span>
</code></pre></div> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/theta_evolution.png"><img alt="" src="../assets/theta_evolution.png"/></a></p> <blockquote> <p>Figure 1. Evolution of the estimated parameters over time using the RLS algorithm.</p> </blockquote> <h2 id="least-mean-squares">Least Mean Squares<a class="headerlink" href="#least-mean-squares" title="Permanent link">¶</a></h2> <p>The Least Mean Squares (LMS) adaptive filter is a popular stochastic gradient algorithm developed by Widrow and Hoff in 1960. The LMS adaptive filter aims to adaptively change its filter coefficients to achieve the best possible filtering of a signal. This is done by minimizing the error between the desired signal <span class="arithmatex">\(d(n)\)</span> and the filter output <span class="arithmatex">\(y(n)\)</span>. We can derive the LMS algorithm from the RLS formulation.</p> <p>In RLS, the <span class="arithmatex">\(\lambda\)</span> is related to the minimization of the sum of weighted squares of the innovation</p> <div class="arithmatex">\[ J_k = \sum^k_{j=1}\lambda^{k-j}e^2_j. \tag{3.23} \]</div> <p>The <span class="arithmatex">\(Q_k\)</span> in Equation 3.20, defined as</p> <div class="arithmatex">\[ Q_k = \frac{P_{k-1}}{\psi_k^{\mathrm{T}} P_{k-1} \psi_k+\lambda} \\ \tag{3.24} \]</div> <p>is derived from the general form the Kalman Filter (KF) algorithm.</p> <div class="arithmatex">\[ Q_k = \frac{P_{k-1}}{\psi_k^{\mathrm{T}} P_{k-1} \psi_k+v_0} \\ \tag{3.25} \]</div> <p>where <span class="arithmatex">\(v_0\)</span> is the variance of the noise in the definition of the KF, in which the cost function is defined as the sum of squares of the innovation (noise). You can check the details in the <a href="[Nonlinear System Identification: NARMAX Methods in the Time, Frequency, and Spatio-Temporal Domains](https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594)">Billings, S. A. book</a></p> <p>If we change <span class="arithmatex">\(Q_k\)</span> in Equation 3.25 to scaled identity matrix</p> <div class="arithmatex">\[ Q_k = \frac{\mu}{\Vert \psi_k \Vert^2}I \tag{3.26} \]</div> <p>where <span class="arithmatex">\(\mu \in \mathbb{R}^+\)</span>, the <span class="arithmatex">\(Q_k\)</span> and <span class="arithmatex">\(\hat{\theta}_k\)</span> in Equation 3.20 becomes</p> <div class="arithmatex">\[ \hat{\theta}_k=\hat{\theta}_{k-1}+\frac{\mu\left[y(k)-\psi_k^{\mathrm{T}} \hat{\theta}_{k-1}\right]}{\Vert \psi_k \Vert^2}\psi_k \tag{3.27} \]</div> <p>where <span class="arithmatex">\(\psi_k^{\mathrm{T}} \hat{\theta}_{k-1} = \hat{y}_k\)</span>, which is known as the LMS algorithm.</p> <h4 id="convergence-and-step-size">Convergence and Step-Size<a class="headerlink" href="#convergence-and-step-size" title="Permanent link">¶</a></h4> <p>The step-size parameter <span class="arithmatex">\(\mu\)</span> plays a crucial role in the performance of the LMS algorithm. If <span class="arithmatex">\(\mu\)</span> is too large, the algorithm may become unstable and fail to converge. If <span class="arithmatex">\(\mu\)</span> is too small, the algorithm will converge slowly. The choice of <span class="arithmatex">\(\mu\)</span> is typically:</p> <div class="arithmatex">\[ 0 &lt; \mu &lt; \frac{2}{\lambda_{\max}} \tag{3.28} \]</div> <p>where <span class="arithmatex">\(\lambda_{\max}\)</span> is the largest eigenvalue of the input signal’s autocorrelation matrix.</p> <p>In SysIdentPy, you can use several variants of the LMS algorithm:</p> <ol> <li><strong>LeastMeanSquareMixedNorm</strong></li> <li><strong>LeastMeanSquares</strong></li> <li><strong>LeastMeanSquaresFourth</strong></li> <li><strong>LeastMeanSquaresLeaky</strong></li> <li><strong>LeastMeanSquaresNormalizedLeaky</strong></li> <li><strong>LeastMeanSquaresNormalizedSignRegressor</strong></li> <li><strong>LeastMeanSquaresNormalizedSignSign</strong></li> <li><strong>LeastMeanSquaresSignError</strong></li> <li><strong>LeastMeanSquaresSignSign</strong></li> <li><strong>AffineLeastMeanSquares</strong></li> <li><strong>NormalizedLeastMeanSquares</strong></li> <li><strong>NormalizedLeastMeanSquaresSignError</strong></li> <li><strong>LeastMeanSquaresSignRegressor</strong></li> </ol> <p>To use any one on the methods above, you just need to import it and set the <code>estimator</code> using the option you want:</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.generate_data</span> <span class="kn">import</span> <span class="n">get_siso_data</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastMeanSquares</span>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.narmax_base</span> <span class="kn">import</span> <span class="n">InformationMatrix</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="p">)</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="n">regressor_matrix</span> <span class="o">=</span> <span class="n">InformationMatrix</span><span class="p">(</span><span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build_input_output_matrix</span><span class="p">(</span>
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>    <span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="p">)</span>
<a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="n">max_lag</span> <span class="o">=</span> <span class="mi">2</span>
<a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="n">psi</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">regressor_matrix</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">)</span>
<a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">LeastMeanSquares</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">y_train</span><span class="p">[</span><span class="n">max_lag</span><span class="p">:,</span> <span class="p">:])</span>
<a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="n">theta</span>
<a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a>
<a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="n">array</span><span class="p">([[</span> <span class="mf">7.53481862e-05</span><span class="p">],</span>
<a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a>      <span class="p">[</span> <span class="mf">2.00336327e-01</span><span class="p">],</span>
<a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a>      <span class="p">[</span> <span class="mf">4.03075867e-04</span><span class="p">],</span>
<a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a>      <span class="p">[</span> <span class="mf">5.16401623e-05</span><span class="p">],</span>
<a href="#__codelineno-9-25" id="__codelineno-9-25" name="__codelineno-9-25"></a>      <span class="p">[</span> <span class="mf">8.99539417e-01</span><span class="p">],</span>
<a href="#__codelineno-9-26" id="__codelineno-9-26" name="__codelineno-9-26"></a>      <span class="p">[</span><span class="o">-</span><span class="mf">6.38551780e-04</span><span class="p">],</span>
<a href="#__codelineno-9-27" id="__codelineno-9-27" name="__codelineno-9-27"></a>      <span class="p">[</span><span class="o">-</span><span class="mf">5.68962465e-05</span><span class="p">],</span>
<a href="#__codelineno-9-28" id="__codelineno-9-28" name="__codelineno-9-28"></a>      <span class="p">[</span> <span class="mf">1.00643282e-01</span><span class="p">],</span>
<a href="#__codelineno-9-29" id="__codelineno-9-29" name="__codelineno-9-29"></a>      <span class="p">[</span> <span class="mf">5.48097106e-04</span><span class="p">],</span>
<a href="#__codelineno-9-30" id="__codelineno-9-30" name="__codelineno-9-30"></a>      <span class="p">[</span> <span class="mf">5.15983109e-04</span><span class="p">],</span>
<a href="#__codelineno-9-31" id="__codelineno-9-31" name="__codelineno-9-31"></a>      <span class="p">[</span> <span class="mf">5.46693676e-04</span><span class="p">],</span>
<a href="#__codelineno-9-32" id="__codelineno-9-32" name="__codelineno-9-32"></a>      <span class="p">[</span><span class="o">-</span><span class="mf">3.18759644e-04</span><span class="p">],</span>
<a href="#__codelineno-9-33" id="__codelineno-9-33" name="__codelineno-9-33"></a>      <span class="p">[</span><span class="o">-</span><span class="mf">4.90420481e-04</span><span class="p">],</span>
<a href="#__codelineno-9-34" id="__codelineno-9-34" name="__codelineno-9-34"></a>      <span class="p">[</span> <span class="mf">4.09662242e-04</span><span class="p">],</span>
<a href="#__codelineno-9-35" id="__codelineno-9-35" name="__codelineno-9-35"></a>      <span class="p">[</span> <span class="mf">5.39826714e-04</span><span class="p">]])</span>
</code></pre></div> <h2 id="extended-least-squares-algorithm">Extended Least Squares Algorithm<a class="headerlink" href="#extended-least-squares-algorithm" title="Permanent link">¶</a></h2> <p>Let's show an example of the effect of a biased parameter estimation. To make things simple,The data is generated by simulating the following model:</p> <div class="arithmatex">\[ y_k = 0.2y_{k-1} + 0.1y_{k-1}x_{k-1} + 0.9x_{k-2} + e_{k} \]</div> <p>In this case, we know the values of the true parameters, so it will be easier to understand how they are affected by a biased estimation. The data is generated using a method from SysIdentPy. If <em>colored_noise</em> is set to True in the method, a colored noise is added to the data:</p> <div class="arithmatex">\[e_{k} = 0.8\nu_{k-1} + \nu_{k}\]</div> <p>where <span class="arithmatex">\(x\)</span> is a uniformly distributed random variable and <span class="arithmatex">\(\nu\)</span> is a gaussian distributed variable with <span class="arithmatex">\(\mu=0\)</span> and <span class="arithmatex">\(\sigma\)</span> is defined by the user.</p> <p>We will generate a data with 1000 samples with white noise and selecting 90% of the data to train the model.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">x_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="p">)</span>
</code></pre></div> <p>First we will train a model without the Extended Least Squares Algorithm for comparison purpose.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="kn">from</span> <span class="nn">sysidentpy.model_structure_selection</span> <span class="kn">import</span> <span class="n">FROLS</span>
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="kn">from</span> <span class="nn">sysidentpy.basis_function._basis_function</span> <span class="kn">import</span> <span class="n">Polynomial</span>
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="kn">from</span> <span class="nn">sysidentpy.parameter_estimation</span> <span class="kn">import</span> <span class="n">LeastSquares</span>
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.generate_data</span> <span class="kn">import</span> <span class="n">get_siso_data</span>
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="kn">from</span> <span class="nn">sysidentpy.utils.display_results</span> <span class="kn">import</span> <span class="n">results</span>
<a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a>
<a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-11-12" id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">(</span><span class="n">unbiased</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="#__codelineno-11-13" id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-11-14" id="__codelineno-11-14" name="__codelineno-11-14"></a>    <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a href="#__codelineno-11-15" id="__codelineno-11-15" name="__codelineno-11-15"></a>    <span class="n">n_terms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-11-16" id="__codelineno-11-16" name="__codelineno-11-16"></a>    <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-11-17" id="__codelineno-11-17" name="__codelineno-11-17"></a>    <span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-11-18" id="__codelineno-11-18" name="__codelineno-11-18"></a>    <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-11-19" id="__codelineno-11-19" name="__codelineno-11-19"></a>    <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a href="#__codelineno-11-20" id="__codelineno-11-20" name="__codelineno-11-20"></a>    <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-11-21" id="__codelineno-11-21" name="__codelineno-11-21"></a>    <span class="n">err_tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a href="#__codelineno-11-22" id="__codelineno-11-22" name="__codelineno-11-22"></a><span class="p">)</span>
<a href="#__codelineno-11-23" id="__codelineno-11-23" name="__codelineno-11-23"></a>
<a href="#__codelineno-11-24" id="__codelineno-11-24" name="__codelineno-11-24"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-11-25" id="__codelineno-11-25" name="__codelineno-11-25"></a><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_valid</span><span class="p">)</span>
<a href="#__codelineno-11-26" id="__codelineno-11-26" name="__codelineno-11-26"></a><span class="n">rrse</span> <span class="o">=</span> <span class="n">root_relative_squared_error</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
<a href="#__codelineno-11-27" id="__codelineno-11-27" name="__codelineno-11-27"></a>
<a href="#__codelineno-11-28" id="__codelineno-11-28" name="__codelineno-11-28"></a><span class="n">r</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a href="#__codelineno-11-29" id="__codelineno-11-29" name="__codelineno-11-29"></a>    <span class="n">results</span><span class="p">(</span>
<a href="#__codelineno-11-30" id="__codelineno-11-30" name="__codelineno-11-30"></a>        <span class="n">model</span><span class="o">.</span><span class="n">final_model</span><span class="p">,</span>
<a href="#__codelineno-11-31" id="__codelineno-11-31" name="__codelineno-11-31"></a>        <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span>
<a href="#__codelineno-11-32" id="__codelineno-11-32" name="__codelineno-11-32"></a>        <span class="n">model</span><span class="o">.</span><span class="n">err</span><span class="p">,</span>
<a href="#__codelineno-11-33" id="__codelineno-11-33" name="__codelineno-11-33"></a>        <span class="n">model</span><span class="o">.</span><span class="n">n_terms</span><span class="p">,</span>
<a href="#__codelineno-11-34" id="__codelineno-11-34" name="__codelineno-11-34"></a>        <span class="n">err_precision</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a href="#__codelineno-11-35" id="__codelineno-11-35" name="__codelineno-11-35"></a>        <span class="n">dtype</span><span class="o">=</span><span class="s2">"sci"</span><span class="p">,</span>
<a href="#__codelineno-11-36" id="__codelineno-11-36" name="__codelineno-11-36"></a>    <span class="p">),</span>
<a href="#__codelineno-11-37" id="__codelineno-11-37" name="__codelineno-11-37"></a>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Regressors"</span><span class="p">,</span> <span class="s2">"Parameters"</span><span class="p">,</span> <span class="s2">"ERR"</span><span class="p">],</span>
<a href="#__codelineno-11-38" id="__codelineno-11-38" name="__codelineno-11-38"></a><span class="p">)</span>
<a href="#__codelineno-11-39" id="__codelineno-11-39" name="__codelineno-11-39"></a>
<a href="#__codelineno-11-40" id="__codelineno-11-40" name="__codelineno-11-40"></a><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.0442E-01</td> <td>7.55518391E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.7405E-01</td> <td>7.57565084E-02</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>9.8757E-02</td> <td>3.12896171E-03</td> </tr> </tbody> </table> <p>Clearly we have something wrong with the obtained model. The estimated parameters differs from the true one defined in the equation that generated the data. As we can observe above, the model structure is exact the same the one that generate the data. You can se that the ERR ordered the terms in the correct way. And this is an important note regarding the ERR algorithm: <strong>it is very robust to colored noise!!</strong></p> <p>That is a great feature! However, although the structure is correct, the model <em>parameters</em> are not correct! Here we have a biased estimation! For instance, the real parameter for <span class="arithmatex">\(y_{k-1}\)</span> is <span class="arithmatex">\(0.2\)</span>, not <span class="arithmatex">\(0.274\)</span>.</p> <p>In this case, we are actually modeling using a NARX model, not a NARMAX. The MA part exists to allow a unbiased estimation of the parameters. To achieve a unbiased estimation of the parameters we have the Extend Least Squares algorithm.</p> <p>Before applying the Extended Least Squares Algorithm we will run several NARX models to check how different the estimated parameters are from the real ones.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>    <span class="n">x_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>        <span class="n">n</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>    <span class="p">)</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a>    <span class="n">parameters</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a>
<a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="c1"># Set the theme for seaborn (optional)</span>
<a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>
<a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="c1"># Plot KDE for each parameter</span>
<a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Parameter 1'</span><span class="p">)</span>
<a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Parameter 2'</span><span class="p">)</span>
<a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Parameter 3'</span><span class="p">)</span>
<a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="c1"># Plot vertical lines where the real values must lie</span>
<a href="#__codelineno-12-17" id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Real Value 0.1'</span><span class="p">)</span>
<a href="#__codelineno-12-18" id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Real Value 0.2'</span><span class="p">)</span>
<a href="#__codelineno-12-19" id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Real Value 0.9'</span><span class="p">)</span>
<a href="#__codelineno-12-20" id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Parameter Value'</span><span class="p">)</span>
<a href="#__codelineno-12-21" id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
<a href="#__codelineno-12-22" id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Kernel Density Estimate of Parameters'</span><span class="p">)</span>
<a href="#__codelineno-12-23" id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-12-24" id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/biased_parameter.png"><img alt="" src="../assets/biased_parameter.png"/></a></p> <blockquote> <p>Figure 2.: Kernel Density Estimates (KDEs) of the estimated parameters obtained from 50 NARX models realizations, each fitted to data with colored noise. The vertical dashed lines indicate the true parameter values used to generate the data. While the model structure is correctly identified, the estimated parameters are biased due to the omission of the Moving Average (MA) component, highlighting the need for the Extended Least Squares algorithm to achieve unbiased parameter estimation</p> </blockquote> <p>As shown in figure above, we have a problem to estimate the parameter for <span class="arithmatex">\(y_{k-1}\)</span>. Now we will use the Extended Least Squares Algorithm. In SysIdentPy, just set <code>unbiased=True</code> in the parameter estimation definition and the ELS algorithm will be applied.</p> <div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">basis_function</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">estimator</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">(</span><span class="n">unbiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="n">parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>    <span class="n">x_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">get_siso_data</span><span class="p">(</span>
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a>        <span class="n">n</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">colored_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train_percentage</span><span class="o">=</span><span class="mi">90</span>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a>    <span class="p">)</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">FROLS</span><span class="p">(</span>
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a>        <span class="n">order_selection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>        <span class="n">n_terms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a>        <span class="n">ylag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a>        <span class="n">xlag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a>        <span class="n">elag</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a>        <span class="n">info_criteria</span><span class="o">=</span><span class="s2">"aic"</span><span class="p">,</span>
<a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a>        <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a>        <span class="n">basis_function</span><span class="o">=</span><span class="n">basis_function</span><span class="p">,</span>
<a href="#__codelineno-13-17" id="__codelineno-13-17" name="__codelineno-13-17"></a>    <span class="p">)</span>
<a href="#__codelineno-13-18" id="__codelineno-13-18" name="__codelineno-13-18"></a>
<a href="#__codelineno-13-19" id="__codelineno-13-19" name="__codelineno-13-19"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a href="#__codelineno-13-20" id="__codelineno-13-20" name="__codelineno-13-20"></a>    <span class="n">parameters</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<a href="#__codelineno-13-21" id="__codelineno-13-21" name="__codelineno-13-21"></a>
<a href="#__codelineno-13-22" id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a href="#__codelineno-13-23" id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="c1"># Plot KDE for each parameter</span>
<a href="#__codelineno-13-24" id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Parameter 1'</span><span class="p">)</span>
<a href="#__codelineno-13-25" id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Parameter 2'</span><span class="p">)</span>
<a href="#__codelineno-13-26" id="__codelineno-13-26" name="__codelineno-13-26"></a><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Parameter 3'</span><span class="p">)</span>
<a href="#__codelineno-13-27" id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="c1"># Plot vertical lines where the real values must lie</span>
<a href="#__codelineno-13-28" id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Real Value 0.1'</span><span class="p">)</span>
<a href="#__codelineno-13-29" id="__codelineno-13-29" name="__codelineno-13-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Real Value 0.2'</span><span class="p">)</span>
<a href="#__codelineno-13-30" id="__codelineno-13-30" name="__codelineno-13-30"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Real Value 0.9'</span><span class="p">)</span>
<a href="#__codelineno-13-31" id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Parameter Value'</span><span class="p">)</span>
<a href="#__codelineno-13-32" id="__codelineno-13-32" name="__codelineno-13-32"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">)</span>
<a href="#__codelineno-13-33" id="__codelineno-13-33" name="__codelineno-13-33"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Kernel Density Estimate of Parameters'</span><span class="p">)</span>
<a href="#__codelineno-13-34" id="__codelineno-13-34" name="__codelineno-13-34"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a href="#__codelineno-13-35" id="__codelineno-13-35" name="__codelineno-13-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div> <p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../assets/unbiased_estimator.png"><img alt="" src="../assets/unbiased_estimator.png"/></a></p> <blockquote> <p>Figure 3. Kernel Density Estimates (KDEs) of the estimated parameters obtained from 50 NARX models using the Extended Least Squares (ELS) algorithm with unbiased estimation. The vertical dashed lines indicate the true parameter values used to generate the data.</p> </blockquote> <p>Unlike the previous biased estimation, these KDEs in Figure 3 show that the estimated parameters are now closely aligned with the true values, demonstrating the effectiveness of the ELS algorithm in achieving unbiased parameter estimation, even in the presence of colored noise.</p> <blockquote> <p>The Extended Least Squares algorithm is iterative by nature. In SysIdentPy, the default number of iterations is set to 30 (<code>uiter=30</code>). However, the <a href="https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas">literature</a> suggests that the algorithm typically converges quickly, often within 10 to 20 iterations. Therefore, you may want to test different numbers of iterations to find the optimal balance between convergence speed and computational efficiency.</p> </blockquote> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: 2. NARMAX Model Representation" class="md-footer__link md-footer__link--prev" href="../2%20-%20NARMAX%20Model%20Representation/"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> 2. NARMAX Model Representation </div> </div> </a> <a aria-label="Next: 4. Model Structure Selection" class="md-footer__link md-footer__link--next" href="../4%20-%20Model%20Structure%20Selection%20%28MSS%29/"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> 4. Model Structure Selection </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2016 - 2022 Wilson Rocha </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/wilsonrljr" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class="md-social__link" href="https://pypi.org/project/sysidentpy/" rel="noopener" target="_blank" title="pypi.org"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"></path></svg> </a> <a class="md-social__link" href="https://twitter.com/wilsonrljr" rel="noopener" target="_blank" title="twitter.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src="../../assets/javascripts/bundle.a7c05c9e.min.js"></script> <script src="../../overrides/assets/extra.js"></script> <script src="../../overrides/assets/javascripts/mathjax.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>