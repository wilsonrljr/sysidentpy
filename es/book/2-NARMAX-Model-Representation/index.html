<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="De Métodos Clásicos a Redes Neuronales"><meta name=author content="Wilson Rocha"><link href=https://sysidentpy.org/es/book/2-NARMAX-Model-Representation/ rel=canonical><link href=../1-Introduction/ rel=prev><link href=../3-Parameter-Estimation/ rel=next><link rel=icon href=../../../en/assets/img/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.6"><title>2. NARMAX Model Representation - SysIdentPy</title><link rel=stylesheet href=../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../overrides/assets/css/extra.css><link rel=stylesheet href=../../../overrides/assets/css/feature-grid.css><link rel=stylesheet href=../../../overrides/assets/css/fontsize.css><link rel=stylesheet href=../../../overrides/assets/css/card-container.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css><link rel=stylesheet href=../../../overrides/assets/vendor/css/prism.css><link rel=stylesheet href=../../../overrides/assets/css/style.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-16K3SQT164"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-16K3SQT164",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-16K3SQT164",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#basis-function class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=../../ title=SysIdentPy class="md-header__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SysIdentPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 2. NARMAX Model Representation </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label="Seleccionar idioma"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=../../../book/2-NARMAX-Model-Representation/ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=../../../pt/book/2-NARMAX-Model-Representation/ hreflang=pt class=md-select__link> Português (Brasil) </a> </li> <li class=md-select__item> <a href=./ hreflang=es class=md-select__link> Español </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Búsqueda placeholder=Búsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Buscar> <a href=javascript:void(0) class="md-search__icon md-icon" title=Compartir aria-label=Compartir data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Limpiar aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando búsqueda </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Pestañas data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../ class=md-tabs__link> Inicio </a> </li> <li class=md-tabs__item> <a href=../../getting-started/getting-started/ class=md-tabs__link> Primeros pasos </a> </li> <li class=md-tabs__item> <a href=../../user-guide/overview/ class=md-tabs__link> Guía de usuario </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../0-Preface/ class=md-tabs__link> Libro </a> </li> <li class=md-tabs__item> <a href=../../developer-guide/contribute/ class=md-tabs__link> Guía de desarrollo </a> </li> <li class=md-tabs__item> <a href=../../community-support/community-overview/ class=md-tabs__link> Comunidad y soporte </a> </li> <li class=md-tabs__item> <a href=../../landing-page/about-us/ class=md-tabs__link> Acerca de </a> </li> <li class=md-tabs__item> <a href=../../changelog/changelog/ class=md-tabs__link> Registro de cambios </a> </li> <li class=md-tabs__item> <a href=../../landing-page/sponsor/ class=md-tabs__link> Patrocinadores </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navegación data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../ title=SysIdentPy class="md-nav__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> SysIdentPy </label> <div class=md-nav__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> <span class=md-ellipsis> Inicio </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Primeros pasos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Primeros pasos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/getting-started/ class=md-nav__link> <span class=md-ellipsis> Resumen </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart-guide/ class=md-nav__link> <span class=md-ellipsis> Guía rápida </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/narmax-intro/ class=md-nav__link> <span class=md-ellipsis> Introducción a NARMAX </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> Licencia </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Guía de usuario </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Guía de usuario </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/overview/ class=md-nav__link> <span class=md-ellipsis> Resumen </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_1> <label class=md-nav__link for=__nav_3_2_1 id=__nav_3_2_1_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/your-first-model/ class=md-nav__link> <span class=md-ellipsis> Your First Model </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/model-with-multiple-inputs/ class=md-nav__link> <span class=md-ellipsis> Model with Multiple Inputs </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/basis-function-overview/ class=md-nav__link> <span class=md-ellipsis> Basis Function - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/information-criteria-overview/ class=md-nav__link> <span class=md-ellipsis> Information Criteria - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/general-NARX-models/ class=md-nav__link> <span class=md-ellipsis> General NARX Models - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/fourier-NARX-overview/ class=md-nav__link> <span class=md-ellipsis> Fourier NARX - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/aols-overview/ class=md-nav__link> <span class=md-ellipsis> AOLS - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/NFIR-model-overview/ class=md-nav__link> <span class=md-ellipsis> NFIR - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/importance-of-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Importance of Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2 id=__nav_3_2_2_label tabindex=0> <span class=md-ellipsis> Electrical and Mechanical Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Electrical and Mechanical Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/modeling-a-magneto-rheological-damper-device/ class=md-nav__link> <span class=md-ellipsis> Modeling a Magneto-Rheological Damper Device </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/silver-box-system/ class=md-nav__link> <span class=md-ellipsis> Silver Box System </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/coupled-eletric-device/ class=md-nav__link> <span class=md-ellipsis> Coupled Electric Device </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/wiener-hammerstein-system/ class=md-nav__link> <span class=md-ellipsis> Wiener-Hammerstein System </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/f-16-aircraft/ class=md-nav__link> <span class=md-ellipsis> F-16 Aircraft </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/f-16-aircraft-n-steps-ahead-prediction/ class=md-nav__link> <span class=md-ellipsis> F-16 Aircraft - N-Steps Ahead Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-overview/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-metamss/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/multiobjective-parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation - Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3 id=__nav_3_2_3_label tabindex=0> <span class=md-ellipsis> Industrial and Corporate </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Industrial and Corporate </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/m4-benchmark/ class=md-nav__link> <span class=md-ellipsis> M4 Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/air-passenger-benchmark/ class=md-nav__link> <span class=md-ellipsis> Air Passenger Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/load-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Load Forecasting Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/PV-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> PV Forecasting Benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4 id=__nav_3_2_4_label tabindex=0> <span class=md-ellipsis> Chaotic Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Chaotic Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/chaotic-systems/lorenz-system/ class=md-nav__link> <span class=md-ellipsis> Lorenz System </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/chaotic-systems/logistic-map/ class=md-nav__link> <span class=md-ellipsis> Logistic Map </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> How to </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> How to </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/how-to/create-custom-basis-function/ class=md-nav__link> <span class=md-ellipsis> Create a Custom Basis Function </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/create-a-narx-neural-network/ class=md-nav__link> <span class=md-ellipsis> Create a Neural NARX Network </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/save-and-load-models/ class=md-nav__link> <span class=md-ellipsis> Save and Load Models </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/set-specific-lags/ class=md-nav__link> <span class=md-ellipsis> Set Specific Lags </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/simulating-existing-models/ class=md-nav__link> <span class=md-ellipsis> Simulating Existing Models </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/use-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Use Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/API/narmax-base/ class=md-nav__link> <span class=md-ellipsis> NARMAX Base </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/ofr-base/ class=md-nav__link> <span class=md-ellipsis> OFR Base </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/basis-function/ class=md-nav__link> <span class=md-ellipsis> Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/frols/ class=md-nav__link> <span class=md-ellipsis> FROLS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metamss/ class=md-nav__link> <span class=md-ellipsis> MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/aols/ class=md-nav__link> <span class=md-ellipsis> AOLS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/uofr/ class=md-nav__link> <span class=md-ellipsis> UOFR </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/neural-narx/ class=md-nav__link> <span class=md-ellipsis> Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/general-estimators/ class=md-nav__link> <span class=md-ellipsis> General Estimators </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/multiobjective-parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/simulation/ class=md-nav__link> <span class=md-ellipsis> Simulation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/residues/ class=md-nav__link> <span class=md-ellipsis> Residual Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metaheuristics/ class=md-nav__link> <span class=md-ellipsis> Metaheuristics </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Libro </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Libro </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../0-Preface/ class=md-nav__link> <span class=md-ellipsis> Preface </span> </a> </li> <li class=md-nav__item> <a href=../0.1-Contents/ class=md-nav__link> <span class=md-ellipsis> Contents </span> </a> </li> <li class=md-nav__item> <a href=../1-Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 2. NARMAX Model Representation </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 2. NARMAX Model Representation </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basis-function class=md-nav__link> <span class=md-ellipsis> Basis Function </span> </a> <nav class=md-nav aria-label="Basis Function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-vandermonde-matrix class=md-nav__link> <span class=md-ellipsis> Example: Vandermonde Matrix </span> </a> </li> <li class=md-nav__item> <a href=#example-rectangular-basis-functions class=md-nav__link> <span class=md-ellipsis> Example: Rectangular Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=#example-triangular-basis-functions class=md-nav__link> <span class=md-ellipsis> Example: Triangular Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=#example-radial-basis-function-rbf-gaussian class=md-nav__link> <span class=md-ellipsis> Example: Radial Basis Function (RBF) - Gaussian </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linear-models class=md-nav__link> <span class=md-ellipsis> Linear Models </span> </a> <nav class=md-nav aria-label="Linear Models"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#armax class=md-nav__link> <span class=md-ellipsis> ARMAX </span> </a> </li> <li class=md-nav__item> <a href=#arx class=md-nav__link> <span class=md-ellipsis> ARX </span> </a> </li> <li class=md-nav__item> <a href=#arma class=md-nav__link> <span class=md-ellipsis> ARMA </span> </a> </li> <li class=md-nav__item> <a href=#ar class=md-nav__link> <span class=md-ellipsis> AR </span> </a> </li> <li class=md-nav__item> <a href=#fir class=md-nav__link> <span class=md-ellipsis> FIR </span> </a> </li> <li class=md-nav__item> <a href=#other-variants class=md-nav__link> <span class=md-ellipsis> Other Variants </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nonlinear-models class=md-nav__link> <span class=md-ellipsis> Nonlinear Models </span> </a> <nav class=md-nav aria-label="Nonlinear Models"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#narmax class=md-nav__link> <span class=md-ellipsis> NARMAX </span> </a> </li> <li class=md-nav__item> <a href=#narx class=md-nav__link> <span class=md-ellipsis> NARX </span> </a> </li> <li class=md-nav__item> <a href=#narma class=md-nav__link> <span class=md-ellipsis> NARMA </span> </a> </li> <li class=md-nav__item> <a href=#nar class=md-nav__link> <span class=md-ellipsis> NAR </span> </a> </li> <li class=md-nav__item> <a href=#nfir class=md-nav__link> <span class=md-ellipsis> NFIR </span> </a> </li> <li class=md-nav__item> <a href=#mixed-narmax-models class=md-nav__link> <span class=md-ellipsis> Mixed NARMAX Models </span> </a> </li> <li class=md-nav__item> <a href=#neural-narx-network class=md-nav__link> <span class=md-ellipsis> Neural NARX Network </span> </a> </li> <li class=md-nav__item> <a href=#general-model-set-representation class=md-nav__link> <span class=md-ellipsis> General Model Set Representation </span> </a> </li> <li class=md-nav__item> <a href=#mimo-models class=md-nav__link> <span class=md-ellipsis> MIMO Models </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../3-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 3. Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../4-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 4. Model Structure Selection </span> </a> </li> <li class=md-nav__item> <a href=../5-Multiobjective-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 5. Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../6-Multiobjective-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 6. Multiobjective Model Structure Selection </span> </a> </li> <li class=md-nav__item> <a href=../7-NARX-Neural-Network/ class=md-nav__link> <span class=md-ellipsis> 7. NARX Neural Network </span> </a> </li> <li class=md-nav__item> <a href=../8-Severely-Nonlinear-System-Identification/ class=md-nav__link> <span class=md-ellipsis> 8. Severely Nonlinear System Identification </span> </a> </li> <li class=md-nav__item> <a href=../9-Validation/ class=md-nav__link> <span class=md-ellipsis> 9. Validation </span> </a> </li> <li class=md-nav__item> <a href=../10-Case-Studies/ class=md-nav__link> <span class=md-ellipsis> 10. Case Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Guía de desarrollo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Guía de desarrollo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/contribute/ class=md-nav__link> <span class=md-ellipsis> How to contribute </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/documentation-overview/ class=md-nav__link> <span class=md-ellipsis> Documentation Overview </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-write-a-tutorial/ class=md-nav__link> <span class=md-ellipsis> How To Write a Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-write-a-how-to-guide/ class=md-nav__link> <span class=md-ellipsis> How To Write a How-to Guide </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-add-a-translation/ class=md-nav__link> <span class=md-ellipsis> How to Add a Translation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Comunidad y soporte </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Comunidad y soporte </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community-support/community-overview/ class=md-nav__link> <span class=md-ellipsis> community-overview </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/get-help/ class=md-nav__link> <span class=md-ellipsis> Get Help </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Meetups </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Meetups </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community-support/meetups/ai-networks-meetup/ class=md-nav__link> <span class=md-ellipsis> AI Networks Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/nubank-meetup/ class=md-nav__link> <span class=md-ellipsis> Nubank Timeseries Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/nubank-meetup-open-source/ class=md-nav__link> <span class=md-ellipsis> Nubank Open Source Talk </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/gcom-meetup/ class=md-nav__link> <span class=md-ellipsis> GCoM Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/estatidados/ class=md-nav__link> <span class=md-ellipsis> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../landing-page/about-us/ class=md-nav__link> <span class=md-ellipsis> Acerca de </span> </a> </li> <li class=md-nav__item> <a href=../../changelog/changelog/ class=md-nav__link> <span class=md-ellipsis> Registro de cambios </span> </a> </li> <li class=md-nav__item> <a href=../../landing-page/sponsor/ class=md-nav__link> <span class=md-ellipsis> Patrocinadores </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basis-function class=md-nav__link> <span class=md-ellipsis> Basis Function </span> </a> <nav class=md-nav aria-label="Basis Function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-vandermonde-matrix class=md-nav__link> <span class=md-ellipsis> Example: Vandermonde Matrix </span> </a> </li> <li class=md-nav__item> <a href=#example-rectangular-basis-functions class=md-nav__link> <span class=md-ellipsis> Example: Rectangular Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=#example-triangular-basis-functions class=md-nav__link> <span class=md-ellipsis> Example: Triangular Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=#example-radial-basis-function-rbf-gaussian class=md-nav__link> <span class=md-ellipsis> Example: Radial Basis Function (RBF) - Gaussian </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linear-models class=md-nav__link> <span class=md-ellipsis> Linear Models </span> </a> <nav class=md-nav aria-label="Linear Models"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#armax class=md-nav__link> <span class=md-ellipsis> ARMAX </span> </a> </li> <li class=md-nav__item> <a href=#arx class=md-nav__link> <span class=md-ellipsis> ARX </span> </a> </li> <li class=md-nav__item> <a href=#arma class=md-nav__link> <span class=md-ellipsis> ARMA </span> </a> </li> <li class=md-nav__item> <a href=#ar class=md-nav__link> <span class=md-ellipsis> AR </span> </a> </li> <li class=md-nav__item> <a href=#fir class=md-nav__link> <span class=md-ellipsis> FIR </span> </a> </li> <li class=md-nav__item> <a href=#other-variants class=md-nav__link> <span class=md-ellipsis> Other Variants </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nonlinear-models class=md-nav__link> <span class=md-ellipsis> Nonlinear Models </span> </a> <nav class=md-nav aria-label="Nonlinear Models"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#narmax class=md-nav__link> <span class=md-ellipsis> NARMAX </span> </a> </li> <li class=md-nav__item> <a href=#narx class=md-nav__link> <span class=md-ellipsis> NARX </span> </a> </li> <li class=md-nav__item> <a href=#narma class=md-nav__link> <span class=md-ellipsis> NARMA </span> </a> </li> <li class=md-nav__item> <a href=#nar class=md-nav__link> <span class=md-ellipsis> NAR </span> </a> </li> <li class=md-nav__item> <a href=#nfir class=md-nav__link> <span class=md-ellipsis> NFIR </span> </a> </li> <li class=md-nav__item> <a href=#mixed-narmax-models class=md-nav__link> <span class=md-ellipsis> Mixed NARMAX Models </span> </a> </li> <li class=md-nav__item> <a href=#neural-narx-network class=md-nav__link> <span class=md-ellipsis> Neural NARX Network </span> </a> </li> <li class=md-nav__item> <a href=#general-model-set-representation class=md-nav__link> <span class=md-ellipsis> General Model Set Representation </span> </a> </li> <li class=md-nav__item> <a href=#mimo-models class=md-nav__link> <span class=md-ellipsis> MIMO Models </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/wilsonrljr/sysidentpy/edit/main/docs/en/book/2-NARMAX-Model-Representation.md title="Editar esta página" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/wilsonrljr/sysidentpy/raw/main/docs/en/book/2-NARMAX-Model-Representation.md title="Ver código fuente de esta página" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>2. NARMAX Model Representation</h1> <p>There are several NARMAX model representations, including polynomial, Fourier, generalized additive, neural networks, and wavelet (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A</a>, <a href=https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas>Aguirra, L. A</a>). This book focuses on the model representations available in SysIdentPy and we’ll keep things updated as new methods are added to the package. If a particular representation is mentioned but is not available in SysIdentPy, it will be explicitly mentioned.</p> <p>To reproduce the codes presented in this section, make sure you have these packages installed:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>sysidentpy, scikit-learn, scipy, pytorch, matplotlib
</code></pre></div> <h2 id=basis-function>Basis Function<a class=headerlink href=#basis-function title="Permanent link">&para;</a></h2> <p>In System Identification, understanding the concept of basis functions is crucial for effectively modeling complex systems. Basis functions are predefined mathematical functions used to transform the input data into a new space, where the relationships within the data can be more easily modeled. By expressing the original data in terms of these basis functions, we can build nonlinear models in respect to its structure while keeping it linear in the parameters, allowing the usage of straightforward parameter estimation methods.</p> <p>Basis functions commonly used in system identification:</p> <ol> <li> <p><strong>Polynomial Basis Functions</strong>: These functions are powers of the input variables. They are useful for capturing simple nonlinear relationships.</p> </li> <li> <p><strong>Fourier Basis Functions</strong>: These sinusoidal functions (sine and cosine) are ideal for representing periodic patterns within the data.</p> </li> <li> <p><strong>Wavelet Basis Functions</strong>: These functions are localized in both time and frequency, making them suitable for analyzing data with varying frequency components. Not available in SysIdentPy yet.</p> </li> </ol> <p>In SysIdentPy you can define the basis function you want to use in your model by just import them:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span><span class=p>,</span> <span class=n>Fourier</span><span class=p>,</span> <span class=n>Bernstein</span>
</code></pre></div> <p>To keep things simple for now, we will show simple examples of how basis function can be used in a modeling task. We will show a simple polynomial basis functions, a triangular basis function, a radial basis function and a rectangular basis function.</p> <blockquote> <p>SysIdentPy does not currently include Vandermonde or any of the other basis functions defined below. These functions are provided solely as examples to illustrate the significance of the basis functions. The examples are based on Fredrik Bagge Carlson's <a href=https://arxiv.org/pdf/1906.02003>PhD thesis</a>, which I highly recommended for anyone interested in Nonlinear System Identification.</p> <p>Although Vandermonde and Radial Basis Functions (RBF) are planned for inclusion as native basis functions in SysIdentPy version 1.0, users can already create and use their own custom basis functions with SysIdentPy. An example of how to do this is available on the SysIdentPy <a href=https://sysidentpy.org/ >documentation page</a>.</p> </blockquote> <h3 id=example-vandermonde-matrix>Example: Vandermonde Matrix<a class=headerlink href=#example-vandermonde-matrix title="Permanent link">&para;</a></h3> <p>The polynomial basis functions used in this example is defined as:</p> <div class=arithmatex>\[ \phi_i(x) = x^i \tag{2.1} \]</div> <p>where <span class=arithmatex>\(i\)</span> is the degree of the polynomial and <span class=arithmatex>\(x\)</span> is the input variable.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=c1># Polynomial basis function</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=k>def</span><span class=w> </span><span class=nf>poly_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span><span class=p>):</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>vander</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>increasing</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=c1># Create polynomial features</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=n>degree</span> <span class=o>=</span> <span class=mi>2</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=n>X_poly</span> <span class=o>=</span> <span class=n>poly_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_poly</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_poly</span><span class=p>)</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=c1># Plot the polynomial approximation</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=c1># Plot the polynomial basis functions</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>poly_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span><span class=p>)[:,</span> <span class=n>i</span><span class=p>],</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)])</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/vandermode_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/vandermode_example.png?raw=true"></a></p> <blockquote> <p>Figure 1. Approximation using Vandermode Matrix. The yellow dots show the system data, the bold blue line represents the predicted values, and the other lines depict the basis functions.</p> </blockquote> <h3 id=example-rectangular-basis-functions>Example: Rectangular Basis Functions<a class=headerlink href=#example-rectangular-basis-functions title="Permanent link">&para;</a></h3> <p>The rectangular basis functions are defined as:</p> <div class=arithmatex>\[ \phi_{i}(x) = \begin{cases} 1 &amp; \text{if } c_i - \frac{w}{2} \leq x &lt; c_i + \frac{w}{2} \\ 0 &amp; \text{otherwise} \end{cases} \tag{2.2} \]</div> <p>where <span class=arithmatex>\(c_i\)</span> represents the center of the basis function, <span class=arithmatex>\(w\)</span> is the width, and <span class=arithmatex>\(x\)</span> is the input variable.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=c1># Rectangular basis function</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=k>def</span><span class=w> </span><span class=nf>rectangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>):</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>width</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>centers</span><span class=p>])</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=c1># Create rectangular features</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=n>centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=n>width</span> <span class=o>=</span> <span class=mi>3</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=n>X_rect</span> <span class=o>=</span> <span class=n>rectangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_rect</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_rect</span><span class=p>)</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=c1># Plot the rectangular approximation</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=c1># Plot the rectangular basis functions</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>centers</span><span class=p>)):</span>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>rectangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)[:,</span> <span class=n>i</span><span class=p>],</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)])</span>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rectangular.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rectangular.png?raw=true"></a></p> <blockquote> <p>Figure 2. Approximation using Rectangular Basis Function. The yellow dots show the system data, the bold blue line represents the predicted values, and the other lines depict the basis functions.</p> </blockquote> <h3 id=example-triangular-basis-functions>Example: Triangular Basis Functions<a class=headerlink href=#example-triangular-basis-functions title="Permanent link">&para;</a></h3> <p>The triangular basis functions are defined as:</p> <div class=arithmatex>\[ \phi_{i}(x) = \max \left(0, 1 - \frac{|x - c_i|}{w} \right) \tag{2.3} \]</div> <p>where <span class=arithmatex>\(c_i\)</span> is the center of the basis function, <span class=arithmatex>\(w\)</span> is the width, and <span class=arithmatex>\(x\)</span> is the input variable.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=c1># Triangular basis function</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=k>def</span><span class=w> </span><span class=nf>triangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>):</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span> <span class=o>/</span> <span class=n>width</span><span class=p>))</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>centers</span><span class=p>])</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=c1># Create triangular features</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=n>centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=n>width</span> <span class=o>=</span> <span class=mf>1.5</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=n>X_tri</span> <span class=o>=</span> <span class=n>triangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_tri</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_tri</span><span class=p>)</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=c1># Plot the triangular approximation</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=c1># Plot the triangular basis functions</span>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>centers</span><span class=p>)):</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>triangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)[:,</span> <span class=n>i</span><span class=p>],</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)])</span>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/triangular.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/triangular.png?raw=true"></a></p> <blockquote> <p>Figure 3. Approximation using a Triangular Basis Function. The yellow dots show the system data, the bold blue line represents the predicted values, and the other lines depict the basis functions.</p> </blockquote> <h3 id=example-radial-basis-function-rbf-gaussian>Example: Radial Basis Function (RBF) - Gaussian<a class=headerlink href=#example-radial-basis-function-rbf-gaussian title="Permanent link">&para;</a></h3> <p>The Gaussian Radial Basis Function is defined as:</p> <div class=arithmatex>\[ \phi(x; c, \sigma) = \exp\left(- \frac{(x - c)^2}{2 \sigma^2}\right) \tag{2.4} \]</div> <p>where: - <span class=arithmatex>\(x\)</span> is the input variable. - <span class=arithmatex>\(c\)</span> is the center of the RBF. - <span class=arithmatex>\(\sigma\)</span> is the spread (or scale) of the RBF.</p> <p>This function measures the distance between <span class=arithmatex>\(x\)</span> and the center <span class=arithmatex>\(c\)</span>, and it decays exponentially based on the width <span class=arithmatex>\(\sigma\)</span>. The smaller the <span class=arithmatex>\(\sigma\)</span>, the more localized the basis function is around the center <span class=arithmatex>\(c\)</span>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>  <span class=c1># Quadratic polynomial with noise</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=c1># RBF centers and sigma</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=n>centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>  <span class=c1># More centers for better coverage</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=n>sigma</span> <span class=o>=</span> <span class=mf>0.5</span>  <span class=c1># Spread of the RBF</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=c1># RBF basis function</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=k>def</span><span class=w> </span><span class=nf>rbf_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>sigma</span><span class=p>):</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=c1># Create RBF features</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=n>X_rbf</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>rbf_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>centers</span><span class=p>])</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_rbf</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_rbf</span><span class=p>)</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=c1># Basis function colors</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=n>n_colors</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=c1># Plot the basis functions</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>centers</span><span class=p>):</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>    <span class=n>color</span> <span class=o>=</span> <span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=n>n_colors</span><span class=p>]</span>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>rbf_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>sigma</span><span class=p>),</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;RBF Center </span><span class=si>{</span><span class=n>c</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a><span class=c1># Plot the approximation</span>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rbf_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rbf_example.png?raw=true"></a></p> <blockquote> <p>Figure 4. Approximation using the Radial Basis Function. The yellow dots show the system data, the bold blue line represents the predicted values, and the other lines depict the basis functions.</p> </blockquote> <h2 id=linear-models>Linear Models<a class=headerlink href=#linear-models title="Permanent link">&para;</a></h2> <h3 id=armax>ARMAX<a class=headerlink href=#armax title="Permanent link">&para;</a></h3> <p>You may have noticed the similarity between the acronym NARMAX with the well-known models ARX, ARMAX, etc., which are widely used for forecasting time series. And this resemblance is not by chance. The AutoRegressive models with Moving Average and Exogenous Input (ARMAX) and their variations AR, ARX, ARMA (to name just a few) are one of the most used mathematical representations for identifying linear systems. The ARMAX can be expressed as:</p> <div class=arithmatex>\[ y_k= \mathcal{\phi}[y_{k-1}, \dotsc, y_{k-n_y},x_{k-d}, x_{k-d-1}, \dotsc, x_{k-d-n_x}, e_{k-1}, \dotsc, e_{k-n_e}] + e_k \tag{2.5} \]</div> <p>where <span class=arithmatex>\(n_y\in \mathbb{N}\)</span>, <span class=arithmatex>\(n_x \in \mathbb{N}\)</span>, <span class=arithmatex>\(n_e \in \mathbb{N}\)</span> , are the maximum lags for the system output, input and noise regressors (representing the moving average part), respectively; <span class=arithmatex>\(x_k \in \mathbb{R}^{n_x}\)</span> is the system input and <span class=arithmatex>\(y_k \in \mathbb{R}^{n_y}\)</span> is the system output at discrete time <span class=arithmatex>\(k \in \mathbb{N}^n\)</span>; <span class=arithmatex>\(e_k \in \mathbb{R}^{n_e}\)</span> stands for uncertainties and possible noise at discrete time <span class=arithmatex>\(k\)</span>. In this case, <span class=arithmatex>\(\mathcal{\phi}\)</span> is some linear function of the input and output regressors and <span class=arithmatex>\(d\)</span> is a time delay typically set to <span class=arithmatex>\(d=1\)</span>.</p> <p>If <span class=arithmatex>\(\mathcal{F}\)</span> is a polynomial, we have a polynomial ARMAX model</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + \sum_{j=1}^{q}\Theta_{e}^{j}e_{k-j} + \sum_{m=1}^{r}\Theta_{x}^{m}x_{k-m} + e_k \tag{2.6} \]</div> <p>where <span class=arithmatex>\(\sum\nolimits_{0}\)</span>, <span class=arithmatex>\(\Theta_{y}^{i}\)</span>, <span class=arithmatex>\(\Theta_{e}^{j}\)</span>, and <span class=arithmatex>\(\Theta_{x}^{m}\)</span> are constant parameters.</p> <p>The following example is a polynomial ARMAX model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139x_{k-1} -0.1691x_{k-1} + 0.2245e_{k-1} \end{align} \tag{2.7} \]</div> <p>You can easily build a polynomial ARMAX model using <strong>SysIdentPy</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=p>)</span>
</code></pre></div></p> <p>In the example above, we define the linear polynomial basis function by importing the Polynomial basis and setting the degree equal to 1 (this ensures that we do not have a nonlinear combination of the regressors). Don't worry about the <code>FROLS</code> and <code>LeastSquares</code> yet. We'll talk about them in chapters 3 and 4, respectively.</p> <p>For Figure 4, we conducted 10 separate simulations to analyse the effects of different noise process generation on the ARMAX system's behavior. Each simulation uses a unique sample of noise to observe how variations in this random component influence the overall system output. To illustrate this, we highlight one specific simulation while the others are displayed with less emphasis.</p> <p>It's important to notice that all simulations, whether highlighted or not, are governed by the same underlying model. The deterministic part of the model equation explains the behavior of all the signals shown. The noticeable differences among the signals arise solely from the distinct noise samples used in each simulation. Despite these variations, the core dynamics of the signal remain consistent and are described by the model's deterministic component.</p> <blockquote> <p>Most of the code presented in this chapter is intended to illustrate fundamental concepts rather than demonstrating how to use SysIdentPy specifically. Many examples are implemented using pure Python to help you better understand the underlying concepts, replicate the examples, and adapt them as needed. SysIdentPy itself will be introduced and be used in the examples in the following chapter.</p> </blockquote> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.9</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.24</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.92</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.92</span><span class=o>*</span><span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>    <span class=c1># Interpolate the data just to make the plot &quot;nicer&quot;</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an ARMAX model&quot;</span><span class=p>)</span>
<a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/armax_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/armax_example.png?raw=true"></a></p> <blockquote> <p>Figure 4. Simulations to show the effects of different noise process generation on the ARMAX model's behavior.</p> </blockquote> <h3 id=arx>ARX<a class=headerlink href=#arx title="Permanent link">&para;</a></h3> <p>If we do not include noise terms <span class=arithmatex>\(e_{k-n_e}\)</span> in equation (1), we have ARX models.</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + \sum_{m=1}^{r}\Theta_{x}^{m}x_{k-m} + e_k \tag{2.8} \]</div> <p>The following example is a polynomial ARX model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139x_{k-1} -0.1691x_{k-1} \end{align} \tag{2.9} \]</div> <p>The only difference in SysIdentPy is setting the <code>unbiased=False</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=p>)</span>
</code></pre></div> <p>The following example shows 10 separate simulations to analyse the effects of different noise process generation on the ARX system's behavior.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.9</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.24</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.92</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>
<a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an ARX model&quot;</span><span class=p>)</span>
<a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arx_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arx_example.png?raw=true"></a></p> <blockquote> <p>Figure 5. Simulations to show the effects of different noise process generation on the ARX model's behavior.</p> </blockquote> <h3 id=arma>ARMA<a class=headerlink href=#arma title="Permanent link">&para;</a></h3> <p>if we do not include input terms in equation (1), it turns to ARMA model</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + \sum_{j=1}^{q}\Theta_{e}^{j}e_{k-j} + e_k \tag{2.10} \]</div> <p>The following example is a polynomial ARMA model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139y_{k-3} -0.1691y_{k-4} + 0.2245e_{k-1} \end{align} \tag{2.11} \]</div> <p>Since the model representation do not have inputs, we have to set the model type to <code>NAR</code> and set <code>unbiased=True</code> again in <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=p>)</span>
</code></pre></div> <p>The figure bellow shows 10 separate simulations to analyse the effects of different noise process generation on the ARX system's behavior.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.5</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.4</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.8</span><span class=o>*</span><span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>
<a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a>
<a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an ARMA model&quot;</span><span class=p>)</span>
<a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arma_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arma_example.png?raw=true"></a></p> <blockquote> <p>Figure 6. Simulations to show the effects of different noise process generation on the ARMA model's behavior.</p> </blockquote> <h3 id=ar>AR<a class=headerlink href=#ar title="Permanent link">&para;</a></h3> <p>if we do not include input terms and noise terms in equation (1), it turns to AR model</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + e_k \tag{2.12} \]</div> <p>The following example is a polynomial AR model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139y_{k-3} -0.1691y_{k-4} \end{align} \tag{2.13} \]</div> <p>In this case, we have to set the model type to <code>NAR</code> and set <code>unbiased=False</code> in <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=p>)</span>
</code></pre></div> <p>The figure bellow shows 10 separate simulations to analyse the effects of different noise process generation on the AR system's behavior.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.5</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.3</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an AR model&quot;</span><span class=p>)</span>
<a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/ar_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/ar_example.png?raw=true"></a></p> <blockquote> <p>Figure 7. Simulations to show the effects of different noise process generation on the AR model's behavior.</p> </blockquote> <h3 id=fir>FIR<a class=headerlink href=#fir title="Permanent link">&para;</a></h3> <p>if we only keep input terms in equation (1), it turns to NFIR model</p> <div class=arithmatex>\[ y_k = \sum_{m=1}^{r}\Theta_{x}^{m}x_{k-m} + e_k \tag{2.14} \]</div> <p>The following example is a polynomial FIR model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213x_{k-1}-0.5692x_{k-2}+0.1139x_{k-3} -0.1691x_{k-4} \end{align} \tag{2.15} \]</div> <p>In this case, we have to set the model type to <code>NFIR</code> and set <code>unbiased=False</code> in <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NFIR&quot;</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=p>)</span>
</code></pre></div> <p>The figure bellow shows 10 separate simulations to analyse the effects of different noise process generation on the FIR system's behavior.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.28</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.34</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=mf>0.1</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a>
<a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a>
<a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an FIR model&quot;</span><span class=p>)</span>
<a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/fir_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/fir_example.png?raw=true"></a></p> <blockquote> <p>Figure 8. Simulations to show the effects of different noise process generation on the <strong>FIR</strong> model's behavior.</p> <p>We didn't set the model_type for ARMAX and ARX because the default is <code>NARMAX</code>. SysIdentPy allows three different model types: <code>NARMAX</code>, <code>NAR</code>, and <code>NFIR</code>. Because ARMAX, ARX and others linear variants are subsets of NARMAX models, there is no need for specific <code>ARMAX</code> model type. The idea is to have model types for model with input and output regressors; models with only output regressors; and models with only input regressors.</p> </blockquote> <h3 id=other-variants>Other Variants<a class=headerlink href=#other-variants title="Permanent link">&para;</a></h3> <p>For the sake of simplicity, we defined Equation 2.5 and only approach the polynomial representations. However, you can extend the representations to other basis functions, like the Fourier. If you set <span class=arithmatex>\(\mathcal{F}\)</span> as the Fourier extension</p> <div class=arithmatex>\[ \mathcal{F}(x) = [\cos(\pi x), \sin(\pi x), \cos(2\pi x), \sin(2\pi x), \ldots, \cos(N\pi x), \sin(N\pi x)] \tag{2.16} \]</div> <p>In this case, the Fourier ARX representation will be:</p> <div class=arithmatex>\[ \begin{aligned} y_k = &amp;\Big[ \cos(\pi y_{k-1}), \sin(\pi y_{k-1}), \cos(2\pi y_{k-1}), \sin(2\pi y_{k-1}), \ldots, \cos(N\pi y_{k-1}), \sin(N\pi y_{k-1}), \\ &amp;\ \ \cos(\pi y_{k-2}), \sin(\pi y_{k-2}), \ldots, \cos(N\pi y_{k-n_y}), \sin(N\pi y_{k-n_y}), \\ &amp;\ \ \cos(\pi x_{k-1}), \sin(\pi x_{k-1}), \cos(2\pi x_{k-1}), \sin(2\pi x_{k-1}), \ldots, \cos(N\pi x_{k-n_x}), \sin(N\pi x_{k-n_x}) \Big] \\ &amp;\ \ + e_k \end{aligned} \tag{2.17} \]</div> <p>To do that in SysIdentPy, just import the Fourier basis instead of the Polynomial</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Fourier</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Fourier</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=p>)</span>
</code></pre></div> <h2 id=nonlinear-models>Nonlinear Models<a class=headerlink href=#nonlinear-models title="Permanent link">&para;</a></h2> <h3 id=narmax>NARMAX<a class=headerlink href=#narmax title="Permanent link">&para;</a></h3> <p>The NARMAX model was proposed by Stephen A. Billings and I.J. Leontaritis in <a href="https://pdf.sciencedirectassets.com/314898/1-s2.0-S1474667082X74355/1-s2.0-S1474667017630398/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjECcaCXVzLWVhc3QtMSJHMEUCIGSxH3DpnP8cywgmDASl%2FBUhnmjjJxeG%2BTay6JhHkUUKAiEAgdzFyYAYcYGDnHxy9T%2BzIVHT%2Fi8J0BVY4ZxI0ovAaUIqsgUIIBAFGgwwNTkwMDM1NDY4NjUiDNTsL0ESuGUnlT%2FyniqPBTUbIgulDeB6wJLJ6sql18H4y3NFfyReA0c45SRi1Rq%2F1TEI%2B0c2cC8v%2FfH8cJF7xGiU%2Fvq3apocGRSFYM6VCJ5IPeyqW3V9Z6lZCAHz3sMY2vX6xHf8czCB4jk85bQAr5Ct9C8m0YI33jvykw7ZC25zOVsyDyR%2Fnas4IOBAboSImvbTzYgDwcwL5S9eSlq%2Byw%2FZPyOMJslF6mOERjXYMrr1Xg51F%2B4xeDt%2BWSGe5qbu5s0RJwifIBp0%2F6WG1m6Mvf0wn%2BQyP8PMJyKMP31fbeA7g3Ndwtjs8ghLPjxax%2BSLby5hgi9ogzm1Gr%2Fv972XLW3TwNUod6yMdzVolsNcxgPBUtns%2Fdfr%2Fm2e%2BkvpETO%2FF1J7V%2FAievzJFE2Sl087x0ZACiy57fK3doa7UWpZj46DaU%2BeAEUbrSXel2PqHbLfSFM9NDsgZWBRXzqygQY4VMGANBEKCR%2BrcJdI3BG%2B%2Bkcg18OKr%2Bf42vgzGRiGB3szABhtRVq5QvGyXYYONv1SFcLBHAt67nuVukKMu%2BR%2BmKQT9CwNOL13oZ5ldS5Fowv1TC8B8o8qdlveFb6WywpTnsSc9%2Bm8Ufbn5W8zI5Fy2sECz4hjUY1zGRhH3O9027j87%2BwyVVfdT6ucHvOdHjQTr2tawgJmUvRunQlw7xN85t2IPEWdFZSXC9IgkG5QRxxzYzsyrCzG4Vsm3CGcShAu7Ms%2Bm7z7XO8QXgfN95JxcG4PX6siAkN5CGZwAdtUkp1VOXzpRt77mrTofG%2BHDGHeXPlyRnBNqR4Z7EJbevPWgUK9BRkVbKfnL0YCtuWbQ3sQ115UTR1a84VejuWmTg%2FJ8Fpf78ApwBE6igc1VfePXVJJwAzxzWcXPSwlhDQNqPIw8ffPtQY6sQHciEnI0Pd0iSUf53%2BhgScY6deC54cJfBcOtzm9RhrSeSoQyPdhrMHU0r2fWAhYRcr9ZeuObdxPtjpqardoQM%2BEizPzQNO8uBtOoYTK2inAXxp2z3U%2BDYHWJHNuapOhC2GsOPlPXco7e0Hm0GxiPUyk6%2B8FtqTAs6d4KxpT7CGLUNChK%2BCUbt%2BsnF84TjzK40Fkf0Gya9ESFUHmIEUmfXabOKfgra2QbSbcogWgoI5gChM%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20240808T001847Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTY343F44W4%2F20240808%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=95d8e3c94d76309850682e9e8f9025436a481f440bf152241e01eb47d70c4438&hash=fb1356fe353cd87c7fb931d951e83c97cce7568257b5a9c6c533aee21ef64f35&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=S1474667017630398&tid=spdf-a9063d37-b51a-42e8-97b3-bb5ab63b0384&sid=07d7477c73bfe241706ba2d-0fba8a3cbcd1gxrqa&type=client&tsoh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&ua=18165805090051570458&rr=8afb54c71f7e1ac0&cc=br">1981</a>, (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A. - Nonlinear System Identification: NARMAX Methods in the Time, Frequency, and Spatio-Temporal Domains</a>), and can be described as</p> <div class=arithmatex>\[ \begin{equation} y_k= \mathcal{F}[y_{k-1}, \dotsc, y_{k-n_y},x_{k-d}, x_{k-d-1}, \dotsc, x_{k-d-n_x}, e_{k-1}, \dotsc, e_{k-n_e}] + e_k, \end{equation} \tag{2.18} \]</div> <p>where <span class=arithmatex>\(n_y\in \mathbb{N}^*\)</span>, <span class=arithmatex>\(n_x \in \mathbb{N}\)</span>, <span class=arithmatex>\(n_e \in \mathbb{N}\)</span> , are the maximum lags for the system output and input respectively; <span class=arithmatex>\(x_k \in \mathbb{R}^{n_x}\)</span> is the system input and <span class=arithmatex>\(y_k \in \mathbb{R}^{n_y}\)</span> is the system output at discrete time <span class=arithmatex>\(k \in \mathbb{N}^n\)</span>; <span class=arithmatex>\(e_k \in \mathbb{R}^{n_e}\)</span> represents uncertainties and possible noise at discrete time <span class=arithmatex>\(k\)</span>. In this case, <span class=arithmatex>\(\mathcal{F}\)</span> is some nonlinear function of the input and output regressors and <span class=arithmatex>\(d\)</span> is a time delay typically set to <span class=arithmatex>\(d=1\)</span>.</p> <p>You can notice that the difference between Equation 2.5 and Equation 2.18 if the function representing the system. For NARMAX models, <span class=arithmatex>\(\mathcal{F}\)</span> can be any nonlinear function, while for Equation 2.5 only linear functions are allowed. Although there are many possible approximations of <span class=arithmatex>\(\mathcal{F}(\cdot)\)</span> (e.g., Neural Networks, Fuzzy, Wavelet, Radial Basis Function), the power-form Polynomial NARMAX model is the most commonly used (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A.</a>; <a href=https://arxiv.org/abs/2001.05320>Khandelwal, D. and Schoukens, M. and Toth, R.</a>):</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}x_{k-j}^{b_i, j}\prod_{l=1}^{n_e}e_{k-l}^{d_i, l}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.19} \]</div> <p>where <span class=arithmatex>\(p\)</span> is the number of regressors, <span class=arithmatex>\(\Theta_i\)</span> are the model parameters, and <span class=arithmatex>\(a_i, m\)</span>, <span class=arithmatex>\(b_i, j\)</span> and <span class=arithmatex>\(d_i, l \in \mathbb{N}\)</span> are the exponents of the output, input and noise terms, respectively.</p> <p>The Equation 2.20 describes a polynomial NARMAX model where the nonlinearity degree is equal to <span class=arithmatex>\(2\)</span>, identified from experimental data of a DC motor/generator with no prior knowledge of the model form, taken from <a href=https://www.ufsj.edu.br/portal2-repositorio/File/gcom/LAM2017.pdf>Lacerda Junior, W. R., Almeida, V. M., &amp; Martins, S. A. M. (2017)</a>:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 1.7813y_{k-1}-0.7962y_{k-2}+0.0339x_{k-1} -0.1597x_{k-1} y_{k-1} +0.0338x_{k-2} + \\ &amp; + 0.1297x_{k-1}y_{k-2} - 0.1396x_{k-2}y_{k-1}+ 0.1086x_{k-2}y_{k-2}+0.0085y_{k-2}^2 + 0.0247e_{k-1}e_{k-2} \end{align} \tag{2.20} \]</div> <p>The <span class=arithmatex>\(\Theta\)</span> values are the coefficients of each term of the polynomial equation.</p> <p>Polynomial basis functions are one of the most used representations of NARMAX models due to several interesting attributes, such as (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A.</a>):</p> <ul> <li>All polynomial functions are smooth in <span class=arithmatex>\(\mathbb{R}\)</span>.</li> <li>The Weierstrass <a href=https://www.researchgate.net/profile/P-Johnson/publication/353192512_Stone-Weierstrass_Theorem/links/60ec4cdc9541032c6d32c4a6/Stone-Weierstrass-Theorem.pdf>approximation theorem</a> states that any continuous real-valued function defined on a closed and bounded space <span class=arithmatex>\([a,b]\)</span> can be uniformly approximated using a polynomial on that interval.</li> <li>They can describe several nonlinear dynamical systems, including industrial processes, control systems, structural systems, economic and financial systems, biology, medicine, and social systems (some examples are detailed in <a href=https://ieeexplore.ieee.org/document/8751951>Lacerda Junior, W. R. and Martins, S. A. M. and Nepomuceno, E. G. and Lacerda, Marcio J.</a> ; <a href=https://www.sciencedirect.com/science/article/pii/S0307904X03000714>Fung, E. H. K. and Wong, Y. K. and Ho, H. F. and Mignolet, M. P.</a>; <a href=https://ieeexplore.ieee.org/document/1179133>Kukreja, S. L. and Galiana, H. L. and Kearney, R. E.</a>; <a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A</a>; <a href="https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas?channel=doi&linkId=574cb16508ae82d2c6bc870f&showFulltext=true">Aguirre, L. A.</a>; and many others).</li> <li>Several algorithms have been developed for structure selection and parameter estimation of polynomial NARMAX models, and it remains an active area of research.</li> <li>Polynomial NARMAX models are versatile and can be used both for prediction and inference. The structure of polynomial NARMAX models are easy to interpret and can be related to the underlying system, which is much harder to achieve with neural networks or wavelet functions, for instance.</li> </ul> <p>You can easily build a polynomial NARMAX model using SysIdentPy. Note that the difference for ARMAX, in this case, is the degree of the polynomial function.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=p>)</span>
</code></pre></div> <p>One could think that is a simple change, but in nonlinear scenarios the course of dimensionality becomes a real problem. The number of candidate regressors, <span class=arithmatex>\(n_r\)</span>, of polynomial NARX can be defined as <a href=https://www.tandfonline.com/doi/abs/10.1080/00207178808906169>Korenberg, M. L., Billings, S. A., Liu, Y. P., and McIlroy, P. J. - Orthogonal parameter estimation algorithm for non-linear stochastic systems</a>:</p> <div class=arithmatex>\[ \begin{equation} n_r = M+1, \end{equation} \tag{2.21} \]</div> <p>where</p> <div class=arithmatex>\[ \begin{align} M = &amp; \sum_{i=1}^{\ell}n_i \\ n_i = &amp; \frac{n_{i-1}(n_y+n_x+i-1)}{i}, n_{0} = 1. \end{align} \tag{2.22} \]</div> <p>As we mentioned in the Introduction of the book, NARMAX methods aims to build the simplest models possible. The idea is to reproduce a wide range of behaviors using a small subset of terms from the vast search space formed by candidate regressors.</p> <p>Let's use SysIdentPy to see how the search space grows in the linear versus the nonlinear scenario. The <code>count_model_regressors</code> method available in <code>narmax_tools</code> can be used the check how many regressors exists in the search space given the number of inputs, the delays of <code>y</code> and <code>x</code> regressors and the basis function. We will use <code>xlag=ylag=10</code> and the polynomial basis function. The user can simulate different scenarios by setting different parameters.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.information_matrix</span><span class=w> </span><span class=kn>import</span> <span class=n>count_model_regressors</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</code></pre></div> <p>For the linear case with 1 input we have 21 regressors: <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># simulating a case with 1 input</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=p>)</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=n>n_regressors</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>21</span>
</code></pre></div></p> <p>For the linear case with 2 inputs, the number of regressors jumps to 31:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># simulating a case with 2 inputs</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>))]</span> <span class=o>*</span> <span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>    <span class=n>xlag</span><span class=o>=</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=p>)</span>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=n>n_regressors</span>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>31</span>
</code></pre></div> <p>If we consider a nonlinear case with 1 input by just changing the degree to 2, we have 231 regressors.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># simulating a case with 1 input</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=p>)</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=n>n_regressors</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>231</span>
</code></pre></div> <p>If we set the degree to 3, the number of terms increases significantly to 1771 regressors.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># simulating a case with 1 input</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=p>)</span>
<a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=n>n_regressors</span>
<a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>1771</span>
</code></pre></div> <p>If you have 2 inputs in the nonlinear scenario with <code>degree=2</code>, the number of regressors is 496:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># simulating a case with 2 inputs</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>))]</span> <span class=o>*</span> <span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>    <span class=n>xlag</span><span class=o>=</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=p>)</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=n>n_regressors</span>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>496</span>
</code></pre></div> <p>If you have 2 inputs in the nonlinear scenario with <code>degree=3</code>, the number jumps to 5456 regressors:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># simulating a case with 2 inputs</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>))]</span> <span class=o>*</span> <span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>    <span class=n>xlag</span><span class=o>=</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=p>)</span>
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=n>n_regressors</span>
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>5456</span>
</code></pre></div> <p>As you can notice, the number of regressors increases significantly as the degree of the polynomial and the number of inputs increases. That makes the model structure selection much more complex! In the linear case with 10 inputs we have <code>2^31=2.15e+09</code> possible model combinations. When <code>degree=2</code> with 2 inputs we have <code>2^496=2.05e+149</code> possible combinations! Try to get the number of possible model combinations when <code>degree=3</code> with 2 inputs. Moreover, try that with more inputs and higher nonlinear degree and see how the course of dimensionality is a big problem.</p> <p>As you can see, getting a simple model in such a large search space is complex model structure selection task. To select the most significant terms from a huge dictionary of possible terms is not an easy task. And it is hard not only because the complex combinatorial problem and the uncertainty concerning the model order. Identifying the most significant terms in a nonlinear scenario is very difficult because depends on the type of the nonlinearity (sparse singularity or near-singular behavior, memory or dumping effects and many others), dynamical response (spatial-temporal systems, time-dependent), the steady-state response, frequency of the data, the noise and many more.</p> <p>Because of the model structure selection algorithms developed for NARMAX models, even linear models like ARMAX can have different performance when obtained using SysIdentPy when compared to other libraries, like Statsmodels. We have a case study showing exactly that in Chapter 10.</p> <h3 id=narx>NARX<a class=headerlink href=#narx title="Permanent link">&para;</a></h3> <p>If we do not include noise terms <span class=arithmatex>\(e_{k-n_e}\)</span> in Equation (2.19), we have NARX models.</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}x_{k-j}^{b_i, j}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.23} \]</div> <p>The Equation 2.24 describes a simple polynomial NARX model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}^2+0.1139y_{k-1}x_{k-1} \end{align} \tag{2.24} \]</div> <p>The only difference in SysIdentPy is setting the <code>unbiased=False</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=p>)</span>
</code></pre></div> <blockquote> <p>The user can use the codes provided for linear models to analyse the nonlinear models with different noise realizations.</p> </blockquote> <h3 id=narma>NARMA<a class=headerlink href=#narma title="Permanent link">&para;</a></h3> <p>if we do not include input terms in Equation 2.19, it turns to NARMA model</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times\prod_{l=1}^{n_e}e_{k-l}^{d_i, l}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.25} \]</div> <p>The following example is a polynomial NARMA model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}^3+0.1139y_{k-3}y_{k-4} + 0.2245e_{k-1} \end{align} \tag{2.26} \]</div> <p>Since the model representation do not have inputs, we have to set the model type to <code>NAR</code> and set <code>unbiased=True</code> again in <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=p>)</span>
</code></pre></div> <h3 id=nar>NAR<a class=headerlink href=#nar title="Permanent link">&para;</a></h3> <p>if we do not include input terms and noise terms in Equation 2.19, it turns to AR model</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.27} \]</div> <p>The following example is a polynomial NAR model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}^2+0.1139y_{k-3}^3 -0.1691y_{k-4}y_{k-5} \end{align} \tag{2.28} \]</div> <p>In this case, we have to set the model type to <code>NAR</code> and set <code>unbiased=False</code> in <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=p>)</span>
</code></pre></div> <h3 id=nfir>NFIR<a class=headerlink href=#nfir title="Permanent link">&para;</a></h3> <p>If we only keep input terms in Equation 2.19, it becomes a NFIR model</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}x_{k-j}^{b_i, j} \end{align} \tag{2.29} \]</div> <p>The following example is a polynomial NFIR model:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213x_{k-1}-0.5692x_{k-2}^2+0.1139x_{k-3}x_{k-4} -0.1691x_{k-4}^3 \end{align} \tag{2.30} \]</div> <p>In this case, we have to set the model type to <code>NFIR</code> and set <code>unbiased=False</code> in <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NFIR&quot;</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=p>)</span>
</code></pre></div> <h3 id=mixed-narmax-models>Mixed NARMAX Models<a class=headerlink href=#mixed-narmax-models title="Permanent link">&para;</a></h3> <p>In some applications, using a single basis functions cannot provide a satisfactory description for the relationship between the input (or independent) variables and the output (or response) variable. In order to improve the performance of the model, it has been proposed to use a linear combination of a set of nonlinear functions to replace the linear counterparts.</p> <p>You can achieve that in SysIdentPy using ensembles in basis functions. You can build a Fourier model where terms have interactions. You can also build a model with mixed basis functions, using terms expanded by polynomial basis and Fourier basis or any other basis function available is the package.</p> <blockquote> <p>You can only mix a basis function with the polynomial basis for now in SysIdentPy. You can mix Fourier with Polynomial, but you can't mix Fourier with Bernstein.</p> </blockquote> <p>To mix Fourier or Bernstein basis with Polynomial, the user just have to set <code>ensamble=True</code> in the basis function definition</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Fourier</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Fourier</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>ensemble</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <h3 id=neural-narx-network>Neural NARX Network<a class=headerlink href=#neural-narx-network title="Permanent link">&para;</a></h3> <p>Neural networks are models composed of interconnected layers of nodes (neurons) designed for tasks like classification and regression. Each neuron is a basic unit within these networks. <a href="https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas?channel=doi&linkId=574cb16508ae82d2c6bc870f&showFulltext=true">Mathematically</a>, a neuron is represented by a function <span class=arithmatex>\(f\)</span> that takes an input vector <span class=arithmatex>\(\mathbf{x} = [x_1, x_2, \ldots, x_n]\)</span> and generates an output <span class=arithmatex>\(y\)</span>. This function usually involves a weighted sum of the inputs, an optional bias term <span class=arithmatex>\(b\)</span>, and an activation function <span class=arithmatex>\(\phi\)</span>:</p> <div class=arithmatex>\[ y = \phi \left( \sum_{i=1}^{n} w_i x_i + b \right) \tag{2.31} \]</div> <p>where <span class=arithmatex>\(\mathbf{w} = [w_1, w_2, \ldots, w_n]\)</span> are the weights associated with the inputs. The activation function <span class=arithmatex>\(\phi\)</span> introduces nonlinearity into the model, allowing the network to learn complex patterns. Common activation functions include:</p> <ul> <li> <p><strong>Sigmoid</strong>: <span class=arithmatex>\(\phi(z) = \frac{1}{1 + e^{-z}}\)</span> Produces outputs between 0 and 1, making it useful for binary classification.</p> </li> <li> <p><strong>Hyperbolic Tangent (tanh)</strong>: <span class=arithmatex>\(\phi(z) = \tanh(z) = \frac{e^z - e^{-z}}{e^z + e^{-z}}\)</span> Outputs values between -1 and 1, often used to center data around zero.</p> </li> <li> <p><strong>Rectified Linear Unit (ReLU)</strong>: <span class=arithmatex>\(\phi(z) = \max(0, z)\)</span> Outputs zero for negative values and the input value itself for positive values, helping to mitigate the vanishing gradient problem.</p> </li> <li> <p><strong>Leaky ReLU</strong>: <span class=arithmatex>\(\phi(z) = \max(0.01z, z)\)</span> A variant of ReLU that allows a small, non-zero gradient when the input is negative, addressing the problem of dying neurons.</p> </li> <li> <p><strong>Softmax</strong>: <span class=arithmatex>\(\phi(z_i) = \frac{e^{z_i}}{\sum_{j} e^{z_j}}\)</span> Converts logits into probabilities for multi-class classification, ensuring that the outputs sum to 1.</p> </li> </ul> <p>Each activation function has its own advantages and is chosen based on the specific needs of the neural network and the task at hand.</p> <p>As mentioned, neural network is composed of multiple layers, each consisting of several neurons. In this respect, the layers can be categorized into:</p> <ul> <li><strong>Input Layer</strong>: The layer that receives the input data.</li> <li><strong>Hidden Layers</strong>: Intermediate layers that process the inputs through weighted connections and activation functions.</li> <li><strong>Output Layer</strong>: The final layer that produces the output of the network.</li> </ul> <blockquote> <p>The network itself therefore has a very simple architecture. The terminology used in neural networks is also slightly different from the standard notation that is universal in system identification and statistics. So, instead of talking about model parameters, the term <em>network weights</em> is used, and instead of estimation, the term <em>learning</em> is used. This terminology was no doubt introduced to make it appear that something completely new was being discussed, whereas some of the problems addressed are quite traditional - <a href="https://www.amazon.com.br/s/ref=dp_byline_sr_book_1?ie=UTF8&field-author=Stephen+A+Billings&text=Stephen+A+Billings&sort=relevancerank&search-alias=stripbooks">Stephen A. Billings</a></p> </blockquote> <p>Notice that the network itself is simply a collection of nonlinear activation units <span class=arithmatex>\(\phi(\cdot)\)</span> that are simple static functions. There are no dynamics within the network. This is fine for applications such as pattern recognition, but to use the network in system identification lagged inputs and outputs are necessary and these have to be supplied as inputs either explicitly or through a recurrent procedure. In this respect, if we set <span class=arithmatex>\(\mathcal{F}\)</span> as a neural function, we can adapt it to create a neural NARX model by transforming the neural architecture into a NARX architecture. The neural NARX, however, is not linear in the parameters like the NARMAX models based on basis functions. So, algorithms like Orthogonal Least Squares are not adequate to estimate the weights of the model.</p> <p><strong>SysIdentPy</strong> support a Series-Parallel (open-loop) Feedforward Network training process, which make the training process easier. We convert the NARX network from Series-Parallel to the Parallel (closed-loop) configuration for prediction.</p> <p>Series-Parallel allows us to use <code>pytorch</code> directly for training, so <strong>SysIdentPy</strong> uses <code>pytorch</code> in the backend for neural NARX along with auxiliary methods available only in <strong>SysIdentPy</strong>.</p> <p>A simple neural NARX model can be represented as a Multi-Layer Perceptron neural network with autoregressive component along with delayed inputs.</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/Pasted%20image%2020240710121246.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/Pasted%20image%2020240710121246.png?raw=true"></a></p> <blockquote> <p>Figure 9. Parallel and series-parallel neural network architectures for modeling the dynamic system <span class=arithmatex>\(\mathbf{y}[k]=\mathbf{F}(\mathbf{y}[k-1], \mathbf{y}[k-2], \mathbf{u}[k-1], \mathbf{u}[k-2])\)</span>. The delay operator <span class=arithmatex>\(q^{-1}\)</span> is such that <span class=arithmatex>\(\mathbf{y}[k-1]=q^{-1} \mathbf{y}[k]\)</span>. Reference: <a href=https://arxiv.org/pdf/1706.07119>Antonio H. Ribeiro and Luis A. Aguirre</a></p> <p>Neural NARX is not the same model as Recurrent Neural Networks (RNN). The user is referred to the following paper for more details <a href=https://link.springer.com/article/10.1007/s005210050005>A Note on the Equivalence of NARX and RNN</a></p> </blockquote> <p>To build a Neural NARX network in SysIdentPy, the user must use <code>pytorch</code>. We use <code>pytorch</code> to make the definition of the network architecture flexible. However, this requires that the user have a better understanding of how a neural networks. See the script bellow of how to build a simple Neural NARX model in <strong>SysIdentPy</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=kn>from</span><span class=w> </span><span class=nn>torch</span><span class=w> </span><span class=kn>import</span> <span class=n>nn</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=kn>import</span><span class=w> </span><span class=nn>torch</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.neural_network</span><span class=w> </span><span class=kn>import</span> <span class=n>NARXNN</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.generate_data</span><span class=w> </span><span class=kn>import</span> <span class=n>get_siso_data</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.narmax_tools</span><span class=w> </span><span class=kn>import</span> <span class=n>regressor_code</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=c1># simulated data</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=n>x_train</span><span class=p>,</span> <span class=n>x_valid</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_valid</span> <span class=o>=</span> <span class=n>get_siso_data</span><span class=p>(</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>colored_noise</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>train_percentage</span><span class=o>=</span><span class=mi>80</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=p>)</span>
</code></pre></div> <p>The user can use <code>cuda</code> following the same approach when build a neural network in <strong>pytorch</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=n>device</span> <span class=o>=</span> <span class=s2>&quot;cuda&quot;</span> <span class=k>if</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&quot;cpu&quot;</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Using </span><span class=si>{</span><span class=n>device</span><span class=si>}</span><span class=s2> device&quot;</span><span class=p>)</span>
</code></pre></div> <p>The user can create a NARXNN object and choose the maximum lag of both input and output for building the regressor matrix to serve as input of the network. In addition, you can choose the loss function, the optimizer, the optional parameters of the optimizer, the number of epochs.</p> <p>Because we built this feature on top of Pytorch, you can choose any of the loss function of the torch.nn.functional. <a href=https://pytorch.org/docs/stable/nn.functional.html#loss-functions>Click here</a> for a list of the loss functions you can use. You just need to pass the name of the loss function you want.</p> <p>Similarly, you can choose any of the optimizer of the torch.optim. <a href=https://pytorch.org/docs/stable/optim.html>Click here</a> for a list of optimizer available.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=n>narx_net</span> <span class=o>=</span> <span class=n>NARXNN</span><span class=p>(</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>    <span class=n>loss_func</span><span class=o>=</span><span class=s2>&quot;mse_loss&quot;</span><span class=p>,</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>2000</span><span class=p>,</span>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>    <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>    <span class=n>optim_params</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>        <span class=s2>&quot;betas&quot;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.999</span><span class=p>),</span>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>        <span class=s2>&quot;eps&quot;</span><span class=p>:</span> <span class=mf>1e-05</span><span class=p>,</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a>    <span class=p>},</span>  <span class=c1># optional parameters of the optimizer</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a><span class=p>)</span>
</code></pre></div> <p>Because the NARXNN model were defined using <span class=arithmatex>\(ylag=2\)</span>, <span class=arithmatex>\(xlag=2\)</span> and a polynomial basis function with <span class=arithmatex>\(degree=1\)</span>, we have a regressor matrix with 4 features. We need the size of the regressor matrix to build the layers of our network. Our input data(<code>x_train</code>) have only one feature, but since we are creating an NARX network, a regressor matrix is built behind the scenes with new features based on the <code>xlag</code> and <code>ylag</code>.</p> <p>If you need help finding how many regressors are created behind the scenes you can use the <code>narmax_tools</code> function <code>regressor_code</code> and take the size of the regressor code generated:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=p>)</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=n>n_regressors</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>4</span>
</code></pre></div> <p>The configuration of your network follows exactly the same pattern of a network defined in Pytorch. The following representing our NARX neural network.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>class</span><span class=w> </span><span class=nc>NARX</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>n_regressors</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Tanh</span><span class=p>()</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>xb</span><span class=p>):</span>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin</span><span class=p>(</span><span class=n>xb</span><span class=p>)</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>        <span class=k>return</span> <span class=n>z</span>
</code></pre></div> <p>The user have to pass the defined network to our NARXNN estimator and set <code>cuda</code> if available (or needed):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=n>narx_net</span><span class=o>.</span><span class=n>net</span> <span class=o>=</span> <span class=n>NARX</span><span class=p>()</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=k>if</span> <span class=n>device</span> <span class=o>==</span> <span class=s2>&quot;cuda&quot;</span><span class=p>:</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>    <span class=n>narx_net</span><span class=o>.</span><span class=n>net</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>device</span><span class=p>(</span><span class=s2>&quot;cuda&quot;</span><span class=p>))</span>
</code></pre></div> <p>Because we have a fit (for training) and predict function for Polynomial NARMAX, we create the same pattern for the NARX net. So, you only have to fit and predict using the following:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=n>narx_net</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span> <span class=n>X_test</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y_test</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>narx_net</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
</code></pre></div> <p>If the net configuration is built before calling the NARXNN, just pass the model to the NARXNN as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=k>class</span><span class=w> </span><span class=nc>NARX</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>n_regressors</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Tanh</span><span class=p>()</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>xb</span><span class=p>):</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin</span><span class=p>(</span><span class=n>xb</span><span class=p>)</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>        <span class=k>return</span> <span class=n>z</span>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=n>narx_net2</span> <span class=o>=</span> <span class=n>NARXNN</span><span class=p>(</span>
<a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a>    <span class=n>net</span><span class=o>=</span><span class=n>NARX</span><span class=p>(),</span>
<a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-37-22 name=__codelineno-37-22 href=#__codelineno-37-22></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-37-23 name=__codelineno-37-23 href=#__codelineno-37-23></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-37-24 name=__codelineno-37-24 href=#__codelineno-37-24></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-37-25 name=__codelineno-37-25 href=#__codelineno-37-25></a>    <span class=n>loss_func</span><span class=o>=</span><span class=s2>&quot;mse_loss&quot;</span><span class=p>,</span>
<a id=__codelineno-37-26 name=__codelineno-37-26 href=#__codelineno-37-26></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
<a id=__codelineno-37-27 name=__codelineno-37-27 href=#__codelineno-37-27></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>2000</span><span class=p>,</span>
<a id=__codelineno-37-28 name=__codelineno-37-28 href=#__codelineno-37-28></a>    <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-37-29 name=__codelineno-37-29 href=#__codelineno-37-29></a>    <span class=n>optim_params</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-37-30 name=__codelineno-37-30 href=#__codelineno-37-30></a>        <span class=s2>&quot;betas&quot;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.999</span><span class=p>),</span>
<a id=__codelineno-37-31 name=__codelineno-37-31 href=#__codelineno-37-31></a>        <span class=s2>&quot;eps&quot;</span><span class=p>:</span> <span class=mf>1e-05</span><span class=p>,</span>
<a id=__codelineno-37-32 name=__codelineno-37-32 href=#__codelineno-37-32></a>    <span class=p>},</span>  <span class=c1># optional parameters of the optimizer</span>
<a id=__codelineno-37-33 name=__codelineno-37-33 href=#__codelineno-37-33></a><span class=p>)</span>
<a id=__codelineno-37-34 name=__codelineno-37-34 href=#__codelineno-37-34></a>
<a id=__codelineno-37-35 name=__codelineno-37-35 href=#__codelineno-37-35></a><span class=n>narx_net2</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-37-36 name=__codelineno-37-36 href=#__codelineno-37-36></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>narx_net2</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
</code></pre></div> <h3 id=general-model-set-representation>General Model Set Representation<a class=headerlink href=#general-model-set-representation title="Permanent link">&para;</a></h3> <p>Based on the idea of transforming a static neural network in a neural NARX model, we can extend the method for basically any model class. SysIdentPy do not aim to implement every model class that exists in literature. However, we created a functionality that allows the usage of any other machine learning package that follows a <code>fit</code> and <code>predict</code> API inside SysIdentPy to convert such models to NARX versions of them.</p> <p>Let's take XGBoost (eXtreme Gradient Boosting) Algorithm as an example. XGBoost is a well known model class used for regression tasks. XGBoost, however, are not a common choice when you are dealing with a dynamical system identification task because they are originally made for modeling static systems. You can easily transform XGBoost into a NARX model using SysIdentPy.</p> <p>Scikit-learn, for example, is another great example. You can transform any Scikit-learn model into NARX models using SysIdentPy. We will see such applications in detail at Chapter 11, but you can see how easy it in the script bellow</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.general_estimators</span><span class=w> </span><span class=kn>import</span> <span class=n>NARX</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>BayesianRidge</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=kn>import</span><span class=w> </span><span class=nn>xgboost</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>xgb</span>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Fourier</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=c1># define the scikit estimator</span>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=n>scikit_estimator</span> <span class=o>=</span> <span class=n>BayesianRidge</span><span class=p>()</span>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=c1># transform scikit_estimator into NARX model</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a><span class=n>gb_narx</span> <span class=o>=</span> <span class=n>NARX</span><span class=p>(</span>
<a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>    <span class=n>base_estimator</span><span class=o>=</span><span class=n>scikit_estimator</span><span class=p>,</span>
<a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-38-16 name=__codelineno-38-16 href=#__codelineno-38-16></a><span class=p>)</span>
<a id=__codelineno-38-17 name=__codelineno-38-17 href=#__codelineno-38-17></a>
<a id=__codelineno-38-18 name=__codelineno-38-18 href=#__codelineno-38-18></a><span class=n>gb_narx</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-38-19 name=__codelineno-38-19 href=#__codelineno-38-19></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>gb_narx</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-38-20 name=__codelineno-38-20 href=#__codelineno-38-20></a>
<a id=__codelineno-38-21 name=__codelineno-38-21 href=#__codelineno-38-21></a><span class=c1># XGboost examples</span>
<a id=__codelineno-38-22 name=__codelineno-38-22 href=#__codelineno-38-22></a><span class=n>xgb_estimator</span> <span class=o>=</span> <span class=n>xgb</span><span class=o>.</span><span class=n>XGBRegressor</span><span class=p>()</span>
<a id=__codelineno-38-23 name=__codelineno-38-23 href=#__codelineno-38-23></a><span class=n>xgb_narx</span> <span class=o>=</span> <span class=n>NARX</span><span class=p>(</span>
<a id=__codelineno-38-24 name=__codelineno-38-24 href=#__codelineno-38-24></a>    <span class=n>base_estimator</span><span class=o>=</span><span class=n>xgb_estimator</span><span class=p>,</span>
<a id=__codelineno-38-25 name=__codelineno-38-25 href=#__codelineno-38-25></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-26 name=__codelineno-38-26 href=#__codelineno-38-26></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-27 name=__codelineno-38-27 href=#__codelineno-38-27></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-38-28 name=__codelineno-38-28 href=#__codelineno-38-28></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-38-29 name=__codelineno-38-29 href=#__codelineno-38-29></a><span class=p>)</span>
<a id=__codelineno-38-30 name=__codelineno-38-30 href=#__codelineno-38-30></a>
<a id=__codelineno-38-31 name=__codelineno-38-31 href=#__codelineno-38-31></a><span class=n>xgb_narx</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-38-32 name=__codelineno-38-32 href=#__codelineno-38-32></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>xgb_narx</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
</code></pre></div> <p>You can use any other model by just changing the model class and passing it to the <code>base_estimator</code> in <code>NARX</code> functionality.</p> <h3 id=mimo-models>MIMO Models<a class=headerlink href=#mimo-models title="Permanent link">&para;</a></h3> <p>To keep things simple, only SISO models were represented in previous sections. However, the NARMAX models can effortlessly be extended to MIMO case (<a href=https://www.tandfonline.com/doi/abs/10.1080/00207178908559767>Billings, S. A. and Chen, S. and Korenberg, M. J.</a>):</p> <div class=arithmatex>\[ \begin{align} y_{{_i}k}=&amp; F_{{_i}}^\ell \bigl[y_{{_1}k-1}, \dotsc, y_{{_1}k-n^i_{y{_1}}},\dotsc, y_{{_s}k-1}, \dotsc, y_{{_s}k-n^i_{y{_s}}}, x_{{_1}k-d}, \\ &amp; x_{{_1}k-d-1}, \dotsc, x_{{_1}k-d-n^i_{x{_1}}}, \dotsc, x_{{_r}k-d}, x_{{_r}k-d-1}, \dotsc, x_{{_r}k-d-n^i_{x{_r}}}\bigr] + \xi_{{_i}k}, \end{align} \tag{2.32} \]</div> <p>where for <span class=arithmatex>\(i = 1, \dotsc, s\)</span>, each linear in the parameter sub-model can change regarding different maximum lags. More generally, considering</p> <div class=arithmatex>\[ \begin{align} Y_k = \begin{bmatrix} y_{{_1}k} \\ y_{{_2}k} \\ \vdots \\ y_{{_s}k} \end{bmatrix}, X_k = \begin{bmatrix} x_{{_1}k} \\ x_{{_2}k} \\ \vdots \\ x_{{_r}k} \end{bmatrix}, \Xi_k = \begin{bmatrix} \xi_{{_1}k} \\ \xi_{{_2}k} \\ \vdots \\ \xi_{{_r}k} \end{bmatrix}, \end{align} \tag{2.33} \]</div> <p>the MIMO model can be denoted as</p> <div class=arithmatex>\[ \begin{equation} Y_k= F^\ell[Y_{k-1}, \dotsc, Y_{k-n_y},X_{k-d}, X_{k-d-1}, \dotsc, X_{k-d-n_x}] + \Xi_k, \end{equation} \tag{2.34} \]</div> <p>where <span class=arithmatex>\(Xk ~= \{x_{{_1}k}, x_{{_2}k}, \dotsc, x_{{_r}k}\}\in \mathbb{R}^{n^i_{x{_r}}}\)</span> and <span class=arithmatex>\(Yk~= \{y_{{_1}k}, y_{{_2}k}, \dotsc, y_{{_s}k}\}\in \mathbb{R}^{n^i_{y{_s}}}\)</span>. The number of possibles terms of MIMO NARX model given the <span class=arithmatex>\(i\)</span>-th polynomial degree, <span class=arithmatex>\(\ell_i\)</span>, is:</p> <div class=arithmatex>\[ \begin{equation} n_{{_{m}}r} = \sum_{j = 0}^{\ell_i}n_{ij}, \end{equation} \tag{2.35} \]</div> <p>where</p> <div class=arithmatex>\[ \begin{align} n_{ij} = \frac{ n_{ij-1} \biggl[ \sum\limits_{k=1}^{s} n^i_{y_k} + \sum\limits_{k=1}^{r} n^i_{x_k} + j - 1 \biggr]}{j}, \qquad n_{i0}=1, j=1, \dotsc, \ell_i. \end{align} \tag{2.36} \]</div> <p>If <span class=arithmatex>\(s=1\)</span>, we have a MISO model that can be represented by a single polynomial function. Additionally, a MIMO model can be decomposed into MISO models, as presented in the following figure:</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/mimo_split.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/mimo_split.png?raw=true"></a></p> <blockquote> <p>Figure 10. A MIMO model split into individual MISO models.</p> <p>SysIdentPy do not support MIMO models yet, only MISO models. You can, however, decompose a MIMO system as presented in Figure 9 and use SysIdentPy to create models for each subsystem.</p> </blockquote> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Volver al principio </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Pie> <a href=../1-Introduction/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: Introduction"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Anterior </span> <div class=md-ellipsis> Introduction </div> </div> </a> <a href=../3-Parameter-Estimation/ class="md-footer__link md-footer__link--next" aria-label="Siguiente: 3. Parameter Estimation"> <div class=md-footer__title> <span class=md-footer__direction> Siguiente </span> <div class=md-ellipsis> 3. Parameter Estimation </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2016 - 2025 Wilson Rocha </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/wilsonrljr target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/sysidentpy/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> <a href=https://twitter.com/wilsonrljr target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script> <script src=../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../../overrides/assets/js/katex.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js></script> <script src=../../../overrides/assets/vendor/js/prism.js></script> <script src=https://cdn.jsdelivr.net/npm/apexcharts></script> <script src=../../../overrides/assets/js/chart-example.js></script> <script src=../../../overrides/assets/js/scripts.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>