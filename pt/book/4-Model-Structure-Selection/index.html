<!doctype html><html lang=pt class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="De Métodos Clássicos a Redes Neurais"><meta name=author content="Wilson Rocha"><link href=https://sysidentpy.org/pt/book/4-Model-Structure-Selection/ rel=canonical><link href=../3-Parameter-Estimation/ rel=prev><link href=../5-Multiobjective-Parameter-Estimation/ rel=next><link rel=icon href=../../../en/assets/img/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.6"><title>4. Seleção de Estrutura de Modelo - SysIdentPy</title><link rel=stylesheet href=../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../overrides/assets/css/extra.css><link rel=stylesheet href=../../../overrides/assets/css/feature-grid.css><link rel=stylesheet href=../../../overrides/assets/css/fontsize.css><link rel=stylesheet href=../../../overrides/assets/css/card-container.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css><link rel=stylesheet href=../../../overrides/assets/vendor/css/prism.css><link rel=stylesheet href=../../../overrides/assets/css/style.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-16K3SQT164"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-16K3SQT164",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-16K3SQT164",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#introducao class=md-skip> Ir para o conteúdo </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabeçalho> <a href=../../ title=SysIdentPy class="md-header__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SysIdentPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 4. Seleção de Estrutura de Modelo </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label="Selecione o idioma"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=../../../book/4-Model-Structure-Selection/ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=./ hreflang=pt class=md-select__link> Português (Brasil) </a> </li> <li class=md-select__item> <a href=../../../es/book/4-Model-Structure-Selection/ hreflang=es class=md-select__link> Español </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Buscar placeholder=Buscar autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Pesquisar> <a href=javascript:void(0) class="md-search__icon md-icon" title=Compartilhar aria-label=Compartilhar data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Limpar aria-label=Limpar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando a pesquisa </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Abas data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../ class=md-tabs__link> Início </a> </li> <li class=md-tabs__item> <a href=../../getting-started/getting-started/ class=md-tabs__link> Primeiros Passos </a> </li> <li class=md-tabs__item> <a href=../../user-guide/overview/ class=md-tabs__link> Guia </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../0-Preface/ class=md-tabs__link> Livro </a> </li> <li class=md-tabs__item> <a href=../../developer-guide/contribute/ class=md-tabs__link> Contribuir </a> </li> <li class=md-tabs__item> <a href=../../community-support/community-overview/ class=md-tabs__link> Comunidade </a> </li> <li class=md-tabs__item> <a href=../../landing-page/about-us/ class=md-tabs__link> Sobre </a> </li> <li class=md-tabs__item> <a href=../../changelog/changelog/ class=md-tabs__link> Changelog </a> </li> <li class=md-tabs__item> <a href=../../landing-page/sponsor/ class=md-tabs__link> Apoie </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navegação data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../ title=SysIdentPy class="md-nav__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> SysIdentPy </label> <div class=md-nav__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> <span class=md-ellipsis> Início </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Primeiros Passos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Primeiros Passos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/getting-started/ class=md-nav__link> <span class=md-ellipsis> Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart-guide/ class=md-nav__link> <span class=md-ellipsis> Guia Rápido </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/narmax-intro/ class=md-nav__link> <span class=md-ellipsis> Introdução ao NARMAX </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> Licença </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Guia </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Guia </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/overview/ class=md-nav__link> <span class=md-ellipsis> Visão Geral </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Tutoriais </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Tutoriais </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_1> <label class=md-nav__link for=__nav_3_2_1 id=__nav_3_2_1_label tabindex=0> <span class=md-ellipsis> Funcionalidades </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Funcionalidades </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/your-first-model/ class=md-nav__link> <span class=md-ellipsis> Seu Primeiro Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/model-with-multiple-inputs/ class=md-nav__link> <span class=md-ellipsis> Modelo com Múltiplas Entradas </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Estimação de Parâmetros - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/basis-function-overview/ class=md-nav__link> <span class=md-ellipsis> Funções Base - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/information-criteria-overview/ class=md-nav__link> <span class=md-ellipsis> Critérios de Informação - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/general-NARX-models/ class=md-nav__link> <span class=md-ellipsis> Modelos NARX Gerais - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/fourier-NARX-overview/ class=md-nav__link> <span class=md-ellipsis> Fourier NARX - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/aols-overview/ class=md-nav__link> <span class=md-ellipsis> AOLS - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/NFIR-model-overview/ class=md-nav__link> <span class=md-ellipsis> NFIR - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/importance-of-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Importância do Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2 id=__nav_3_2_2_label tabindex=0> <span class=md-ellipsis> Sistemas Elétricos e Mecânicos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Sistemas Elétricos e Mecânicos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/modeling-a-magneto-rheological-damper-device/ class=md-nav__link> <span class=md-ellipsis> Modelagem de um Dispositivo Amortecedor Magneto-Reológico </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/silver-box-system/ class=md-nav__link> <span class=md-ellipsis> Sistema Silver Box </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/coupled-eletric-device/ class=md-nav__link> <span class=md-ellipsis> Dispositivo Elétrico Acoplado </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/wiener-hammerstein-system/ class=md-nav__link> <span class=md-ellipsis> Sistema Wiener-Hammerstein </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/f-16-aircraft/ class=md-nav__link> <span class=md-ellipsis> Aeronave F-16 </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/f-16-aircraft-n-steps-ahead-prediction/ class=md-nav__link> <span class=md-ellipsis> Aeronave F-16 - Previsão N Passos à Frente </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-overview/ class=md-nav__link> <span class=md-ellipsis> Identificação de Sistema Eletromecânico - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-metamss/ class=md-nav__link> <span class=md-ellipsis> Identificação de Sistema Eletromecânico - MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Identificação de Sistema Eletromecânico - Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/multiobjective-parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Estimação de Parâmetros Multiobjetivo - Visão Geral </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3 id=__nav_3_2_3_label tabindex=0> <span class=md-ellipsis> Industriais e Corporativos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Industriais e Corporativos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/m4-benchmark/ class=md-nav__link> <span class=md-ellipsis> M4 Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/air-passenger-benchmark/ class=md-nav__link> <span class=md-ellipsis> Air Passenger Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/load-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Previsão de Carga - Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/PV-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Previsão Fotovoltaica - Benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4 id=__nav_3_2_4_label tabindex=0> <span class=md-ellipsis> Sistemas Caóticos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Sistemas Caóticos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/chaotic-systems/lorenz-system/ class=md-nav__link> <span class=md-ellipsis> Sistema de Lorenz </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/chaotic-systems/logistic-map/ class=md-nav__link> <span class=md-ellipsis> Mapa Logístico </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Como fazer </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Como fazer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/how-to/create-custom-basis-function/ class=md-nav__link> <span class=md-ellipsis> Criar uma Função Base Customizada </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/create-a-narx-neural-network/ class=md-nav__link> <span class=md-ellipsis> Criar uma Rede Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/save-and-load-models/ class=md-nav__link> <span class=md-ellipsis> Salvar e Carregar Modelos </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/set-specific-lags/ class=md-nav__link> <span class=md-ellipsis> Definir Lags Específicos </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/simulating-existing-models/ class=md-nav__link> <span class=md-ellipsis> Simular Modelos Existentes </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/use-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Usar Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/API/narmax-base/ class=md-nav__link> <span class=md-ellipsis> NARMAX Base </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/ofr-base/ class=md-nav__link> <span class=md-ellipsis> OFR Base </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/basis-function/ class=md-nav__link> <span class=md-ellipsis> Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/frols/ class=md-nav__link> <span class=md-ellipsis> FROLS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metamss/ class=md-nav__link> <span class=md-ellipsis> MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/aols/ class=md-nav__link> <span class=md-ellipsis> AOLS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/uofr/ class=md-nav__link> <span class=md-ellipsis> UOFR </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/neural-narx/ class=md-nav__link> <span class=md-ellipsis> Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/general-estimators/ class=md-nav__link> <span class=md-ellipsis> General Estimators </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/multiobjective-parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/simulation/ class=md-nav__link> <span class=md-ellipsis> Simulation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/residues/ class=md-nav__link> <span class=md-ellipsis> Residual Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metaheuristics/ class=md-nav__link> <span class=md-ellipsis> Metaheuristics </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Livro </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Livro </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../0-Preface/ class=md-nav__link> <span class=md-ellipsis> Prefácio </span> </a> </li> <li class=md-nav__item> <a href=../0.1-Contents/ class=md-nav__link> <span class=md-ellipsis> Sumário </span> </a> </li> <li class=md-nav__item> <a href=../1-Introduction/ class=md-nav__link> <span class=md-ellipsis> Introdução </span> </a> </li> <li class=md-nav__item> <a href=../2-NARMAX-Model-Representation/ class=md-nav__link> <span class=md-ellipsis> 2. Representação do Modelo NARMAX </span> </a> </li> <li class=md-nav__item> <a href=../3-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 3. Estimação de Parâmetros </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 4. Seleção de Estrutura de Modelo </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 4. Seleção de Estrutura de Modelo </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introducao class=md-nav__link> <span class=md-ellipsis> Introdução </span> </a> </li> <li class=md-nav__item> <a href=#o-algoritmo-forward-regression-orthogonal-least-squares class=md-nav__link> <span class=md-ellipsis> O algoritmo Forward Regression Orthogonal Least Squares </span> </a> <nav class=md-nav aria-label="O algoritmo Forward Regression Orthogonal Least Squares"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mantendo-as-coisas-simples class=md-nav__link> <span class=md-ellipsis> Mantendo as coisas simples </span> </a> <nav class=md-nav aria-label="Mantendo as coisas simples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#caso-ortogonal class=md-nav__link> <span class=md-ellipsis> Caso ortogonal </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#estudo-de-caso class=md-nav__link> <span class=md-ellipsis> Estudo de caso </span> </a> </li> <li class=md-nav__item> <a href=#criterios-de-informacao class=md-nav__link> <span class=md-ellipsis> Critérios de Informação </span> </a> <nav class=md-nav aria-label="Critérios de Informação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#visao-geral-dos-metodos-de-criterio-de-informacao class=md-nav__link> <span class=md-ellipsis> Visão geral dos métodos de Critério de Informação </span> </a> <nav class=md-nav aria-label="Visão geral dos métodos de Critério de Informação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#aic class=md-nav__link> <span class=md-ellipsis> AIC </span> </a> </li> <li class=md-nav__item> <a href=#aicc class=md-nav__link> <span class=md-ellipsis> AICc </span> </a> </li> <li class=md-nav__item> <a href=#bic class=md-nav__link> <span class=md-ellipsis> BIC </span> </a> </li> <li class=md-nav__item> <a href=#lilc class=md-nav__link> <span class=md-ellipsis> LILC </span> </a> </li> <li class=md-nav__item> <a href=#fpe class=md-nav__link> <span class=md-ellipsis> FPE </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#meta-model-structure-selection-metamss class=md-nav__link> <span class=md-ellipsis> Meta Model Structure Selection (MetaMSS) </span> </a> <nav class=md-nav aria-label="Meta Model Structure Selection (MetaMSS)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#metaheuristicas class=md-nav__link> <span class=md-ellipsis> Metaheurísticas </span> </a> <nav class=md-nav aria-label=Metaheurísticas> <ul class=md-nav__list> <li class=md-nav__item> <a href=#o-algoritmo-binary-hybrid-particle-swarm-optimization-and-gravitational-search-algorithm-bpsogsa class=md-nav__link> <span class=md-ellipsis> O algoritmo Binary hybrid Particle Swarm Optimization and Gravitational Search Algorithm (BPSOGSA) </span> </a> </li> <li class=md-nav__item> <a href=#particle-swarm-optimization-pso-padrao class=md-nav__link> <span class=md-ellipsis> Particle Swarm Optimization (PSO) padrão </span> </a> </li> <li class=md-nav__item> <a href=#gravitational-search-algorithm-gsa-padrao class=md-nav__link> <span class=md-ellipsis> Gravitational Search Algorithm (GSA) padrão </span> </a> </li> <li class=md-nav__item> <a href=#o-algoritmo-hibrido-binario-de-otimizacao class=md-nav__link> <span class=md-ellipsis> O algoritmo híbrido binário de otimização </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#meta-model-structure-selection-metamss-construindo-narx-para-regressao class=md-nav__link> <span class=md-ellipsis> Meta-Model Structure Selection (MetaMSS): Construindo NARX para regressão </span> </a> <nav class=md-nav aria-label="Meta-Model Structure Selection (MetaMSS): Construindo NARX para regressão"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#esquema-de-codificacao class=md-nav__link> <span class=md-ellipsis> Esquema de codificação </span> </a> </li> <li class=md-nav__item> <a href=#formulacao-da-funcao-objetivo class=md-nav__link> <span class=md-ellipsis> Formulação da função objetivo </span> </a> </li> <li class=md-nav__item> <a href=#valor-de-penalizacao-baseado-na-derivada-da-sigmoid-linear-unit class=md-nav__link> <span class=md-ellipsis> Valor de penalização baseado na derivada da Sigmoid Linear Unit </span> </a> </li> <li class=md-nav__item> <a href=#estudos-de-caso-resultados-de-simulacao class=md-nav__link> <span class=md-ellipsis> Estudos de caso: resultados de simulação </span> </a> </li> <li class=md-nav__item> <a href=#influencia-dos-parametros-max_iter-e-n_agents class=md-nav__link> <span class=md-ellipsis> Influência dos parâmetros \(max\_iter\) e \(n\_agents\) </span> </a> </li> <li class=md-nav__item> <a href=#selecao-de-modelos-super-e-subparametrizados class=md-nav__link> <span class=md-ellipsis> Seleção de modelos super e sub‑parametrizados </span> </a> </li> <li class=md-nav__item> <a href=#metamss-vs-frols class=md-nav__link> <span class=md-ellipsis> MetaMSS vs FROLS </span> </a> </li> <li class=md-nav__item> <a href=#meta-mss-vs-rjmcmc class=md-nav__link> <span class=md-ellipsis> Meta-MSS vs RJMCMC </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#metamss-usando-sysidentpy class=md-nav__link> <span class=md-ellipsis> MetaMSS usando SysIdentPy </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accelerated-orthogonal-least-squares-aols-e-entropic-regression-er class=md-nav__link> <span class=md-ellipsis> Accelerated Orthogonal Least Squares (AOLS) e Entropic Regression (ER) </span> </a> <nav class=md-nav aria-label="Accelerated Orthogonal Least Squares (AOLS) e Entropic Regression (ER)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accelerated-orthogonal-least-squares class=md-nav__link> <span class=md-ellipsis> Accelerated Orthogonal Least Squares </span> </a> </li> <li class=md-nav__item> <a href=#entropic-regression class=md-nav__link> <span class=md-ellipsis> Entropic Regression </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../5-Multiobjective-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 5. Estimação de Parâmetros Multiobjetivo </span> </a> </li> <li class=md-nav__item> <a href=../6-Multiobjective-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 6. Seleção de Estrutura de Modelo Multiobjetivo </span> </a> </li> <li class=md-nav__item> <a href=../7-NARX-Neural-Network/ class=md-nav__link> <span class=md-ellipsis> 7. Rede Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../8-Severely-Nonlinear-System-Identification/ class=md-nav__link> <span class=md-ellipsis> 8. Identificação de Sistemas Severamente Não Lineares </span> </a> </li> <li class=md-nav__item> <a href=../9-Validation/ class=md-nav__link> <span class=md-ellipsis> 9. Validação </span> </a> </li> <li class=md-nav__item> <a href=../10-Case-Studies/ class=md-nav__link> <span class=md-ellipsis> 10. Estudos de Caso </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Contribuir </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Contribuir </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/contribute/ class=md-nav__link> <span class=md-ellipsis> Como contribuir </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Documentação </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Documentação </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/documentation-overview/ class=md-nav__link> <span class=md-ellipsis> Visão Geral da Documentação </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-write-a-tutorial/ class=md-nav__link> <span class=md-ellipsis> Como Escrever um Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-write-a-how-to-guide/ class=md-nav__link> <span class=md-ellipsis> Como Escrever um Guia How-to </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-add-a-translation/ class=md-nav__link> <span class=md-ellipsis> Como Adicionar uma Tradução </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Comunidade </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Comunidade </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community-support/community-overview/ class=md-nav__link> <span class=md-ellipsis> Visão Geral da Comunidade </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/get-help/ class=md-nav__link> <span class=md-ellipsis> Obter Ajuda </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Palestras </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Palestras </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community-support/meetups/ai-networks-meetup/ class=md-nav__link> <span class=md-ellipsis> AI Networks Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/nubank-meetup/ class=md-nav__link> <span class=md-ellipsis> Nubank Meetup - Séries Temporais </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/nubank-meetup-open-source/ class=md-nav__link> <span class=md-ellipsis> Nubank Meetup - Open Source </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/gcom-meetup/ class=md-nav__link> <span class=md-ellipsis> GCoM Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/estatidados/ class=md-nav__link> <span class=md-ellipsis> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../landing-page/about-us/ class=md-nav__link> <span class=md-ellipsis> Sobre </span> </a> </li> <li class=md-nav__item> <a href=../../changelog/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../landing-page/sponsor/ class=md-nav__link> <span class=md-ellipsis> Apoie </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introducao class=md-nav__link> <span class=md-ellipsis> Introdução </span> </a> </li> <li class=md-nav__item> <a href=#o-algoritmo-forward-regression-orthogonal-least-squares class=md-nav__link> <span class=md-ellipsis> O algoritmo Forward Regression Orthogonal Least Squares </span> </a> <nav class=md-nav aria-label="O algoritmo Forward Regression Orthogonal Least Squares"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mantendo-as-coisas-simples class=md-nav__link> <span class=md-ellipsis> Mantendo as coisas simples </span> </a> <nav class=md-nav aria-label="Mantendo as coisas simples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#caso-ortogonal class=md-nav__link> <span class=md-ellipsis> Caso ortogonal </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#estudo-de-caso class=md-nav__link> <span class=md-ellipsis> Estudo de caso </span> </a> </li> <li class=md-nav__item> <a href=#criterios-de-informacao class=md-nav__link> <span class=md-ellipsis> Critérios de Informação </span> </a> <nav class=md-nav aria-label="Critérios de Informação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#visao-geral-dos-metodos-de-criterio-de-informacao class=md-nav__link> <span class=md-ellipsis> Visão geral dos métodos de Critério de Informação </span> </a> <nav class=md-nav aria-label="Visão geral dos métodos de Critério de Informação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#aic class=md-nav__link> <span class=md-ellipsis> AIC </span> </a> </li> <li class=md-nav__item> <a href=#aicc class=md-nav__link> <span class=md-ellipsis> AICc </span> </a> </li> <li class=md-nav__item> <a href=#bic class=md-nav__link> <span class=md-ellipsis> BIC </span> </a> </li> <li class=md-nav__item> <a href=#lilc class=md-nav__link> <span class=md-ellipsis> LILC </span> </a> </li> <li class=md-nav__item> <a href=#fpe class=md-nav__link> <span class=md-ellipsis> FPE </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#meta-model-structure-selection-metamss class=md-nav__link> <span class=md-ellipsis> Meta Model Structure Selection (MetaMSS) </span> </a> <nav class=md-nav aria-label="Meta Model Structure Selection (MetaMSS)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#metaheuristicas class=md-nav__link> <span class=md-ellipsis> Metaheurísticas </span> </a> <nav class=md-nav aria-label=Metaheurísticas> <ul class=md-nav__list> <li class=md-nav__item> <a href=#o-algoritmo-binary-hybrid-particle-swarm-optimization-and-gravitational-search-algorithm-bpsogsa class=md-nav__link> <span class=md-ellipsis> O algoritmo Binary hybrid Particle Swarm Optimization and Gravitational Search Algorithm (BPSOGSA) </span> </a> </li> <li class=md-nav__item> <a href=#particle-swarm-optimization-pso-padrao class=md-nav__link> <span class=md-ellipsis> Particle Swarm Optimization (PSO) padrão </span> </a> </li> <li class=md-nav__item> <a href=#gravitational-search-algorithm-gsa-padrao class=md-nav__link> <span class=md-ellipsis> Gravitational Search Algorithm (GSA) padrão </span> </a> </li> <li class=md-nav__item> <a href=#o-algoritmo-hibrido-binario-de-otimizacao class=md-nav__link> <span class=md-ellipsis> O algoritmo híbrido binário de otimização </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#meta-model-structure-selection-metamss-construindo-narx-para-regressao class=md-nav__link> <span class=md-ellipsis> Meta-Model Structure Selection (MetaMSS): Construindo NARX para regressão </span> </a> <nav class=md-nav aria-label="Meta-Model Structure Selection (MetaMSS): Construindo NARX para regressão"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#esquema-de-codificacao class=md-nav__link> <span class=md-ellipsis> Esquema de codificação </span> </a> </li> <li class=md-nav__item> <a href=#formulacao-da-funcao-objetivo class=md-nav__link> <span class=md-ellipsis> Formulação da função objetivo </span> </a> </li> <li class=md-nav__item> <a href=#valor-de-penalizacao-baseado-na-derivada-da-sigmoid-linear-unit class=md-nav__link> <span class=md-ellipsis> Valor de penalização baseado na derivada da Sigmoid Linear Unit </span> </a> </li> <li class=md-nav__item> <a href=#estudos-de-caso-resultados-de-simulacao class=md-nav__link> <span class=md-ellipsis> Estudos de caso: resultados de simulação </span> </a> </li> <li class=md-nav__item> <a href=#influencia-dos-parametros-max_iter-e-n_agents class=md-nav__link> <span class=md-ellipsis> Influência dos parâmetros \(max\_iter\) e \(n\_agents\) </span> </a> </li> <li class=md-nav__item> <a href=#selecao-de-modelos-super-e-subparametrizados class=md-nav__link> <span class=md-ellipsis> Seleção de modelos super e sub‑parametrizados </span> </a> </li> <li class=md-nav__item> <a href=#metamss-vs-frols class=md-nav__link> <span class=md-ellipsis> MetaMSS vs FROLS </span> </a> </li> <li class=md-nav__item> <a href=#meta-mss-vs-rjmcmc class=md-nav__link> <span class=md-ellipsis> Meta-MSS vs RJMCMC </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#metamss-usando-sysidentpy class=md-nav__link> <span class=md-ellipsis> MetaMSS usando SysIdentPy </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accelerated-orthogonal-least-squares-aols-e-entropic-regression-er class=md-nav__link> <span class=md-ellipsis> Accelerated Orthogonal Least Squares (AOLS) e Entropic Regression (ER) </span> </a> <nav class=md-nav aria-label="Accelerated Orthogonal Least Squares (AOLS) e Entropic Regression (ER)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accelerated-orthogonal-least-squares class=md-nav__link> <span class=md-ellipsis> Accelerated Orthogonal Least Squares </span> </a> </li> <li class=md-nav__item> <a href=#entropic-regression class=md-nav__link> <span class=md-ellipsis> Entropic Regression </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/wilsonrljr/sysidentpy/edit/main/docs/pt/book/4-Model-Structure-Selection.md title="Editar esta página" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/wilsonrljr/sysidentpy/raw/main/docs/pt/book/4-Model-Structure-Selection.md title="Ver fonte desta página" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>4. Seleção de Estrutura de Modelo</h1> <h2 id=introducao>Introdução<a class=headerlink href=#introducao title="Permanent link">&para;</a></h2> <blockquote> <p>Esta seção é baseada, em grande parte, na minha dissertação de mestrado, que por sua vez se baseia em <a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A</a>.</p> </blockquote> <p>Selecionar a estrutura do modelo é um passo crucial para desenvolver modelos capazes de reproduzir corretamente o comportamento de um sistema. Se algumas informações prévias sobre o sistema forem conhecidas, por exemplo, a ordem dinâmica e o grau de não linearidade, determinar os termos e então estimar os parâmetros torna-se uma tarefa trivial. Em cenários reais, entretanto, geralmente não há informação sobre quais termos devem ser incluídos no modelo e os regressores corretos precisam ser selecionados no contexto de identificação. Se o processo de Model Structure Selection (MSS) não for realizado com o devido cuidado, a lei científica que descreve o sistema pode não ser revelada, resultando em interpretações equivocadas sobre o comportamento do sistema. Para ilustrar esse cenário, considere o seguinte exemplo.</p> <p>Seja <span class=arithmatex>\(\mathcal{D}\)</span> um conjunto de dados arbitrário</p> <div class=arithmatex>\[ \begin{equation} \mathcal{D} = \{(x_k, y_k), k = 1, 2, \dotsc, n\}, \end{equation} \]</div> <p>em que <span class=arithmatex>\(x_k \in \mathbb{R}^{n_x}\)</span> e <span class=arithmatex>\(y_k\in \mathbb{R}^{n_y}\)</span> são, respectivamente, a entrada e a saída de um sistema desconhecido, e <span class=arithmatex>\(n\)</span> é o número de amostras no conjunto de dados. A seguir, considere dois modelos polinomiais NARX construídos para descrever esse sistema:</p> <div class=arithmatex>\[ \begin{align} y_{ak} &amp;= 0.7077y_{ak-1} + 0.1642u_{k-1} + 0.1280u_{k-2} \end{align} \tag{2} \]</div> <div class=arithmatex>\[ \begin{align} y_{bk} &amp;= 0.7103y_{bk-1} + 0.1458u_{k-1} + 0.1631u_{k-2} \\ &amp;\quad - 1467y_{bk-1}^3 + 0.0710y_{bk-2}^3 + 0.0554y_{bk-3}^2u_{k-3}. \end{align} \tag{3} \]</div> <p>A Figura 1 mostra os valores previstos por cada modelo e os dados reais. Como pode ser observado, o modelo não linear 2 parece ajustar melhor os dados do que o modelo linear 1. O sistema original considerado é um circuito RLC, composto por um resistor (R), um indutor (L) e um capacitor (C) conectados em série com uma fonte de tensão. Sabe‑se que o comportamento de um circuito RLC em série pode ser descrito com precisão por uma equação diferencial linear de segunda ordem que relaciona a corrente <span class=arithmatex>\(I(t)\)</span> e a tensão aplicada <span class=arithmatex>\(V(t)\)</span>:</p> <div class=arithmatex>\[ L\frac{d^2I(t)}{dt^2} + R\frac{dI(t)}{dt} + \frac{1}{C}I(t) = \frac{dV(t)}{dt} \tag{4} \]</div> <p>Dada essa relação linear, um modelo adequado para o circuito RLC deve refletir essa linearidade de segunda ordem. Embora o Modelo 2, que inclui termos não lineares, possa fornecer um ajuste mais próximo aos dados, ele é claramente superparametrizado. Tal superparametrização pode introduzir efeitos não lineares espúrios, frequentemente chamados de "ghost nonlinearities", que não correspondem à dinâmica real do sistema. Portanto, esses modelos precisam ser interpretados com cautela, pois o uso de um modelo excessivamente complexo pode mascarar a verdadeira natureza linear do sistema e levar a conclusões equivocadas sobre o seu comportamento.</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rlc.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rlc.png?raw=true"></a></p> <blockquote> <p>Figura 1. Resultados para dois modelos polinomiais NARX ajustados a dados de um sistema desconhecido. O Modelo 1 (esquerda) é linear, enquanto o Modelo 2 (direita) inclui termos não lineares. A figura ilustra que o Modelo 2 fornece um ajuste mais próximo aos dados em comparação com o Modelo 1. No entanto, como o sistema original é um circuito RLC linear de segunda ordem, o melhor ajuste do Modelo 2 pode ser enganoso devido à superparametrização. Isso destaca a importância de considerar as características físicas do sistema ao interpretar os resultados, para evitar interpretar como reais não linearidades artificiais. Referência: <a href=https://ufsj.edu.br/portal2-repositorio/File/ppgel/225-2020-02-17-DissertacaoWilsonLacerda.pdf>Meta Model Structure Selection: An Algorithm For Building Polynomial NARX Models For Regression And Classification</a></p> </blockquote> <p>Identificar corretamente a estrutura de um modelo é fundamental para analisar com precisão a dinâmica do sistema. Uma estrutura de modelo bem escolhida garante que o modelo reflita o comportamento real do sistema, permitindo uma análise consistente e significativa. Nesse sentido, diversos algoritmos foram desenvolvidos para selecionar os termos apropriados na construção de um modelo polinomial NARX. O objetivo principal dos algoritmos de Model Structure Selection (MSS) é revelar as características do sistema produzindo o modelo mais simples possível que ainda descreva adequadamente os dados. Embora alguns sistemas exijam, de fato, modelos mais complexos, é essencial buscar um equilíbrio entre simplicidade e acurácia. Como Einstein disse de forma bastante apropriada:</p> <blockquote> <p>Um modelo deve ser o mais simples possível, mas não mais simples do que isso.</p> </blockquote> <p>Esse princípio enfatiza a importância de evitar complexidade desnecessária, garantindo ao mesmo tempo que o modelo capture as dinâmicas essenciais do sistema.</p> <p>Vimos no Capítulo 2 que a seleção de regressores não é uma tarefa simples. Se o grau de não linearidade, a ordem do modelo e o número de entradas aumentam, o número de modelos candidatos se torna grande demais para uma abordagem de força bruta. Considerando o caso MIMO, esse problema é ainda mais severo do que no caso SISO quando muitas entradas e saídas são necessárias. O número de todos os modelos distintos pode ser calculado como</p> <div class=arithmatex>\[ \begin{align} n_m = \begin{cases} 2^{n_r} &amp; \text{para modelos SISO}, \\ 2^{n_{{_{m}}r}} &amp; \text{para modelos MIMO}, \end{cases} \end{align} \tag{5} \]</div> <p>em que <span class=arithmatex>\(n_r\)</span> e <span class=arithmatex>\(n_{{_{m}}r}\)</span> são os valores calculados usando as equações apresentadas no Capítulo 2.</p> <p>Uma solução clássica para o problema de seleção de regressores é o algoritmo Forward Regression Orthogonal Least Squares (FROLS) associado ao algoritmo Error Reduction Ratio (ERR). Essa técnica é baseada no framework de Prediction Error Minimization e seleciona, termo a termo, o regressor mais relevante por meio de uma regressão step‑wise. O método FROLS adapta o conjunto de regressores no espaço de busca para um conjunto de vetores ortogonais, sobre os quais o ERR avalia a contribuição individual para a variância da saída desejada.</p> <h2 id=o-algoritmo-forward-regression-orthogonal-least-squares>O algoritmo Forward Regression Orthogonal Least Squares<a class=headerlink href=#o-algoritmo-forward-regression-orthogonal-least-squares title="Permanent link">&para;</a></h2> <p>Considere o modelo NARMAX geral definido na Equação 2.23, descrito de forma genérica como</p> <div class=arithmatex>\[ \begin{equation} y_k = \psi^\top_{k-1}\hat{\Theta} + \xi_k, \end{equation} \tag{6} \]</div> <p>em que <span class=arithmatex>\(\psi^\top_{k-1} \in \mathbb{R}^{n_r \times n}\)</span> é um vetor contendo combinações dos regressores e <span class=arithmatex>\(\hat{\Theta} \in \mathbb{R}^{n_{\Theta}}\)</span> é o vetor de parâmetros estimados. De forma mais compacta, o modelo NARMAX pode ser representado em forma matricial como:</p> <div class=arithmatex>\[ \begin{equation} y = \Psi\hat{\Theta} + \Xi, \end{equation} \tag{7} \]</div> <p>onde</p> <div class=arithmatex>\[ \begin{align} Y = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}, \Psi = \begin{bmatrix} \psi_{{_1}} \\ \psi_{{_2}} \\ \vdots \\ \psi_{{_{n_{\Theta}}}} \end{bmatrix}^\top= \begin{bmatrix} \psi_{{_1}1} &amp; \psi_{{_2}1} &amp; \dots &amp; \psi_{{_{n_{\Theta}}}1} \\ \psi_{{_1}2} &amp; \psi_{{_2}2} &amp; \dots &amp; \psi_{{_{n_{\Theta}}}2} \\ \vdots &amp; \vdots &amp; &amp; \vdots \\ \psi_{{_1}n} &amp; \psi_{{_2}n} &amp; \dots &amp; \psi_{{_{n_{\Theta}}}n} \\ \end{bmatrix}, \hat{\Theta} = \begin{bmatrix} \hat{\Theta}_1 \\ \hat{\Theta}_2 \\ \vdots \\ \hat{\Theta}_{n_\Theta} \end{bmatrix}, \Xi = \begin{bmatrix} \xi_1 \\ \xi_2 \\ \vdots \\ \xi_n \end{bmatrix}. \end{align} \tag{8} \]</div> <p>Os parâmetros na equação acima podem ser estimados por um algoritmo baseado em Mínimos Quadrados, mas isso exigiria otimizar todos os parâmetros ao mesmo tempo devido à interação entre regressores causada pela falta de ortogonalidade. Consequentemente, a demanda computacional torna‑se impraticável para um número elevado de regressores. Nesse contexto, o FROLS transforma o modelo não ortogonal apresentado na equação acima em um modelo ortogonal.</p> <p>A matriz de regressores <span class=arithmatex>\(\Psi\)</span> pode ser decomposta ortogonalmente como</p> <div class=arithmatex>\[ \begin{equation} \Psi = QA, \end{equation} \tag{9} \]</div> <p>em que <span class=arithmatex>\(A \in \mathbb{R}^{n_{\Theta}\times n_{\Theta}}\)</span> é uma matriz triangular superior unitária, dada por</p> <div class=arithmatex>\[ \begin{align} A = \begin{bmatrix} 1 &amp; a_{12} &amp; a_{13} &amp; \dotsc &amp; a_{1n_{\Theta}} \\ 0 &amp; 1 &amp; a_{23} &amp; \dotsc &amp; a_{2n_{\Theta}} \\ 0 &amp; 0 &amp; 1 &amp; \dotsc &amp; \vdots \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; a_{n_{\Theta}-1n_{\Theta}} \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \end{bmatrix}, \end{align} \tag{10} \]</div> <p>e <span class=arithmatex>\(Q \in \mathbb{R}^{n\times n_{\Theta}}\)</span> é uma matriz com colunas ortogonais <span class=arithmatex>\(q_i\)</span>, descrita como</p> <div class=arithmatex>\[ \begin{equation} Q = \begin{bmatrix} q_{{_1}} &amp; q_{{_2}} &amp; q_{{_3}} &amp; \dotsc &amp; q_{{_{n_{\Theta}}}} \end{bmatrix}, \end{equation} \tag{11} \]</div> <p>tal que <span class=arithmatex>\(Q^\top Q = \Lambda\)</span> e <span class=arithmatex>\(\Lambda\)</span> é diagonal com entradas <span class=arithmatex>\(d_i\)</span>, que podem ser expressas como</p> <div class=arithmatex>\[ \begin{align} d_i = q_i^\top q_i = \sum^{k=1}_{n}q_{{_i}k}q_{{_i}k}, \qquad 1\leq i \leq n_{\Theta}. \end{align} \]</div> <p>Como o subespaço gerado pela base ortogonal <span class=arithmatex>\(Q\)</span> (Equação 11) é o mesmo subespaço gerado pelo conjunto de base <span class=arithmatex>\(\Psi\)</span> (Equação 8) (isto é, contém todas as combinações lineares possíveis nesse subespaço), podemos reescrever a Equação 7 como</p> <div class=arithmatex>\[ \begin{equation} Y = \underbrace{(\Psi A^{-1})}_{Q}\underbrace{(A\Theta)}_{g}+ \Xi = Qg+\Xi, \end{equation} \tag{12} \]</div> <p>onde <span class=arithmatex>\(g\in \mathbb{R}^{n_\Theta}\)</span> é um vetor auxiliar de parâmetros. A solução do modelo descrito na Equação 12 é dada por</p> <div class=arithmatex>\[ \begin{equation} g = \left(Q^\top Q\right)^{-1}Q^\top Y = \Lambda^{-1}Q^\top Y \end{equation} \tag{13} \]</div> <p>ou, de forma equivalente,</p> <div class=arithmatex>\[ \begin{equation} g_{{_i}} = \frac{q_{{_i}}^\top Y}{q_{{_i}}^\top q_{{_i}}}. \end{equation} \tag{14} \]</div> <p>Como os vetores de parâmetros <span class=arithmatex>\(\Theta\)</span> e <span class=arithmatex>\(g\)</span> satisfazem o sistema triangular <span class=arithmatex>\(A\Theta = g\)</span>, qualquer método de ortogonalização, como Householder, Gram‑Schmidt, Gram‑Schmidt modificado ou transformações de Givens, pode ser utilizado para resolver a equação e estimar os parâmetros originais. Assumindo que <span class=arithmatex>\(E[\Psi^\top \Xi] = 0\)</span>, a variância da saída pode ser obtida multiplicando a Equação 12 por ela mesma e dividindo por <span class=arithmatex>\(n\)</span>, o que resulta em</p> <div class=arithmatex>\[ \begin{equation} \frac{1}{n}Y^\top Y = \underbrace{\frac{1}{n}\sum^{i = 1}_{n_{\Theta}}g_{{_i}}^2q^\top_{{_i}}q_{{_i}}}_{\text{{variância explicada pelos regressores}}} + \underbrace{\frac{1}{n}\Xi^\top \Xi}_{\text{{variância não explicada}}}. \end{equation} \tag{15} \]</div> <p>Assim, o ERR associado à inclusão do regressor <span class=arithmatex>\(q_{{_i}}\)</span> pode ser expresso como</p> <div class=arithmatex>\[ [\text{ERR}]_i = \frac{g_{i}^2 \cdot q_{i}^\top q_{i}}{Y^\top Y}, \qquad \text{para } i=1,2,\dotsc, n_\Theta. \]</div> <p>Existem diversas formas de encerrar o algoritmo. Uma abordagem frequentemente utilizada é parar quando a variância da saída não explicada pelo modelo cai abaixo de um limite pré‑definido <span class=arithmatex>\(\varepsilon\)</span>:</p> <div class=arithmatex>\[ \begin{equation} 1 - \sum_{i = 1}^{n_{\Theta}}\text{ERR}_i \leq \varepsilon, \end{equation} \tag{17} \]</div> <h3 id=mantendo-as-coisas-simples>Mantendo as coisas simples<a class=headerlink href=#mantendo-as-coisas-simples title="Permanent link">&para;</a></h3> <p>Para fins didáticos, vamos apresentar o FROLS usando exemplos simples, de forma a tornar a intuição por trás do método mais clara. Primeiro, definimos o cálculo do ERR e, em seguida, explicamos a ideia do FROLS em termos simples.</p> <h4 id=caso-ortogonal>Caso ortogonal<a class=headerlink href=#caso-ortogonal title="Permanent link">&para;</a></h4> <p>Considere o caso em que temos um conjunto de entradas <span class=arithmatex>\(x_1, x_2, \ldots, x_n\)</span> e uma saída <span class=arithmatex>\(y\)</span>. Suponha que esses vetores de entrada sejam ortogonais entre si.</p> <p>Suponha que queremos construir um modelo para aproximar <span class=arithmatex>\(y\)</span> usando <span class=arithmatex>\(x_1, x_2, \ldots, x_n\)</span> da seguinte forma:</p> <div class=arithmatex>\[ y=\hat{\theta}_1 x_1+\hat{\theta}_2 x_2+\ldots+\hat{\theta}_n x_n+e \tag{18} \]</div> <p>onde <span class=arithmatex>\(\hat{\theta}_1, \hat{\theta}_2, \ldots, \hat{\theta}_n\)</span> são parâmetros e <span class=arithmatex>\(e\)</span> é um ruído branco, independente de <span class=arithmatex>\(x\)</span> e <span class=arithmatex>\(y\)</span> (note a hipótese <span class=arithmatex>\(E[\Psi^\top \Xi] = 0\)</span> mencionada na seção anterior). Nesse caso, podemos reescrever a equação acima como</p> <div class=arithmatex>\[ y = \hat{\theta} x \tag{19} \]</div> <p>de modo que</p> <div class=arithmatex>\[ \left\langle x, y\right\rangle = \left\langle \hat{\theta} x, x\right\rangle = \hat{\theta} \left\langle x, x\right\rangle \tag{20} \]</div> <p>o que implica</p> <div class=arithmatex>\[ \hat{\theta} = \frac{\left\langle x, y\right\rangle}{\left\langle x, x\right\rangle} \tag{21} \]</div> <p>Portanto, podemos mostrar que</p> <div class=arithmatex>\[ \begin{align} &amp; \left\langle x_1, y\right\rangle=\hat{\theta}_1\left\langle x_1, x_1\right\rangle \Rightarrow \hat{\theta}_1=\frac{\left\langle x_1, y\right\rangle}{\left\langle x_1, x_1\right\rangle}=\frac{x_1^T y}{x_1^T x_1} \\ &amp; \left\langle x_2, y\right\rangle=\hat{\theta}_2\left\langle x_2, x_2\right\rangle \Rightarrow \hat{\theta}_2=\frac{\left\langle x_2, y\right\rangle}{\left\langle x_2, x_2\right\rangle}=\frac{x_2^T y}{x_2^T x_2}, \ldots \\ &amp; \left\langle x_n, y\right\rangle=\hat{\theta}_n\left\langle x_n, x_n\right\rangle \Rightarrow \hat{\theta}_n=\frac{\left\langle x_n, y\right\rangle}{\left\langle x_n, x_n\right\rangle}=\frac{x_n^T y}{x_n^T x_n}, \end{align} \tag{22} \]</div> <p>Seguindo a mesma ideia, também podemos mostrar que</p> <div class=arithmatex>\[ \langle y, y\rangle=\hat{\theta}_1^2\left\langle x_1, x_1\right\rangle+\hat{\theta}_2^2\left\langle x_2, x_2\right\rangle+\ldots+\hat{\theta}_n^2\left\langle x_n, x_n\right\rangle+\langle e, e\rangle \tag{23} \]</div> <p>que pode ser descrito como</p> <div class=arithmatex>\[ y^T y=\hat{\theta}_1^2 x_1^T x_1+\hat{\theta}_2^2 x_2^T x_2+\ldots+\hat{\theta}_n^2 x_n^T x_n+e^T e \tag{24} \]</div> <p>ou ainda</p> <div class=arithmatex>\[ \|y\|^2=\hat{\theta}_1^2\left\|x_1\right\|^2+\hat{\theta}_2^2\left\|x_2\right\|^2+\ldots+\hat{\theta}_n^2\left\|x_n\right\|^2+\|e\|^2 \tag{25} \]</div> <p>Dividindo ambos os lados da equação por <span class=arithmatex>\(\|y\|^2\)</span> e rearranjando, obtemos</p> <div class=arithmatex>\[ \frac{\|e\|^2}{\|y\|^2}=1-\hat{\theta}_1^2 \frac{\left\|x_1\right\|^2}{\|y\|^2}-\hat{\theta}_2^2 \frac{\left\|x_2\right\|^2}{\|y\|^2}-\ldots-\hat{\theta}_n^2 \frac{\left\|x_n\right\|^2}{\|y\|^2} \tag{26} \]</div> <p>Como <span class=arithmatex>\(\hat{\theta}_k=\frac{x_k^T y}{x_k^T x_k}=\frac{x_k^T y}{\left\|x_k\right\|^2}, k=1,2, . ., n\)</span>, temos</p> <div class=arithmatex>\[ \begin{align} \frac{\|e\|^2}{\|y\|^2} &amp; =1-\left(\frac{x_1^T y}{\left\|x_1\right\|^2}\right)^2 \frac{\left\|x_1\right\|^2}{\|y\|^2}-\left(\frac{x_2^T y}{\left\|x_2\right\|^2}\right)^2 \frac{\left\|x_2\right\|^2}{\|y\|^2}-\ldots-\left(\frac{x_n^T y}{\left\|x_n\right\|^2}\right)^2 \frac{\left\|x_n\right\|^2}{\|y\|^2} \\ &amp; =1-\frac{\left(x_1^T y\right)^2}{\left\|x_1\right\|^2\| y \|^2}-\frac{\left(x_2^T y\right)^2}{\left\|x_2\right\|^2\|y\|^2}-\cdots-\frac{\left(x_n^T y\right)^2}{\left\|x_n\right\|^2\|y\|^2} \\ &amp; =1-ERR_1 \quad-ERR_2-\cdots-ERR_n \end{align} \tag{27} \]</div> <p>onde <span class=arithmatex>\(\operatorname{ERR}_k(k=1,2 \ldots, n)\)</span> é o Error Reduction Ratio definido na seção anterior.</p> <p>Veja o exemplo abaixo usando a base canônica:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>])</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1># Orthogonal Basis</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>x1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>x2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=n>x3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>theta1</span> <span class=o>=</span> <span class=p>(</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@x1</span><span class=p>)</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>theta2</span> <span class=o>=</span> <span class=p>(</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@x2</span><span class=p>)</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=n>theta3</span> <span class=o>=</span> <span class=p>(</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@x3</span><span class=p>)</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=n>squared_y</span> <span class=o>=</span> <span class=n>y</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=n>err1</span> <span class=o>=</span> <span class=p>(</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@x1</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=n>err2</span> <span class=o>=</span> <span class=p>(</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@x2</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=n>err3</span> <span class=o>=</span> <span class=p>(</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@x3</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;x1 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>err1</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y, </span><span class=se>\n</span><span class=s2> x2 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>err2</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y, </span><span class=se>\n</span><span class=s2> x3 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>err3</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y&quot;</span><span class=p>)</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=n>x1</span> <span class=n>represents</span> <span class=mf>7.38</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=n>x2</span> <span class=n>represents</span> <span class=mf>40.16</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=n>x3</span> <span class=n>represents</span> <span class=mf>52.46</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span>
</code></pre></div> <p>Vamos agora analisar o que acontece em um cenário não ortogonal.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>])</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>x1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>x2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=n>x3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=n>theta1</span> <span class=o>=</span> <span class=p>(</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@x1</span><span class=p>)</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=n>theta2</span> <span class=o>=</span> <span class=p>(</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@x2</span><span class=p>)</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=n>theta3</span> <span class=o>=</span> <span class=p>(</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@x3</span><span class=p>)</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=n>squared_y</span> <span class=o>=</span> <span class=n>y</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=n>err1</span> <span class=o>=</span> <span class=p>(</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>x1</span><span class=o>.</span><span class=n>T</span><span class=nd>@x1</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=n>err2</span> <span class=o>=</span> <span class=p>(</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>/</span><span class=p>((</span><span class=n>x2</span><span class=o>.</span><span class=n>T</span><span class=nd>@x2</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=n>err3</span> <span class=o>=</span> <span class=p>(</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>x3</span><span class=o>.</span><span class=n>T</span><span class=nd>@x3</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;x1 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>err1</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y, </span><span class=se>\n</span><span class=s2> x2 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>err2</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y, </span><span class=se>\n</span><span class=s2> x3 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>err3</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y&quot;</span><span class=p>)</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=o>&gt;&gt;&gt;</span> <span class=n>x1</span> <span class=n>represents</span> <span class=mf>99.18</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=o>&gt;&gt;&gt;</span> <span class=n>x2</span> <span class=n>represents</span> <span class=mf>2.13</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=o>&gt;&gt;&gt;</span> <span class=n>x3</span> <span class=n>represents</span> <span class=mf>52.46</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span>
</code></pre></div> <p>Nesse caso, <span class=arithmatex>\(x1\)</span> apresenta o maior valor de <span class=arithmatex>\(err\)</span>, então o escolhemos como o primeiro vetor ortogonal.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>q1</span> <span class=o>=</span> <span class=n>x1</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>v1</span> <span class=o>=</span> <span class=n>x2</span> <span class=o>-</span> <span class=p>(</span><span class=n>q1</span><span class=o>.</span><span class=n>T</span><span class=nd>@x2</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>q1</span><span class=o>.</span><span class=n>T</span><span class=nd>@q1</span><span class=p>)</span><span class=o>*</span><span class=n>q1</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>errv1</span> <span class=o>=</span> <span class=p>(</span><span class=n>v1</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>v1</span><span class=o>.</span><span class=n>T</span><span class=nd>@v1</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>v2</span> <span class=o>=</span> <span class=n>x3</span> <span class=o>-</span> <span class=p>(</span><span class=n>q1</span><span class=o>.</span><span class=n>T</span><span class=nd>@x3</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>q1</span><span class=o>.</span><span class=n>T</span><span class=nd>@q1</span><span class=p>)</span><span class=o>*</span><span class=n>q1</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>errv2</span> <span class=o>=</span> <span class=p>(</span><span class=n>v2</span><span class=o>.</span><span class=n>T</span><span class=nd>@y</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>((</span><span class=n>v2</span><span class=o>.</span><span class=n>T</span><span class=nd>@v2</span><span class=p>)</span> <span class=o>*</span> <span class=n>squared_y</span><span class=p>)</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;v1 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>errv1</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y, </span><span class=se>\n</span><span class=s2> v2 represents </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>errv2</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>% of the variation in y&quot;</span><span class=p>)</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=o>&gt;&gt;&gt;</span> <span class=n>v1</span> <span class=n>represents</span> <span class=mf>0.82</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=o>&gt;&gt;&gt;</span> <span class=n>v2</span> <span class=n>represents</span> <span class=mf>0.66</span><span class=o>%</span> <span class=n>of</span> <span class=n>the</span> <span class=n>variation</span> <span class=ow>in</span> <span class=n>y</span>
</code></pre></div> <p>Assim, neste caso, ao somarmos os valores de ERR dos dois primeiros vetores ortogonais, <span class=arithmatex>\(x1\)</span> e <span class=arithmatex>\(v1\)</span>, obtemos <span class=arithmatex>\(err_3 + errv1 = 100\%\)</span>. Não há necessidade de continuar a busca por mais termos: o modelo com esses dois termos já explica toda a variância dos dados.</p> <blockquote> <p>Essa é a ideia do algoritmo FROLS. Calculamos o ERR, escolhemos o vetor com maior ERR como o primeiro vetor ortogonal, ortogonalizamos todos os demais vetores em relação a ele, calculamos o ERR de cada um deles, escolhemos novamente aquele com maior ERR e repetimos o processo até que algum critério de parada seja satisfeito.</p> </blockquote> <p>No SysIdentPy, temos dois hiperparâmetros chamados <code>n_terms</code> e <code>err_tol</code>. Ambos podem ser usados para interromper as iterações. O primeiro faz com que o algoritmo selecione até <code>n_terms</code> regressores. O segundo interrompe o processo quando <span class=arithmatex>\(\sum ERR_i &gt; err_{tol}\)</span>. Se ambos forem definidos, o algoritmo pára quando qualquer uma das condições for satisfeita.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>        <span class=n>n_terms</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>        <span class=n>ylag</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>        <span class=n>xlag</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>        <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>        <span class=n>err_tol</span><span class=o>=</span><span class=mf>0.98</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=p>)</span>
</code></pre></div> <p>O SysIdentPy aplica o método de Golub‑Householder para a decomposição ortogonal. Uma discussão mais detalhada sobre Householder e procedimentos de ortogonalização em geral pode ser encontrada em <a href=https://www.tandfonline.com/doi/abs/10.1080/00207178908953472>Chen, S. and Billings, S. A. and Luo, W.</a></p> <h2 id=estudo-de-caso>Estudo de caso<a class=headerlink href=#estudo-de-caso title="Permanent link">&para;</a></h2> <p>Um exemplo usando dados reais será apresentado utilizando o SysIdentPy. Neste exemplo, construiremos modelos lineares e não lineares para descrever o comportamento de um motor de corrente contínua operando como gerador. Detalhes do experimento usado para gerar esses dados podem ser encontrados no artigo (em português) <a href=https://www.researchgate.net/publication/320418710_Identificacao_de_um_motorgerador_CC_por_meio_de_modelos_polinomiais_autorregressivos_e_redes_neurais_artificiais>IDENTIFICAÇÃO DE UM MOTOR/GERADOR CC POR MEIO DE MODELOS POLINOMIAIS AUTORREGRESSIVOS E REDES NEURAIS ARTIFICIAIS</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.display_results</span><span class=w> </span><span class=kn>import</span> <span class=n>results</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.plotting</span><span class=w> </span><span class=kn>import</span> <span class=n>plot_results</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&quot;examples/datasets/x_cc.csv&quot;</span><span class=p>)</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&quot;examples/datasets/y_cc.csv&quot;</span><span class=p>)</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=c1># checking the ouput</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=n>df2</span><span class=p>[</span><span class=mi>5000</span><span class=p>:</span><span class=mi>80000</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/generator_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/generator_example.png?raw=true"></a></p> <blockquote> <p>Figura 2. Saída do sistema eletromecânico.</p> </blockquote> <p>Neste exemplo, iremos dizimar os dados usando <span class=arithmatex>\(d = 500\)</span>. A motivação para a dizimação é que os dados estão superamostrados devido à configuração experimental. Em uma seção futura discutiremos em mais detalhes como lidar com dados superamostrados no contexto de identificação de sistemas. Por ora, considere essa abordagem como a mais apropriada para este caso.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>x_train</span><span class=p>,</span> <span class=n>x_valid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>df1</span><span class=o>.</span><span class=n>iloc</span><span class=p>[::</span><span class=mi>500</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>y_train</span><span class=p>,</span> <span class=n>y_valid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>df2</span><span class=o>.</span><span class=n>iloc</span><span class=p>[::</span><span class=mi>500</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</code></pre></div> <p>Neste caso, construiremos um modelo NARX. No SysIdentPy, isso significa definir <code>unbiased=False</code> na classe <code>LeastSquares</code>. Usaremos uma função base <code>Polynomial</code> e definiremos o atraso máximo tanto para a entrada quanto para a saída como 2. Essa configuração resulta em 15 termos na matriz de informação; portanto, definiremos <code>n_terms=15</code>. Essa especificação é necessária porque, neste exemplo, <code>order_selection=False</code>. Discutiremos <code>order_selection</code> com mais detalhes na seção de Critérios de Informação.</p> <blockquote> <p>No SysIdentPy, <code>order_selection</code> é <code>True</code> por padrão. Quando <code>order_selection=False</code>, o usuário deve informar um valor para <code>n_terms</code>, pois esse hiperparâmetro é opcional e o valor padrão é <code>None</code>. Se definirmos <code>n_terms=5</code>, por exemplo, o FROLS irá parar após selecionar os primeiros 5 regressores. Não queremos isso neste caso, pois desejamos que o FROLS pare apenas quando <code>e_tol</code> for atingido.</p> </blockquote> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=n>e_tol</span><span class=o>=</span><span class=mf>0.9999</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>    <span class=n>n_terms</span><span class=o>=</span><span class=mi>15</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=p>)</span>
</code></pre></div> <p>O SysIdentPy foi projetado para simplificar o uso de algoritmos como o <code>FROLS</code>. Construir, treinar ou ajustar um modelo é feito por meio de uma interface simples chamada <code>fit</code>. Ao utilizar esse método, todo o processo é tratado internamente, sem a necessidade de interação adicional do usuário.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
</code></pre></div> <p>O SysIdentPy também oferece um método para recuperar informações detalhadas sobre o modelo ajustado. É possível inspecionar os termos incluídos no modelo, os parâmetros estimados, os valores de Error Reduction Ratio (ERR) e muito mais.</p> <blockquote> <p>Estamos usando <code>pandas</code> aqui apenas para tornar a saída mais legível, mas isso é opcional.</p> </blockquote> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=p>),</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=p>)</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>y(k-1)</td> <td>1.0998E+00</td> <td>9.86000384E-01</td> </tr> <tr> <td>x1(k-1)^2</td> <td>1.0165E+02</td> <td>7.94805130E-03</td> </tr> <tr> <td>y(k-2)^2</td> <td>-1.9786E-05</td> <td>2.50905908E-03</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>-1.2138E-01</td> <td>1.43301039E-03</td> </tr> <tr> <td>y(k-2)</td> <td>-3.2621E-01</td> <td>1.02781443E-03</td> </tr> <tr> <td>x1(k-1)y(k-2)</td> <td>5.3596E-02</td> <td>5.35200312E-04</td> </tr> <tr> <td>x1(k-2)</td> <td>3.4655E+02</td> <td>2.79648078E-04</td> </tr> <tr> <td>x1(k-2)y(k-1)</td> <td>-5.1647E-02</td> <td>1.12211942E-04</td> </tr> <tr> <td>x1(k-2)x1(k-1)</td> <td>-8.2162E+00</td> <td>4.54743448E-05</td> </tr> <tr> <td>y(k-2)y(k-1)</td> <td>4.0961E-05</td> <td>3.25346101E-05</td> </tr> <tr> <td>&gt;Table 1</td> <td></td> <td></td> </tr> </tbody> </table> <p>A tabela acima mostra que 10 regressores (de um total de 15 disponíveis) foram suficientes para atingir o <code>e_tol</code> definido, com a soma dos ERR para os regressores selecionados igual a <span class=arithmatex>\(0.99992\)</span>.</p> <p>Em seguida, vamos avaliar o desempenho do modelo usando os dados de validação. De forma análoga ao método <code>fit</code>, o SysIdentPy oferece o método <code>predict</code>. Para obter os valores previstos e plotar os resultados, basta fazer o seguinte:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=c1># plot only the first 100 samples (n=100)</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/generator_predict_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/generator_predict_c4.png?raw=true"></a></p> <blockquote> <p>Figura 3. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado.</p> </blockquote> <h2 id=criterios-de-informacao>Critérios de Informação<a class=headerlink href=#criterios-de-informacao title="Permanent link">&para;</a></h2> <p>Mencionamos que existem diversas maneiras de encerrar o algoritmo e selecionar os termos do modelo, mas até agora só definimos o critério baseado em ERR. Uma forma alternativa de parar o algoritmo é utilizando critérios de informação, por exemplo, o Akaike Information Criterion (AIC). Para regressão baseada em Mínimos Quadrados, o AIC indica o número de regressores ao minimizar a função objetivo (<a href=https://ieeexplore.ieee.org/document/1100705>Akaike, H. - A new look at the statistical model identification</a>):</p> <div class=arithmatex>\[ \begin{equation} J_{\text{AIC}} = \underbrace{n\log\left(Var[\xi_k]\right)}_{\text{primeiro termo}}+\underbrace{2n_{\Theta}}_{\text{{segundo termo}}}. \end{equation} \tag{28} \]</div> <p>É importante notar que a equação acima ilustra o trade‑off entre ajuste do modelo e complexidade do modelo. Em particular, esse trade‑off envolve equilibrar a capacidade do modelo de ajustar bem os dados (primeiro termo) com a sua complexidade, relacionada ao número de parâmetros incluídos (segundo termo). À medida que mais termos são incluídos no modelo, o valor do AIC tende inicialmente a diminuir, atingindo um mínimo que representa um equilíbrio ótimo entre complexidade e desempenho preditivo. No entanto, se o número de parâmetros se tornar excessivo, a penalização por complexidade passa a superar o benefício de um melhor ajuste, fazendo com que o valor de AIC volte a crescer. O AIC e várias de suas variantes têm sido amplamente utilizados na identificação de sistemas lineares e não lineares. Ver, por exemplo, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0273117707002086>Wei, H. and Zhu, D. and Billings, S. A. and Balikhin, M. A. - Forecasting the geomagnetic activity of the Dst index using multiscale radial basis function networks</a>, <a href=https://link.springer.com/article/10.1007/s40313-013-0071-9>Martins, S. A. M. and Nepomuceno, E. G. and Barroso, M. F. S. - Improved Structure Detection For Polynomial NARX Models Using a Multiobjective Error Reduction Ratio</a>, <a href=https://ieeexplore.ieee.org/document/8477782>Hafiz, F. and Swain, A. and Mendes, E. M. A. M. and Patel, N. - Structure Selection of Polynomial NARX Models Using Two Dimensional (2D) Particle Swarms</a>, <a href=https://www.tandfonline.com/doi/full/10.1080/21642583.2018.1496042>Gu, Y. and Wei, H. and Balikhin, M. M. - Nonlinear predictive model selection and model averaging using information criteria</a> e referências aí citadas.</p> <p>Apesar de bastante eficazes em muitos problemas de seleção de modelos lineares, critérios de informação como AIC podem ter dificuldade em selecionar um número adequado de parâmetros quando lidamos com sistemas fortemente não lineares. Além disso, esses critérios podem levar a modelos subótimos se o espaço de busca não contiver todos os termos necessários para representar adequadamente o modelo "verdadeiro". Consequentemente, em sistemas altamente não lineares ou quando componentes importantes do modelo estão ausentes, os critérios de informação podem não fornecer orientações confiáveis, resultando em modelos com desempenho ruim.</p> <p>Além do AIC, o SysIdentPy disponibiliza outros quatro critérios de informação: <a href=https://wires.onlinelibrary.wiley.com/doi/abs/10.1002/wics.199>Bayesian Information Criteria</a> (BIC), <a href=https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas>Final Prediction Error</a> (FPE), <a href=https://www.sciencedirect.com/science/article/abs/pii/S0169743902000515>Low of Iterated Logarithm Criteria</a> (LILC) e <a href=https://www.sciencedirect.com/science/article/abs/pii/S0167715296001289>Corrected Akaike Information Criteria</a> (AICc), definidos, respectivamente, como</p> <div class=arithmatex>\[ \begin{align} \operatorname{FPE}\left(n_\theta\right) &amp; =N \ln \left[\sigma_{\text {erro }}^2\left(n_\theta\right)\right]+N \ln \left[\frac{N+n_\theta}{N-n_\theta}\right] \\ BI C\left(n_\theta\right) &amp; =N \ln \left[\sigma_{\text {erro }}^2\left(n_\theta\right)\right]+n_\theta \ln N \\ AICc &amp;=AIC+2 n_p * \frac{n_p+1}{N-n_p-1} \\ LILC &amp;= 2n_{\theta}\ln(\ln(N)) + N \ln(\left[\sigma_{\text {erro }}^2\left(n_\theta\right)\right]) \end{align} \tag{29} \]</div> <p>Para usar qualquer critério de informação no SysIdentPy, defina <code>order_selection=True</code> (como mencionado, esse já é o valor padrão). Além de <code>order_selection</code>, você pode definir quantos regressores deseja avaliar antes de interromper o algoritmo por meio do hiperparâmetro <code>n_info_values</code>. O valor padrão é <span class=arithmatex>\(15\)</span>, mas o usuário deve aumentá‑lo de acordo com o número de regressores disponíveis, dado por <code>ylag</code>, <code>xlag</code> e o grau da função base.</p> <blockquote> <p>O uso de critérios de informação pode ser computacionalmente custoso, dependendo do número de regressores avaliados e da quantidade de amostras. Para calcular o critério, o algoritmo ERR é executado <code>n</code> vezes, onde <code>n</code> é o valor definido em <code>n_info_values</code>. Certifique‑se de entender bem o funcionamento do método antes de decidir se realmente precisa utilizá‑lo.</p> </blockquote> <p>Executando o mesmo exemplo, mas agora usando o critério de informação BIC para selecionar a ordem do modelo, temos:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>n_info_values</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>info_criteria</span><span class=o>=</span><span class=s2>&quot;bic&quot;</span><span class=p>,</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=p>)</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>    <span class=p>),</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=p>)</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>y(k-1)</td> <td>1.3666E+00</td> <td>9.86000384E-01</td> </tr> <tr> <td>x1(k-1)^2</td> <td>1.0500E+02</td> <td>7.94805130E-03</td> </tr> <tr> <td>y(k-2)^2</td> <td>-5.8577E-05</td> <td>2.50905908E-03</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>-1.2427E-01</td> <td>1.43301039E-03</td> </tr> <tr> <td>y(k-2)</td> <td>-5.1414E-01</td> <td>1.02781443E-03</td> </tr> <tr> <td>x1(k-1)y(k-2)</td> <td>5.3001E-02</td> <td>5.35200312E-04</td> </tr> <tr> <td>x1(k-2)</td> <td>3.1144E+02</td> <td>2.79648078E-04</td> </tr> <tr> <td>x1(k-2)y(k-1)</td> <td>-4.8013E-02</td> <td>1.12211942E-04</td> </tr> <tr> <td>x1(k-2)x1(k-1)</td> <td>-8.0561E+00</td> <td>4.54743448E-05</td> </tr> <tr> <td>x1(k-2)y(k-2)</td> <td>4.1381E-03</td> <td>3.25346101E-05</td> </tr> <tr> <td>1</td> <td>-5.6653E+01</td> <td>7.54107553E-06</td> </tr> <tr> <td>y(k-2)y(k-1)</td> <td>1.5679E-04</td> <td>3.52002717E-06</td> </tr> <tr> <td>y(k-1)^2</td> <td>-9.0164E-05</td> <td>6.17373260E-06</td> </tr> <tr> <td>&gt;Table 2</td> <td></td> <td></td> </tr> </tbody> </table> <p>Nesse caso, em vez de 8 regressores, o modelo final possui 13 termos.</p> <p>Atualmente, o número de regressores é determinado identificando o índice da última posição em que a diferença entre o valor atual do critério e o valor anterior é menor que 0. Para inspecionar esses valores, você pode utilizar a abordagem a seguir:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>xaxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>n_info_values</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xaxis</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>info_values</span><span class=p>)</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;n_terms&quot;</span><span class=p>)</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Information Criteria&quot;</span><span class=p>)</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/dc_generator_aic_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/dc_generator_aic_c4.png?raw=true"></a></p> <blockquote> <p>Figura 4. O gráfico mostra os valores do critério de informação (BIC) em função do número de termos incluídos no modelo. O processo de seleção de modelo, com base no BIC, adiciona regresssores iterativamente até que o BIC atinja um mínimo, indicando o balanço ótimo entre complexidade e ajuste. O ponto em que o valor de BIC deixa de diminuir define o número ótimo de termos, resultando em um modelo final com 13 termos.</p> </blockquote> <p>A predição do modelo neste caso é mostrada na Figura 5.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=c1># plot only the first 100 samples (n=100)</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/dc_generator_bic_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/dc_generator_bic_c4.png?raw=true"></a></p> <blockquote> <p>Figura 5. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado utilizando o BIC.</p> </blockquote> <h3 id=visao-geral-dos-metodos-de-criterio-de-informacao>Visão geral dos métodos de Critério de Informação<a class=headerlink href=#visao-geral-dos-metodos-de-criterio-de-informacao title="Permanent link">&para;</a></h3> <p>Nesta seção, utilizamos dados simulados para fornecer ao leitor uma visão mais clara dos critérios de informação disponíveis no SysIdentPy.</p> <blockquote> <p>Aqui estamos trabalhando com uma estrutura de modelo conhecida, o que nos permite focar apenas em como os diferentes critérios de informação se comportam. Em dados reais, o número correto de termos do modelo é desconhecido, o que torna esses métodos ferramentas importantes para guiar a seleção de modelos.</p> <p>Se você observar as métricas reportadas abaixo, notará que o desempenho é excelente para todos os modelos. No entanto, é fundamental lembrar que Identificação de Sistemas não trata apenas de obter boas métricas de predição — o objetivo é encontrar a estrutura de modelo mais adequada. Model Structure Selection está no coração dos métodos NARMAX!</p> </blockquote> <p>Os dados são gerados pela simulação do seguinte modelo:</p> <div class=arithmatex>\[ y_k = 0.2y_{k-1} + 0.1y_{k-1}x_{k-1} + 0.9x_{k-1} + e_k \tag{30} \]</div> <p>Se <code>colored_noise</code> for definido como <code>True</code>, o termo de ruído é dado por:</p> <div class=arithmatex>\[ e_k = 0.8\nu_{k-1} + \nu_k \tag{31} \]</div> <p>em que <span class=arithmatex>\(x\)</span> é uma variável aleatória uniformemente distribuída e <span class=arithmatex>\(\nu\)</span> é uma variável Gaussiana com <span class=arithmatex>\(\mu = 0\)</span> e <span class=arithmatex>\(\sigma = 0.1\)</span>.</p> <p>No próximo exemplo, geraremos dados com 100 amostras, usando ruído branco, e selecionaremos 70% dos dados para treinar o modelo.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.generate_data</span><span class=w> </span><span class=kn>import</span> <span class=n>get_siso_data</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.display_results</span><span class=w> </span><span class=kn>import</span> <span class=n>results</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=n>x_train</span><span class=p>,</span> <span class=n>x_valid</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_valid</span> <span class=o>=</span> <span class=n>get_siso_data</span><span class=p>(</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>    <span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>colored_noise</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>train_percentage</span><span class=o>=</span><span class=mi>70</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=p>)</span>
</code></pre></div> <p>A ideia aqui é mostrar o impacto dos critérios de informação na seleção do número de termos que compõem o modelo final. Você verá por que esses critérios são ferramentas auxiliares e por que deixar o algoritmo selecionar o número de termos apenas com base no valor mínimo do critério nem sempre é uma boa ideia quando lidamos com dados muito contaminados por ruído (mesmo ruído branco).</p> <h4 id=aic>AIC<a class=headerlink href=#aic title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=n>info_criteria</span><span class=o>=</span><span class=s2>&quot;aic&quot;</span><span class=p>,</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=p>)</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a>    <span class=p>),</span>
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=p>)</span>
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a>
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=n>xaxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>n_info_values</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xaxis</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>info_values</span><span class=p>)</span>
<a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;n_terms&quot;</span><span class=p>)</span>
<a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Information Criteria&quot;</span><span class=p>)</span>
</code></pre></div> <p>Os regressores, a simulação em regime livre e os valores de AIC são detalhados a seguir.</p> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.4236E-01</td> <td>9.26094341E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.4933E-01</td> <td>3.35898283E-02</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>1.3001E-01</td> <td>2.35736200E-03</td> </tr> <tr> <td>x1(k-1)</td> <td>8.4024E-02</td> <td>4.11741791E-03</td> </tr> <tr> <td>x1(k-1)^2</td> <td>7.0807E-02</td> <td>2.54231877E-03</td> </tr> <tr> <td>x1(k-2)^2</td> <td>-9.1138E-02</td> <td>1.39658893E-03</td> </tr> <tr> <td>y(k-1)^2</td> <td>1.1698E-01</td> <td>1.70257419E-03</td> </tr> <tr> <td>x1(k-2)y(k-2)</td> <td>8.3745E-02</td> <td>1.11056684E-03</td> </tr> <tr> <td>y(k-2)^2</td> <td>-4.1946E-02</td> <td>1.01686239E-03</td> </tr> <tr> <td>x1(k-2)x1(k-1)</td> <td>5.9034E-02</td> <td>7.47435512E-04</td> </tr> <tr> <td>&gt;Table 3</td> <td></td> <td></td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predict_aic_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predict_aic_c4.png?raw=true"></a></p> <blockquote> <p>Figura 5. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado utilizando AIC.</p> </blockquote> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/aic_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/aic_c4.png?raw=true"></a></p> <blockquote> <p>Figura 6. O gráfico mostra os valores do critério de informação (AIC) em função do número de termos incluídos no modelo. O processo de seleção de modelo, baseado no AIC, adiciona regressores iterativamente até que o critério atinja um mínimo, indicando o balanço ótimo entre complexidade e ajuste. O ponto em que o valor de AIC deixa de diminuir define o número ótimo de termos, resultando em um modelo final com 10 termos.</p> </blockquote> <p>Neste caso, obtemos um modelo com 10 termos. Sabemos, porém, que o número correto é 3, pois estamos trabalhando com um sistema simulado conhecido.</p> <h4 id=aicc>AICc<a class=headerlink href=#aicc title="Permanent link">&para;</a></h4> <p>A única modificação necessária para usar AICc em vez de AIC é alterar o hiperparâmetro de critério de informação: <code>information_criteria="aicc"</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=n>n_info_values</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>    <span class=n>info_criteria</span><span class=o>=</span><span class=s2>&quot;aicc&quot;</span><span class=p>,</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=p>)</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>    <span class=p>),</span>
<a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=p>)</span>
<a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>
<a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a><span class=n>xaxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>n_info_values</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xaxis</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>info_values</span><span class=p>)</span>
<a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;n_terms&quot;</span><span class=p>)</span>
<a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Information Criteria&quot;</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.2282E-01</td> <td>9.26094341E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.4294E-01</td> <td>3.35898283E-02</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>1.2753E-01</td> <td>2.35736200E-03</td> </tr> <tr> <td>x1(k-1)</td> <td>6.9597E-02</td> <td>4.11741791E-03</td> </tr> <tr> <td>x1(k-1)^2</td> <td>7.0578E-02</td> <td>2.54231877E-03</td> </tr> <tr> <td>x1(k-2)^2</td> <td>-1.0523E-01</td> <td>1.39658893E-03</td> </tr> <tr> <td>y(k-1)^2</td> <td>1.0949E-01</td> <td>1.70257419E-03</td> </tr> <tr> <td>x1(k-2)y(k-2)</td> <td>7.1821E-02</td> <td>1.11056684E-03</td> </tr> <tr> <td>y(k-2)^2</td> <td>-3.9756E-02</td> <td>1.01686239E-03</td> </tr> <tr> <td>&gt;Table 4</td> <td></td> <td></td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_aicc_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_aicc_c4.png?raw=true"></a></p> <blockquote> <p>Figura 7. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado utilizando AICc.</p> </blockquote> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/aicc_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/aicc_c4.png?raw=true"></a></p> <blockquote> <p>Figura 8. O gráfico mostra os valores do critério de informação (AICc) em função do número de termos incluídos no modelo. O processo de seleção de modelo, baseado no AICc, adiciona regressores iterativamente até que o critério atinja um mínimo, indicando o balanço ótimo entre complexidade e ajuste. O ponto em que o valor de AICc deixa de diminuir define o número ótimo de termos, resultando em um modelo final com 9 termos.</p> </blockquote> <p>Desta vez, obtemos um modelo com 9 regressores.</p> <h4 id=bic>BIC<a class=headerlink href=#bic title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=n>n_info_values</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>info_criteria</span><span class=o>=</span><span class=s2>&quot;bic&quot;</span><span class=p>,</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=p>)</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>    <span class=p>),</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=p>)</span>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=n>xaxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>n_info_values</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xaxis</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>info_values</span><span class=p>)</span>
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;n_terms&quot;</span><span class=p>)</span>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Information Criteria&quot;</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.1726E-01</td> <td>9.26094341E-01</td> </tr> <tr> <td>y(k-1)</td> <td>1.8670E-01</td> <td>3.35898283E-02</td> </tr> <tr> <td>&gt;Table 5</td> <td></td> <td></td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_bic_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_bic_c4.png?raw=true"></a></p> <blockquote> <p>Figura 9. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado utilizando BIC.</p> </blockquote> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/bic_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/bic_c4.png?raw=true"></a></p> <blockquote> <p>Figura 10. O gráfico mostra os valores do critério de informação (BIC) em função do número de termos incluídos no modelo. O processo de seleção de modelo, baseado no BIC, adiciona regressores iterativamente até que o critério atinja um mínimo, indicando o balanço ótimo entre complexidade e ajuste. O ponto em que o valor de BIC deixa de diminuir define o número ótimo de termos, resultando em um modelo final com 2 termos.</p> </blockquote> <p>O BIC retornou um modelo com apenas 2 regressores.</p> <h4 id=lilc>LILC<a class=headerlink href=#lilc title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=n>n_info_values</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>info_criteria</span><span class=o>=</span><span class=s2>&quot;lilc&quot;</span><span class=p>,</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=p>)</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>    <span class=p>),</span>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=p>)</span>
<a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a>
<a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a><span class=n>xaxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>n_info_values</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xaxis</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>info_values</span><span class=p>)</span>
<a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;n_terms&quot;</span><span class=p>)</span>
<a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Information Criteria&quot;</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.1160E-01</td> <td>9.26094341E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.3178E-01</td> <td>3.35898283E-02</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>1.2080E-01</td> <td>2.35736200E-03</td> </tr> <tr> <td>x1(k-1)</td> <td>6.3113E-02</td> <td>4.11741791E-03</td> </tr> <tr> <td>x1(k-1)^2</td> <td>5.4088E-02</td> <td>2.54231877E-03</td> </tr> <tr> <td>x1(k-2)^2</td> <td>-9.0683E-02</td> <td>1.39658893E-03</td> </tr> <tr> <td>y(k-1)^2</td> <td>8.2157E-02</td> <td>1.70257419E-03</td> </tr> <tr> <td>&gt;Table 6</td> <td></td> <td></td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_lilc_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_lilc_c4.png?raw=true"></a></p> <blockquote> <p>Figura 11. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado utilizando LILC.</p> </blockquote> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/lilc_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/lilc_c4.png?raw=true"></a></p> <blockquote> <p>Figura 12. O gráfico mostra os valores do critério de informação (LILC) em função do número de termos incluídos no modelo. O processo de seleção de modelo, baseado no LILC, adiciona regressores iterativamente até que o critério atinja um mínimo, indicando o balanço ótimo entre complexidade e ajuste. O ponto em que o valor de LILC deixa de diminuir define o número ótimo de termos, resultando em um modelo final com 7 termos.</p> </blockquote> <p>O LILC retornou um modelo com 7 regressores.</p> <h4 id=fpe>FPE<a class=headerlink href=#fpe title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>    <span class=n>order_selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>n_info_values</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>    <span class=n>info_criteria</span><span class=o>=</span><span class=s2>&quot;fpe&quot;</span><span class=p>,</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=p>)</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a>    <span class=p>),</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=p>)</span>
<a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a>
<a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=n>xaxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>n_info_values</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xaxis</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>info_values</span><span class=p>)</span>
<a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&quot;n_terms&quot;</span><span class=p>)</span>
<a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&quot;Information Criteria&quot;</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.4236E-01</td> <td>9.26094341E-01</td> </tr> <tr> <td>y(k-1)</td> <td>2.4933E-01</td> <td>3.35898283E-02</td> </tr> <tr> <td>x1(k-1)y(k-1)</td> <td>1.3001E-01</td> <td>2.35736200E-03</td> </tr> <tr> <td>x1(k-1)</td> <td>8.4024E-02</td> <td>4.11741791E-03</td> </tr> <tr> <td>x1(k-1)^2</td> <td>7.0807E-02</td> <td>2.54231877E-03</td> </tr> <tr> <td>x1(k-2)^2</td> <td>-9.1138E-02</td> <td>1.39658893E-03</td> </tr> <tr> <td>y(k-1)^2</td> <td>1.1698E-01</td> <td>1.70257419E-03</td> </tr> <tr> <td>x1(k-2)y(k-2)</td> <td>8.3745E-02</td> <td>1.11056684E-03</td> </tr> <tr> <td>y(k-2)^2</td> <td>-4.1946E-02</td> <td>1.01686239E-03</td> </tr> <tr> <td>x1(k-2)x1(k-1)</td> <td>5.9034E-02</td> <td>7.47435512E-04</td> </tr> <tr> <td>&gt;Table 7</td> <td></td> <td></td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_fpe_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/predicted_fpe_c4.png?raw=true"></a></p> <blockquote> <p>Figura 13. Simulação em regime livre (ou previsão em passos infinitos à frente) do modelo ajustado utilizando FPE.</p> </blockquote> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/fpe_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/fpe_c4.png?raw=true"></a></p> <blockquote> <p>Figura 14. O gráfico mostra os valores do critério de informação (FPE) em função do número de termos incluídos no modelo. O processo de seleção de modelo, baseado no FPE, adiciona regressores iterativamente até que o critério atinja um mínimo, indicando o balanço ótimo entre complexidade e ajuste. O ponto em que o valor de FPE deixa de diminuir define o número ótimo de termos, resultando em um modelo final com 10 termos.</p> </blockquote> <p>O FPE retornou um modelo com 10 regressores.</p> <h2 id=meta-model-structure-selection-metamss>Meta Model Structure Selection (MetaMSS)<a class=headerlink href=#meta-model-structure-selection-metamss title="Permanent link">&para;</a></h2> <blockquote> <p>Esta seção reflete em grande parte o conteúdo de um artigo que publiquei no <a href=https://arxiv.org/abs/2109.09917>ArXiv</a>, intitulado <em>"Meta-Model Structure Selection: Building Polynomial NARX Models for Regression and Classification."</em> Esse artigo foi inicialmente escrito para submissão em periódico, com base nos resultados da minha <a href=https://ufsj.edu.br/portal2-repositorio/File/ppgel/225-2020-02-17-DissertacaoWilsonLacerda.pdf>dissertação de mestrado</a>. No entanto, como passei a atuar como Data Scientist e considerando o longo processo de submissão em periódicos, decidi não seguir com a publicação formal neste momento. Assim, o artigo permanece disponível apenas no ArXiv.</p> <p>Esse trabalho estende um artigo anterior apresentado em um <a href="https://proceedings.science/sbai-2019/trabalhos/identificacao-de-sistemas-nao-lineares-utilizando-o-algoritmo-hibrido-e-binario?lang=pt-br">congresso brasileiro</a>, onde parte dos resultados foi inicialmente divulgada.</p> </blockquote> <p>Esta seção apresenta uma abordagem meta‑heurística para seleção da estrutura de modelos polinomiais NARX em problemas de regressão. O método proposto considera simultaneamente a complexidade do modelo e a contribuição de cada termo para construir modelos parcimoniosos por meio de uma nova formulação de função de custo. A robustez do algoritmo é avaliada em diversos sistemas simulados e experimentais com diferentes características de não linearidade. Os resultados mostram que o algoritmo é capaz de identificar corretamente o modelo quando a estrutura verdadeira é conhecida e de produzir modelos parcimoniosos com dados experimentais, mesmo em casos em que métodos clássicos e contemporâneos frequentemente falham. A nova abordagem é comparada com métodos clássicos, como FROLS, e com técnicas recentes baseadas em amostragem aleatória.</p> <p>Comentamos anteriormente que selecionar termos adequados de modelo é crucial para capturar corretamente a dinâmica do sistema original. Problemas como superparametrização e má condição numérica frequentemente surgem devido às limitações dos algoritmos de identificação existentes em selecionar os termos corretos para o modelo final. Ver, por exemplo, <a href=https://www.sciencedirect.com/science/article/abs/pii/0167278995900535>Aguirre, L. A. and Billings, S. A. - Dynamical effects of overparametrization in nonlinear models</a>, <a href=https://www.tandfonline.com/doi/abs/10.1080/00207170310001635419>Piroddi, L. and Spinelli, W. - An identification algorithm for polynomial NARX models based on simulation error minimization</a>. Também mencionamos que um dos algoritmos mais tradicionais para seleção de estrutura em modelos NARMAX polinomiais é o ERR. Diversas variantes do algoritmo FROLS foram desenvolvidas para melhorar o desempenho da seleção de modelo, como em <a href=https://www.tandfonline.com/doi/abs/10.1080/00207178908559767>Billings, S. A., Chen, S., and Korenberg, M. J. - Identification of MIMO non-linear systems using a forward-regression orthogonal estimator</a>, <a href=https://www.sciencedirect.com/science/article/pii/S1474667016388462>Farina, M. and Piroddi, L. - Simulation Error Minimization–Based Identification of Polynomial Input–Output Recursive Models</a>, <a href=https://eprints.whiterose.ac.uk/107315/3/A%20New%20Iterative%20Orthogonal%20Forward%20Regression%20Algorithm%20-%20R2.pdf>Guo, Y., Guo, L. Z., Billings, S. A., and Wei, H. - A New Iterative Orthogonal Forward Regression Algorithm</a>, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0888327098901807>Mao, K. Z. and Billings, S. A. - VARIABLE SELECTION IN NON-LINEAR SYSTEMS MODELLING</a>. As limitações do FROLS foram amplamente discutidas na literatura, por exemplo, em <a href=https://core.ac.uk/download/pdf/29031334.pdf>Billings, S. A. and Aguirre, L. A.</a>, <a href=https://ui.adsabs.harvard.edu/abs/2001JSV...239..405P/abstract>Palumbo, P. and Piroddi, L.</a>, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109815003088>Falsone, A., Piroddi, L., and Prandini, M.</a>. A maior parte desses pontos fracos está relacionada a (i) o framework de Prediction Error Minimization (PEM); (ii) a inadequação do índice ERR para medir a importância absoluta dos regressores; e (iii) o uso de critérios de informação como AIC, FPE e BIC para selecionar a ordem do modelo. Em relação aos critérios de informação, embora funcionem bem para modelos lineares, em um contexto não linear não é possível estabelecer uma relação simples entre tamanho do modelo e acurácia <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109815003088>Falsone, A., Piroddi, L., and Prandini, M. - A randomized algorithm for nonlinear model structure selection</a>, <a href=https://ieeexplore.ieee.org/document/1205199>Chen, S., Hong, X., and Harris, C. J. - Sparse kernel regression modeling using combined locally regularized orthogonal least squares and D-optimality experimental design</a>.</p> <p>Devido às limitações dos algoritmos baseados em Ordinary Least Squares (OLS), pesquisas recentes propuseram soluções que se afastam da abordagem clássica FROLS. Novos métodos reformularam o processo de Model Structure Selection (MSS) em um arcabouço probabilístico e passaram a empregar técnicas de amostragem aleatória <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109815003088>Falsone, A., Piroddi, L., and Prandini, M. - A randomized algorithm for nonlinear model structure selection</a>, <a href=https://link.springer.com/book/10.1007/978-1-4471-4610-0>Tempo, R., Calafiore, G., and Dabbene, F. - Randomized Algorithms for Analysis and Control of Uncertain Systems: With Applications</a>, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109813003063>Baldacchino, T., Anderson, S. R., and Kadirkamanathan, V. - Computational system identification for Bayesian NARMAX modelling</a>, <a href=https://ieeexplore.ieee.org/document/1306531>Rodriguez-Vazquez, K., Fonseca, C. M., and Fleming, P. J. - Identifying the structure of nonlinear dynamic systems using multiobjective genetic programming</a>, <a href=https://repositorio.ufrn.br/bitstream/123456789/24900/1/AlcemyGabrielVitorSeverino_DISSERT.pdf>Severino, A. G. V. and Araujo, F. M. U. de</a>. Apesar desses avanços, abordagens meta‑heurísticas e probabilísticas ainda apresentam algumas limitações. Em particular, muitas dependem de critérios de informação como AIC, FPE e BIC para definir a função de custo da otimização, o que frequentemente leva a modelos superparametrizados.</p> <p>Considere <span class=arithmatex>\(\mathcal{F}\)</span> como uma classe de funções limitadas <span class=arithmatex>\(\phi: \mathbf{R} \mapsto \mathbf{R}\)</span>. Se as propriedades de <span class=arithmatex>\(\phi(x)\)</span> satisfazem</p> <div class=arithmatex>\[ \begin{align} &amp;\lim\limits_{x \to \infty} \phi(x) = \alpha \nonumber \\ &amp;\lim\limits_{x \to -\infty} \phi(x) = \beta \quad \text{com } \alpha &gt; \beta, \nonumber \end{align} \tag{32} \]</div> <p>então <span class=arithmatex>\(\phi(x)\)</span> é chamada de função sigmoide.</p> <p>No caso particular considerado aqui, seguindo a definição da Equação 32 com <span class=arithmatex>\(\alpha = 1\)</span> e <span class=arithmatex>\(\beta = 0\)</span>, podemos escrever uma curva em "S" como</p> <div class=arithmatex>\[ \begin{equation} \varsigma(x) = \frac{1}{1+e^{-a(x-c)}}. \end{equation} \tag{33} \]</div> <p>Nesse caso, podemos especificar o parâmetro <span class=arithmatex>\(a\)</span>, que controla a taxa de variação. Se <span class=arithmatex>\(a\)</span> é próximo de zero, a função sigmoide é suave. Se <span class=arithmatex>\(a\)</span> é grande, a transição da sigmoide é abrupta. Se <span class=arithmatex>\(a\)</span> é negativo, a sigmoide varia de 1 para 0. O parâmetro <span class=arithmatex>\(c\)</span> corresponde ao valor de <span class=arithmatex>\(x\)</span> para o qual <span class=arithmatex>\(y = 0.5\)</span>.</p> <p>A Sigmoid Linear Unit Function (SiLU) é definida como o produto da função sigmoide pela sua entrada</p> <div class=arithmatex>\[ \begin{equation} \text{silu}(x) = x \varsigma(x), \end{equation} \tag{34} \]</div> <p>que pode ser vista como uma função sigmoide "mais íngreme" com overshoot.</p> <h3 id=metaheuristicas>Metaheurísticas<a class=headerlink href=#metaheuristicas title="Permanent link">&para;</a></h3> <p>Nas últimas duas décadas, algoritmos de otimização inspirados na natureza têm ganhado destaque devido à sua flexibilidade, simplicidade, versatilidade e capacidade de evitar mínimos locais em aplicações reais.</p> <p>Algoritmos metaheurísticos são caracterizados por duas propriedades fundamentais: exploração e explotação <a href=https://dl.acm.org/doi/10.1145/937503.937505>Blum, C. and Roli, A. - Metaheuristics in combinatorial optimization: Overview and conceptual comparison</a>. <strong>Exploitation</strong> (exploração local) foca em utilizar informações locais para refinar a busca em torno da melhor solução atual, melhorando a qualidade das soluções vizinhas. Por outro lado, <strong>exploration</strong> (exploração global) procura investigar regiões mais amplas do espaço de busca, de modo a descobrir soluções potencialmente superiores e evitar que o algoritmo fique preso em mínimos locais.</p> <p>Embora não haja consenso absoluto sobre as definições exatas de exploração e explotação em computação evolutiva, como discutido em <a href=https://www.researchgate.net/publication/220443407_On_Evolutionary_Exploration_and_Exploitation>Eiben, Agoston E and Schippers, Cornelis A</a>, existe um entendimento geral de que esses conceitos atuam como forças opostas e difíceis de equilibrar. Para lidar com esse desafio, metaheurísticas híbridas combinam múltiplos algoritmos, buscando tirar proveito tanto da exploração global quanto da explotação local, resultando em métodos de otimização mais robustos.</p> <h4 id=o-algoritmo-binary-hybrid-particle-swarm-optimization-and-gravitational-search-algorithm-bpsogsa>O algoritmo Binary hybrid Particle Swarm Optimization and Gravitational Search Algorithm (BPSOGSA)<a class=headerlink href=#o-algoritmo-binary-hybrid-particle-swarm-optimization-and-gravitational-search-algorithm-bpsogsa title="Permanent link">&para;</a></h4> <p>Alcançar um bom equilíbrio entre exploração e explotação é um dos grandes desafios da maioria dos algoritmos metaheurísticos. Na abordagem considerada aqui, aumentamos o desempenho e a flexibilidade do processo de busca utilizando uma estratégia híbrida que combina Binary Particle Swarm Optimization (BPSO) com Gravitational Search Algorithm (GSA), conforme proposto em <a href=https://ieeexplore.ieee.org/abstract/document/6141614>Mirjalili, S. and Hashim, S. Z. M.</a>. Esse método híbrido incorpora uma técnica de coevolução heterogênea de baixo nível, originalmente introduzida por <a href=https://link.springer.com/article/10.1023/A:1016540724870>Talbi, E. G.</a>.</p> <p>O BPSOGSA tira proveito das forças de ambos os algoritmos: a componente Particle Swarm Optimization (PSO) é especialmente eficiente em explorar o espaço de busca em escala global, buscando o ótimo global, enquanto a componente Gravitational Search Algorithm (GSA) é eficaz em refinar a busca em torno de soluções locais dentro de um espaço binário. Essa combinação visa fornecer uma estratégia de otimização mais abrangente e eficiente, garantindo um melhor equilíbrio entre exploração e explotação.</p> <h4 id=particle-swarm-optimization-pso-padrao>Particle Swarm Optimization (PSO) padrão<a class=headerlink href=#particle-swarm-optimization-pso-padrao title="Permanent link">&para;</a></h4> <p>No Particle Swarm Optimization (PSO) <a href=https://ieeexplore.ieee.org/document/488968>Kennedy, J. and Eberhart, R. C.</a>, <a href=https://ieeexplore.ieee.org/document/488968>Kennedy, J.</a>, cada partícula representa uma solução candidata e é caracterizada por dois componentes: sua posição no espaço de busca, denotada por <span class=arithmatex>\(\vec{x}_{\,np,d} \in \mathbb{R}^{np \times d}\)</span>, e sua velocidade, <span class=arithmatex>\(\vec{v}_{\,np,d} \in \mathbb{R}^{np \times d}\)</span>. Aqui, <span class=arithmatex>\(np = 1, 2, \ldots, n_a\)</span>, onde <span class=arithmatex>\(n_a\)</span> é o tamanho do enxame, e <span class=arithmatex>\(d\)</span> é a dimensionalidade do problema. A população inicial é representada por</p> <div class=arithmatex>\[ \vec{x}_{\,np,d} = \begin{bmatrix} x_{1,1} &amp; x_{1,2} &amp; \cdots &amp; x_{1,d} \\ x_{2,1} &amp; x_{2,2} &amp; \cdots &amp; x_{2,d} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ x_{n_a,1} &amp; x_{n_a,2} &amp; \cdots &amp; x_{n_a,d} \end{bmatrix} \tag{35} \]</div> <p>A cada iteração <span class=arithmatex>\(t\)</span>, a posição e a velocidade de uma partícula são atualizadas pelas seguintes equações:</p> <div class=arithmatex>\[ v_{np,d}^{t+1} = \zeta v_{np,d}^{t} + c_1 \kappa_1 (pbest_{np}^{t} - x_{np,d}^{t}) + c_2 \kappa_2 (gbest_{np}^{t} - x_{np,d}^{t}), \tag{36} \]</div> <p>em que <span class=arithmatex>\(\kappa_j \in \mathbb{R}\)</span> para <span class=arithmatex>\(j = [1,2]\)</span> são variáveis aleatórias contínuas no intervalo <span class=arithmatex>\([0,1]\)</span>, <span class=arithmatex>\(\zeta \in \mathbb{R}\)</span> é o fator de inércia que controla a influência da velocidade anterior na velocidade atual (representando o trade‑off entre exploração e explotação), <span class=arithmatex>\(c_1\)</span> é o fator cognitivo associado à melhor posição pessoal <span class=arithmatex>\(pbest\)</span>, e <span class=arithmatex>\(c_2\)</span> é o fator social associado à melhor posição global <span class=arithmatex>\(gbest\)</span>. A velocidade <span class=arithmatex>\(\vec{v}_{\,np,d}\)</span> é tipicamente limitada ao intervalo <span class=arithmatex>\([v_{min}, v_{max}]\)</span> para evitar que as partículas saiam do espaço de busca. A posição é então atualizada por</p> <div class=arithmatex>\[ x_{np,d}^{t+1} = x_{np,d}^{t} + v_{np,d}^{t+1}. \tag{37} \]</div> <h4 id=gravitational-search-algorithm-gsa-padrao>Gravitational Search Algorithm (GSA) padrão<a class=headerlink href=#gravitational-search-algorithm-gsa-padrao title="Permanent link">&para;</a></h4> <p>No Gravitational Search Algorithm (GSA) <a href=https://www.sciencedirect.com/science/article/abs/pii/S0020025509001200>Rashedi, Esmat, Nezamabadi-Pour, Hossein, and Saryazdi, Saeid - GSA: A Gravitational Search Algorithm</a>, os agentes são representados por massas, cujo valor é proporcional ao fitness (valor da função objetivo) associado a cada agente. Essas massas interagem mediante forças gravitacionais, atraindo‑se mutuamente em direção a regiões mais promissoras do espaço de busca. Massas mais pesadas (agentes com melhor fitness) movem‑se mais lentamente, enquanto massas mais leves (agentes com pior fitness) tendem a se mover mais rapidamente. Cada massa no GSA possui quatro propriedades: posição, massa inercial, massa gravitacional ativa e massa gravitacional passiva. A posição de uma massa representa uma solução candidata, e suas massas gravitacional e inercial são derivadas da função de fitness.</p> <p>Considere uma população de agentes descrita pelas seguintes equações. Em um instante de tempo <span class=arithmatex>\(t\)</span>, a velocidade e a posição de cada agente são atualizadas como</p> <div class=arithmatex>\[ \begin{align} v_{i,d}^{t+1} &amp;= \kappa_i \times v_{i,d}^t + a_{i,d}^t, \\ x_{i,d}^{t+1} &amp;= x_{i,d}^t + v_{i,d}^{t+1}. \end{align} \tag{38} \]</div> <p>Aqui, <span class=arithmatex>\(\kappa_i\)</span> introduz características estocásticas no processo de busca. A aceleração <span class=arithmatex>\(a_{i,d}^t\)</span> é calculada de acordo com a lei do movimento <a href=https://www.sciencedirect.com/science/article/abs/pii/S0020025509001200>Rashedi, Esmat and Nezamabadi-Pour, Hossein and Saryazdi, Saeid</a>:</p> <div class=arithmatex>\[ \begin{equation} a_{i,d}^t = \frac{F_{i,d}^t}{M_{ii}^{t}}, \end{equation} \tag{39} \]</div> <p>em que <span class=arithmatex>\(M_{ii}^{t}\)</span> é a massa inercial do agente <span class=arithmatex>\(i\)</span> e <span class=arithmatex>\(F_{i,d}^t\)</span> representa a força gravitacional atuando sobre o agente <span class=arithmatex>\(i\)</span> na dimensão <span class=arithmatex>\(d\)</span>. Os detalhes do cálculo de <span class=arithmatex>\(F_{i,d}\)</span> e <span class=arithmatex>\(M_{ii}\)</span> podem ser encontrados em <a href=https://www.sciencedirect.com/science/article/abs/pii/S0020025509001200>Rashedi, Esmat and Nezamabadi-Pour, Hossein and Saryazdi, Saeid</a>.</p> <h4 id=o-algoritmo-hibrido-binario-de-otimizacao>O algoritmo híbrido binário de otimização<a class=headerlink href=#o-algoritmo-hibrido-binario-de-otimizacao title="Permanent link">&para;</a></h4> <p>A combinação dos algoritmos segue a formulação descrita em <a href=https://ieeexplore.ieee.org/abstract/document/6141614>Mirjalili, S. and Hashim, S. Z. M. - A new hybrid PSOGSA algorithm for function optimization</a>:</p> <div class=arithmatex>\[ \begin{align} v_{i}^{t+1} = \zeta \times v_i^t + \mathrm{c}'_{1} \times \kappa \times a_i^t + \mathrm{c}'_2 \times \kappa \times (gbest - x_i^t), \end{align} \tag{40} \]</div> <p>onde <span class=arithmatex>\(\mathrm{c}'_j \in \mathbb{R}\)</span> são coeficientes de aceleração. Essa formulação intensifica a fase de explotação ao incorporar a melhor posição encontrada até o momento. Por outro lado, essa mesma característica pode prejudicar a fase de exploração. Para contornar esse problema, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0965997813001853>Mirjalili, S., Mirjalili, S. M., and Lewis, A. - Grey Wolf Optimizer</a> propuseram valores adaptativos para <span class=arithmatex>\(\mathrm{c}'_j\)</span>, conforme descrito em <a href=https://dl.acm.org/doi/10.1007/s00521-014-1629-6>Mirjalili, S., Wang, Gai-Ge, and Coelho, L. dos S. - Binary optimization using hybrid particle swarm optimization and gravitational search algorithm</a>:</p> <div class=arithmatex>\[ \begin{align} \mathrm{c}_1' &amp;= -2 \times \frac{t^3}{\max(t)^3} + 2, \\ \mathrm{c}_2' &amp;= 2 \times \frac{t^3}{\max(t)^3} + 2. \end{align} \tag{41} \]</div> <p>Em cada iteração, as posições das partículas são atualizadas segundo as regras acima, sendo o espaço contínuo mapeado para soluções discretas por meio de uma função de transferência <a href=https://www.sciencedirect.com/science/article/abs/pii/S2210650212000648>Mirjalili, S. and Lewis, A. - S-shaped versus V-shaped transfer functions for binary Particle Swarm Optimization</a>:</p> <div class=arithmatex>\[ \begin{equation} S(v_{ik}) = \left|\frac{2}{\pi}\arctan\left(\frac{\pi}{2}v_{ik}\right)\right|. \end{equation} \tag{42} \]</div> <p>Com um número aleatório <span class=arithmatex>\(\kappa \in (0,1)\)</span> uniformemente distribuído, as posições dos agentes no espaço binário são atualizadas como</p> <div class=arithmatex>\[ \begin{equation} x_{np,d}^{t+1} = \begin{cases} (x_{np,d}^{t})^{-1}, &amp; \text{se } \kappa &lt; S(v_{ik}^{t+1}), \\ x_{np,d}^{t}, &amp; \text{se } \kappa \geq S(v_{ik}^{t+1}). \end{cases} \end{equation} \tag{43} \]</div> <h3 id=meta-model-structure-selection-metamss-construindo-narx-para-regressao>Meta-Model Structure Selection (MetaMSS): Construindo NARX para regressão<a class=headerlink href=#meta-model-structure-selection-metamss-construindo-narx-para-regressao title="Permanent link">&para;</a></h3> <p>Nesta subseção, exploramos a abordagem meta‑heurística para seleção da estrutura de modelos NARX com BPSOGSA proposta na minha <a href=https://ufsj.edu.br/portal2-repositorio/File/ppgel/225-2020-02-17-DissertacaoWilsonLacerda.pdf>dissertação de mestrado</a>. A ideia é buscar, no espaço de decisão definido por um dicionário de regressores pré‑especificado, a estrutura de modelo que minimiza uma função de custo. A função objetivo considerada é baseada no root mean squared error (RMSE) da saída em regime livre (free‑run simulation), acrescida de um termo de penalização que leva em conta a complexidade do modelo e a contribuição de cada regressor.</p> <h4 id=esquema-de-codificacao>Esquema de codificação<a class=headerlink href=#esquema-de-codificacao title="Permanent link">&para;</a></h4> <p>O processo de uso do BPSOGSA para seleção de estrutura envolve definir as dimensões da função de teste. Em particular, <span class=arithmatex>\(n_y\)</span>, <span class=arithmatex>\(n_x\)</span> e <span class=arithmatex>\(\ell\)</span> são escolhidos de forma a cobrir todos os regressores possíveis, e uma matriz geral de regressores <span class=arithmatex>\(\Psi\)</span> é construída. O número de colunas de <span class=arithmatex>\(\Psi\)</span> é denotado por <span class=arithmatex>\(noV\)</span>, e o número de agentes, por <span class=arithmatex>\(N\)</span>. Uma matriz binária <span class=arithmatex>\(noV \times N\)</span>, denotada <span class=arithmatex>\(\mathcal{X}\)</span>, é então gerada aleatoriamente para representar a posição de cada agente no espaço de busca. Cada coluna de <span class=arithmatex>\(\mathcal{X}\)</span> representa uma solução candidata, isto é, uma estrutura de modelo a ser avaliada em cada iteração. Nessa matriz, um valor 1 indica que a coluna correspondente de <span class=arithmatex>\(\Psi\)</span> é incluída na matriz reduzida de regressores, enquanto um valor 0 indica a exclusão.</p> <p>Como exemplo, considere o caso em que todos os regressores possíveis são definidos com <span class=arithmatex>\(\ell = 1\)</span> e <span class=arithmatex>\(n_y = n_u = 2\)</span>. A matriz <span class=arithmatex>\(\Psi\)</span> é dada por</p> <div class=arithmatex>\[ \begin{align} [ \text{constant} \quad y(k-1) \quad y(k-2) \quad u(k-1) \quad u(k-2) ] \end{align} \tag{44} \]</div> <p>Com 5 regressores possíveis, temos <span class=arithmatex>\(noV = 5\)</span>. Supondo <span class=arithmatex>\(N = 5\)</span>, a matriz <span class=arithmatex>\(\mathcal{X}\)</span> pode ser representada como</p> <div class=arithmatex>\[ \begin{equation} \mathcal{X} = \begin{bmatrix} 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 1 &amp; 1 &amp; 1 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\ 1 &amp; 0 &amp; 1 &amp; 1 &amp; 0 \end{bmatrix} \end{equation} \tag{45} \]</div> <p>Cada coluna de <span class=arithmatex>\(\mathcal{X}\)</span> é transposta para gerar uma solução candidata. Por exemplo, a primeira coluna resulta em</p> <div class=arithmatex>\[ \begin{equation*} \mathcal{X} = \begin{bmatrix} \text{constant} &amp; y(k-1) &amp; y(k-2) &amp; u(k-1) &amp; u(k-2) \\ 1 &amp; 1 &amp; 1 &amp; 0 &amp; 1 \end{bmatrix} \end{equation*} \tag{46} \]</div> <p>Neste cenário, o primeiro modelo a ser avaliado é <span class=arithmatex>\(\alpha y(k-1) + \beta u(k-2)\)</span>, cujos parâmetros <span class=arithmatex>\(\alpha\)</span> e <span class=arithmatex>\(\beta\)</span> podem ser estimados com qualquer método de estimação de parâmetros disponível. O mesmo procedimento é repetido para cada coluna de <span class=arithmatex>\(\mathcal{X}\)</span>.</p> <h4 id=formulacao-da-funcao-objetivo>Formulação da função objetivo<a class=headerlink href=#formulacao-da-funcao-objetivo title="Permanent link">&para;</a></h4> <p>Para cada estrutura de modelo candidata, o sistema linear nos parâmetros pode ser resolvido diretamente utilizando o algoritmo de Mínimos Quadrados (Least Squares) ou qualquer outro método disponível no SysIdentPy. A variância dos parâmetros estimados pode ser calculada como</p> <div class=arithmatex>\[ \hat{\sigma}^2 = \hat{\sigma}_e^2 V_{jj}, \tag{47} \]</div> <p>em que <span class=arithmatex>\(\hat{\sigma}_e^2\)</span> é a variância do erro estimada, dada por</p> <div class=arithmatex>\[ \hat{\sigma}_e^2 = \frac{1}{N-m} \sum_{k=1}^{N} (y_k - \psi_{k-1}^\top \hat{\Theta}), \tag{48} \]</div> <p>e <span class=arithmatex>\(V_{jj}\)</span> é o <span class=arithmatex>\(j\)</span>‑ésimo elemento da diagonal de <span class=arithmatex>\((\Psi^\top \Psi)^{-1}\)</span>.</p> <p>O erro padrão estimado para o <span class=arithmatex>\(j\)</span>‑ésimo coeficiente de regressão <span class=arithmatex>\(\hat{\Theta}_j\)</span> é dado pela raiz quadrada positiva dos elementos diagonais de <span class=arithmatex>\(\hat{\sigma}^2\)</span>:</p> <div class=arithmatex>\[ \mathrm{se}(\hat{\Theta}_j) = \sqrt{\hat{\sigma}^2_{jj}}. \tag{49} \]</div> <p>Para avaliar a relevância estatística de cada regressor, propõe‑se um teste de penalização baseado no erro padrão dos coeficientes de regressão. Neste caso, utilizamos o teste t (t‑student) para realizar um teste de hipótese sobre os coeficientes, avaliando a significância de cada regressor no modelo de regressão linear múltipla. As hipóteses consideradas são</p> <div class=arithmatex>\[ \begin{align*} H_0 &amp;: \Theta_j = 0, \\ H_a &amp;: \Theta_j \neq 0. \end{align*} \tag{50} \]</div> <p>O valor da estatística de teste t é calculado como</p> <div class=arithmatex>\[ T_0 = \frac{\hat{\Theta}_j}{\mathrm{se}(\hat{\Theta}_j)}, \tag{51} \]</div> <p>que mede quantos desvios padrão <span class=arithmatex>\(\hat{\Theta}_j\)</span> está distante de zero. Mais precisamente, se</p> <div class=arithmatex>\[ -t_{\alpha/2, N-m} &lt; T_0 &lt; t_{\alpha/2, N-m}, \tag{52} \]</div> <p>onde <span class=arithmatex>\(t_{\alpha/2, N-m}\)</span> é o valor crítico da distribuição t para nível de significância <span class=arithmatex>\(\alpha\)</span> e <span class=arithmatex>\(N-m\)</span> graus de liberdade, então, se <span class=arithmatex>\(T_0\)</span> estiver fora dessa região de aceitação, rejeitamos a hipótese nula <span class=arithmatex>\(H_0: \Theta_j = 0\)</span>. Isso implica que <span class=arithmatex>\(\Theta_j\)</span> é estatisticamente significativo ao nível <span class=arithmatex>\(\alpha\)</span>. Caso contrário, se <span class=arithmatex>\(T_0\)</span> estiver dentro da região de aceitação, não rejeitamos <span class=arithmatex>\(H_0\)</span> e consideramos que <span class=arithmatex>\(\Theta_j\)</span> não é significativamente diferente de zero.</p> <h4 id=valor-de-penalizacao-baseado-na-derivada-da-sigmoid-linear-unit>Valor de penalização baseado na derivada da Sigmoid Linear Unit<a class=headerlink href=#valor-de-penalizacao-baseado-na-derivada-da-sigmoid-linear-unit title="Permanent link">&para;</a></h4> <p>Propomos um valor de penalização baseado na derivada da função sigmoide, definida como</p> <div class=arithmatex>\[ \dot{\varsigma}(x(\varrho)) = \varsigma(x) [1 + (a(x - c))(1 - \varsigma(x))]. \tag{53} \]</div> <p>Nessa formulação, os parâmetros são definidos da seguinte forma: <span class=arithmatex>\(x\)</span> tem dimensão <span class=arithmatex>\(noV\)</span>; <span class=arithmatex>\(c = noV / 2\)</span>; e <span class=arithmatex>\(a\)</span> é definido como a razão entre o número de regressores do modelo em teste e <span class=arithmatex>\(c\)</span>. Esse procedimento leva a uma curva específica para cada modelo, sendo que o declive da sigmoide se torna mais acentuado à medida que o número de regressores aumenta. O valor de penalização <span class=arithmatex>\(\varrho\)</span> corresponde ao valor de <span class=arithmatex>\(y\)</span> da curva sigmoide para o número de regressores considerado em <span class=arithmatex>\(x\)</span>. Como a derivada da função sigmoide pode assumir valores negativos, normalizamos <span class=arithmatex>\(\varsigma\)</span> como</p> <div class=arithmatex>\[ \varrho = \varsigma - \mathrm{min}(\varsigma), \tag{54} \]</div> <p>garantindo que <span class=arithmatex>\(\varrho \in \mathbb{R}^{+}\)</span>.</p> <p>Note que dois modelos distintos com o mesmo número de regressores podem apresentar desempenhos bastante diferentes, devido à importância relativa de cada termo. Para lidar com isso, incorporamos o teste t‑student na penalização para quantificar a relevância estatística dos regressores. Mais especificamente, calculamos <span class=arithmatex>\(n_{\Theta, H_{0}}\)</span>, o número de regressores considerados não significativos para o modelo. O valor de penalização é então ajustado com base no tamanho efetivo do modelo:</p> <div class=arithmatex>\[ \mathrm{model\_size} = n_{\Theta} + n_{\Theta, H_{0}}. \tag{55} \]</div> <p>A função objetivo que combina o root mean squared error relativo com o termo de penalização <span class=arithmatex>\(\varrho\)</span> é definida como</p> <div class=arithmatex>\[ \mathcal{F} = \frac{\sqrt{\sum_{k=1}^{n} (y_k - \hat{y}_k)^2}}{\sqrt{\sum_{k=1}^{n} (y_k - \bar{y})^2}} \times \varrho. \tag{56} \]</div> <p>Essa abordagem garante que, mesmo para modelos com o mesmo número de regressores, aqueles contendo termos redundantes sejam mais penalizados.</p> <h4 id=estudos-de-caso-resultados-de-simulacao>Estudos de caso: resultados de simulação<a class=headerlink href=#estudos-de-caso-resultados-de-simulacao title="Permanent link">&para;</a></h4> <p>Nesta subseção, apresentamos seis exemplos de simulação para ilustrar a eficácia do algoritmo MetaMSS. Uma análise detalhada do desempenho do algoritmo é realizada considerando diferentes configurações de parâmetros. Os sistemas selecionados são amplamente utilizados como benchmarks em problemas de seleção de estrutura de modelos e foram extraídos de <a href=https://www.inderscienceonline.com/doi/abs/10.1504/IJMIC.2008.020543>Wei, H. and Billings, S. A., "Model structure selection using an integrated forward orthogonal search algorithm assisted by squared correlation and mutual information"</a>, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109815003088>Falsone, A. and Piroddi, L. and Prandini, M., "A randomized algorithm for nonlinear model structure selection"</a>, <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109813003063>Baldacchino, T. and Anderson, S. R. and Kadirkamanathan, V., "Computational system identification for Bayesian NARMAX modelling"</a>, <a href=https://www.tandfonline.com/doi/abs/10.1080/00207170310001635419>Piroddi, L. and Spinelli, W., "An identification algorithm for polynomial NARX models based on simulation error minimization"</a>, <a href=https://eprints.whiterose.ac.uk/107315/3/A%20New%20Iterative%20Orthogonal%20Forward%20Regression%20Algorithm%20-%20R2.pdf>Guo, Y. and Guo, L. Z. and Billings, S. A. and Wei, H., "A New Iterative Orthogonal Forward Regression Algorithm"</a>, <a href=https://www.researchgate.net/publication/224153379_NARX_model_selection_based_on_simulation_error_minimisation_and_LASSO>Bonin, M. and Seghezza, V. and Piroddi, L., "NARX model selection based on simulation error minimization and LASSO"</a> e <a href=https://www.sciencedirect.com/science/article/abs/pii/S0888327010001469>Aguirre, L. A. and Barbosa, B. H. G. and Braga, A. P., "Prediction and simulation errors in parameter estimation for nonlinear systems"</a>. Finalmente, realizamos uma análise comparativa com o <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109815003088>Randomized Model Structure Selection (RaMSS), "A randomized algorithm for nonlinear model structure selection"</a>, o FROLS e o algoritmo <a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109813003063>Reversible-jump Markov chain Monte Carlo (RJMCMC), "Computational system identification for Bayesian NARMAX modelling"</a> para avaliar a eficácia do método proposto.</p> <p>Os modelos de simulação são definidos como</p> <div class=arithmatex>\[ \begin{align} &amp; S_1: \quad y_k = -1.7y_{k-1} - 0.8y_{k-2} + x_{k-1} + 0.81x_{k-2} + e_k, \\ &amp; \qquad \quad \text{com } x_k \sim \mathcal{U}(-2, 2) \text{ e } e_k \sim \mathcal{N}(0, 0.01^2); \\ &amp; S_2: \quad y_k = 0.8y_{k-1} + 0.4x_{k-1} + 0.4x_{k-1}^2 + 0.4x_{k-1}^3 + e_k, \\ &amp; \qquad \quad \text{com } x_k \sim \mathcal{N}(0, 0.3^2) \text{ e } e_k \sim \mathcal{N}(0, 0.01^2). \\ &amp; S_3: \quad y_k = 0.2y_{k-1}^3 + 0.7y_{k-1}x_{k-1} + 0.6x_{k-2}^2 \\ &amp;- 0.7y_{k-2}x_{k-2}^2 -0.5y_{k-2}+ e_k, \\ &amp; \qquad \quad \text{com } x_k \sim \mathcal{U}(-1, 1) \text{ e } e_k \sim \mathcal{N}(0, 0.01^2). \\ &amp; S_4: \quad y_k = 0.7y_{k-1}x_{k-1} - 0.5y_{k-2} + 0.6x_{k-2}^2 \\ &amp;- 0.7y_{k-2}x_{k-2}^2 + e_k, \\ &amp; \qquad \quad \text{com } x_k \sim \mathcal{U}(-1, 1) \text{ e } e_k \sim \mathcal{N}(0, 0.04^2). \\ &amp; S_5: \quad y_k = 0.7y_{k-1}x_{k-1} - 0.5y_{k-2} + 0.6x_{k-2}^2 \\ &amp;- 0.7y_{k-2}x_{k-2}^2 + 0.2e_{k-1} \\ &amp; \qquad \quad - 0.3x_{k-1}e_{k-2} + e_k,\\ &amp; \qquad \quad \text{com } x_k \sim \mathcal{U}(-1, 1) \text{ e } e_k \sim \mathcal{N}(0, 0.02^2); \\ &amp; S_6: \quad y_k = 0.75y_{k-2} + 0.25x_{k-2} - 0.2y_{k-2}x_{k-2} + e_k \\ &amp; \qquad \quad \text{com } x_k \sim \mathcal{N}(0, 0.25^2) \text{ e } e_k \sim \mathcal{N}(0, 0.02^2); \end{align} \tag{57} \]</div> <p>em que <span class=arithmatex>\(\mathcal{U}(a, b)\)</span> denota amostras uniformemente distribuídas em <span class=arithmatex>\([a, b]\)</span> e <span class=arithmatex>\(\mathcal{N}(\eta, \sigma^2)\)</span> denota amostras com distribuição Gaussiana de média <span class=arithmatex>\(\eta\)</span> e desvio padrão <span class=arithmatex>\(\sigma\)</span>. Todas as realizações dos sistemas são compostas por 500 amostras de entrada e saída. Além disso, a mesma semente aleatória é utilizada para garantir reprodutibilidade.</p> <p>Todos os resultados apresentados nesta subseção são baseados na implementação original e foram extraídos da minha dissertação de mestrado. Na época, o algoritmo foi implementado em Matlab <span class=arithmatex>\(2018\)</span>a, executado em um Dell Inspiron <span class=arithmatex>\(5448\)</span> Core i<span class=arithmatex>\(5-5200\)</span>U CPU <span class=arithmatex>\(2.20\)</span>GHz com <span class=arithmatex>\(12\)</span>GB de RAM. No entanto, não é difícil adaptar o código para o SysIdentPy.</p> <p>Seguindo os estudos mencionados, escolhemos lags máximos <span class=arithmatex>\(n_u=n_y=4\)</span> para entrada e saída e grau de não linearidade <span class=arithmatex>\(\ell = 3\)</span>. Os parâmetros relacionados ao BPSOGSA são detalhados na Tabela 8.</p> <table> <thead> <tr> <th>Parameters</th> <th><span class=arithmatex>\(n_u\)</span></th> <th><span class=arithmatex>\(n_y\)</span></th> <th><span class=arithmatex>\(\ell\)</span></th> <th>p-value</th> <th>max_iter</th> <th>n_agents</th> <th><span class=arithmatex>\(\alpha\)</span></th> <th><span class=arithmatex>\(G_0\)</span></th> </tr> </thead> <tbody> <tr> <td>Values</td> <td><span class=arithmatex>\(4\)</span></td> <td><span class=arithmatex>\(4\)</span></td> <td><span class=arithmatex>\(3\)</span></td> <td><span class=arithmatex>\(0.05\)</span></td> <td><span class=arithmatex>\(30\)</span></td> <td><span class=arithmatex>\(10\)</span></td> <td><span class=arithmatex>\(23\)</span></td> <td><span class=arithmatex>\(100\)</span></td> </tr> <tr> <td>&gt;Table 8. Parâmetros usados no MetaMSS</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>Foram realizadas 300 execuções do algoritmo MetaMSS para cada modelo, com o objetivo de comparar estatísticas sobre o desempenho do método. O tempo de execução (elapsed time) e a taxa de acerto (correctness), isto é, a porcentagem de vezes em que a estrutura correta foi selecionada, foram analisados.</p> <p>Os resultados na Tabela 9 foram obtidos com os parâmetros configurados de acordo com a Tabela 8.</p> <table> <thead> <tr> <th></th> <th><span class=arithmatex>\(S_1\)</span></th> <th><span class=arithmatex>\(S_2\)</span></th> <th><span class=arithmatex>\(S_3\)</span></th> <th><span class=arithmatex>\(S_4\)</span></th> <th><span class=arithmatex>\(S_5\)</span></th> <th><span class=arithmatex>\(S_6\)</span></th> </tr> </thead> <tbody> <tr> <td>Correct model</td> <td>100\%</td> <td>100\%</td> <td>100\%</td> <td>100\%</td> <td>100\%</td> <td>100\%</td> </tr> <tr> <td>Elapsed time (mean)</td> <td>5.16s</td> <td>3.90s</td> <td>3.40s</td> <td>2.37s</td> <td>1.40s</td> <td>3.80s</td> </tr> <tr> <td>&gt;Table 9. Desempenho geral do MetaMSS</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>A Tabela 9 mostra que todos os termos dos modelos foram corretamente selecionados usando o MetaMSS. Vale destacar que até mesmo o modelo <span class=arithmatex>\(S_5\)</span>, que possui ruído autoregressivo, foi corretamente identificado pelo algoritmo. Esse resultado se deve ao fato de que todos os regressores são avaliados individualmente, e aqueles considerados redundantes são removidos do modelo.</p> <p>A Figura 15 apresenta a convergência de cada execução do MetaMSS. Observa‑se que a maioria das execuções converge para a estrutura correta com 10 ou menos iterações. Isso está relacionado ao número máximo de iterações e ao número de agentes de busca. O primeiro parâmetro influencia diretamente os coeficientes de aceleração do algoritmo, que reforçam a fase de exploração, enquanto o segundo aumenta o número de modelos candidatos avaliados. Intuitivamente, ambos influenciam o tempo de execução e, ainda mais importante, a estrutura de modelo selecionada como solução final. Assim, escolhas inadequadas desses parâmetros podem levar à seleção de modelos sub ou superparametrizados, uma vez que o algoritmo pode convergir para um ótimo local. A subseção a seguir apresenta uma análise da influência de <code>max_iter</code> e <code>n_agents</code> no desempenho do algoritmo.</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/metamss_convergence.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/metamss_convergence.png?raw=true"></a></p> <blockquote> <p>Figura 15. Convergência do MetaMSS para diferentes estruturas de modelo. Cada curva representa a trajetória de convergência do algoritmo para uma estrutura específica, de <span class=arithmatex>\(S_1\)</span> a <span class=arithmatex>\(S_6\)</span>, ao longo de, no máximo, 30 iterações.</p> </blockquote> <h4 id=influencia-dos-parametros-max_iter-e-n_agents>Influência dos parâmetros <span class=arithmatex>\(max\_iter\)</span> e <span class=arithmatex>\(n\_agents\)</span><a class=headerlink href=#influencia-dos-parametros-max_iter-e-n_agents title="Permanent link">&para;</a></h4> <p>Os modelos simulados são usados para avaliar o desempenho do MetaMSS considerando diferentes configurações para <code>max_iter</code> e <code>n_agents</code>. Primeiro, fixamos <code>max_iter=30</code> e variamos <code>n_agents</code>. Em seguida, fixamos <code>n_agents</code> e variamos <code>max_iter</code>. Os resultados apresentados nesta subseção foram obtidos com os demais parâmetros configurados conforme a Tabela 8.</p> <table> <thead> <tr> <th></th> <th></th> <th><span class=arithmatex>\(S_1\)</span></th> <th><span class=arithmatex>\(S_2\)</span></th> <th><span class=arithmatex>\(S_3\)</span></th> <th><span class=arithmatex>\(S_4\)</span></th> <th><span class=arithmatex>\(S_5\)</span></th> <th><span class=arithmatex>\(S_6\)</span></th> </tr> </thead> <tbody> <tr> <td><strong>max_iter = 30, n_agents = 1</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(65\%\)</span></td> <td><span class=arithmatex>\(55.66\%\)</span></td> <td><span class=arithmatex>\(14\%\)</span></td> <td><span class=arithmatex>\(14\%\)</span></td> <td><span class=arithmatex>\(7.3\%\)</span></td> <td><span class=arithmatex>\(20.66\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(0.26\)</span>s</td> <td><span class=arithmatex>\(0.19\)</span>s</td> <td><span class=arithmatex>\(0.15\)</span>s</td> <td><span class=arithmatex>\(0.11\)</span>s</td> <td><span class=arithmatex>\(0.13\)</span>s</td> <td><span class=arithmatex>\(0.13\)</span>s</td> </tr> <tr> <td><strong>max_iter = 30, n_agents = 5</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(99\%\)</span></td> <td><span class=arithmatex>\(98\%\)</span></td> <td><span class=arithmatex>\(91.66\%\)</span></td> <td><span class=arithmatex>\(98.33\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(2.08\)</span>s</td> <td><span class=arithmatex>\(1.51\)</span>s</td> <td><span class=arithmatex>\(1.41\)</span>s</td> <td><span class=arithmatex>\(0.99\)</span>s</td> <td><span class=arithmatex>\(0.59\)</span>s</td> <td><span class=arithmatex>\(1.13\)</span>s</td> </tr> <tr> <td><strong>max_iter = 30, n_agents = 20</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(12.88\)</span>s</td> <td><span class=arithmatex>\(9.10\)</span>s</td> <td><span class=arithmatex>\(8.77\)</span>s</td> <td><span class=arithmatex>\(5.70\)</span>s</td> <td><span class=arithmatex>\(3.37\)</span>s</td> <td><span class=arithmatex>\(9.50\)</span>s</td> </tr> <tr> <td><strong>max_iter = 5, n_agents = 10</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(96.33\%\)</span></td> <td><span class=arithmatex>\(99\%\)</span></td> <td><span class=arithmatex>\(86\%\)</span></td> <td><span class=arithmatex>\(93.66\%\)</span></td> <td><span class=arithmatex>\(93\%\)</span></td> <td><span class=arithmatex>\(97.33\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(0.92\)</span>s</td> <td><span class=arithmatex>\(0.73\)</span>s</td> <td><span class=arithmatex>\(0.72\)</span>s</td> <td><span class=arithmatex>\(0.52\)</span>s</td> <td><span class=arithmatex>\(0.29\)</span>s</td> <td><span class=arithmatex>\(0.64\)</span>s</td> </tr> <tr> <td><strong>max_iter = 15, n_agents = 10</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(99\%\)</span></td> <td><span class=arithmatex>\(99\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(2.80\)</span>s</td> <td><span class=arithmatex>\(2.33\)</span>s</td> <td><span class=arithmatex>\(2.25\)</span>s</td> <td><span class=arithmatex>\(1.60\)</span>s</td> <td><span class=arithmatex>\(0.90\)</span>s</td> <td><span class=arithmatex>\(2.30\)</span>s</td> </tr> <tr> <td><strong>max_iter = 50, n_agents = 10</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(7.38\)</span>s</td> <td><span class=arithmatex>\(5.44\)</span>s</td> <td><span class=arithmatex>\(4.56\)</span>s</td> <td><span class=arithmatex>\(3.01\)</span>s</td> <td><span class=arithmatex>\(2.10\)</span>s</td> <td><span class=arithmatex>\(4.52\)</span>s</td> </tr> <tr> <td>&gt;Table 10.</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>Os resultados agregados da Tabela 10 confirmam o comportamento esperado em relação ao tempo de execução e à taxa de acerto. Ambos aumentam significativamente à medida que o número de agentes e o número máximo de iterações crescem. O número de agentes é particularmente relevante, pois amplia a capacidade de exploração do espaço de busca. Todos os sistemas são impactados pelo aumento no número de agentes e no máximo de iterações.</p> <p>Observando todos os sistemas testados, fica claro que uma exploração mais ampla tem impacto significativo na exatidão da seleção de modelos. Quando poucos agentes são utilizados, o desempenho do MetaMSS se deteriora de forma importante, especialmente para os sistemas <span class=arithmatex>\(S_3\)</span>, <span class=arithmatex>\(S_4\)</span> e <span class=arithmatex>\(S_5\)</span>. O número máximo de iterações, por sua vez, permite que os agentes explorem, de forma global e local, regiões em torno dos modelos candidatos já testados. Assim, quanto maior o número de iterações, mais o algoritmo pode explorar o espaço e examinar diferentes conjuntos de regressores.</p> <p>Se esses parâmetros forem escolhidos de forma inadequada, o algoritmo pode não ser capaz de encontrar a estrutura ideal. Nesse sentido, os resultados apresentados aqui se referem apenas aos sistemas analisados. Quanto maior o espaço de busca, maior precisará ser o número de agentes e o número de iterações. Embora o esforço computacional aumente com valores grandes de <code>n_agents</code> e <code>max_iteration</code>, o algoritmo permanece bastante eficiente em termos de tempo de execução para todas as configurações que garantem a seleção das estruturas verdadeiras.</p> <h4 id=selecao-de-modelos-super-e-subparametrizados>Seleção de modelos super e sub‑parametrizados<a class=headerlink href=#selecao-de-modelos-super-e-subparametrizados title="Permanent link">&para;</a></h4> <p>Mesmo diante do sucesso na seleção das estruturas de todos os modelos pelo MetaMSS, é natural perguntar como os modelos selecionados diferem do modelo verdadeiro nos casos apresentados na Tabela 10 em que o algoritmo não garantiu 100\% de acerto. A Figura 16 ilustra a distribuição do número de termos selecionados em cada caso. É evidente que o número de modelos superparametrizados é, em geral, maior do que o de modelos subparametrizados. Nos casos em que o número de agentes é baixo, devido à baixa capacidade de exploração e explotação, o algoritmo tende a convergir prematuramente, resultando em modelos com muitos regressores espúrios. Em particular, para <span class=arithmatex>\(S_2\)</span> e <span class=arithmatex>\(S_5\)</span> com <code>n_agents=1</code>, o algoritmo selecionou modelos com mais de 20 termos. Pode‑se argumentar que esse é um cenário extremo usado apenas para fins de comparação, mas a escolha adequada dos parâmetros está intrinsecamente ligada à dimensão do espaço de busca. Para casos com <code>n_agents</code><span class=arithmatex>\(\geq 5\)</span>, por exemplo, o número de termos espúrios diminui significativamente quando o algoritmo não consegue selecionar o modelo verdadeiro.</p> <p>Além disso, é importante destacar a relevância de uma boa calibração dos parâmetros, já que as fases de exploração e explotação dependem fortemente deles. Uma convergência prematura pode levar à seleção de modelos com o número correto de termos, mas com regressores errados. Isso aconteceu em todos os casos com <code>n_agents=1</code>. Por exemplo, para <span class=arithmatex>\(S_3\)</span>, o algoritmo produziu modelos com o número correto de termos em 33.33\% das execuções, mas a Tabela 10 mostra que apenas 14\% desses modelos são, de fato, equivalentes à estrutura verdadeira.</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/metamss_terms_distribution.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/metamss_terms_distribution.png?raw=true"></a></p> <blockquote> <p>Figura 16. Distribuição do número de termos selecionados em cada modelo simulado, considerando diferentes configurações de <code>max_iter</code> e <code>n_agents</code>.</p> </blockquote> <p>Os sistemas <span class=arithmatex>\(S_1\)</span>, <span class=arithmatex>\(S_2\)</span>, <span class=arithmatex>\(S_3\)</span>, <span class=arithmatex>\(S_4\)</span> e <span class=arithmatex>\(S_6\)</span> foram utilizados como benchmark por <a href=https://www.tandfonline.com/doi/abs/10.1080/00207721.2016.1244309>Bianchi, F., Falsone, A., Prandini, M. and Piroddi, L.</a>, o que permite comparar diretamente nossos resultados com aqueles reportados na literatura. Todas as técnicas utilizaram <span class=arithmatex>\(n_y=n_u=4\)</span> e <span class=arithmatex>\(\ell = 3\)</span>. O RaMSS e o RaMSS com Conditional Linear Family (C-RaMSS) foram configurados com: <span class=arithmatex>\(K=1\)</span>, <span class=arithmatex>\(\alpha = 0.997\)</span>, <span class=arithmatex>\(NP = 200\)</span> e <span class=arithmatex>\(v=0.1\)</span>. O MetaMSS foi ajustado conforme os parâmetros indicados na Tabela 8.</p> <table> <thead> <tr> <th></th> <th></th> <th><span class=arithmatex>\(S_1\)</span></th> <th><span class=arithmatex>\(S_2\)</span></th> <th><span class=arithmatex>\(S_3\)</span></th> <th><span class=arithmatex>\(S_4\)</span></th> <th><span class=arithmatex>\(S_6\)</span></th> </tr> </thead> <tbody> <tr> <td><strong>Meta-MSS</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(5.16\)</span>s</td> <td><span class=arithmatex>\(3.90\)</span>s</td> <td><span class=arithmatex>\(3.40\)</span>s</td> <td><span class=arithmatex>\(2.37\)</span>s</td> <td><span class=arithmatex>\(3.80\)</span>s</td> </tr> <tr> <td><strong>RaMSS- <span class=arithmatex>\(NP=100\)</span></strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(90.33\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(66\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(3.27\)</span>s</td> <td><span class=arithmatex>\(1.24\)</span>s</td> <td><span class=arithmatex>\(2.59\)</span>s</td> <td><span class=arithmatex>\(1.67\)</span>s</td> <td><span class=arithmatex>\(6.66\)</span>s</td> </tr> <tr> <td><strong>RaMSS- <span class=arithmatex>\(NP=200\)</span></strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(78.33\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(82\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(6.25\)</span>s</td> <td><span class=arithmatex>\(2.07\)</span>s</td> <td><span class=arithmatex>\(4.42\)</span>s</td> <td><span class=arithmatex>\(2.77\)</span>s</td> <td><span class=arithmatex>\(9.16\)</span>s</td> </tr> <tr> <td><strong>C-RaMSS</strong></td> <td><strong>Correct model</strong></td> <td><span class=arithmatex>\(93.33\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> <td><span class=arithmatex>\(100\%\)</span></td> </tr> <tr> <td></td> <td><strong>Elapsed time (mean)</strong></td> <td><span class=arithmatex>\(18\)</span>s</td> <td><span class=arithmatex>\(10.50\)</span>s</td> <td><span class=arithmatex>\(16.96\)</span>s</td> <td><span class=arithmatex>\(10.56\)</span>s</td> <td><span class=arithmatex>\(48.52\)</span>s</td> </tr> <tr> <td>&gt; Table 11. Análise comparativa entre MetaMSS, RaMSS e C-RaMSS</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>Em termos de taxa de acerto, o MetaMSS supera (ou pelo menos iguala) o RaMSS e o C-RaMSS para todos os sistemas analisados, como mostrado na Tabela 11. Para o sistema <span class=arithmatex>\(S_6\)</span>, por exemplo, a taxa de acerto aumenta em 18\% em relação ao RaMSS, enquanto o tempo de execução necessário para que o C-RaMSS atinja 100\% de acerto é 1276.84\% maior do que o do MetaMSS. Além disso, o MetaMSS é visivelmente mais eficiente do que o C-RaMSS e possui desempenho computacional semelhante ao RaMSS.</p> <h4 id=metamss-vs-frols>MetaMSS vs FROLS<a class=headerlink href=#metamss-vs-frols title="Permanent link">&para;</a></h4> <p>O algoritmo FROLS foi aplicado a todos os sistemas testados, com os resultados resumidos na Tabela 12. O método foi capaz de selecionar corretamente a estrutura para <span class=arithmatex>\(S_2\)</span> e <span class=arithmatex>\(S_6\)</span>. No entanto, falhou em identificar dois dos quatro regressores de <span class=arithmatex>\(S_1\)</span>. Para <span class=arithmatex>\(S_3\)</span>, o FROLS incluiu <span class=arithmatex>\(y_{k-1}\)</span> no lugar do termo correto <span class=arithmatex>\(y_{k-1}^3\)</span>. De forma semelhante, em <span class=arithmatex>\(S_4\)</span>, o termo <span class=arithmatex>\(y_{k-4}\)</span> foi selecionado em vez de <span class=arithmatex>\(y_{k-2}\)</span>. Para <span class=arithmatex>\(S_5\)</span>, o algoritmo resultou em uma estrutura incorreta ao incluir o termo espúrio <span class=arithmatex>\(y_{k-4}\)</span>.</p> <table> <thead> <tr> <th></th> <th>Meta-MSS Regressor</th> <th>Correct</th> <th>FROLS Regressor</th> <th>Correct</th> </tr> </thead> <tbody> <tr> <td><strong><span class=arithmatex>\(S_1\)</span></strong></td> <td><span class=arithmatex>\(y_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-4}\)</span></td> <td>no</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-4}\)</span></td> <td>no</td> </tr> <tr> <td><strong><span class=arithmatex>\(S_2\)</span></strong></td> <td><span class=arithmatex>\(y_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-1}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-1}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-1}^3\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-1}^3\)</span></td> <td>yes</td> </tr> <tr> <td><strong><span class=arithmatex>\(S_3\)</span></strong></td> <td><span class=arithmatex>\(y_{k-1}^3\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}\)</span></td> <td>no</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> </tr> <tr> <td><strong><span class=arithmatex>\(S_4\)</span></strong></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-4}\)</span></td> <td>no</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td><strong><span class=arithmatex>\(S_5\)</span></strong></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-4}\)</span></td> <td>no</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td><strong><span class=arithmatex>\(S_6\)</span></strong></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td>&gt; Table 12. Análise comparativa entre MetaMSS e FROLS</td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <h4 id=meta-mss-vs-rjmcmc>Meta-MSS vs RJMCMC<a class=headerlink href=#meta-mss-vs-rjmcmc title="Permanent link">&para;</a></h4> <p>O modelo <span class=arithmatex>\(S_4\)</span> foi tomado do trabalho de Baldacchino, Anderson e Kadirkamanathan (<a href=https://www.sciencedirect.com/science/article/abs/pii/S0005109813003063>Computational System Identification for Bayesian NARMAX Modelling</a>). No estudo, os lags máximos são <span class=arithmatex>\(n_y = n_u = 4\)</span> e o grau de não linearidade é <span class=arithmatex>\(\ell = 3\)</span>. Os autores executaram o algoritmo RJMCMC 10 vezes sobre os mesmos dados de entrada e saída. O método RJMCMC identificou a estrutura verdadeira 7 de 10 vezes. Em contraste, o algoritmo MetaMSS identificou a estrutura correta em todas as execuções. Esses resultados são resumidos na Tabela 13.</p> <p>Além disso, o RJMCMC apresenta algumas desvantagens que são mitigadas pelo MetaMSS. Em particular, o RJMCMC é computacionalmente intensivo, exigindo 30.000 iterações para obter os resultados. Ademais, ele depende de diversas distribuições de probabilidade para simplificar o processo de estimação de parâmetros, o que torna as contas mais complexas. Já o MetaMSS oferece uma abordagem mais simples e eficiente, evitando esses problemas.</p> <table> <thead> <tr> <th></th> <th>Meta-MSS Model</th> <th>Correct</th> <th>RJMCMC Model 1 (<span class=arithmatex>\(7\times\)</span>)</th> <th>RJMCMC Model 2</th> <th>RJMCMC Model 3</th> <th>RJMCMC Model 4</th> <th>Correct</th> </tr> </thead> <tbody> <tr> <td><strong><span class=arithmatex>\(S_4\)</span></strong></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td><span class=arithmatex>\(y_{k-1}x_{k-1}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td><span class=arithmatex>\(y_{k-2}\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td><span class=arithmatex>\(x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td><span class=arithmatex>\(y_{k-2}x_{k-2}^2\)</span></td> <td>yes</td> </tr> <tr> <td></td> <td>-</td> <td>-</td> <td>-</td> <td><span class=arithmatex>\(y_{k-3}x_{k-3}\)</span></td> <td><span class=arithmatex>\(x_{k-4}^2\)</span></td> <td><span class=arithmatex>\(x_{k-1}x_{k-3}^2\)</span></td> <td>no</td> </tr> <tr> <td>&gt; Table 13. Análise comparativa entre MetaMSS e RJMCMC.</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <h3 id=metamss-usando-sysidentpy>MetaMSS usando SysIdentPy<a class=headerlink href=#metamss-usando-sysidentpy title="Permanent link">&para;</a></h3> <p>Considere agora os mesmos dados utilizados na subseção Overview of the Information Criteria Methods.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>MetaMSS</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=n>model</span> <span class=o>=</span> <span class=n>MetaMSS</span><span class=p>(</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=p>)</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a>    <span class=p>),</span>
<a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a><span class=p>)</span>
<a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
</code></pre></div> <p>O algoritmo MetaMSS não depende de critérios de informação como ERR para seleção de estrutura de modelo e, por isso, não utiliza esses hiperparâmetros. O mesmo vale para os algoritmos AOLS e ER. Para mais detalhes sobre o uso desses métodos e seus hiperparâmetros, consulte a documentação.</p> <p>No que diz respeito à estimação de parâmetros, o SysIdentPy permite empregar qualquer método disponível, independentemente do algoritmo de seleção de estrutura utilizado. Ou seja, o usuário pode combinar métodos de estrutura (FROLS, AOLS, ER, MetaMSS, etc.) com diferentes estimadores de parâmetros. Essa flexibilidade permite explorar diversas abordagens de modelagem e personalizar o processo de identificação. Embora os exemplos fornecidos utilizem o método de estimação padrão, o usuário é encorajado a testar outras opções para encontrar a melhor solução para o seu problema.</p> <p>Os resultados do MetaMSS são</p> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>y(k-1)</td> <td>1.8004E-01</td> <td>0.00000000E+00</td> </tr> <tr> <td>x1(k-2)</td> <td>8.9747E-01</td> <td>0.00000000E+00</td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/metamss_result_c4_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/metamss_result_c4_example.png?raw=true"></a></p> <blockquote> <p>Figura 17. Simulação em regime livre para o modelo ajustado utilizando MetaMSS.</p> </blockquote> <p>O método <code>results</code> retorna ERR igual a 0 para todos os regressores porque, como mencionado, o algoritmo ERR não é executado neste caso.</p> <h2 id=accelerated-orthogonal-least-squares-aols-e-entropic-regression-er>Accelerated Orthogonal Least Squares (AOLS) e Entropic Regression (ER)<a class=headerlink href=#accelerated-orthogonal-least-squares-aols-e-entropic-regression-er title="Permanent link">&para;</a></h2> <p>Além de FROLS e MetaMSS, o SysIdentPy inclui outros dois métodos para seleção de estrutura de modelo: Accelerated Orthogonal Least Squares (AOLS) e Entropic Regression (ER). Nesta seção não entraremos em detalhes sobre os métodos, como fizemos com FROLS e MetaMSS, mas apresentaremos uma visão geral e referências para leitura adicional:</p> <ul> <li><strong>Accelerated Orthogonal Least Squares (AOLS):</strong> para uma discussão detalhada sobre AOLS, ver o artigo original <a href=https://www.sciencedirect.com/science/article/abs/pii/S1051200418305311>aqui</a>.</li> <li><strong>Entropic Regression (ER):</strong> detalhes sobre ER podem ser encontrados no artigo original <a href=https://arxiv.org/pdf/1905.08061>aqui</a>.</li> </ul> <p>A seguir, mostramos como utilizar esses métodos no SysIdentPy.</p> <h3 id=accelerated-orthogonal-least-squares>Accelerated Orthogonal Least Squares<a class=headerlink href=#accelerated-orthogonal-least-squares title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>AOLS</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=n>model</span> <span class=o>=</span> <span class=n>AOLS</span><span class=p>(</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=p>)</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a>    <span class=p>),</span>
<a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=p>)</span>
<a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>x1(k-2)</td> <td>9.1542E-01</td> <td>0.00000000E+00</td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/aols_example_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/aols_example_c4.png?raw=true"></a></p> <blockquote> <p>Figura 18. Simulação em regime livre para o modelo ajustado com AOLS.</p> </blockquote> <h3 id=entropic-regression>Entropic Regression<a class=headerlink href=#entropic-regression title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>ER</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=n>model</span> <span class=o>=</span> <span class=n>ER</span><span class=p>(</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=p>)</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span>
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>        <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span>
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>        <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span>
<a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a>        <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
<a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>        <span class=n>dtype</span><span class=o>=</span><span class=s2>&quot;sci&quot;</span><span class=p>,</span>
<a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>    <span class=p>),</span>
<a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Regressors&quot;</span><span class=p>,</span> <span class=s2>&quot;Parameters&quot;</span><span class=p>,</span> <span class=s2>&quot;ERR&quot;</span><span class=p>],</span>
<a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a><span class=p>)</span>
<a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>
<a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a><span class=n>plot_results</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=o>=</span><span class=n>yhat</span><span class=p>,</span> <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
</code></pre></div> <table> <thead> <tr> <th>Regressors</th> <th>Parameters</th> <th>ERR</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>-2.4554E-02</td> <td>0.00000000E+00</td> </tr> <tr> <td>x1(k-2)</td> <td>9.0273E-01</td> <td>0.00000000E+00</td> </tr> </tbody> </table> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/er_example_c4.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/er_example_c4.png?raw=true"></a></p> <blockquote> <p>Figura 19. Simulação em regime livre para o modelo ajustado com Entropic Regression.</p> </blockquote> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Voltar ao topo </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Rodapé> <a href=../3-Parameter-Estimation/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: 3. Estimação de Parâmetros"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Anterior </span> <div class=md-ellipsis> 3. Estimação de Parâmetros </div> </div> </a> <a href=../5-Multiobjective-Parameter-Estimation/ class="md-footer__link md-footer__link--next" aria-label="Próximo: 5. Estimação de Parâmetros Multiobjetivo"> <div class=md-footer__title> <span class=md-footer__direction> Próximo </span> <div class=md-ellipsis> 5. Estimação de Parâmetros Multiobjetivo </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2016 - 2025 Wilson Rocha </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/wilsonrljr target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/sysidentpy/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> <a href=https://twitter.com/wilsonrljr target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}}</script> <script src=../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../../overrides/assets/js/katex.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js></script> <script src=../../../overrides/assets/vendor/js/prism.js></script> <script src=https://cdn.jsdelivr.net/npm/apexcharts></script> <script src=../../../overrides/assets/js/chart-example.js></script> <script src=../../../overrides/assets/js/scripts.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>