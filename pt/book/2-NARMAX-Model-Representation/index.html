<!doctype html><html lang=pt class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="De Métodos Clássicos a Redes Neurais"><meta name=author content="Wilson Rocha"><link href=https://sysidentpy.org/pt/book/2-NARMAX-Model-Representation/ rel=canonical><link href=../1-Introduction/ rel=prev><link href=../3-Parameter-Estimation/ rel=next><link rel=icon href=../../../en/assets/img/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.6"><title>2. Representação do Modelo NARMAX - SysIdentPy</title><link rel=stylesheet href=../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../overrides/assets/css/extra.css><link rel=stylesheet href=../../../overrides/assets/css/feature-grid.css><link rel=stylesheet href=../../../overrides/assets/css/fontsize.css><link rel=stylesheet href=../../../overrides/assets/css/card-container.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css><link rel=stylesheet href=../../../overrides/assets/vendor/css/prism.css><link rel=stylesheet href=../../../overrides/assets/css/style.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-16K3SQT164"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-16K3SQT164",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-16K3SQT164",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#funcoes-base-basis-function class=md-skip> Ir para o conteúdo </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabeçalho> <a href=../../ title=SysIdentPy class="md-header__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SysIdentPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 2. Representação do Modelo NARMAX </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label="Selecione o idioma"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=../../../book/2-NARMAX-Model-Representation/ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=./ hreflang=pt class=md-select__link> Português (Brasil) </a> </li> <li class=md-select__item> <a href=../../../es/book/2-NARMAX-Model-Representation/ hreflang=es class=md-select__link> Español </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Buscar placeholder=Buscar autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Pesquisar> <a href=javascript:void(0) class="md-search__icon md-icon" title=Compartilhar aria-label=Compartilhar data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Limpar aria-label=Limpar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando a pesquisa </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Abas data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../ class=md-tabs__link> Início </a> </li> <li class=md-tabs__item> <a href=../../getting-started/getting-started/ class=md-tabs__link> Primeiros Passos </a> </li> <li class=md-tabs__item> <a href=../../user-guide/overview/ class=md-tabs__link> Guia </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../0-Preface/ class=md-tabs__link> Livro </a> </li> <li class=md-tabs__item> <a href=../../developer-guide/contribute/ class=md-tabs__link> Contribuir </a> </li> <li class=md-tabs__item> <a href=../../community-support/community-overview/ class=md-tabs__link> Comunidade </a> </li> <li class=md-tabs__item> <a href=../../landing-page/about-us/ class=md-tabs__link> Sobre </a> </li> <li class=md-tabs__item> <a href=../../changelog/changelog/ class=md-tabs__link> Changelog </a> </li> <li class=md-tabs__item> <a href=../../landing-page/sponsor/ class=md-tabs__link> Apoie </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navegação data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../ title=SysIdentPy class="md-nav__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> SysIdentPy </label> <div class=md-nav__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> <span class=md-ellipsis> Início </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Primeiros Passos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Primeiros Passos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/getting-started/ class=md-nav__link> <span class=md-ellipsis> Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart-guide/ class=md-nav__link> <span class=md-ellipsis> Guia Rápido </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/narmax-intro/ class=md-nav__link> <span class=md-ellipsis> Introdução ao NARMAX </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> Licença </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Guia </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Guia </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/overview/ class=md-nav__link> <span class=md-ellipsis> Visão Geral </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Tutoriais </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Tutoriais </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_1> <label class=md-nav__link for=__nav_3_2_1 id=__nav_3_2_1_label tabindex=0> <span class=md-ellipsis> Funcionalidades </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Funcionalidades </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/your-first-model/ class=md-nav__link> <span class=md-ellipsis> Seu Primeiro Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/model-with-multiple-inputs/ class=md-nav__link> <span class=md-ellipsis> Modelo com Múltiplas Entradas </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Estimação de Parâmetros - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/basis-function-overview/ class=md-nav__link> <span class=md-ellipsis> Funções Base - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/information-criteria-overview/ class=md-nav__link> <span class=md-ellipsis> Critérios de Informação - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/general-NARX-models/ class=md-nav__link> <span class=md-ellipsis> Modelos NARX Gerais - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/fourier-NARX-overview/ class=md-nav__link> <span class=md-ellipsis> Fourier NARX - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/aols-overview/ class=md-nav__link> <span class=md-ellipsis> AOLS - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/NFIR-model-overview/ class=md-nav__link> <span class=md-ellipsis> NFIR - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/importance-of-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Importância do Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2 id=__nav_3_2_2_label tabindex=0> <span class=md-ellipsis> Sistemas Elétricos e Mecânicos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Sistemas Elétricos e Mecânicos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/modeling-a-magneto-rheological-damper-device/ class=md-nav__link> <span class=md-ellipsis> Modelagem de um Dispositivo Amortecedor Magneto-Reológico </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/silver-box-system/ class=md-nav__link> <span class=md-ellipsis> Sistema Silver Box </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/coupled-eletric-device/ class=md-nav__link> <span class=md-ellipsis> Dispositivo Elétrico Acoplado </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/wiener-hammerstein-system/ class=md-nav__link> <span class=md-ellipsis> Sistema Wiener-Hammerstein </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/f-16-aircraft/ class=md-nav__link> <span class=md-ellipsis> Aeronave F-16 </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/f-16-aircraft-n-steps-ahead-prediction/ class=md-nav__link> <span class=md-ellipsis> Aeronave F-16 - Previsão N Passos à Frente </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-overview/ class=md-nav__link> <span class=md-ellipsis> Identificação de Sistema Eletromecânico - Visão Geral </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-metamss/ class=md-nav__link> <span class=md-ellipsis> Identificação de Sistema Eletromecânico - MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/electromechanical-system-identification-entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Identificação de Sistema Eletromecânico - Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/multiobjective-parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Estimação de Parâmetros Multiobjetivo - Visão Geral </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3 id=__nav_3_2_3_label tabindex=0> <span class=md-ellipsis> Industriais e Corporativos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Industriais e Corporativos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/m4-benchmark/ class=md-nav__link> <span class=md-ellipsis> M4 Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/air-passenger-benchmark/ class=md-nav__link> <span class=md-ellipsis> Air Passenger Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/load-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Previsão de Carga - Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/PV-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Previsão Fotovoltaica - Benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4 id=__nav_3_2_4_label tabindex=0> <span class=md-ellipsis> Sistemas Caóticos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Sistemas Caóticos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/tutorials/chaotic-systems/lorenz-system/ class=md-nav__link> <span class=md-ellipsis> Sistema de Lorenz </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tutorials/chaotic-systems/logistic-map/ class=md-nav__link> <span class=md-ellipsis> Mapa Logístico </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Como fazer </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Como fazer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/how-to/create-custom-basis-function/ class=md-nav__link> <span class=md-ellipsis> Criar uma Função Base Customizada </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/create-a-narx-neural-network/ class=md-nav__link> <span class=md-ellipsis> Criar uma Rede Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/save-and-load-models/ class=md-nav__link> <span class=md-ellipsis> Salvar e Carregar Modelos </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/set-specific-lags/ class=md-nav__link> <span class=md-ellipsis> Definir Lags Específicos </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/simulating-existing-models/ class=md-nav__link> <span class=md-ellipsis> Simular Modelos Existentes </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/how-to/use-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Usar Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/API/narmax-base/ class=md-nav__link> <span class=md-ellipsis> NARMAX Base </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/ofr-base/ class=md-nav__link> <span class=md-ellipsis> OFR Base </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/basis-function/ class=md-nav__link> <span class=md-ellipsis> Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/frols/ class=md-nav__link> <span class=md-ellipsis> FROLS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metamss/ class=md-nav__link> <span class=md-ellipsis> MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/aols/ class=md-nav__link> <span class=md-ellipsis> AOLS </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/uofr/ class=md-nav__link> <span class=md-ellipsis> UOFR </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/neural-narx/ class=md-nav__link> <span class=md-ellipsis> Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/general-estimators/ class=md-nav__link> <span class=md-ellipsis> General Estimators </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/multiobjective-parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/simulation/ class=md-nav__link> <span class=md-ellipsis> Simulation </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/residues/ class=md-nav__link> <span class=md-ellipsis> Residual Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metaheuristics/ class=md-nav__link> <span class=md-ellipsis> Metaheuristics </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/API/utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Livro </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Livro </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../0-Preface/ class=md-nav__link> <span class=md-ellipsis> Prefácio </span> </a> </li> <li class=md-nav__item> <a href=../0.1-Contents/ class=md-nav__link> <span class=md-ellipsis> Sumário </span> </a> </li> <li class=md-nav__item> <a href=../1-Introduction/ class=md-nav__link> <span class=md-ellipsis> Introdução </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 2. Representação do Modelo NARMAX </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 2. Representação do Modelo NARMAX </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#funcoes-base-basis-function class=md-nav__link> <span class=md-ellipsis> Funções Base (Basis Function) </span> </a> <nav class=md-nav aria-label="Funções Base (Basis Function)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#exemplo-matriz-de-vandermonde class=md-nav__link> <span class=md-ellipsis> Exemplo: Matriz de Vandermonde </span> </a> </li> <li class=md-nav__item> <a href=#exemplo-funcoes-base-retangulares class=md-nav__link> <span class=md-ellipsis> Exemplo: Funções Base Retangulares </span> </a> </li> <li class=md-nav__item> <a href=#exemplo-funcoes-base-triangulares class=md-nav__link> <span class=md-ellipsis> Exemplo: Funções Base Triangulares </span> </a> </li> <li class=md-nav__item> <a href=#exemplo-radial-basis-function-rbf-gaussiana class=md-nav__link> <span class=md-ellipsis> Exemplo: Radial Basis Function (RBF) - Gaussiana </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#modelos-lineares class=md-nav__link> <span class=md-ellipsis> Modelos Lineares </span> </a> <nav class=md-nav aria-label="Modelos Lineares"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#armax class=md-nav__link> <span class=md-ellipsis> ARMAX </span> </a> </li> <li class=md-nav__item> <a href=#arx class=md-nav__link> <span class=md-ellipsis> ARX </span> </a> </li> <li class=md-nav__item> <a href=#arma class=md-nav__link> <span class=md-ellipsis> ARMA </span> </a> </li> <li class=md-nav__item> <a href=#ar class=md-nav__link> <span class=md-ellipsis> AR </span> </a> </li> <li class=md-nav__item> <a href=#fir class=md-nav__link> <span class=md-ellipsis> FIR </span> </a> </li> <li class=md-nav__item> <a href=#outras-variantes class=md-nav__link> <span class=md-ellipsis> Outras Variantes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#modelos-nao-lineares class=md-nav__link> <span class=md-ellipsis> Modelos Não Lineares </span> </a> <nav class=md-nav aria-label="Modelos Não Lineares"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#narmax class=md-nav__link> <span class=md-ellipsis> NARMAX </span> </a> </li> <li class=md-nav__item> <a href=#narx class=md-nav__link> <span class=md-ellipsis> NARX </span> </a> </li> <li class=md-nav__item> <a href=#narma class=md-nav__link> <span class=md-ellipsis> NARMA </span> </a> </li> <li class=md-nav__item> <a href=#nar class=md-nav__link> <span class=md-ellipsis> NAR </span> </a> </li> <li class=md-nav__item> <a href=#nfir class=md-nav__link> <span class=md-ellipsis> NFIR </span> </a> </li> <li class=md-nav__item> <a href=#modelos-narmax-mistos class=md-nav__link> <span class=md-ellipsis> Modelos NARMAX Mistos </span> </a> </li> <li class=md-nav__item> <a href=#rede-neural-narx class=md-nav__link> <span class=md-ellipsis> Rede Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=#representacao-geral-de-conjunto-de-modelos class=md-nav__link> <span class=md-ellipsis> Representação Geral de Conjunto de Modelos </span> </a> </li> <li class=md-nav__item> <a href=#modelos-mimo class=md-nav__link> <span class=md-ellipsis> Modelos MIMO </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../3-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 3. Estimação de Parâmetros </span> </a> </li> <li class=md-nav__item> <a href=../4-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 4. Seleção de Estrutura de Modelo </span> </a> </li> <li class=md-nav__item> <a href=../5-Multiobjective-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 5. Estimação de Parâmetros Multiobjetivo </span> </a> </li> <li class=md-nav__item> <a href=../6-Multiobjective-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 6. Seleção de Estrutura de Modelo Multiobjetivo </span> </a> </li> <li class=md-nav__item> <a href=../7-NARX-Neural-Network/ class=md-nav__link> <span class=md-ellipsis> 7. Rede Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../8-Severely-Nonlinear-System-Identification/ class=md-nav__link> <span class=md-ellipsis> 8. Identificação de Sistemas Severamente Não Lineares </span> </a> </li> <li class=md-nav__item> <a href=../9-Validation/ class=md-nav__link> <span class=md-ellipsis> 9. Validação </span> </a> </li> <li class=md-nav__item> <a href=../10-Case-Studies/ class=md-nav__link> <span class=md-ellipsis> 10. Estudos de Caso </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Contribuir </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Contribuir </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/contribute/ class=md-nav__link> <span class=md-ellipsis> Como contribuir </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Documentação </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Documentação </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer-guide/documentation-overview/ class=md-nav__link> <span class=md-ellipsis> Visão Geral da Documentação </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-write-a-tutorial/ class=md-nav__link> <span class=md-ellipsis> Como Escrever um Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-write-a-how-to-guide/ class=md-nav__link> <span class=md-ellipsis> Como Escrever um Guia How-to </span> </a> </li> <li class=md-nav__item> <a href=../../developer-guide/how-to-add-a-translation/ class=md-nav__link> <span class=md-ellipsis> Como Adicionar uma Tradução </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Comunidade </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Comunidade </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community-support/community-overview/ class=md-nav__link> <span class=md-ellipsis> Visão Geral da Comunidade </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/get-help/ class=md-nav__link> <span class=md-ellipsis> Obter Ajuda </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Palestras </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Palestras </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community-support/meetups/ai-networks-meetup/ class=md-nav__link> <span class=md-ellipsis> AI Networks Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/nubank-meetup/ class=md-nav__link> <span class=md-ellipsis> Nubank Meetup - Séries Temporais </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/nubank-meetup-open-source/ class=md-nav__link> <span class=md-ellipsis> Nubank Meetup - Open Source </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/gcom-meetup/ class=md-nav__link> <span class=md-ellipsis> GCoM Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../community-support/meetups/estatidados/ class=md-nav__link> <span class=md-ellipsis> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../landing-page/about-us/ class=md-nav__link> <span class=md-ellipsis> Sobre </span> </a> </li> <li class=md-nav__item> <a href=../../changelog/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../landing-page/sponsor/ class=md-nav__link> <span class=md-ellipsis> Apoie </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#funcoes-base-basis-function class=md-nav__link> <span class=md-ellipsis> Funções Base (Basis Function) </span> </a> <nav class=md-nav aria-label="Funções Base (Basis Function)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#exemplo-matriz-de-vandermonde class=md-nav__link> <span class=md-ellipsis> Exemplo: Matriz de Vandermonde </span> </a> </li> <li class=md-nav__item> <a href=#exemplo-funcoes-base-retangulares class=md-nav__link> <span class=md-ellipsis> Exemplo: Funções Base Retangulares </span> </a> </li> <li class=md-nav__item> <a href=#exemplo-funcoes-base-triangulares class=md-nav__link> <span class=md-ellipsis> Exemplo: Funções Base Triangulares </span> </a> </li> <li class=md-nav__item> <a href=#exemplo-radial-basis-function-rbf-gaussiana class=md-nav__link> <span class=md-ellipsis> Exemplo: Radial Basis Function (RBF) - Gaussiana </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#modelos-lineares class=md-nav__link> <span class=md-ellipsis> Modelos Lineares </span> </a> <nav class=md-nav aria-label="Modelos Lineares"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#armax class=md-nav__link> <span class=md-ellipsis> ARMAX </span> </a> </li> <li class=md-nav__item> <a href=#arx class=md-nav__link> <span class=md-ellipsis> ARX </span> </a> </li> <li class=md-nav__item> <a href=#arma class=md-nav__link> <span class=md-ellipsis> ARMA </span> </a> </li> <li class=md-nav__item> <a href=#ar class=md-nav__link> <span class=md-ellipsis> AR </span> </a> </li> <li class=md-nav__item> <a href=#fir class=md-nav__link> <span class=md-ellipsis> FIR </span> </a> </li> <li class=md-nav__item> <a href=#outras-variantes class=md-nav__link> <span class=md-ellipsis> Outras Variantes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#modelos-nao-lineares class=md-nav__link> <span class=md-ellipsis> Modelos Não Lineares </span> </a> <nav class=md-nav aria-label="Modelos Não Lineares"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#narmax class=md-nav__link> <span class=md-ellipsis> NARMAX </span> </a> </li> <li class=md-nav__item> <a href=#narx class=md-nav__link> <span class=md-ellipsis> NARX </span> </a> </li> <li class=md-nav__item> <a href=#narma class=md-nav__link> <span class=md-ellipsis> NARMA </span> </a> </li> <li class=md-nav__item> <a href=#nar class=md-nav__link> <span class=md-ellipsis> NAR </span> </a> </li> <li class=md-nav__item> <a href=#nfir class=md-nav__link> <span class=md-ellipsis> NFIR </span> </a> </li> <li class=md-nav__item> <a href=#modelos-narmax-mistos class=md-nav__link> <span class=md-ellipsis> Modelos NARMAX Mistos </span> </a> </li> <li class=md-nav__item> <a href=#rede-neural-narx class=md-nav__link> <span class=md-ellipsis> Rede Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=#representacao-geral-de-conjunto-de-modelos class=md-nav__link> <span class=md-ellipsis> Representação Geral de Conjunto de Modelos </span> </a> </li> <li class=md-nav__item> <a href=#modelos-mimo class=md-nav__link> <span class=md-ellipsis> Modelos MIMO </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/wilsonrljr/sysidentpy/edit/main/docs/pt/book/2-NARMAX-Model-Representation.md title="Editar esta página" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/wilsonrljr/sysidentpy/raw/main/docs/pt/book/2-NARMAX-Model-Representation.md title="Ver fonte desta página" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>2. Representação do Modelo NARMAX</h1> <p>Existem diversas representações de modelos NARMAX, incluindo polinomial, Fourier, aditivo generalizado, redes neurais e wavelet (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A</a>, <a href=https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas>Aguirra, L. A</a>). Este livro foca nas representações de modelos disponíveis no SysIdentPy, e manteremos o conteúdo atualizado à medida que novos métodos forem adicionados ao pacote. Se alguma representação específica for mencionada, mas ainda não estiver disponível no SysIdentPy, isso será explicitamente indicado.</p> <p>Para reproduzir os códigos apresentados nesta seção, certifique-se de ter os seguintes pacotes instalados:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>sysidentpy, scikit-learn, scipy, pytorch, matplotlib
</code></pre></div> <h2 id=funcoes-base-basis-function>Funções Base (Basis Function)<a class=headerlink href=#funcoes-base-basis-function title="Permanent link">&para;</a></h2> <p>Em Identificação de Sistemas, entender o conceito de funções base é fundamental para modelar de forma eficaz sistemas complexos. Funções base são funções matemáticas pré-definidas usadas para transformar os dados de entrada em um novo espaço, no qual as relações nos dados podem ser mais facilmente modeladas. Ao expressar os dados originais em termos dessas funções base, podemos construir modelos não lineares em relação à estrutura, mantendo-os lineares nos parâmetros, o que permite o uso de métodos diretos de estimação de parâmetros.</p> <p>Funções base comumente usadas em Identificação de Sistemas:</p> <ol> <li> <p><strong>Funções Base Polinomiais</strong>: São potências das variáveis de entrada. São úteis para capturar relações não lineares simples.</p> </li> <li> <p><strong>Funções Base de Fourier</strong>: São funções senoidais (seno e cosseno), ideais para representar padrões periódicos nos dados.</p> </li> <li> <p><strong>Funções Base Wavelet</strong>: São funções localizadas no tempo e na frequência, adequadas para analisar dados com componentes de frequência variáveis. Ainda não estão disponíveis no SysIdentPy.</p> </li> </ol> <p>No SysIdentPy você pode definir a função base que deseja usar no seu modelo simplesmente importando-as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span><span class=p>,</span> <span class=n>Fourier</span><span class=p>,</span> <span class=n>Bernstein</span>
</code></pre></div> <p>Para manter as coisas simples por enquanto, vamos mostrar exemplos simples de como funções base podem ser usadas em uma tarefa de modelagem. Apresentaremos uma função base polinomial simples, uma função base triangular, uma função base radial e uma função base retangular.</p> <blockquote> <p>O SysIdentPy atualmente não inclui Vandermonde nem nenhuma das outras funções base definidas abaixo. Essas funções são fornecidas apenas como exemplos para ilustrar a importância das funções base. Os exemplos são baseados na <a href=https://arxiv.org/pdf/1906.02003>tese de doutorado de Fredrik Bagge Carlson</a>, que é altamente recomendada para quem tem interesse em Identificação de Sistemas Não Lineares.</p> <p>Embora Vandermonde e Radial Basis Functions (RBF) estejam planejadas para serem incluídas como funções base nativas no SysIdentPy versão 1.0, os usuários já podem criar e usar suas próprias funções base customizadas com o SysIdentPy. Um exemplo de como fazer isso está disponível na <a href=https://sysidentpy.org/ >página de documentação do SysIdentPy</a>.</p> </blockquote> <h3 id=exemplo-matriz-de-vandermonde>Exemplo: Matriz de Vandermonde<a class=headerlink href=#exemplo-matriz-de-vandermonde title="Permanent link">&para;</a></h3> <p>As funções base polinomiais usadas neste exemplo são definidas como:</p> <div class=arithmatex>\[ \phi_i(x) = x^i \tag{2.1} \]</div> <p>em que <span class=arithmatex>\(i\)</span> é o grau do polinômio e <span class=arithmatex>\(x\)</span> é a variável de entrada.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=c1># Polynomial basis function</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=k>def</span><span class=w> </span><span class=nf>poly_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span><span class=p>):</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>vander</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>increasing</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=c1># Create polynomial features</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=n>degree</span> <span class=o>=</span> <span class=mi>2</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=n>X_poly</span> <span class=o>=</span> <span class=n>poly_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span><span class=p>)</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_poly</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_poly</span><span class=p>)</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=c1># Plot the polynomial approximation</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=c1># Plot the polynomial basis functions</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>degree</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>poly_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>degree</span><span class=p>)[:,</span> <span class=n>i</span><span class=p>],</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)])</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/vandermode_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/vandermode_example.png?raw=true"></a></p> <blockquote> <p>Figura 1. Aproximação usando Matriz de Vandermonde. Os pontos amarelos representam os dados do sistema, a linha azul em negrito representa os valores preditos e as demais linhas representam as funções base.</p> </blockquote> <h3 id=exemplo-funcoes-base-retangulares>Exemplo: Funções Base Retangulares<a class=headerlink href=#exemplo-funcoes-base-retangulares title="Permanent link">&para;</a></h3> <p>As funções base retangulares são definidas como:</p> <div class=arithmatex>\[ \phi_{i}(x) = \begin{cases} 1 &amp; \text{se } c_i - \frac{w}{2} \leq x &lt; c_i + \frac{w}{2} \\ 0 &amp; \text{caso contrário} \end{cases} \tag{2.2} \]</div> <p>em que <span class=arithmatex>\(c_i\)</span> representa o centro da função base, <span class=arithmatex>\(w\)</span> é a largura e <span class=arithmatex>\(x\)</span> é a variável de entrada.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=c1># Rectangular basis function</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=k>def</span><span class=w> </span><span class=nf>rectangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>):</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>width</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>centers</span><span class=p>])</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=c1># Create rectangular features</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=n>centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=n>width</span> <span class=o>=</span> <span class=mi>3</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=n>X_rect</span> <span class=o>=</span> <span class=n>rectangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_rect</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_rect</span><span class=p>)</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=c1># Plot the rectangular approximation</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=c1># Plot the rectangular basis functions</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>centers</span><span class=p>)):</span>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>rectangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)[:,</span> <span class=n>i</span><span class=p>],</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)])</span>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rectangular.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rectangular.png?raw=true"></a></p> <blockquote> <p>Figura 2. Aproximação usando Função Base Retangular. Os pontos amarelos representam os dados do sistema, a linha azul em negrito representa os valores preditos e as demais linhas representam as funções base.</p> </blockquote> <h3 id=exemplo-funcoes-base-triangulares>Exemplo: Funções Base Triangulares<a class=headerlink href=#exemplo-funcoes-base-triangulares title="Permanent link">&para;</a></h3> <p>As funções base triangulares são definidas como:</p> <div class=arithmatex>\[ \phi_{i}(x) = \max \left(0, 1 - \frac{|x - c_i|}{w} \right) \tag{2.3} \]</div> <p>em que <span class=arithmatex>\(c_i\)</span> é o centro da função base, <span class=arithmatex>\(w\)</span> é a largura e <span class=arithmatex>\(x\)</span> é a variável de entrada.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=c1># Triangular basis function</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=k>def</span><span class=w> </span><span class=nf>triangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>):</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span> <span class=o>/</span> <span class=n>width</span><span class=p>))</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>centers</span><span class=p>])</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=c1># Create triangular features</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=n>centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=n>width</span> <span class=o>=</span> <span class=mf>1.5</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=n>X_tri</span> <span class=o>=</span> <span class=n>triangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_tri</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_tri</span><span class=p>)</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=c1># Plot the triangular approximation</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=c1># Plot the triangular basis functions</span>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>centers</span><span class=p>)):</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>triangular_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>centers</span><span class=p>,</span> <span class=n>width</span><span class=p>)[:,</span> <span class=n>i</span><span class=p>],</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)])</span>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/triangular.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/triangular.png?raw=true"></a></p> <blockquote> <p>Figura 3. Aproximação usando Função Base Triangular. Os pontos amarelos representam os dados do sistema, a linha azul em negrito representa os valores preditos e as demais linhas representam as funções base.</p> </blockquote> <h3 id=exemplo-radial-basis-function-rbf-gaussiana>Exemplo: Radial Basis Function (RBF) - Gaussiana<a class=headerlink href=#exemplo-radial-basis-function-rbf-gaussiana title="Permanent link">&para;</a></h3> <p>A Radial Basis Function Gaussiana é definida como:</p> <div class=arithmatex>\[ \phi(x; c, \sigma) = \exp\left(- \frac{(x - c)^2}{2 \sigma^2}\right) \tag{2.4} \]</div> <p>em que: - <span class=arithmatex>\(x\)</span> é a variável de entrada; - <span class=arithmatex>\(c\)</span> é o centro da RBF; - <span class=arithmatex>\(\sigma\)</span> é a largura (ou escala) da RBF.</p> <p>Essa função mede a distância entre <span class=arithmatex>\(x\)</span> e o centro <span class=arithmatex>\(c\)</span>, decaindo exponencialmente com base na largura <span class=arithmatex>\(\sigma\)</span>. Quanto menor o <span class=arithmatex>\(\sigma\)</span>, mais localizada é a função base ao redor do centro <span class=arithmatex>\(c\)</span>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=c1># Generate simulated quadratic polynomial data</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>y</span> <span class=o>=</span> <span class=mf>0.2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>-</span> <span class=mf>0.3</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=mf>0.1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>  <span class=c1># Quadratic polynomial with noise</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=c1># RBF centers and sigma</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=n>centers</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>  <span class=c1># More centers for better coverage</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=n>sigma</span> <span class=o>=</span> <span class=mf>0.5</span>  <span class=c1># Spread of the RBF</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=c1># RBF basis function</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=k>def</span><span class=w> </span><span class=nf>rbf_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>sigma</span><span class=p>):</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=c1># Create RBF features</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=n>X_rbf</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>rbf_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>centers</span><span class=p>])</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=c1># Fit a linear regression model</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=n>model</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_rbf</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_rbf</span><span class=p>)</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=c1># Plot the original data (quadratic polynomial)</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#ffc865&#39;</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>25</span><span class=p>)</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=c1># Basis function colors</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=n>basis_colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;#00b262&quot;</span><span class=p>,</span> <span class=s2>&quot;#20007e&quot;</span><span class=p>,</span> <span class=s2>&quot;#b20000&quot;</span><span class=p>]</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=n>n_colors</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>basis_colors</span><span class=p>)</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=c1># Plot the basis functions</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>centers</span><span class=p>):</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>    <span class=n>color</span> <span class=o>=</span> <span class=n>basis_colors</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=n>n_colors</span><span class=p>]</span>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>rbf_basis</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>sigma</span><span class=p>),</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;RBF Center </span><span class=si>{</span><span class=n>c</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a><span class=c1># Plot the approximation</span>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#00008c&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;top&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>spines</span><span class=p>[</span><span class=s1>&#39;bottom&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>set_visible</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_ticks_position</span><span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
<a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_ticks</span><span class=p>([])</span>
<a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rbf_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/rbf_example.png?raw=true"></a></p> <blockquote> <p>Figura 4. Aproximação usando Radial Basis Function. Os pontos amarelos representam os dados do sistema, a linha azul em negrito representa os valores preditos e as demais linhas representam as funções base.</p> </blockquote> <h2 id=modelos-lineares>Modelos Lineares<a class=headerlink href=#modelos-lineares title="Permanent link">&para;</a></h2> <h3 id=armax>ARMAX<a class=headerlink href=#armax title="Permanent link">&para;</a></h3> <p>Você provavelmente já notou a semelhança entre o acrônimo NARMAX e os modelos bem conhecidos ARX, ARMAX etc., amplamente usados para previsão de séries temporais. E essa semelhança não é por acaso. Os modelos AutoRegressivos com Média Móvel e Entrada Exógena (ARMAX) e suas variações AR, ARX, ARMA (para citar apenas algumas) estão entre as representações matemáticas mais utilizadas para identificação de sistemas lineares. O modelo ARMAX pode ser expresso como:</p> <div class=arithmatex>\[ y_k= \mathcal{\phi}[y_{k-1}, \dotsc, y_{k-n_y},x_{k-d}, x_{k-d-1}, \dotsc, x_{k-d-n_x}, e_{k-1}, \dotsc, e_{k-n_e}] + e_k \tag{2.5} \]</div> <p>em que <span class=arithmatex>\(n_y\in \mathbb{N}\)</span>, <span class=arithmatex>\(n_x \in \mathbb{N}\)</span>, <span class=arithmatex>\(n_e \in \mathbb{N}\)</span> são os máximos atrasos para os regressors de saída, entrada e ruído do sistema (representando a parte de média móvel), respectivamente; <span class=arithmatex>\(x_k \in \mathbb{R}^{n_x}\)</span> é a entrada do sistema e <span class=arithmatex>\(y_k \in \mathbb{R}^{n_y}\)</span> é a saída do sistema no instante discreto <span class=arithmatex>\(k \in \mathbb{N}^n\)</span>; <span class=arithmatex>\(e_k \in \mathbb{R}^{n_e}\)</span> representa incertezas e possíveis ruídos no instante discreto <span class=arithmatex>\(k\)</span>. Neste caso, <span class=arithmatex>\(\mathcal{\phi}\)</span> é alguma função linear dos regressors de entrada e saída e <span class=arithmatex>\(d\)</span> é um atraso de tempo, tipicamente definido como <span class=arithmatex>\(d=1\)</span>.</p> <p>Se <span class=arithmatex>\(\mathcal{F}\)</span> é um polinômio, obtemos um modelo ARMAX polinomial:</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + \sum_{j=1}^{q}\Theta_{e}^{j}e_{k-j} + \sum_{m=1}^{r}\Theta_{x}^{m}x_{k-m} + e_k \tag{2.6} \]</div> <p>em que <span class=arithmatex>\(\sum\nolimits_{0}\)</span>, <span class=arithmatex>\(\Theta_{y}^{i}\)</span>, <span class=arithmatex>\(\Theta_{e}^{j}\)</span> e <span class=arithmatex>\(\Theta_{x}^{m}\)</span> são parâmetros constantes.</p> <p>O exemplo a seguir é um modelo ARMAX polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139x_{k-1} -0.1691x_{k-1} + 0.2245e_{k-1} \end{align} \tag{2.7} \]</div> <p>Você pode construir facilmente um modelo ARMAX polinomial usando o <strong>SysIdentPy</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=p>)</span>
</code></pre></div></p> <p>No exemplo acima, definimos a função base polinomial linear importando a função base <code>Polynomial</code> e definindo o grau igual a 1 (isso garante que não tenhamos combinações não lineares dos regressors). Não se preocupe ainda com <code>FROLS</code> e <code>LeastSquares</code>. Falaremos sobre eles nos capítulos 3 e 4, respectivamente.</p> <p>Para a Figura 4, realizamos 10 simulações independentes para analisar os efeitos de diferentes realizações de processo de ruído no comportamento do sistema ARMAX. Cada simulação usa uma amostra distinta de ruído para observar como variações nesse componente aleatório influenciam a saída do sistema. Para ilustrar isso, destacamos uma simulação específica enquanto as demais são exibidas com menor destaque.</p> <p>É importante notar que todas as simulações, destacadas ou não, são governadas pelo mesmo modelo subjacente. A parte determinística da equação do modelo explica o comportamento de todos os sinais exibidos. As diferenças observadas entre os sinais surgem apenas das diferentes amostras de ruído usadas em cada simulação. Apesar dessas variações, a dinâmica central do sinal permanece consistente e é descrita pelo componente determinístico do modelo.</p> <blockquote> <p>A maior parte do código apresentado neste capítulo tem o objetivo de ilustrar conceitos fundamentais, e não de mostrar especificamente como utilizar o SysIdentPy. Muitos exemplos são implementados usando Python "puro" para ajudar você a compreender melhor os conceitos subjacentes, reproduzir os exemplos e adaptá-los conforme necessário. O SysIdentPy em si será introduzido e utilizado nos exemplos a partir do próximo capítulo.</p> </blockquote> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.9</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.24</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.92</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.92</span><span class=o>*</span><span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>    <span class=c1># Interpolate the data just to make the plot &quot;nicer&quot;</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an ARMAX model&quot;</span><span class=p>)</span>
<a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/armax_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/armax_example.png?raw=true"></a></p> <blockquote> <p>Figura 5. Simulações para mostrar os efeitos de diferentes realizações de processo de ruído no comportamento do modelo ARMAX.</p> </blockquote> <h3 id=arx>ARX<a class=headerlink href=#arx title="Permanent link">&para;</a></h3> <p>Se não incluirmos os termos de ruído <span class=arithmatex>\(e_{k-n_e}\)</span> na Equação (2.5), obtemos modelos ARX.</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + \sum_{m=1}^{r}\Theta_{x}^{m}x_{k-m} + e_k \tag{2.8} \]</div> <p>O exemplo a seguir é um modelo ARX polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139x_{k-1} -0.1691x_{k-1} \end{align} \tag{2.9} \]</div> <p>A única diferença no SysIdentPy é definir <code>unbiased=False</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=p>)</span>
</code></pre></div> <p>O exemplo a seguir mostra 10 simulações independentes para analisar os efeitos de diferentes realizações de processo de ruído no comportamento do sistema ARX.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.9</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.24</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.92</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>
<a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an ARX model&quot;</span><span class=p>)</span>
<a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arx_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arx_example.png?raw=true"></a></p> <blockquote> <p>Figura 6. Simulações para mostrar os efeitos de diferentes realizações de processo de ruído no comportamento do modelo ARX.</p> </blockquote> <h3 id=arma>ARMA<a class=headerlink href=#arma title="Permanent link">&para;</a></h3> <p>Se não incluirmos termos de entrada na Equação (2.5), obtemos o modelo ARMA:</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + \sum_{j=1}^{q}\Theta_{e}^{j}e_{k-j} + e_k \tag{2.10} \]</div> <p>O exemplo a seguir é um modelo ARMA polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139y_{k-3} -0.1691y_{k-4} + 0.2245e_{k-1} \end{align} \tag{2.11} \]</div> <p>Como a representação do modelo não possui entradas, precisamos definir o tipo de modelo como <code>NAR</code> e <code>unbiased=True</code> novamente em <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=p>)</span>
</code></pre></div> <p>A figura abaixo mostra 10 simulações independentes para analisar os efeitos de diferentes realizações de processo de ruído no comportamento do sistema ARMA.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.5</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.4</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>0.8</span><span class=o>*</span><span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>
<a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a>
<a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an ARMA model&quot;</span><span class=p>)</span>
<a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arma_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/arma_example.png?raw=true"></a></p> <blockquote> <p>Figura 7. Simulações para mostrar os efeitos de diferentes realizações de processo de ruído no comportamento do modelo ARMA.</p> </blockquote> <h3 id=ar>AR<a class=headerlink href=#ar title="Permanent link">&para;</a></h3> <p>Se não incluirmos termos de entrada e de ruído na Equação (2.5), obtemos o modelo AR:</p> <div class=arithmatex>\[ y_k = \sum_{0} + \sum_{i=1}^{p}\Theta_{y}^{i}y_{k-i} + e_k \tag{2.12} \]</div> <p>O exemplo a seguir é um modelo AR polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}+0.1139y_{k-3} -0.1691y_{k-4} \end{align} \tag{2.13} \]</div> <p>Nesse caso, precisamos definir o tipo de modelo como <code>NAR</code> e <code>unbiased=False</code> em <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=p>)</span>
</code></pre></div> <p>A figura abaixo mostra 10 simulações independentes para analisar os efeitos de diferentes realizações de processo de ruído no comportamento do sistema AR.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.5</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.3</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an AR model&quot;</span><span class=p>)</span>
<a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/ar_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/ar_example.png?raw=true"></a></p> <blockquote> <p>Figura 8. Simulações para mostrar os efeitos de diferentes realizações de processo de ruído no comportamento do modelo AR.</p> </blockquote> <h3 id=fir>FIR<a class=headerlink href=#fir title="Permanent link">&para;</a></h3> <p>Se mantivermos apenas os termos de entrada na Equação (2.5), obtemos o modelo NFIR:</p> <div class=arithmatex>\[ y_k = \sum_{m=1}^{r}\Theta_{x}^{m}x_{k-m} + e_k \tag{2.14} \]</div> <p>O exemplo a seguir é um modelo FIR polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213x_{k-1}-0.5692x_{k-2}+0.1139x_{k-3} -0.1691x_{k-4} \end{align} \tag{2.15} \]</div> <p>Nesse caso, precisamos definir o tipo de modelo como <code>NFIR</code> e <code>unbiased=False</code> em <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NFIR&quot;</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=p>)</span>
</code></pre></div> <p>A figura abaixo mostra 10 simulações independentes para analisar os efeitos de diferentes realizações de processo de ruído no comportamento do sistema FIR.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.interpolate</span><span class=w> </span><span class=kn>import</span> <span class=n>interp1d</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=n>random_samples</span> <span class=o>=</span> <span class=mi>50</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=n>n</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>random_samples</span><span class=p>)</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=k>def</span><span class=w> </span><span class=nf>system_equation</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>nu</span><span class=p>):</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>    <span class=n>yk</span> <span class=o>=</span> <span class=mf>0.28</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>0.34</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>nu</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>    <span class=k>return</span> <span class=n>yk</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=n>u</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=c1># Create a single figure and axis for all plots</span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>    <span class=n>nu</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>random_samples</span><span class=p>,),</span> <span class=n>scale</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty_like</span><span class=p>(</span><span class=n>nu</span><span class=p>)</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>    <span class=c1># Initial Conditions</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>    <span class=n>y0</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>]</span>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>    <span class=n>y</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>y0</span>
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
<a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>system_equation</span><span class=p>([</span><span class=mf>0.1</span><span class=o>*</span><span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>u</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>nu</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
<a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a>
<a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a>    <span class=c1># Interpolate the data just to make the plot easier to understand</span>
<a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a>    <span class=n>interpolation_function</span> <span class=o>=</span> <span class=n>interp1d</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s1>&#39;quadratic&#39;</span><span class=p>)</span>
<a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>    <span class=n>n_fine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>n</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span> <span class=mi>10</span><span class=o>*</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>))</span>  <span class=c1># More points for a smoother curve</span>
<a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a>    <span class=n>y_interpolated</span> <span class=o>=</span> <span class=n>interpolation_function</span><span class=p>(</span><span class=n>n_fine</span><span class=p>)</span>
<a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>    <span class=c1># Plotting the interpolated data</span>
<a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>    <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;k&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>        <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>n_fine</span><span class=p>,</span> <span class=n>y_interpolated</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;grey&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)</span>
<a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a>
<a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a><span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>&quot;$n$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a><span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&quot;$y[n]$&quot;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>18</span><span class=p>)</span>
<a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>&quot;Simulation of an FIR model&quot;</span><span class=p>)</span>
<a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/fir_example.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/fir_example.png?raw=true"></a></p> <blockquote> <p>Figura 9. Simulações para mostrar os efeitos de diferentes realizações de processo de ruído no comportamento do modelo <strong>FIR</strong>.</p> <p>Não definimos o <code>model_type</code> para ARMAX e ARX porque o padrão é <code>NARMAX</code>. O SysIdentPy permite três tipos de modelo: <code>NARMAX</code>, <code>NAR</code> e <code>NFIR</code>. Como ARMAX, ARX e outras variantes lineares são subconjuntos de modelos NARMAX, não há necessidade de um tipo de modelo específico <code>ARMAX</code>. A ideia é ter tipos de modelos para: modelos com regressors de entrada e saída; modelos apenas com regressors de saída; e modelos apenas com regressors de entrada.</p> </blockquote> <h3 id=outras-variantes>Outras Variantes<a class=headerlink href=#outras-variantes title="Permanent link">&para;</a></h3> <p>Por simplicidade, definimos a Equação (2.5) e consideramos apenas as representações polinomiais. No entanto, você pode estender essas representações para outras funções base, como Fourier. Se definirmos <span class=arithmatex>\(\mathcal{F}\)</span> como a extensão de Fourier:</p> <div class=arithmatex>\[ \mathcal{F}(x) = [\cos(\pi x), \sin(\pi x), \cos(2\pi x), \sin(2\pi x), \ldots, \cos(N\pi x), \sin(N\pi x)] \tag{2.16} \]</div> <p>Nesse caso, a representação ARX de Fourier será:</p> <div class=arithmatex>\[ \begin{aligned} y_k = &amp;\Big[ \cos(\pi y_{k-1}), \sin(\pi y_{k-1}), \cos(2\pi y_{k-1}), \sin(2\pi y_{k-1}), \ldots, \cos(N\pi y_{k-1}), \sin(N\pi y_{k-1}), \\ &amp;\ \ \cos(\pi y_{k-2}), \sin(\pi y_{k-2}), \ldots, \cos(N\pi y_{k-n_y}), \sin(N\pi y_{k-n_y}), \\ &amp;\ \ \cos(\pi x_{k-1}), \sin(\pi x_{k-1}), \cos(2\pi x_{k-1}), \sin(2\pi x_{k-1}), \ldots, \cos(N\pi x_{k-n_x}), \sin(N\pi x_{k-n_x}) \Big] \\ &amp;\ \ + e_k \end{aligned} \tag{2.17} \]</div> <p>Para fazer isso no SysIdentPy, basta importar a função base de Fourier em vez da polinomial:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Fourier</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Fourier</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=p>)</span>
</code></pre></div> <h2 id=modelos-nao-lineares>Modelos Não Lineares<a class=headerlink href=#modelos-nao-lineares title="Permanent link">&para;</a></h2> <h3 id=narmax>NARMAX<a class=headerlink href=#narmax title="Permanent link">&para;</a></h3> <p>O modelo NARMAX foi proposto por Stephen A. Billings e I. J. Leontaritis em <a href="https://pdf.sciencedirectassets.com/314898/1-s2.0-S1474667082X74355/1-s2.0-S1474667017630398/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjECcaCXVzLWVhc3QtMSJHMEUCIGSxH3DpnP8cywgmDASl%2FBUhnmjjJxeG%2BTay6JhHkUUKAiEAgdzFyYAYcYGDnHxy9T%2BzIVHT%2Fi8J0BVY4ZxI0ovAaUIqsgUIIBAFGgwwNTkwMDM1NDY4NjUiDNTsL0ESuGUnlT%2FyniqPBTUbIgulDeB6wJLJ6sql18H4y3NFfyReA0c45SRi1Rq%2F1TEI%2B0c2cC8v%2FfH8cJF7xGiU%2Fvq3apocGRSFYM6VCJ5IPeyqW3V9Z6lZCAHz3sMY2vX6xHf8czCB4jk85bQAr5Ct9C8m0YI33jvykw7ZC25zOVsyDyR%2Fnas4IOBAboSImvbTzYgDwcwL5S9eSlq%2Byw%2FZPyOMJslF6mOERjXYMrr1Xg51F%2B4xeDt%2BWSGe5qbu5s0RJwifIBp0%2F6WG1m6Mvf0wn%2BQyP8PMJyKMP31fbeA7g3Ndwtjs8ghLPjxax%2BSLby5hgi9ogzm1Gr%2Fv972XLW3TwNUod6yMdzVolsNcxgPBUtns%2Fdfr%2Fm2e%2BkvpETO%2FF1J7V%2FAievzJFE2Sl087x0ZACiy57fK3doa7UWpZj46DaU%2BeAEUbrSXel2PqHbLfSFM9NDsgZWBRXzqygQY4VMGANBEKCR%2BrcJdI3BG%2B%2Bkcg18OKr%2Bf42vgzGRiGB3szABhtRVq5QvGyXYYONv1SFcLBHAt67nuVukKMu%2BR%2BmKQT9CwNOL13oZ5ldS5Fowv1TC8B8o8qdlveFb6WywpTnsSc9%2Bm8Ufbn5W8zI5Fy2sECz4hjUY1zGRhH3O9027j87%2BwyVVfdT6ucHvOdHjQTr2tawgJmUvRunQlw7xN85t2IPEWdFZSXC9IgkG5QRxxzYzsyrCzG4Vsm3CGcShAu7Ms%2Bm7z7XO8QXgfN95JxcG4PX6siAkN5CGZwAdtUkp1VOXzpRt77mrTofG%2BHDGHeXPlyRnBNqR4Z7EJbevPWgUK9BRkVbKfnL0YCtuWbQ3sQ115UTR1a84VejuWmTg%2FJ8Fpf78ApwBE6igc1VfePXVJJwAzxzWcXPSwlhDQNqPIw8ffPtQY6sQHciEnI0Pd0iSUf53%2BhgScY6deC54cJfBcOtzm9RhrSeSoQyPdhrMHU0r2fWAhYRcr9ZeuObdxPtjpqardoQM%2BEizPzQNO8uBtOoYTK2inAXxp2z3U%2BDYHWJHNuapOhC2GsOPlPXco7e0Hm0GxiPUyk6%2B8FtqTAs6d4KxpT7CGLUNChK%2BCUbt%2BsnF84TjzK40Fkf0Gya9ESFUHmIEUmfXabOKfgra2QbSbcogWgoI5gChM%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20240808T001847Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTY343F44W4%2F20240808%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=95d8e3c94d76309850682e9e8f9025436a481f440bf152241e01eb47d70c4438&hash=fb1356fe353cd87c7fb931d951e83c97cce7568257b5a9c6c533aee21ef64f35&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=S1474667017630398&tid=spdf-a9063d37-b51a-42e8-97b3-bb5ab63b0384&sid=07d7477c73bfe241706ba2d-0fba8a3cbcd1gxrqa&type=client&tsoh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&ua=18165805090051570458&rr=8afb54c71f7e1ac0&cc=br">1981</a>, (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A. - Nonlinear System Identification: NARMAX Methods in the Time, Frequency, and Spatio-Temporal Domains</a>), e pode ser descrito como</p> <div class=arithmatex>\[ \begin{equation} y_k= \mathcal{F}[y_{k-1}, \dotsc, y_{k-n_y},x_{k-d}, x_{k-d-1}, \dotsc, x_{k-d-n_x}, e_{k-1}, \dotsc, e_{k-n_e}] + e_k, \end{equation} \tag{2.18} \]</div> <p>em que <span class=arithmatex>\(n_y\in \mathbb{N}^*\)</span>, <span class=arithmatex>\(n_x \in \mathbb{N}\)</span>, <span class=arithmatex>\(n_e \in \mathbb{N}\)</span> são os máximos atrasos para saída, entrada e ruído, respectivamente; <span class=arithmatex>\(x_k \in \mathbb{R}^{n_x}\)</span> é a entrada do sistema e <span class=arithmatex>\(y_k \in \mathbb{R}^{n_y}\)</span> é a saída do sistema no instante discreto <span class=arithmatex>\(k \in \mathbb{N}^n\)</span>; <span class=arithmatex>\(e_k \in \mathbb{R}^{n_e}\)</span> representa incertezas e possíveis ruídos no instante discreto <span class=arithmatex>\(k\)</span>. Nesse caso, <span class=arithmatex>\(\mathcal{F}\)</span> é alguma função não linear dos regressors de entrada e saída, e <span class=arithmatex>\(d\)</span> é um atraso de tempo tipicamente definido como <span class=arithmatex>\(d=1\)</span>.</p> <p>Você pode notar que a diferença entre as Equações (2.5) e (2.18) está na função que representa o sistema. Para modelos NARMAX, <span class=arithmatex>\(\mathcal{F}\)</span> pode ser qualquer função não linear, enquanto na Equação (2.5) apenas funções lineares são permitidas. Embora existam muitas possíveis aproximações para <span class=arithmatex>\(\mathcal{F}(\cdot)\)</span> (por exemplo, redes neurais, fuzzy, wavelet, Radial Basis Function), o modelo NARMAX polinomial em forma de potência é o mais amplamente utilizado (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A.</a>; <a href=https://arxiv.org/abs/2001.05320>Khandelwal, D. and Schoukens, M. and Toth, R.</a>):</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}x_{k-j}^{b_i, j}\prod_{l=1}^{n_e}e_{k-l}^{d_i, l}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.19} \]</div> <p>em que <span class=arithmatex>\(p\)</span> é o número de regressors, <span class=arithmatex>\(\Theta_i\)</span> são os parâmetros do modelo e <span class=arithmatex>\(a_i, m\)</span>, <span class=arithmatex>\(b_i, j\)</span> e <span class=arithmatex>\(d_i, l \in \mathbb{N}\)</span> são os expoentes dos termos de saída, entrada e ruído, respectivamente.</p> <p>A Equação (2.20) descreve um modelo NARMAX polinomial com grau de não linearidade igual a <span class=arithmatex>\(2\)</span>, identificado a partir de dados experimentais de um sistema motor/gerador CC, sem conhecimento prévio da forma do modelo, extraído de <a href=https://www.ufsj.edu.br/portal2-repositorio/File/gcom/LAM2017.pdf>Lacerda Junior, W. R., Almeida, V. M., &amp; Martins, S. A. M. (2017)</a>:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 1.7813y_{k-1}-0.7962y_{k-2}+0.0339x_{k-1} -0.1597x_{k-1} y_{k-1} +0.0338x_{k-2} + \\ &amp; + 0.1297x_{k-1}y_{k-2} - 0.1396x_{k-2}y_{k-1}+ 0.1086x_{k-2}y_{k-2}+0.0085y_{k-2}^2 + 0.0247e_{k-1}e_{k-2} \end{align} \tag{2.20} \]</div> <p>Os valores de <span class=arithmatex>\(\Theta\)</span> são os coeficientes de cada termo da equação polinomial.</p> <p>Funções base polinomiais são uma das representações de NARMAX mais utilizadas devido a diversas características interessantes (<a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A.</a>):</p> <ul> <li>Todas as funções polinomiais são suaves em <span class=arithmatex>\(\mathbb{R}\)</span>.</li> <li>O <a href=https://www.researchgate.net/profile/P-Johnson/publication/353192512_Stone-Weierstrass_Theorem/links/60ec4cdc9541032c6d32c4a6/Stone-Weierstrass-Theorem.pdf>Teorema de Aproximação de Weierstrass</a> afirma que qualquer função contínua real definida em um espaço fechado e limitado <span class=arithmatex>\([a,b]\)</span> pode ser aproximada uniformemente por um polinômio nesse intervalo.</li> <li>Elas podem descrever diversos sistemas dinâmicos não lineares, incluindo processos industriais, sistemas de controle, sistemas estruturais, sistemas econômicos e financeiros, biologia, medicina e sistemas sociais (alguns exemplos são detalhados em <a href=https://ieeexplore.ieee.org/document/8751951>Lacerda Junior, W. R. and Martins, S. A. M. and Nepomuceno, E. G. and Lacerda, Marcio J.</a>; <a href=https://www.sciencedirect.com/science/article/pii/S0307904X03000714>Fung, E. H. K. and Wong, Y. K. and Ho, H. F. and Mignolet, M. P.</a>; <a href=https://ieeexplore.ieee.org/document/1179133>Kukreja, S. L. and Galiana, H. L. and Kearney, R. E.</a>; <a href=https://www.wiley.com/en-us/Nonlinear+System+Identification%3A+NARMAX+Methods+in+the+Time%2C+Frequency%2C+and+Spatio-Temporal+Domains-p-9781119943594>Billings, S. A</a>; <a href="https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas?channel=doi&linkId=574cb16508ae82d2c6bc870f&showFulltext=true">Aguirre, L. A.</a>; entre muitos outros).</li> <li>Diversos algoritmos foram desenvolvidos para seleção de estrutura e estimação de parâmetros de modelos NARMAX polinomiais, e essa continua sendo uma área ativa de pesquisa.</li> <li>Modelos NARMAX polinomiais são versáteis e podem ser usados tanto para predição quanto para inferência. A estrutura desses modelos é relativamente fácil de interpretar e pode ser relacionada ao sistema subjacente, o que é muito mais difícil de alcançar com redes neurais ou funções wavelet, por exemplo.</li> </ul> <p>Você pode construir facilmente um modelo NARMAX polinomial usando o SysIdentPy. Note que, neste caso, a diferença em relação ao ARMAX está no grau da função polinomial.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=p>)</span>
</code></pre></div> <p>Pode parecer uma mudança simples, mas em cenários não lineares a "curse of dimensionality" se torna um problema real. O número de regressors candidatos, <span class=arithmatex>\(n_r\)</span>, de um modelo NARX polinomial pode ser definido como em <a href=https://www.tandfonline.com/doi/abs/10.1080/00207178808906169>Korenberg, M. L., Billings, S. A., Liu, Y. P., and McIlroy, P. J. - Orthogonal parameter estimation algorithm for non-linear stochastic systems</a>:</p> <div class=arithmatex>\[ \begin{equation} n_r = M+1, \end{equation} \tag{2.21} \]</div> <p>em que</p> <div class=arithmatex>\[ \begin{align} M = &amp; \sum_{i=1}^{\ell}n_i \\ n_i = &amp; \frac{n_{i-1}(n_y+n_x+i-1)}{i}, n_{0} = 1. \end{align} \tag{2.22} \]</div> <p>Como mencionamos na Introdução do livro, os métodos NARMAX buscam construir modelos o mais simples possível. A ideia é reproduzir uma ampla gama de comportamentos usando um pequeno subconjunto de termos do vasto espaço de busca formado pelos regressors candidatos.</p> <p>Vamos usar o SysIdentPy para ver como o espaço de busca cresce no cenário linear versus o não linear. O método <code>count_model_regressors</code> disponível em <code>narmax_tools</code> pode ser usado para verificar quantos regressors existem no espaço de busca, dado o número de entradas, os atrasos de <code>y</code> e <code>x</code> e a função base. Vamos usar <code>xlag=ylag=10</code> e a função base polinomial. O usuário pode simular diferentes cenários definindo parâmetros distintos.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.information_matrix</span><span class=w> </span><span class=kn>import</span> <span class=n>count_model_regressors</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</code></pre></div> <p>Para o caso linear com 1 entrada, temos 21 regressors: <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># simulating a case with 1 input</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=p>)</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=n>n_regressors</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>21</span>
</code></pre></div></p> <p>Para o caso linear com 2 entradas, o número de regressors salta para 31:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># simulating a case with 2 inputs</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>))]</span> <span class=o>*</span> <span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>    <span class=n>xlag</span><span class=o>=</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=p>)</span>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=n>n_regressors</span>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>31</span>
</code></pre></div> <p>Se considerarmos um caso não linear com 1 entrada apenas mudando o grau para 2, temos 231 regressors:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># simulating a case with 1 input</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=p>)</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=n>n_regressors</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>231</span>
</code></pre></div> <p>Se definirmos o grau como 3, o número de termos aumenta significativamente para 1771 regressors:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># simulating a case with 1 input</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=p>)</span>
<a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=n>n_regressors</span>
<a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>1771</span>
</code></pre></div> <p>Se tivermos 2 entradas no cenário não linear com <code>degree=2</code>, o número de regressors é 496:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># simulating a case with 2 inputs</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>))]</span> <span class=o>*</span> <span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>    <span class=n>xlag</span><span class=o>=</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=p>)</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=n>n_regressors</span>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>496</span>
</code></pre></div> <p>Se tivermos 2 entradas no cenário não linear com <code>degree=3</code>, o número salta para 5456 regressors:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=n>x_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># simulating a case with 2 inputs</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=n>xlag</span> <span class=o>=</span> <span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>))]</span> <span class=o>*</span> <span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>    <span class=n>xlag</span><span class=o>=</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=p>)</span>
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=n>n_regressors</span>
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>5456</span>
</code></pre></div> <p>Como você pode notar, o número de regressors aumenta significativamente à medida que o grau do polinômio e o número de entradas crescem. Isso torna a seleção da estrutura do modelo muito mais complexa! No caso linear com 10 entradas, temos <code>2^31=2.15e+09</code> combinações possíveis de modelos. Quando <code>degree=2</code> com 2 entradas, temos <code>2^496=2.05e+149</code> combinações possíveis! Tente obter o número de combinações possíveis quando <code>degree=3</code> com 2 entradas. Além disso, tente repetir o exercício com mais entradas e graus de não linearidade mais altos e veja como a "curse of dimensionality" é um grande problema.</p> <p>Como se pode ver, obter um modelo simples em um espaço de busca tão grande é uma tarefa complexa de seleção de estrutura. Selecionar os termos mais significativos a partir de um dicionário enorme de termos possíveis não é uma tarefa trivial. E isso é difícil não apenas devido ao problema combinatório complexo e à incerteza sobre a ordem do modelo. Identificar os termos mais relevantes em um cenário não linear é muito desafiador porque depende do tipo de não linearidade (singularidade esparsa ou quase singular, efeitos de memória ou amortecimento, entre outros), da resposta dinâmica (sistemas espaço-temporais, dependentes do tempo), da resposta em regime permanente, da frequência dos dados, do ruído e de muitos outros fatores.</p> <p>Devido aos algoritmos de seleção de estrutura desenvolvidos para modelos NARMAX, mesmo modelos lineares como ARMAX podem apresentar desempenho diferente quando obtidos usando o SysIdentPy em comparação com outras bibliotecas, como Statsmodels. Apresentamos um estudo de caso mostrando exatamente isso no Capítulo 10.</p> <h3 id=narx>NARX<a class=headerlink href=#narx title="Permanent link">&para;</a></h3> <p>Se não incluirmos termos de ruído <span class=arithmatex>\(e_{k-n_e}\)</span> na Equação (2.19), obtemos modelos NARX:</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}x_{k-j}^{b_i, j}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.23} \]</div> <p>A Equação (2.24) descreve um modelo NARX polinomial simples:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}^2+0.1139y_{k-1}x_{k-1} \end{align} \tag{2.24} \]</div> <p>A única diferença no SysIdentPy é definir <code>unbiased=False</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=p>)</span>
</code></pre></div> <blockquote> <p>O usuário pode reutilizar os códigos fornecidos para modelos lineares a fim de analisar modelos não lineares com diferentes realizações de ruído.</p> </blockquote> <h3 id=narma>NARMA<a class=headerlink href=#narma title="Permanent link">&para;</a></h3> <p>Se não incluirmos termos de entrada na Equação (2.19), obtemos o modelo NARMA:</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times\prod_{l=1}^{n_e}e_{k-l}^{d_i, l}\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.25} \]</div> <p>O exemplo a seguir é um modelo NARMA polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}^3+0.1139y_{k-3}y_{k-4} + 0.2245e_{k-1} \end{align} \tag{2.26} \]</div> <p>Como a representação do modelo não possui entradas, precisamos definir o tipo de modelo como <code>NAR</code> e <code>unbiased=True</code> novamente em <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=p>)</span>
</code></pre></div> <h3 id=nar>NAR<a class=headerlink href=#nar title="Permanent link">&para;</a></h3> <p>Se não incluirmos termos de entrada e ruído na Equação (2.19), obtemos o modelo NAR:</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times\prod_{m=1}^{n_y}y_{k-m}^{a_i, m} \end{align} \tag{2.27} \]</div> <p>O exemplo a seguir é um modelo NAR polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213y_{k-1}-0.5692y_{k-2}^2+0.1139y_{k-3}^3 -0.1691y_{k-4}y_{k-5} \end{align} \tag{2.28} \]</div> <p>Nesse caso, precisamos definir o tipo de modelo como <code>NAR</code> e <code>unbiased=False</code> em <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NAR&quot;</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=p>)</span>
</code></pre></div> <h3 id=nfir>NFIR<a class=headerlink href=#nfir title="Permanent link">&para;</a></h3> <p>Se mantivermos apenas os termos de entrada na Equação (2.19), obtemos o modelo NFIR:</p> <div class=arithmatex>\[ \begin{align} y_k = \sum_{i=1}^{p}\Theta_i \times \prod_{j=0}^{n_x}x_{k-j}^{b_i, j} \end{align} \tag{2.29} \]</div> <p>O exemplo a seguir é um modelo NFIR polinomial:</p> <div class=arithmatex>\[ \begin{align} y_k =&amp; 0.7213x_{k-1}-0.5692x_{k-2}^2+0.1139x_{k-3}x_{k-4} -0.1691x_{k-4}^3 \end{align} \tag{2.30} \]</div> <p>Nesse caso, precisamos definir o tipo de modelo como <code>NFIR</code> e <code>unbiased=False</code> em <code>LeastSquares</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>FROLS</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.parameter_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>LeastSquares</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>FROLS</span><span class=p>(</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>LeastSquares</span><span class=p>(</span><span class=n>unbiased</span><span class=o>=</span><span class=kc>False</span><span class=p>),</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NFIR&quot;</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=p>)</span>
</code></pre></div> <h3 id=modelos-narmax-mistos>Modelos NARMAX Mistos<a class=headerlink href=#modelos-narmax-mistos title="Permanent link">&para;</a></h3> <p>Em algumas aplicações, o uso de uma única função base pode não fornecer uma descrição satisfatória da relação entre as variáveis de entrada (ou independentes) e a variável de saída (ou resposta). Para melhorar o desempenho do modelo, foi proposto o uso de uma combinação linear de um conjunto de funções não lineares para substituir as contrapartes lineares.</p> <p>Você pode obter isso no SysIdentPy utilizando ensembles de funções base. É possível construir um modelo de Fourier em que os termos possuem interações, bem como modelos com funções base mistas, usando termos expandidos por funções base polinomiais e de Fourier, ou qualquer outra função base disponível no pacote.</p> <blockquote> <p>No SysIdentPy, por enquanto, você só pode misturar uma função base com a função base polinomial. Você pode, por exemplo, misturar Fourier com Polynomial, mas não pode misturar Fourier com Bernstein.</p> </blockquote> <p>Para misturar as funções base Fourier ou Bernstein com Polynomial, basta definir <code>ensemble=True</code> na definição da função base:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Fourier</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Fourier</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>ensemble</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <h3 id=rede-neural-narx>Rede Neural NARX<a class=headerlink href=#rede-neural-narx title="Permanent link">&para;</a></h3> <p>Redes neurais são modelos compostos por camadas interconectadas de nós (neurônios) projetados para tarefas como classificação e regressão. Cada neurônio é uma unidade básica dentro dessas redes. <a href="https://www.researchgate.net/publication/303679484_Introducao_a_Identificacao_de_Sistemas?channel=doi&linkId=574cb16508ae82d2c6bc870f&showFulltext=true">Matematicamente</a>, um neurônio é representado por uma função <span class=arithmatex>\(f\)</span> que recebe um vetor de entrada <span class=arithmatex>\(\mathbf{x} = [x_1, x_2, \ldots, x_n]\)</span> e gera uma saída <span class=arithmatex>\(y\)</span>. Essa função normalmente envolve uma soma ponderada das entradas, um termo de bias opcional <span class=arithmatex>\(b\)</span> e uma função de ativação <span class=arithmatex>\(\phi\)</span>:</p> <div class=arithmatex>\[ y = \phi \left( \sum_{i=1}^{n} w_i x_i + b \right) \tag{2.31} \]</div> <p>em que <span class=arithmatex>\(\mathbf{w} = [w_1, w_2, \ldots, w_n]\)</span> são os pesos associados às entradas. A função de ativação <span class=arithmatex>\(\phi\)</span> introduz não linearidade no modelo, permitindo que a rede aprenda padrões complexos. Funções de ativação comuns incluem:</p> <ul> <li> <p><strong>Sigmoid</strong>: <span class=arithmatex>\(\phi(z) = \frac{1}{1 + e^{-z}}\)</span><br> Produz saídas entre 0 e 1, sendo útil para classificação binária.</p> </li> <li> <p><strong>Tangente Hiperbólica (tanh)</strong>: <span class=arithmatex>\(\phi(z) = \tanh(z) = \frac{e^z - e^{-z}}{e^z + e^{-z}}\)</span><br> Produz valores entre -1 e 1, frequentemente usada para centralizar os dados em torno de zero.</p> </li> <li> <p><strong>Rectified Linear Unit (ReLU)</strong>: <span class=arithmatex>\(\phi(z) = \max(0, z)\)</span><br> Retorna zero para valores negativos e o próprio valor de entrada para valores positivos, ajudando a mitigar o problema do gradiente desvanecente.</p> </li> <li> <p><strong>Leaky ReLU</strong>: <span class=arithmatex>\(\phi(z) = \max(0.01z, z)\)</span><br> Uma variação da ReLU que permite um gradiente pequeno e diferente de zero quando a entrada é negativa, abordando o problema de "neurônios mortos".</p> </li> <li> <p><strong>Softmax</strong>: <span class=arithmatex>\(\phi(z_i) = \frac{e^{z_i}}{\sum_{j} e^{z_j}}\)</span><br> Converte logits em probabilidades para classificação multiclasse, garantindo que as saídas somem 1.</p> </li> </ul> <p>Cada função de ativação possui vantagens específicas e é escolhida de acordo com as necessidades da rede neural e da tarefa em questão.</p> <p>Como mencionado, uma rede neural é composta por múltiplas camadas, cada uma contendo diversos neurônios. Sob esse aspecto, as camadas podem ser categorizadas em:</p> <ul> <li><strong>Camada de Entrada (Input Layer)</strong>: Camada que recebe os dados de entrada.</li> <li><strong>Camadas Escondidas (Hidden Layers)</strong>: Camadas intermediárias que processam as entradas por meio de conexões ponderadas e funções de ativação.</li> <li><strong>Camada de Saída (Output Layer)</strong>: Camada final que produz a saída da rede.</li> </ul> <blockquote> <p>A própria rede possui, portanto, uma arquitetura muito simples. A terminologia usada em redes neurais também é ligeiramente diferente da notação padrão, universal em Identificação de Sistemas e Estatística. Em vez de falar de parâmetros do modelo, fala-se em <em>pesos da rede</em> e, em vez de estimação, fala-se em <em>aprendizado</em>. Essa terminologia foi, sem dúvida, introduzida para fazer parecer que algo completamente novo estava sendo discutido, quando alguns dos problemas abordados são bastante tradicionais — <a href="https://www.amazon.com.br/s/ref=dp_byline_sr_book_1?ie=UTF8&field-author=Stephen+A+Billings&text=Stephen+A+Billings&sort=relevancerank&search-alias=stripbooks">Stephen A. Billings</a></p> </blockquote> <p>Note que a rede em si é simplesmente uma coleção de unidades de ativação não lineares <span class=arithmatex>\(\phi(\cdot)\)</span> que são funções estáticas simples. Não há dinâmica dentro da rede. Isso é aceitável para aplicações como reconhecimento de padrões, mas, para usar a rede em Identificação de Sistemas, são necessários atrasos de entrada e saída, que devem ser fornecidos como entradas, seja explicitamente, seja por meio de um procedimento recorrente. Nesse sentido, se definirmos <span class=arithmatex>\(\mathcal{F}\)</span> como uma função neural, podemos adaptá-la para criar um modelo neural NARX, transformando a arquitetura neural em uma arquitetura NARX. A rede neural NARX, porém, não é linear nos parâmetros, como os modelos NARMAX baseados em funções base. Assim, algoritmos como Orthogonal Least Squares não são adequados para estimar os pesos do modelo.</p> <p>O <strong>SysIdentPy</strong> oferece suporte a redes NARX em configuração Série-Paralelo (open-loop) para treinamento, o que torna o processo de treinamento mais simples. Em seguida, convertemos a rede NARX da configuração Série-Paralelo para a configuração Paralelo (closed-loop) para predição.</p> <p>A configuração Série-Paralelo nos permite usar <code>pytorch</code> diretamente para o treinamento, portanto o <strong>SysIdentPy</strong> utiliza <code>pytorch</code> no backend para redes neurais NARX, juntamente com métodos auxiliares disponíveis apenas no <strong>SysIdentPy</strong>.</p> <p>Um modelo neural NARX simples pode ser representado como uma rede neural Perceptron Multicamadas (MLP) com componente autorregressivo, junto com entradas atrasadas.</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/Pasted%20image%2020240710121246.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/Pasted%20image%2020240710121246.png?raw=true"></a></p> <blockquote> <p>Figura 10. Arquiteturas de rede neural em paralelo e série-paralelo para modelagem do sistema dinâmico <span class=arithmatex>\(\mathbf{y}[k]=\mathbf{F}(\mathbf{y}[k-1], \mathbf{y}[k-2], \mathbf{u}[k-1], \mathbf{u}[k-2])\)</span>. O operador de atraso <span class=arithmatex>\(q^{-1}\)</span> é tal que <span class=arithmatex>\(\mathbf{y}[k-1]=q^{-1} \mathbf{y}[k]\)</span>. Referência: <a href=https://arxiv.org/pdf/1706.07119>Antonio H. Ribeiro and Luis A. Aguirre</a></p> <p>Neural NARX não é o mesmo que Redes Neurais Recorrentes (RNN). Para mais detalhes, consulte o artigo <a href=https://link.springer.com/article/10.1007/s005210050005>A Note on the Equivalence of NARX and RNN</a>.</p> </blockquote> <p>Para construir uma rede Neural NARX no SysIdentPy, o usuário deve usar <code>pytorch</code>. Utilizamos <code>pytorch</code> para tornar flexível a definição da arquitetura da rede. No entanto, isso exige que o usuário tenha uma compreensão razoável de como redes neurais funcionam. Veja abaixo um script que mostra como construir um modelo Neural NARX simples no <strong>SysIdentPy</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=kn>from</span><span class=w> </span><span class=nn>torch</span><span class=w> </span><span class=kn>import</span> <span class=n>nn</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=kn>import</span><span class=w> </span><span class=nn>torch</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.neural_network</span><span class=w> </span><span class=kn>import</span> <span class=n>NARXNN</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.generate_data</span><span class=w> </span><span class=kn>import</span> <span class=n>get_siso_data</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.narmax_tools</span><span class=w> </span><span class=kn>import</span> <span class=n>regressor_code</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=c1># simulated data</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=n>x_train</span><span class=p>,</span> <span class=n>x_valid</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_valid</span> <span class=o>=</span> <span class=n>get_siso_data</span><span class=p>(</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>colored_noise</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>train_percentage</span><span class=o>=</span><span class=mi>80</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=p>)</span>
</code></pre></div> <p>O usuário pode utilizar <code>cuda</code> seguindo a mesma abordagem usada ao construir uma rede neural em <strong>pytorch</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=n>device</span> <span class=o>=</span> <span class=s2>&quot;cuda&quot;</span> <span class=k>if</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&quot;cpu&quot;</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Using </span><span class=si>{</span><span class=n>device</span><span class=si>}</span><span class=s2> device&quot;</span><span class=p>)</span>
</code></pre></div> <p>O usuário pode criar um objeto <code>NARXNN</code> e escolher o atraso máximo tanto da entrada quanto da saída para construir a matriz de regressors que servirá como entrada da rede. Além disso, é possível escolher a função de custo, o otimizador, os parâmetros opcionais do otimizador e o número de épocas.</p> <p>Como construímos esse recurso sobre o Pytorch, você pode escolher qualquer função de custo disponível em <code>torch.nn.functional</code>. <a href=https://pytorch.org/docs/stable/nn.functional.html#loss-functions>Clique aqui</a> para ver a lista de funções de custo disponíveis. Basta passar o nome da função de custo desejada.</p> <p>De forma análoga, você pode escolher qualquer otimizador disponível em <code>torch.optim</code>. <a href=https://pytorch.org/docs/stable/optim.html>Clique aqui</a> para ver a lista de otimizadores disponíveis.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=n>narx_net</span> <span class=o>=</span> <span class=n>NARXNN</span><span class=p>(</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>    <span class=n>loss_func</span><span class=o>=</span><span class=s2>&quot;mse_loss&quot;</span><span class=p>,</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>2000</span><span class=p>,</span>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>    <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>    <span class=n>optim_params</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>        <span class=s2>&quot;betas&quot;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.999</span><span class=p>),</span>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>        <span class=s2>&quot;eps&quot;</span><span class=p>:</span> <span class=mf>1e-05</span><span class=p>,</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a>    <span class=p>},</span>  <span class=c1># optional parameters of the optimizer</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a><span class=p>)</span>
</code></pre></div> <p>Como o modelo NARXNN foi definido com <span class=arithmatex>\(ylag=2\)</span>, <span class=arithmatex>\(xlag=2\)</span> e função base polinomial com <span class=arithmatex>\(degree=1\)</span>, obtemos uma matriz de regressors com 4 features. Precisamos do tamanho dessa matriz de regressors para construir as camadas da nossa rede. Nossos dados de entrada (<code>x_train</code>) possuem apenas uma feature, mas como estamos criando uma rede NARX, uma matriz de regressors é construída internamente com novas features baseadas em <code>xlag</code> e <code>ylag</code>.</p> <p>Se precisar de ajuda para descobrir quantos regressors são criados internamente, você pode usar a função <code>regressor_code</code> de <code>narmax_tools</code> e obter o tamanho do código de regressors gerado:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=n>n_regressors</span> <span class=o>=</span> <span class=n>count_model_regressors</span><span class=p>(</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>    <span class=n>x</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>    <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>    <span class=n>is_neural_narx</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=p>)</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=n>n_regressors</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=o>&gt;&gt;&gt;</span> <span class=mi>4</span>
</code></pre></div> <p>A configuração da sua rede segue exatamente o mesmo padrão de uma rede definida em Pytorch. O código a seguir representa nossa rede neural NARX:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>class</span><span class=w> </span><span class=nc>NARX</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>n_regressors</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Tanh</span><span class=p>()</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>xb</span><span class=p>):</span>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin</span><span class=p>(</span><span class=n>xb</span><span class=p>)</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>        <span class=k>return</span> <span class=n>z</span>
</code></pre></div> <p>O usuário deve passar a rede definida para o estimador <code>NARXNN</code> e configurar <code>cuda</code> se estiver disponível (ou se for necessário):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=n>narx_net</span><span class=o>.</span><span class=n>net</span> <span class=o>=</span> <span class=n>NARX</span><span class=p>()</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=k>if</span> <span class=n>device</span> <span class=o>==</span> <span class=s2>&quot;cuda&quot;</span><span class=p>:</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>    <span class=n>narx_net</span><span class=o>.</span><span class=n>net</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>device</span><span class=p>(</span><span class=s2>&quot;cuda&quot;</span><span class=p>))</span>
</code></pre></div> <p>Como temos funções <code>fit</code> (para treinamento) e <code>predict</code> para o NARMAX polinomial, criamos o mesmo padrão para a rede NARX. Assim, basta chamar <code>fit</code> e <code>predict</code> da seguinte forma:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=n>narx_net</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>,</span> <span class=n>X_test</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y_test</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>narx_net</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
</code></pre></div> <p>Se a configuração da rede for construída antes de chamar o <code>NARXNN</code>, basta passar o modelo para o <code>NARXNN</code> da seguinte forma:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=k>class</span><span class=w> </span><span class=nc>NARX</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>n_regressors</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Tanh</span><span class=p>()</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>xb</span><span class=p>):</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin</span><span class=p>(</span><span class=n>xb</span><span class=p>)</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin2</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lin3</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>        <span class=k>return</span> <span class=n>z</span>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=n>narx_net2</span> <span class=o>=</span> <span class=n>NARXNN</span><span class=p>(</span>
<a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a>    <span class=n>net</span><span class=o>=</span><span class=n>NARX</span><span class=p>(),</span>
<a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-37-22 name=__codelineno-37-22 href=#__codelineno-37-22></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-37-23 name=__codelineno-37-23 href=#__codelineno-37-23></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-37-24 name=__codelineno-37-24 href=#__codelineno-37-24></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-37-25 name=__codelineno-37-25 href=#__codelineno-37-25></a>    <span class=n>loss_func</span><span class=o>=</span><span class=s2>&quot;mse_loss&quot;</span><span class=p>,</span>
<a id=__codelineno-37-26 name=__codelineno-37-26 href=#__codelineno-37-26></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
<a id=__codelineno-37-27 name=__codelineno-37-27 href=#__codelineno-37-27></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>2000</span><span class=p>,</span>
<a id=__codelineno-37-28 name=__codelineno-37-28 href=#__codelineno-37-28></a>    <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-37-29 name=__codelineno-37-29 href=#__codelineno-37-29></a>    <span class=n>optim_params</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-37-30 name=__codelineno-37-30 href=#__codelineno-37-30></a>        <span class=s2>&quot;betas&quot;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.999</span><span class=p>),</span>
<a id=__codelineno-37-31 name=__codelineno-37-31 href=#__codelineno-37-31></a>        <span class=s2>&quot;eps&quot;</span><span class=p>:</span> <span class=mf>1e-05</span><span class=p>,</span>
<a id=__codelineno-37-32 name=__codelineno-37-32 href=#__codelineno-37-32></a>    <span class=p>},</span>  <span class=c1># optional parameters of the optimizer</span>
<a id=__codelineno-37-33 name=__codelineno-37-33 href=#__codelineno-37-33></a><span class=p>)</span>
<a id=__codelineno-37-34 name=__codelineno-37-34 href=#__codelineno-37-34></a>
<a id=__codelineno-37-35 name=__codelineno-37-35 href=#__codelineno-37-35></a><span class=n>narx_net2</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-37-36 name=__codelineno-37-36 href=#__codelineno-37-36></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>narx_net2</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
</code></pre></div> <h3 id=representacao-geral-de-conjunto-de-modelos>Representação Geral de Conjunto de Modelos<a class=headerlink href=#representacao-geral-de-conjunto-de-modelos title="Permanent link">&para;</a></h3> <p>Com base na ideia de transformar uma rede neural estática em um modelo neural NARX, podemos estender o método basicamente para qualquer classe de modelo. O SysIdentPy não tem como objetivo implementar todas as classes de modelos existentes na literatura. Entretanto, criamos uma funcionalidade que permite o uso de qualquer outro pacote de machine learning que siga a API <code>fit</code> e <code>predict</code> dentro do SysIdentPy para convertê-los em versões NARX desses modelos.</p> <p>Vamos tomar o XGBoost (eXtreme Gradient Boosting) como exemplo. XGBoost é uma classe de modelos bem conhecida para tarefas de regressão. No entanto, XGBoost não é uma escolha comum quando tratamos de identificação de sistemas dinâmicos, pois foi originalmente projetado para modelar sistemas estáticos. Com o SysIdentPy, você pode facilmente transformar XGBoost em um modelo NARX.</p> <p>O Scikit-learn é outro excelente exemplo. Você pode transformar qualquer modelo do Scikit-learn em um modelo NARX usando o SysIdentPy. Veremos essas aplicações em detalhes no Capítulo 11, mas o script abaixo ilustra como isso é simples:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.general_estimators</span><span class=w> </span><span class=kn>import</span> <span class=n>NARX</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>BayesianRidge</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=kn>import</span><span class=w> </span><span class=nn>xgboost</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>xgb</span>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Fourier</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=c1># define the scikit estimator</span>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=n>scikit_estimator</span> <span class=o>=</span> <span class=n>BayesianRidge</span><span class=p>()</span>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=c1># transform scikit_estimator into NARX model</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a><span class=n>gb_narx</span> <span class=o>=</span> <span class=n>NARX</span><span class=p>(</span>
<a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>    <span class=n>base_estimator</span><span class=o>=</span><span class=n>scikit_estimator</span><span class=p>,</span>
<a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-38-16 name=__codelineno-38-16 href=#__codelineno-38-16></a><span class=p>)</span>
<a id=__codelineno-38-17 name=__codelineno-38-17 href=#__codelineno-38-17></a>
<a id=__codelineno-38-18 name=__codelineno-38-18 href=#__codelineno-38-18></a><span class=n>gb_narx</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-38-19 name=__codelineno-38-19 href=#__codelineno-38-19></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>gb_narx</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-38-20 name=__codelineno-38-20 href=#__codelineno-38-20></a>
<a id=__codelineno-38-21 name=__codelineno-38-21 href=#__codelineno-38-21></a><span class=c1># XGboost examples</span>
<a id=__codelineno-38-22 name=__codelineno-38-22 href=#__codelineno-38-22></a><span class=n>xgb_estimator</span> <span class=o>=</span> <span class=n>xgb</span><span class=o>.</span><span class=n>XGBRegressor</span><span class=p>()</span>
<a id=__codelineno-38-23 name=__codelineno-38-23 href=#__codelineno-38-23></a><span class=n>xgb_narx</span> <span class=o>=</span> <span class=n>NARX</span><span class=p>(</span>
<a id=__codelineno-38-24 name=__codelineno-38-24 href=#__codelineno-38-24></a>    <span class=n>base_estimator</span><span class=o>=</span><span class=n>xgb_estimator</span><span class=p>,</span>
<a id=__codelineno-38-25 name=__codelineno-38-25 href=#__codelineno-38-25></a>    <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-26 name=__codelineno-38-26 href=#__codelineno-38-26></a>    <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-38-27 name=__codelineno-38-27 href=#__codelineno-38-27></a>    <span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-38-28 name=__codelineno-38-28 href=#__codelineno-38-28></a>    <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-38-29 name=__codelineno-38-29 href=#__codelineno-38-29></a><span class=p>)</span>
<a id=__codelineno-38-30 name=__codelineno-38-30 href=#__codelineno-38-30></a>
<a id=__codelineno-38-31 name=__codelineno-38-31 href=#__codelineno-38-31></a><span class=n>xgb_narx</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-38-32 name=__codelineno-38-32 href=#__codelineno-38-32></a><span class=n>yhat</span> <span class=o>=</span> <span class=n>xgb_narx</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=o>=</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>y_valid</span><span class=p>)</span>
</code></pre></div> <p>Você pode usar qualquer outro modelo simplesmente trocando a classe do modelo e passando-a para o parâmetro <code>base_estimator</code> na funcionalidade <code>NARX</code>.</p> <h3 id=modelos-mimo>Modelos MIMO<a class=headerlink href=#modelos-mimo title="Permanent link">&para;</a></h3> <p>Para manter as coisas simples, apenas modelos SISO foram apresentados nas seções anteriores. No entanto, modelos NARMAX podem ser estendidos de forma natural para o caso MIMO (<a href=https://www.tandfonline.com/doi/abs/10.1080/00207178908559767>Billings, S. A. and Chen, S. and Korenberg, M. J.</a>):</p> <div class=arithmatex>\[ \begin{align} \t y_{{_i}k}=&amp; F_{{_i}}^\ell \bigl[y_{{_1}k-1}, \dotsc, y_{{_1}k-n^i_{y{_1}}},\dotsc, y_{{_s}k-1}, \dotsc, y_{{_s}k-n^i_{y{_s}}}, x_{{_1}k-d}, \\ \t &amp; x_{{_1}k-d-1}, \dotsc, x_{{_1}k-d-n^i_{x{_1}}}, \dotsc, x_{{_r}k-d}, x_{{_r}k-d-1}, \dotsc, x_{{_r}k-d-n^i_{x{_r}}}\bigr] + \xi_{{_i}k}, \end{align} \tag{2.32} \]</div> <p>em que, para <span class=arithmatex>\(i = 1, \dotsc, s\)</span>, cada submodelo linear nos parâmetros pode ter diferentes atrasos máximos. Mais genericamente, considerando</p> <div class=arithmatex>\[ \begin{align} Y_k = \begin{bmatrix} y_{{_1}k} \\ y_{{_2}k} \\ \vdots \\ y_{{_s}k} \end{bmatrix}, X_k = \begin{bmatrix} x_{{_1}k} \\ x_{{_2}k} \\ \vdots \\ x_{{_r}k} \end{bmatrix}, \Xi_k = \begin{bmatrix} \xi_{{_1}k} \\ \xi_{{_2}k} \\ \vdots \\ \xi_{{_r}k} \end{bmatrix}, \end{align} \tag{2.33} \]</div> <p>o modelo MIMO pode ser denotado como</p> <div class=arithmatex>\[ \begin{equation} Y_k= F^\ell[Y_{k-1}, \dotsc, Y_{k-n_y},X_{k-d}, X_{k-d-1}, \dotsc, X_{k-d-n_x}] + \Xi_k, \end{equation} \tag{2.34} \]</div> <p>em que <span class=arithmatex>\(Xk ~= \{x_{{_1}k}, x_{{_2}k}, \dotsc, x_{{_r}k}\}\in \mathbb{R}^{n^i_{x{_r}}}\)</span> e <span class=arithmatex>\(Yk~= \{y_{{_1}k}, y_{{_2}k}, \dotsc, y_{{_s}k}\}\in \mathbb{R}^{n^i_{y{_s}}}\)</span>. O número de termos possíveis de um modelo MIMO NARX dado o <span class=arithmatex>\(i\)</span>-ésimo grau polinomial, <span class=arithmatex>\(\ell_i\)</span>, é:</p> <div class=arithmatex>\[ \begin{equation} n_{{_{m}}r} = \sum_{j = 0}^{\ell_i}n_{ij}, \end{equation} \tag{2.35} \]</div> <p>em que</p> <div class=arithmatex>\[ \begin{align} n_{ij} = \frac{ n_{ij-1} \biggl[ \sum\limits_{k=1}^{s} n^i_{y_k} + \sum\limits_{k=1}^{r} n^i_{x_k} + j - 1 \biggr]}{j}, \qquad n_{i0}=1, j=1, \dotsc, \ell_i. \end{align} \tag{2.36} \]</div> <p>Se <span class=arithmatex>\(s=1\)</span>, temos um modelo MISO que pode ser representado por uma única função polinomial. Além disso, um modelo MIMO pode ser decomposto em modelos MISO, como apresentado na figura a seguir:</p> <p><a class=glightbox href="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/mimo_split.png?raw=true" data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src="https://github.com/wilsonrljr/sysidentpy-data/blob/4085901293ba5ed5674bb2911ef4d1fa20f3438d/book/assets/mimo_split.png?raw=true"></a></p> <blockquote> <p>Figura 11. Um modelo MIMO decomposto em modelos MISO individuais.</p> <p>O SysIdentPy ainda não oferece suporte a modelos MIMO, apenas modelos MISO. Você pode, no entanto, decompor um sistema MIMO como apresentado na Figura 11 e usar o SysIdentPy para criar modelos para cada subsistema.</p> </blockquote> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Voltar ao topo </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Rodapé> <a href=../1-Introduction/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: Introdução"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Anterior </span> <div class=md-ellipsis> Introdução </div> </div> </a> <a href=../3-Parameter-Estimation/ class="md-footer__link md-footer__link--next" aria-label="Próximo: 3. Estimação de Parâmetros"> <div class=md-footer__title> <span class=md-footer__direction> Próximo </span> <div class=md-ellipsis> 3. Estimação de Parâmetros </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2016 - 2025 Wilson Rocha </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/wilsonrljr target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/sysidentpy/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> <a href=https://twitter.com/wilsonrljr target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}}</script> <script src=../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../../overrides/assets/js/katex.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js></script> <script src=../../../overrides/assets/vendor/js/prism.js></script> <script src=https://cdn.jsdelivr.net/npm/apexcharts></script> <script src=../../../overrides/assets/js/chart-example.js></script> <script src=../../../overrides/assets/js/scripts.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>