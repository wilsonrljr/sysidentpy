<!doctype html><html lang=pt class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="De Métodos Clássicos a Redes Neurais"><meta name=author content="Wilson Rocha"><link href=https://sysidentpy.org/pt/user-guide/API/entropic-regression/ rel=canonical><link href=../uofr/ rel=prev><link href=../neural-narx/ rel=next><link rel=icon href=../../../../en/assets/img/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.6"><title>Entropic Regression - SysIdentPy</title><link rel=stylesheet href=../../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../overrides/assets/css/extra.css><link rel=stylesheet href=../../../../overrides/assets/css/feature-grid.css><link rel=stylesheet href=../../../../overrides/assets/css/fontsize.css><link rel=stylesheet href=../../../../overrides/assets/css/card-container.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css><link rel=stylesheet href=../../../../overrides/assets/vendor/css/prism.css><link rel=stylesheet href=../../../../overrides/assets/css/style.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-16K3SQT164"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-16K3SQT164",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-16K3SQT164",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#documentation-for-entropic-regression class=md-skip> Ir para o conteúdo </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://github.com/sponsors/wilsonrljr> Sponsor <strong>SysIdentPy</strong> on <span class="twemoji github"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </span> <strong>Github</strong> </a> </div> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabeçalho> <a href=../../../ title=SysIdentPy class="md-header__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SysIdentPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Entropic Regression </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=orange aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label="Selecione o idioma"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=../../../../user-guide/API/entropic-regression/ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=./ hreflang=pt class=md-select__link> Português (Brasil) </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Buscar placeholder=Buscar autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Pesquisar> <a href=javascript:void(0) class="md-search__icon md-icon" title=Compartilhar aria-label=Compartilhar data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Limpar aria-label=Limpar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando a pesquisa </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Abas data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../ class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../getting-started/getting-started/ class=md-tabs__link> Getting started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../overview/ class=md-tabs__link> User guide </a> </li> <li class=md-tabs__item> <a href=../../../book/0-Preface/ class=md-tabs__link> Companion Book </a> </li> <li class=md-tabs__item> <a href=../../../developer-guide/contribute/ class=md-tabs__link> Developer guide </a> </li> <li class=md-tabs__item> <a href=../../../community-support/community-overview/ class=md-tabs__link> Community & Support </a> </li> <li class=md-tabs__item> <a href=../../../landing-page/about-us/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../changelog/changelog/ class=md-tabs__link> Changelog </a> </li> <li class=md-tabs__item> <a href=../../../landing-page/sponsor/ class=md-tabs__link> Sponsors </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navegação data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../ title=SysIdentPy class="md-nav__button md-logo" aria-label=SysIdentPy data-md-component=logo> <img src=../../../../overrides/assets/img/logotype-sysidentpy.svg alt=logo> </a> SysIdentPy </label> <div class=md-nav__source> <a href=https://github.com/wilsonrljr/sysidentpy title="Ir ao repositório" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> wilsonrljr/sysidentpy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../getting-started/getting-started/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../getting-started/quickstart-guide/ class=md-nav__link> <span class=md-ellipsis> Quickstart Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../getting-started/narmax-intro/ class=md-nav__link> <span class=md-ellipsis> Introduction to NARMAX </span> </a> </li> <li class=md-nav__item> <a href=../../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> User guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_1> <label class=md-nav__link for=__nav_3_2_1 id=__nav_3_2_1_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/your-first-model/ class=md-nav__link> <span class=md-ellipsis> Your First Model </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/model-with-multiple-inputs/ class=md-nav__link> <span class=md-ellipsis> Model with Multiple Inputs </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/basis-function-overview/ class=md-nav__link> <span class=md-ellipsis> Basis Function - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/information-criteria-overview/ class=md-nav__link> <span class=md-ellipsis> Information Criteria - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/general-NARX-models/ class=md-nav__link> <span class=md-ellipsis> General NARX Models - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/fourier-NARX-overview/ class=md-nav__link> <span class=md-ellipsis> Fourier NARX - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/aols-overview/ class=md-nav__link> <span class=md-ellipsis> AOLS - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/NFIR-model-overview/ class=md-nav__link> <span class=md-ellipsis> NFIR - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/importance-of-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Importance of Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2 id=__nav_3_2_2_label tabindex=0> <span class=md-ellipsis> Electrical and Mechanical Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Electrical and Mechanical Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/modeling-a-magneto-rheological-damper-device/ class=md-nav__link> <span class=md-ellipsis> Modeling a Magneto-Rheological Damper Device </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/silver-box-system/ class=md-nav__link> <span class=md-ellipsis> Silver Box System </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/coupled-eletric-device/ class=md-nav__link> <span class=md-ellipsis> Coupled Electric Device </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/wiener-hammerstein-system/ class=md-nav__link> <span class=md-ellipsis> Wiener-Hammerstein System </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/f-16-aircraft/ class=md-nav__link> <span class=md-ellipsis> F-16 Aircraft </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/f-16-aircraft-n-steps-ahead-prediction/ class=md-nav__link> <span class=md-ellipsis> F-16 Aircraft - N-Steps Ahead Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/electromechanical-system-identification-overview/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/electromechanical-system-identification-metamss/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/electromechanical-system-identification-entropic-regression/ class=md-nav__link> <span class=md-ellipsis> Electromechanical System Identification - Entropic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/multiobjective-parameter-estimation-overview/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation - Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3 id=__nav_3_2_3_label tabindex=0> <span class=md-ellipsis> Industrial and Corporate </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Industrial and Corporate </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/m4-benchmark/ class=md-nav__link> <span class=md-ellipsis> M4 Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/air-passenger-benchmark/ class=md-nav__link> <span class=md-ellipsis> Air Passenger Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/load-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> Load Forecasting Benchmark </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/PV-forecasting-benchmark/ class=md-nav__link> <span class=md-ellipsis> PV Forecasting Benchmark </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4 id=__nav_3_2_4_label tabindex=0> <span class=md-ellipsis> Chaotic Systems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Chaotic Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/chaotic-systems/lorenz-system/ class=md-nav__link> <span class=md-ellipsis> Lorenz System </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/chaotic-systems/logistic-map/ class=md-nav__link> <span class=md-ellipsis> Logistic Map </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> How to </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> How to </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../how-to/create-a-narx-neural-network/ class=md-nav__link> <span class=md-ellipsis> Create a Neural NARX Network </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/save-and-load-models/ class=md-nav__link> <span class=md-ellipsis> Save and Load Models </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/set-specific-lags/ class=md-nav__link> <span class=md-ellipsis> Set Specific Lags </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/simulating-existing-models/ class=md-nav__link> <span class=md-ellipsis> Simulating Existing Models </span> </a> </li> <li class=md-nav__item> <a href=../../how-to/use-extended-least-squares/ class=md-nav__link> <span class=md-ellipsis> Use Extended Least Squares </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4 checked> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=true> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../narmax-base/ class=md-nav__link> <span class=md-ellipsis> NARMAX Base </span> </a> </li> <li class=md-nav__item> <a href=../ofr-base/ class=md-nav__link> <span class=md-ellipsis> OFR Base </span> </a> </li> <li class=md-nav__item> <a href=../basis-function/ class=md-nav__link> <span class=md-ellipsis> Basis Functions </span> </a> </li> <li class=md-nav__item> <a href=../frols/ class=md-nav__link> <span class=md-ellipsis> FROLS </span> </a> </li> <li class=md-nav__item> <a href=../metamss/ class=md-nav__link> <span class=md-ellipsis> MetaMSS </span> </a> </li> <li class=md-nav__item> <a href=../aols/ class=md-nav__link> <span class=md-ellipsis> AOLS </span> </a> </li> <li class=md-nav__item> <a href=../uofr/ class=md-nav__link> <span class=md-ellipsis> UOFR </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Entropic Regression </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Entropic Regression </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression class=md-nav__link> <span class=md-ellipsis> entropic_regression </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER class=md-nav__link> <span class=md-ellipsis> ER </span> </a> <nav class=md-nav aria-label=ER> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.conditional_mutual_information class=md-nav__link> <span class=md-ellipsis> conditional_mutual_information </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_backward class=md-nav__link> <span class=md-ellipsis> entropic_regression_backward </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_forward class=md-nav__link> <span class=md-ellipsis> entropic_regression_forward </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.mutual_information_knn class=md-nav__link> <span class=md-ellipsis> mutual_information_knn </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.predict class=md-nav__link> <span class=md-ellipsis> predict </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.tolerance_estimator class=md-nav__link> <span class=md-ellipsis> tolerance_estimator </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../neural-narx/ class=md-nav__link> <span class=md-ellipsis> Neural NARX </span> </a> </li> <li class=md-nav__item> <a href=../general-estimators/ class=md-nav__link> <span class=md-ellipsis> General Estimators </span> </a> </li> <li class=md-nav__item> <a href=../parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../multiobjective-parameter-estimation/ class=md-nav__link> <span class=md-ellipsis> Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../simulation/ class=md-nav__link> <span class=md-ellipsis> Simulation </span> </a> </li> <li class=md-nav__item> <a href=../residues/ class=md-nav__link> <span class=md-ellipsis> Residual Analysis </span> </a> </li> <li class=md-nav__item> <a href=../metaheuristics/ class=md-nav__link> <span class=md-ellipsis> Metaheuristics </span> </a> </li> <li class=md-nav__item> <a href=../metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=../utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Companion Book </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Companion Book </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../book/0-Preface/ class=md-nav__link> <span class=md-ellipsis> Preface </span> </a> </li> <li class=md-nav__item> <a href=../../../book/0.1-Contents/ class=md-nav__link> <span class=md-ellipsis> Contents </span> </a> </li> <li class=md-nav__item> <a href=../../../book/1-Introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../book/2-NARMAX-Model-Representation/ class=md-nav__link> <span class=md-ellipsis> 2. NARMAX Model Representation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/3-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 3. Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/4-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 4. Model Structure Selection </span> </a> </li> <li class=md-nav__item> <a href=../../../book/5-Multiobjective-Parameter-Estimation/ class=md-nav__link> <span class=md-ellipsis> 5. Multiobjective Parameter Estimation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/6-Multiobjective-Model-Structure-Selection/ class=md-nav__link> <span class=md-ellipsis> 6. Multiobjective Model Structure Selection </span> </a> </li> <li class=md-nav__item> <a href=../../../book/7-NARX-Neural-Network/ class=md-nav__link> <span class=md-ellipsis> 7. NARX Neural Network </span> </a> </li> <li class=md-nav__item> <a href=../../../book/8-Severely-Nonlinear-System-Identification/ class=md-nav__link> <span class=md-ellipsis> 8. Severely Nonlinear System Identification </span> </a> </li> <li class=md-nav__item> <a href=../../../book/9-Validation/ class=md-nav__link> <span class=md-ellipsis> 9. Validation </span> </a> </li> <li class=md-nav__item> <a href=../../../book/10-Case-Studies/ class=md-nav__link> <span class=md-ellipsis> 10. Case Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Developer guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Developer guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../developer-guide/contribute/ class=md-nav__link> <span class=md-ellipsis> How to contribute </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../developer-guide/documentation-overview/ class=md-nav__link> <span class=md-ellipsis> Documentation Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../developer-guide/how-to-write-a-tutorial/ class=md-nav__link> <span class=md-ellipsis> How To Write a Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../../developer-guide/how-to-write-a-how-to-guide/ class=md-nav__link> <span class=md-ellipsis> How To Write a How-to Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../developer-guide/how-to-add-a-translation/ class=md-nav__link> <span class=md-ellipsis> How to Add a Translation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Community & Support </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Community & Support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../community-support/community-overview/ class=md-nav__link> <span class=md-ellipsis> community-overview </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/get-help/ class=md-nav__link> <span class=md-ellipsis> Get Help </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Meetups </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Meetups </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../community-support/meetups/ai-networks-meetup/ class=md-nav__link> <span class=md-ellipsis> AI Networks Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/nubank-meetup/ class=md-nav__link> <span class=md-ellipsis> Nubank Timeseries Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/nubank-meetup-open-source/ class=md-nav__link> <span class=md-ellipsis> Nubank Open Source Talk </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/gcom-meetup/ class=md-nav__link> <span class=md-ellipsis> GCoM Meetup </span> </a> </li> <li class=md-nav__item> <a href=../../../community-support/meetups/estatidados/ class=md-nav__link> <span class=md-ellipsis> Estatidados Meetup </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../landing-page/about-us/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../../../changelog/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../../landing-page/sponsor/ class=md-nav__link> <span class=md-ellipsis> Sponsors </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Índice> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Índice </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression class=md-nav__link> <span class=md-ellipsis> entropic_regression </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER class=md-nav__link> <span class=md-ellipsis> ER </span> </a> <nav class=md-nav aria-label=ER> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.conditional_mutual_information class=md-nav__link> <span class=md-ellipsis> conditional_mutual_information </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_backward class=md-nav__link> <span class=md-ellipsis> entropic_regression_backward </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_forward class=md-nav__link> <span class=md-ellipsis> entropic_regression_forward </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.fit class=md-nav__link> <span class=md-ellipsis> fit </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.mutual_information_knn class=md-nav__link> <span class=md-ellipsis> mutual_information_knn </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.predict class=md-nav__link> <span class=md-ellipsis> predict </span> </a> </li> <li class=md-nav__item> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.tolerance_estimator class=md-nav__link> <span class=md-ellipsis> tolerance_estimator </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/wilsonrljr/sysidentpy/edit/main/docs/en/user-guide/API/entropic-regression.md title=edit.link.title class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://raw.githubusercontent.com/wilsonrljr/sysidentpy/main/docs/en/user-guide/API/entropic-regression.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=documentation-for-entropic-regression>Documentation for <code>Entropic Regression</code><a class=headerlink href=#documentation-for-entropic-regression title="Permanent link">&para;</a></h1> <div class="doc doc-object doc-module"> <a id=sysidentpy.model_structure_selection.entropic_regression></a> <div class="doc doc-contents first"> <p>Build Polynomial NARMAX Models using the Entropic Regression algorithm.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=sysidentpy.model_structure_selection.entropic_regression.ER class="doc doc-heading"> <code>ER</code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="<code>sysidentpy.narmax_base.BaseMSS</code>" href=../../../../user-guide/API/narmax-base/#sysidentpy.narmax_base.BaseMSS>BaseMSS</a></code></p> <p>Entropic Regression Algorithm.</p> <p>Build Polynomial NARMAX model using the Entropic Regression Algorithm ([1]_). This algorithm is based on the Matlab package available on: <a href=https://github.com/almomaa/ERFit-Package>https://github.com/almomaa/ERFit-Package</a></p> <p>The NARMAX model is described as:</p> <div class=arithmatex>\[ y_k= F^\ell[y_{k-1}, \dotsc, y_{k-n_y},x_{k-d}, x_{k-d-1}, \dotsc, x_{k-d-n_x}, e_{k-1}, \dotsc, e_{k-n_e}] + e_k \]</div> <p>where <span class=arithmatex>\(n_y\in \mathbb{N}^*\)</span>, <span class=arithmatex>\(n_x \in \mathbb{N}\)</span>, <span class=arithmatex>\(n_e \in \mathbb{N}\)</span>, are the maximum lags for the system output and input respectively; <span class=arithmatex>\(x_k \in \mathbb{R}^{n_x}\)</span> is the system input and <span class=arithmatex>\(y_k \in \mathbb{R}^{n_y}\)</span> is the system output at discrete time <span class=arithmatex>\(k \in \mathbb{N}^n\)</span>; <span class=arithmatex>\(e_k \in \mathbb{R}^{n_e}\)</span> stands for uncertainties and possible noise at discrete time <span class=arithmatex>\(k\)</span>. In this case, <span class=arithmatex>\(\mathcal{F}^\ell\)</span> is some nonlinear function of the input and output regressors with nonlinearity degree <span class=arithmatex>\(\ell \in \mathbb{N}\)</span> and <span class=arithmatex>\(d\)</span> is a time delay typically set to <span class=arithmatex>\(d=1\)</span>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ylag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum lag of the output.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>xlag</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The maximum lag of the input.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>k</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The kth nearest neighbor to be used in estimation.</p> </div> </td> <td> <code>2</code> </td> </tr> <tr class=doc-section-item> <td> <code>q</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Quantile to compute, which must be between 0 and 1 inclusive.</p> </div> </td> <td> <code>0.99</code> </td> </tr> <tr class=doc-section-item> <td> <code>p</code> </td> <td> <code>default=inf,</code> </td> <td> <div class=doc-md-description> <p>Lp Measure of the distance in Knn estimator.</p> </div> </td> <td> <code><span title=numpy.inf>inf</span></code> </td> </tr> <tr class=doc-section-item> <td> <code>n_perm</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of permutation to be used in shuffle test</p> </div> </td> <td> <code>200</code> </td> </tr> <tr class=doc-section-item> <td> <code>estimator</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The parameter estimation method.</p> </div> </td> <td> <code>&#34;least_squares&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>skip_forward</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>To be used for difficult and highly uncertain problems. Skipping the forward selection results in more accurate solution, but comes with higher computational cost.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The user can choose "NARMAX", "NAR" and "NFIR" models</p> </div> </td> <td> <code>&#39;NARMAX&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.model_structure_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>ER</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.basis_function</span><span class=w> </span><span class=kn>import</span> <span class=n>Polynomial</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.display_results</span><span class=w> </span><span class=kn>import</span> <span class=n>results</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>root_relative_squared_error</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>sysidentpy.utils.generate_data</span><span class=w> </span><span class=kn>import</span> <span class=n>get_miso_data</span><span class=p>,</span> <span class=n>get_siso_data</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>x_train</span><span class=p>,</span> <span class=n>x_valid</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_valid</span> <span class=o>=</span> <span class=n>get_siso_data</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>                                                   <span class=n>colored_noise</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>                                                   <span class=n>sigma</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>                                                   <span class=n>train_percentage</span><span class=o>=</span><span class=mi>90</span><span class=p>)</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>&gt;&gt;&gt; </span><span class=n>basis_function</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>&gt;&gt;&gt; </span><span class=n>model</span> <span class=o>=</span> <span class=n>ER</span><span class=p>(</span><span class=n>basis_function</span><span class=o>=</span><span class=n>basis_function</span><span class=p>,</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=gp>... </span>             <span class=n>ylag</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>xlag</span><span class=o>=</span><span class=mi>2</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=gp>... </span>             <span class=p>)</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=gp>&gt;&gt;&gt; </span><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=gp>&gt;&gt;&gt; </span><span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_valid</span><span class=p>,</span> <span class=n>y_valid</span><span class=p>)</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=gp>&gt;&gt;&gt; </span><span class=n>rrse</span> <span class=o>=</span> <span class=n>root_relative_squared_error</span><span class=p>(</span><span class=n>y_valid</span><span class=p>,</span> <span class=n>yhat</span><span class=p>)</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>rrse</span><span class=p>)</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=go>0.001993603325328823</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=gp>&gt;&gt;&gt; </span><span class=n>r</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=gp>... </span>    <span class=n>results</span><span class=p>(</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=gp>... </span>        <span class=n>model</span><span class=o>.</span><span class=n>final_model</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>theta</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>err</span><span class=p>,</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=gp>... </span>        <span class=n>model</span><span class=o>.</span><span class=n>n_terms</span><span class=p>,</span> <span class=n>err_precision</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s1>&#39;sci&#39;</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=gp>... </span>        <span class=p>),</span>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=gp>... </span>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Regressors&#39;</span><span class=p>,</span> <span class=s1>&#39;Parameters&#39;</span><span class=p>,</span> <span class=s1>&#39;ERR&#39;</span><span class=p>])</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=gp>&gt;&gt;&gt; </span><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=go>    Regressors Parameters         ERR</span>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=go>0        x1(k-2)     0.9000       0.0</span>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=go>1         y(k-1)     0.1999       0.0</span>
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=go>2  x1(k-1)y(k-1)     0.1000       0.0</span>
</code></pre></div> <details class=references open> <summary>References</summary> <ul> <li>Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic Regression Beats the Outliers Problem in Nonlinear System Identification. Chaos 30, 013107 (2020).</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span>
<span class=normal><a href=#__codelineno-0-736>736</a></span>
<span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span>
<span class=normal><a href=#__codelineno-0-762>762</a></span>
<span class=normal><a href=#__codelineno-0-763>763</a></span>
<span class=normal><a href=#__codelineno-0-764>764</a></span>
<span class=normal><a href=#__codelineno-0-765>765</a></span>
<span class=normal><a href=#__codelineno-0-766>766</a></span>
<span class=normal><a href=#__codelineno-0-767>767</a></span>
<span class=normal><a href=#__codelineno-0-768>768</a></span>
<span class=normal><a href=#__codelineno-0-769>769</a></span>
<span class=normal><a href=#__codelineno-0-770>770</a></span>
<span class=normal><a href=#__codelineno-0-771>771</a></span>
<span class=normal><a href=#__codelineno-0-772>772</a></span>
<span class=normal><a href=#__codelineno-0-773>773</a></span>
<span class=normal><a href=#__codelineno-0-774>774</a></span>
<span class=normal><a href=#__codelineno-0-775>775</a></span>
<span class=normal><a href=#__codelineno-0-776>776</a></span>
<span class=normal><a href=#__codelineno-0-777>777</a></span>
<span class=normal><a href=#__codelineno-0-778>778</a></span>
<span class=normal><a href=#__codelineno-0-779>779</a></span>
<span class=normal><a href=#__codelineno-0-780>780</a></span>
<span class=normal><a href=#__codelineno-0-781>781</a></span>
<span class=normal><a href=#__codelineno-0-782>782</a></span>
<span class=normal><a href=#__codelineno-0-783>783</a></span>
<span class=normal><a href=#__codelineno-0-784>784</a></span>
<span class=normal><a href=#__codelineno-0-785>785</a></span>
<span class=normal><a href=#__codelineno-0-786>786</a></span>
<span class=normal><a href=#__codelineno-0-787>787</a></span>
<span class=normal><a href=#__codelineno-0-788>788</a></span>
<span class=normal><a href=#__codelineno-0-789>789</a></span>
<span class=normal><a href=#__codelineno-0-790>790</a></span>
<span class=normal><a href=#__codelineno-0-791>791</a></span>
<span class=normal><a href=#__codelineno-0-792>792</a></span>
<span class=normal><a href=#__codelineno-0-793>793</a></span>
<span class=normal><a href=#__codelineno-0-794>794</a></span>
<span class=normal><a href=#__codelineno-0-795>795</a></span>
<span class=normal><a href=#__codelineno-0-796>796</a></span>
<span class=normal><a href=#__codelineno-0-797>797</a></span>
<span class=normal><a href=#__codelineno-0-798>798</a></span>
<span class=normal><a href=#__codelineno-0-799>799</a></span>
<span class=normal><a href=#__codelineno-0-800>800</a></span>
<span class=normal><a href=#__codelineno-0-801>801</a></span>
<span class=normal><a href=#__codelineno-0-802>802</a></span>
<span class=normal><a href=#__codelineno-0-803>803</a></span>
<span class=normal><a href=#__codelineno-0-804>804</a></span>
<span class=normal><a href=#__codelineno-0-805>805</a></span>
<span class=normal><a href=#__codelineno-0-806>806</a></span>
<span class=normal><a href=#__codelineno-0-807>807</a></span>
<span class=normal><a href=#__codelineno-0-808>808</a></span>
<span class=normal><a href=#__codelineno-0-809>809</a></span>
<span class=normal><a href=#__codelineno-0-810>810</a></span>
<span class=normal><a href=#__codelineno-0-811>811</a></span>
<span class=normal><a href=#__codelineno-0-812>812</a></span>
<span class=normal><a href=#__codelineno-0-813>813</a></span>
<span class=normal><a href=#__codelineno-0-814>814</a></span>
<span class=normal><a href=#__codelineno-0-815>815</a></span>
<span class=normal><a href=#__codelineno-0-816>816</a></span>
<span class=normal><a href=#__codelineno-0-817>817</a></span>
<span class=normal><a href=#__codelineno-0-818>818</a></span>
<span class=normal><a href=#__codelineno-0-819>819</a></span>
<span class=normal><a href=#__codelineno-0-820>820</a></span>
<span class=normal><a href=#__codelineno-0-821>821</a></span>
<span class=normal><a href=#__codelineno-0-822>822</a></span>
<span class=normal><a href=#__codelineno-0-823>823</a></span>
<span class=normal><a href=#__codelineno-0-824>824</a></span>
<span class=normal><a href=#__codelineno-0-825>825</a></span>
<span class=normal><a href=#__codelineno-0-826>826</a></span>
<span class=normal><a href=#__codelineno-0-827>827</a></span>
<span class=normal><a href=#__codelineno-0-828>828</a></span>
<span class=normal><a href=#__codelineno-0-829>829</a></span>
<span class=normal><a href=#__codelineno-0-830>830</a></span>
<span class=normal><a href=#__codelineno-0-831>831</a></span>
<span class=normal><a href=#__codelineno-0-832>832</a></span>
<span class=normal><a href=#__codelineno-0-833>833</a></span>
<span class=normal><a href=#__codelineno-0-834>834</a></span>
<span class=normal><a href=#__codelineno-0-835>835</a></span>
<span class=normal><a href=#__codelineno-0-836>836</a></span>
<span class=normal><a href=#__codelineno-0-837>837</a></span>
<span class=normal><a href=#__codelineno-0-838>838</a></span>
<span class=normal><a href=#__codelineno-0-839>839</a></span>
<span class=normal><a href=#__codelineno-0-840>840</a></span>
<span class=normal><a href=#__codelineno-0-841>841</a></span>
<span class=normal><a href=#__codelineno-0-842>842</a></span>
<span class=normal><a href=#__codelineno-0-843>843</a></span>
<span class=normal><a href=#__codelineno-0-844>844</a></span>
<span class=normal><a href=#__codelineno-0-845>845</a></span>
<span class=normal><a href=#__codelineno-0-846>846</a></span>
<span class=normal><a href=#__codelineno-0-847>847</a></span>
<span class=normal><a href=#__codelineno-0-848>848</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=k>class</span><span class=w> </span><span class=nc>ER</span><span class=p>(</span><span class=n>BaseMSS</span><span class=p>):</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Entropic Regression Algorithm.</span>
<a id=__codelineno-0-62 name=__codelineno-0-62></a>
<a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>    Build Polynomial NARMAX model using the Entropic Regression Algorithm ([1]_).</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>    This algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>    https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>    The NARMAX model is described as:</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>    $$</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>        y_k= F^\ell[y_{k-1}, \dotsc, y_{k-n_y},x_{k-d}, x_{k-d-1}, \dotsc, x_{k-d-n_x},</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        e_{k-1}, \dotsc, e_{k-n_e}] + e_k</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>    $$</span>
<a id=__codelineno-0-73 name=__codelineno-0-73></a>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>    where $n_y\in \mathbb{N}^*$, $n_x \in \mathbb{N}$, $n_e \in \mathbb{N}$,</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>    are the maximum lags for the system output and input respectively;</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    $x_k \in \mathbb{R}^{n_x}$ is the system input and $y_k \in \mathbb{R}^{n_y}$</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>    is the system output at discrete time $k \in \mathbb{N}^n$;</span>
<a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>    $e_k \in \mathbb{R}^{n_e}$ stands for uncertainties and possible noise</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    at discrete time $k$. In this case, $\mathcal{F}^\ell$ is some nonlinear function</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>    of the input and output regressors with nonlinearity degree $\ell \in \mathbb{N}$</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>    and $d$ is a time delay typically set to $d=1$.</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>    ----------</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>    ylag : int, default=2</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>        The maximum lag of the output.</span>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>    xlag : int, default=2</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        The maximum lag of the input.</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    k : int, default=2</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>        The kth nearest neighbor to be used in estimation.</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>    q : float, default=0.99</span>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>        Quantile to compute, which must be between 0 and 1 inclusive.</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>    p : default=inf,</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=sd>        Lp Measure of the distance in Knn estimator.</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=sd>    n_perm: int, default=200</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a><span class=sd>        Number of permutation to be used in shuffle test</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>    estimator : str, default=&quot;least_squares&quot;</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>        The parameter estimation method.</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>    skip_forward = bool, default=False</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=sd>        To be used for difficult and highly uncertain problems.</span>
<a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=sd>        Skipping the forward selection results in more accurate solution,</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>        but comes with higher computational cost.</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=sd>    model_type: str, default=&quot;NARMAX&quot;</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=sd>        The user can choose &quot;NARMAX&quot;, &quot;NAR&quot; and &quot;NFIR&quot; models</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a>
<a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>    Examples</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=sd>    --------</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=sd>    &gt;&gt;&gt; import numpy as np</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>    &gt;&gt;&gt; from sysidentpy.model_structure_selection import ER</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>    &gt;&gt;&gt; from sysidentpy.basis_function import Polynomial</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>    &gt;&gt;&gt; from sysidentpy.utils.display_results import results</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>    &gt;&gt;&gt; from sysidentpy.metrics import root_relative_squared_error</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    &gt;&gt;&gt; from sysidentpy.utils.generate_data import get_miso_data, get_siso_data</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>    &gt;&gt;&gt; x_train, x_valid, y_train, y_valid = get_siso_data(n=1000,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>    ...                                                    colored_noise=True,</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>    ...                                                    sigma=0.2,</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>    ...                                                    train_percentage=90)</span>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>    &gt;&gt;&gt; basis_function = Polynomial(degree=2)</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>    &gt;&gt;&gt; model = ER(basis_function=basis_function,</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>    ...              ylag=2, xlag=2</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>    ...              )</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>    &gt;&gt;&gt; model.fit(x_train, y_train)</span>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>    &gt;&gt;&gt; yhat = model.predict(x_valid, y_valid)</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>    &gt;&gt;&gt; rrse = root_relative_squared_error(y_valid, yhat)</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>    &gt;&gt;&gt; print(rrse)</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    0.001993603325328823</span>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>    &gt;&gt;&gt; r = pd.DataFrame(</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>    ...     results(</span>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    ...         model.final_model, model.theta, model.err,</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>    ...         model.n_terms, err_precision=8, dtype=&#39;sci&#39;</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>    ...         ),</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>    ...     columns=[&#39;Regressors&#39;, &#39;Parameters&#39;, &#39;ERR&#39;])</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>    &gt;&gt;&gt; print(r)</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        Regressors Parameters         ERR</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>    0        x1(k-2)     0.9000       0.0</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>    1         y(k-1)     0.1999       0.0</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>    2  x1(k-1)y(k-1)     0.1000       0.0</span>
<a id=__codelineno-0-139 name=__codelineno-0-139></a>
<a id=__codelineno-0-140 name=__codelineno-0-140></a><span class=sd>    References</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>    ----------</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>    - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>        Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>        Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a>
<a id=__codelineno-0-154 name=__codelineno-0-154></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a>        <span class=o>*</span><span class=p>,</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=n>ylag</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>list</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a>        <span class=n>xlag</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>list</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a>        <span class=n>q</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.99</span><span class=p>,</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a>        <span class=n>estimator</span><span class=p>:</span> <span class=n>Estimators_Union</span> <span class=o>=</span> <span class=n>LeastSquares</span><span class=p>(),</span>
<a id=__codelineno-0-161 name=__codelineno-0-161></a>        <span class=n>h</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.01</span><span class=p>,</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a>        <span class=n>k</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a>        <span class=n>mutual_information_estimator</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;mutual_information_knn&quot;</span><span class=p>,</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a>        <span class=n>n_perm</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>200</span><span class=p>,</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=n>p</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>,</span>
<a id=__codelineno-0-166 name=__codelineno-0-166></a>        <span class=n>skip_forward</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a>        <span class=n>model_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span>
<a id=__codelineno-0-168 name=__codelineno-0-168></a>        <span class=n>basis_function</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Polynomial</span><span class=p>,</span> <span class=n>Fourier</span><span class=p>]</span> <span class=o>=</span> <span class=n>Polynomial</span><span class=p>(),</span>
<a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=n>random_state</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-170 name=__codelineno-0-170></a>    <span class=p>):</span>
<a id=__codelineno-0-171 name=__codelineno-0-171></a>        <span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span> <span class=o>=</span> <span class=n>basis_function</span>
<a id=__codelineno-0-172 name=__codelineno-0-172></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span> <span class=o>=</span> <span class=n>model_type</span>
<a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span> <span class=o>=</span> <span class=n>xlag</span>
<a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span> <span class=o>=</span> <span class=n>ylag</span>
<a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=bp>self</span><span class=o>.</span><span class=n>non_degree</span> <span class=o>=</span> <span class=n>basis_function</span><span class=o>.</span><span class=n>degree</span>
<a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_max_lag</span><span class=p>()</span>
<a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>=</span> <span class=n>k</span>
<a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=bp>self</span><span class=o>.</span><span class=n>estimator</span> <span class=o>=</span> <span class=n>estimator</span>
<a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=bp>self</span><span class=o>.</span><span class=n>q</span> <span class=o>=</span> <span class=n>q</span>
<a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=bp>self</span><span class=o>.</span><span class=n>h</span> <span class=o>=</span> <span class=n>h</span>
<a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span> <span class=o>=</span> <span class=n>mutual_information_estimator</span>
<a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span> <span class=o>=</span> <span class=n>n_perm</span>
<a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=bp>self</span><span class=o>.</span><span class=n>p</span> <span class=o>=</span> <span class=n>p</span>
<a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span> <span class=o>=</span> <span class=n>skip_forward</span>
<a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=bp>self</span><span class=o>.</span><span class=n>random_state</span> <span class=o>=</span> <span class=n>random_state</span>
<a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rng</span> <span class=o>=</span> <span class=n>check_random_state</span><span class=p>(</span><span class=n>random_state</span><span class=p>)</span>
<a id=__codelineno-0-187 name=__codelineno-0-187></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=bp>self</span><span class=o>.</span><span class=n>estimated_tolerance</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_terms</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=bp>self</span><span class=o>.</span><span class=n>err</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pivv</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_validate_params</span><span class=p>()</span>
<a id=__codelineno-0-197 name=__codelineno-0-197></a>
<a id=__codelineno-0-198 name=__codelineno-0-198></a>    <span class=k>def</span><span class=w> </span><span class=nf>_validate_params</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Validate input params.&quot;&quot;&quot;</span>
<a id=__codelineno-0-200 name=__codelineno-0-200></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-201 name=__codelineno-0-201></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;ylag must be integer and &gt; zero. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-202 name=__codelineno-0-202></a>
<a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-204 name=__codelineno-0-204></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;xlag must be integer and &gt; zero. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-205 name=__codelineno-0-205></a>
<a id=__codelineno-0-206 name=__codelineno-0-206></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
<a id=__codelineno-0-207 name=__codelineno-0-207></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;xlag must be integer and &gt; zero. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-208 name=__codelineno-0-208></a>
<a id=__codelineno-0-209 name=__codelineno-0-209></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
<a id=__codelineno-0-210 name=__codelineno-0-210></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;ylag must be integer and &gt; zero. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-211 name=__codelineno-0-211></a>
<a id=__codelineno-0-212 name=__codelineno-0-212></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-213 name=__codelineno-0-213></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;k must be integer and &gt; zero. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-214 name=__codelineno-0-214></a>
<a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-216 name=__codelineno-0-216></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;n_perm must be integer and &gt; zero. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-217 name=__codelineno-0-217></a>
<a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>q</span><span class=p>,</span> <span class=nb>float</span><span class=p>)</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>q</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>q</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-219 name=__codelineno-0-219></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-220 name=__codelineno-0-220></a>                <span class=sa>f</span><span class=s2>&quot;q must be float and must be between 0 and 1 inclusive. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>q</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=p>)</span>
<a id=__codelineno-0-222 name=__codelineno-0-222></a>
<a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
<a id=__codelineno-0-225 name=__codelineno-0-225></a>                <span class=sa>f</span><span class=s2>&quot;skip_forward must be False or True. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-226 name=__codelineno-0-226></a>            <span class=p>)</span>
<a id=__codelineno-0-227 name=__codelineno-0-227></a>
<a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span> <span class=s2>&quot;NAR&quot;</span><span class=p>,</span> <span class=s2>&quot;NFIR&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-229 name=__codelineno-0-229></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-230 name=__codelineno-0-230></a>                <span class=sa>f</span><span class=s2>&quot;model_type must be NARMAX, NAR or NFIR. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=p>)</span>
<a id=__codelineno-0-232 name=__codelineno-0-232></a>
<a id=__codelineno-0-233 name=__codelineno-0-233></a>    <span class=k>def</span><span class=w> </span><span class=nf>mutual_information_knn</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>):</span>
<a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Find the mutual information.</span>
<a id=__codelineno-0-235 name=__codelineno-0-235></a>
<a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>        Finds the mutual information between $x$ and $y$ given $z$.</span>
<a id=__codelineno-0-237 name=__codelineno-0-237></a>
<a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=sd>        This code is based on Matlab Entropic Regression package.</span>
<a id=__codelineno-0-239 name=__codelineno-0-239></a>
<a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        ----------</span>
<a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>            The source signal.</span>
<a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>        y_perm : ndarray of floats</span>
<a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>            The destination signal.</span>
<a id=__codelineno-0-246 name=__codelineno-0-246></a>
<a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>        Returns</span>
<a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>        -------</span>
<a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>        ksg_estimation : float</span>
<a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>            The conditioned mutual information.</span>
<a id=__codelineno-0-251 name=__codelineno-0-251></a>
<a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>        References</span>
<a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>        ----------</span>
<a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=sd>        - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-255 name=__codelineno-0-255></a><span class=sd>            Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>            Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-257 name=__codelineno-0-257></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-261 name=__codelineno-0-261></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-262 name=__codelineno-0-262></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-263 name=__codelineno-0-263></a>
<a id=__codelineno-0-264 name=__codelineno-0-264></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=n>joint_space</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-266 name=__codelineno-0-266></a>        <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
<a id=__codelineno-0-267 name=__codelineno-0-267></a>            <span class=n>cdist</span><span class=p>(</span><span class=n>joint_space</span><span class=p>,</span> <span class=n>joint_space</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=p>)</span>
<a id=__codelineno-0-269 name=__codelineno-0-269></a>        <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>smallest_distance</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=p>:],</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=n>idx</span><span class=p>]</span>
<a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>epsilon</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>smallest_distance_y</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
<a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=n>less_than_array_nx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_y</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=n>nx</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_nx</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-275 name=__codelineno-0-275></a>        <span class=n>smallest_distance_y_perm</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span><span class=n>y_perm</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
<a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=n>less_than_array_ny</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_y_perm</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-277 name=__codelineno-0-277></a>        <span class=n>ny</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_ny</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-278 name=__codelineno-0-278></a>        <span class=n>arr</span> <span class=o>=</span> <span class=n>psi</span><span class=p>(</span><span class=n>nx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>psi</span><span class=p>(</span><span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-280 name=__codelineno-0-280></a>            <span class=n>psi</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>)</span> <span class=o>+</span> <span class=n>psi</span><span class=p>(</span><span class=n>y</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>arr</span><span class=p>)])</span>
<a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=p>)</span>
<a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=k>return</span> <span class=n>ksg_estimation</span>
<a id=__codelineno-0-283 name=__codelineno-0-283></a>
<a id=__codelineno-0-284 name=__codelineno-0-284></a>    <span class=k>def</span><span class=w> </span><span class=nf>entropic_regression_backward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>piv</span><span class=p>):</span>
<a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Entropic Regression Backward Greedy Feature Elimination.</span>
<a id=__codelineno-0-286 name=__codelineno-0-286></a>
<a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>        This algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-288 name=__codelineno-0-288></a><span class=sd>        https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-289 name=__codelineno-0-289></a>
<a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=sd>        ----------</span>
<a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>        reg_matrix : ndarray of floats</span>
<a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>            The input data to be used in the prediction process.</span>
<a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>            The output data to be used in the prediction process.</span>
<a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=sd>        piv : ndarray of ints</span>
<a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>            The set of indices to investigate</span>
<a id=__codelineno-0-298 name=__codelineno-0-298></a>
<a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>        Returns</span>
<a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>        -------</span>
<a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>        piv : ndarray of ints</span>
<a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>            The set of remaining indices after the</span>
<a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>            Backward Greedy Feature Elimination.</span>
<a id=__codelineno-0-304 name=__codelineno-0-304></a>
<a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-306 name=__codelineno-0-306></a>        <span class=n>min_value</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
<a id=__codelineno-0-307 name=__codelineno-0-307></a>        <span class=n>piv</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>piv</span><span class=p>)</span>
<a id=__codelineno-0-308 name=__codelineno-0-308></a>        <span class=n>ix</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-309 name=__codelineno-0-309></a>        <span class=k>while</span> <span class=p>(</span><span class=n>min_value</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>piv</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-0-310 name=__codelineno-0-310></a>            <span class=n>initial_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>piv</span><span class=p>)),</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span>
<a id=__codelineno-0-311 name=__codelineno-0-311></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>initial_array</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
<a id=__codelineno-0-312 name=__codelineno-0-312></a>                <span class=k>if</span> <span class=n>piv</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[]:</span>  <span class=c1># if you want to keep any regressor</span>
<a id=__codelineno-0-313 name=__codelineno-0-313></a>                    <span class=n>rem</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>setdiff1d</span><span class=p>(</span><span class=n>piv</span><span class=p>,</span> <span class=n>piv</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
<a id=__codelineno-0-314 name=__codelineno-0-314></a>                    <span class=n>f1</span> <span class=o>=</span> <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>piv</span><span class=p>]</span> <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>piv</span><span class=p>])</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-315 name=__codelineno-0-315></a>                    <span class=n>f2</span> <span class=o>=</span> <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>rem</span><span class=p>]</span> <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>rem</span><span class=p>])</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-316 name=__codelineno-0-316></a>                    <span class=n>initial_array</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional_mutual_information</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)</span>
<a id=__codelineno-0-317 name=__codelineno-0-317></a>
<a id=__codelineno-0-318 name=__codelineno-0-318></a>            <span class=n>ix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmin</span><span class=p>(</span><span class=n>initial_array</span><span class=p>)</span>
<a id=__codelineno-0-319 name=__codelineno-0-319></a>            <span class=n>min_value</span> <span class=o>=</span> <span class=n>initial_array</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>ix</span><span class=p>]</span>
<a id=__codelineno-0-320 name=__codelineno-0-320></a>            <span class=n>piv</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>piv</span><span class=p>,</span> <span class=n>ix</span><span class=p>)</span>
<a id=__codelineno-0-321 name=__codelineno-0-321></a>
<a id=__codelineno-0-322 name=__codelineno-0-322></a>        <span class=k>return</span> <span class=n>piv</span>
<a id=__codelineno-0-323 name=__codelineno-0-323></a>
<a id=__codelineno-0-324 name=__codelineno-0-324></a>    <span class=k>def</span><span class=w> </span><span class=nf>entropic_regression_forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Entropic Regression Forward Greedy Feature Selection.</span>
<a id=__codelineno-0-326 name=__codelineno-0-326></a>
<a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>        This algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>        https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-329 name=__codelineno-0-329></a>
<a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>        ----------</span>
<a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>        reg_matrix : ndarray of floats</span>
<a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>            The input data to be used in the prediction process.</span>
<a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-335 name=__codelineno-0-335></a><span class=sd>            The output data to be used in the prediction process.</span>
<a id=__codelineno-0-336 name=__codelineno-0-336></a>
<a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>        Returns</span>
<a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>        -------</span>
<a id=__codelineno-0-339 name=__codelineno-0-339></a><span class=sd>        selected_terms : ndarray of ints</span>
<a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>            The set of selected regressors after the</span>
<a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>            Forward Greedy Feature Selection.</span>
<a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>        success : boolean</span>
<a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>            Indicate if the forward selection succeed.</span>
<a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>            If high degree of uncertainty is detected, and many parameters are</span>
<a id=__codelineno-0-345 name=__codelineno-0-345></a><span class=sd>            selected, the success flag will be set to false. Then, the</span>
<a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>            backward elimination will be applied for all indices.</span>
<a id=__codelineno-0-347 name=__codelineno-0-347></a>
<a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-349 name=__codelineno-0-349></a>        <span class=n>success</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-350 name=__codelineno-0-350></a>        <span class=n>ix</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-351 name=__codelineno-0-351></a>        <span class=n>selected_terms</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-352 name=__codelineno-0-352></a>        <span class=n>reg_matrix_columns</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])))</span>
<a id=__codelineno-0-353 name=__codelineno-0-353></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tolerance_estimator</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=n>ksg_max</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span><span class=p>)(</span>
<a id=__codelineno-0-355 name=__codelineno-0-355></a>            <span class=n>y</span><span class=p>,</span> <span class=n>reg_matrix</span> <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>)</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-356 name=__codelineno-0-356></a>        <span class=p>)</span>
<a id=__codelineno-0-357 name=__codelineno-0-357></a>        <span class=n>stop_criteria</span> <span class=o>=</span> <span class=kc>False</span>
<a id=__codelineno-0-358 name=__codelineno-0-358></a>        <span class=k>while</span> <span class=n>stop_criteria</span> <span class=ow>is</span> <span class=kc>False</span><span class=p>:</span>
<a id=__codelineno-0-359 name=__codelineno-0-359></a>            <span class=n>selected_terms</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ravel</span><span class=p>(</span>
<a id=__codelineno-0-360 name=__codelineno-0-360></a>                <span class=p>[</span><span class=o>*</span><span class=n>selected_terms</span><span class=p>,</span> <span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>ix</span><span class=p>]])]</span>
<a id=__codelineno-0-361 name=__codelineno-0-361></a>            <span class=p>)</span>
<a id=__codelineno-0-362 name=__codelineno-0-362></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-363 name=__codelineno-0-363></a>                <span class=n>ksg_local</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span><span class=p>)(</span>
<a id=__codelineno-0-364 name=__codelineno-0-364></a>                    <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-0-365 name=__codelineno-0-365></a>                    <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>]</span>
<a id=__codelineno-0-366 name=__codelineno-0-366></a>                    <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>])</span>
<a id=__codelineno-0-367 name=__codelineno-0-367></a>                    <span class=o>@</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-0-368 name=__codelineno-0-368></a>                <span class=p>)</span>
<a id=__codelineno-0-369 name=__codelineno-0-369></a>            <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-370 name=__codelineno-0-370></a>                <span class=n>ksg_local</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span><span class=p>)(</span>
<a id=__codelineno-0-371 name=__codelineno-0-371></a>                    <span class=n>y</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-372 name=__codelineno-0-372></a>                <span class=p>)</span>
<a id=__codelineno-0-373 name=__codelineno-0-373></a>
<a id=__codelineno-0-374 name=__codelineno-0-374></a>            <span class=n>initial_vector</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span>
<a id=__codelineno-0-375 name=__codelineno-0-375></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
<a id=__codelineno-0-376 name=__codelineno-0-376></a>                <span class=k>if</span> <span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>selected_terms</span><span class=p>:</span>
<a id=__codelineno-0-377 name=__codelineno-0-377></a>                    <span class=n>f1</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-378 name=__codelineno-0-378></a>                        <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=p>[</span><span class=o>*</span><span class=n>selected_terms</span><span class=p>,</span> <span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>i</span><span class=p>]]]</span>
<a id=__codelineno-0-379 name=__codelineno-0-379></a>                        <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=p>[</span><span class=o>*</span><span class=n>selected_terms</span><span class=p>,</span> <span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>i</span><span class=p>]]])</span>
<a id=__codelineno-0-380 name=__codelineno-0-380></a>                        <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-381 name=__codelineno-0-381></a>                    <span class=p>)</span>
<a id=__codelineno-0-382 name=__codelineno-0-382></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-383 name=__codelineno-0-383></a>                        <span class=n>f2</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-384 name=__codelineno-0-384></a>                            <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>]</span>
<a id=__codelineno-0-385 name=__codelineno-0-385></a>                            <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>])</span>
<a id=__codelineno-0-386 name=__codelineno-0-386></a>                            <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-387 name=__codelineno-0-387></a>                        <span class=p>)</span>
<a id=__codelineno-0-388 name=__codelineno-0-388></a>                    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-389 name=__codelineno-0-389></a>                        <span class=n>f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-390 name=__codelineno-0-390></a>                    <span class=n>vp_estimation</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional_mutual_information</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)</span>
<a id=__codelineno-0-391 name=__codelineno-0-391></a>                    <span class=n>initial_vector</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>vp_estimation</span>
<a id=__codelineno-0-392 name=__codelineno-0-392></a>                <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-393 name=__codelineno-0-393></a>                    <span class=k>continue</span>
<a id=__codelineno-0-394 name=__codelineno-0-394></a>
<a id=__codelineno-0-395 name=__codelineno-0-395></a>            <span class=n>ix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanargmax</span><span class=p>(</span><span class=n>initial_vector</span><span class=p>)</span>
<a id=__codelineno-0-396 name=__codelineno-0-396></a>            <span class=n>max_value</span> <span class=o>=</span> <span class=n>initial_vector</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>ix</span><span class=p>]</span>
<a id=__codelineno-0-397 name=__codelineno-0-397></a>
<a id=__codelineno-0-398 name=__codelineno-0-398></a>            <span class=k>if</span> <span class=p>(</span><span class=n>ksg_max</span> <span class=o>-</span> <span class=n>ksg_local</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>)</span> <span class=ow>or</span> <span class=p>(</span><span class=n>max_value</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>):</span>
<a id=__codelineno-0-399 name=__codelineno-0-399></a>                <span class=n>stop_criteria</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-400 name=__codelineno-0-400></a>            <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>([</span><span class=mi>8</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]):</span>
<a id=__codelineno-0-401 name=__codelineno-0-401></a>                <span class=n>success</span> <span class=o>=</span> <span class=kc>False</span>
<a id=__codelineno-0-402 name=__codelineno-0-402></a>                <span class=n>stop_criteria</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-403 name=__codelineno-0-403></a>
<a id=__codelineno-0-404 name=__codelineno-0-404></a>        <span class=k>return</span> <span class=n>selected_terms</span><span class=p>,</span> <span class=n>success</span>
<a id=__codelineno-0-405 name=__codelineno-0-405></a>
<a id=__codelineno-0-406 name=__codelineno-0-406></a>    <span class=k>def</span><span class=w> </span><span class=nf>conditional_mutual_information</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>):</span>
<a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Find the conditional mutual information.</span>
<a id=__codelineno-0-408 name=__codelineno-0-408></a>
<a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>        Finds the conditioned mutual information between $y$ and $f1$ given $f2$.</span>
<a id=__codelineno-0-410 name=__codelineno-0-410></a>
<a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>        This code is based on Matlab Entropic Regression package.</span>
<a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>        https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-413 name=__codelineno-0-413></a>
<a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>        ----------</span>
<a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-417 name=__codelineno-0-417></a><span class=sd>            The source signal.</span>
<a id=__codelineno-0-418 name=__codelineno-0-418></a><span class=sd>        f1 : ndarray of floats</span>
<a id=__codelineno-0-419 name=__codelineno-0-419></a><span class=sd>            The destination signal.</span>
<a id=__codelineno-0-420 name=__codelineno-0-420></a><span class=sd>        f2 : ndarray of floats</span>
<a id=__codelineno-0-421 name=__codelineno-0-421></a><span class=sd>            The condition set.</span>
<a id=__codelineno-0-422 name=__codelineno-0-422></a>
<a id=__codelineno-0-423 name=__codelineno-0-423></a><span class=sd>        Returns</span>
<a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=sd>        -------</span>
<a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=sd>        vp_estimation : float</span>
<a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>            The conditioned mutual information.</span>
<a id=__codelineno-0-427 name=__codelineno-0-427></a>
<a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>        References</span>
<a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>        ----------</span>
<a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>        - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-431 name=__codelineno-0-431></a><span class=sd>            Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=sd>            Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-436 name=__codelineno-0-436></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-437 name=__codelineno-0-437></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-438 name=__codelineno-0-438></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-439 name=__codelineno-0-439></a>
<a id=__codelineno-0-440 name=__codelineno-0-440></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-441 name=__codelineno-0-441></a>        <span class=n>joint_space</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-442 name=__codelineno-0-442></a>        <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
<a id=__codelineno-0-443 name=__codelineno-0-443></a>            <span class=n>cdist</span><span class=p>(</span><span class=n>joint_space</span><span class=p>,</span> <span class=n>joint_space</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<a id=__codelineno-0-444 name=__codelineno-0-444></a>        <span class=p>)</span>
<a id=__codelineno-0-445 name=__codelineno-0-445></a>        <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>smallest_distance</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=p>:],</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-446 name=__codelineno-0-446></a>        <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=n>idx</span><span class=p>]</span>
<a id=__codelineno-0-447 name=__codelineno-0-447></a>        <span class=n>epsilon</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-448 name=__codelineno-0-448></a>        <span class=c1># Find number of points from (y,f2), (f1,f2), and (f2,f2) that lies withing the</span>
<a id=__codelineno-0-449 name=__codelineno-0-449></a>        <span class=c1># k^{th} nearest neighbor distance from each point of themselves.</span>
<a id=__codelineno-0-450 name=__codelineno-0-450></a>        <span class=n>smallest_distance_y_f2</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span>
<a id=__codelineno-0-451 name=__codelineno-0-451></a>            <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-452 name=__codelineno-0-452></a>            <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-453 name=__codelineno-0-453></a>            <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span>
<a id=__codelineno-0-454 name=__codelineno-0-454></a>            <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a id=__codelineno-0-455 name=__codelineno-0-455></a>        <span class=p>)</span>
<a id=__codelineno-0-456 name=__codelineno-0-456></a>        <span class=n>less_than_array_y_f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_y_f2</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-457 name=__codelineno-0-457></a>        <span class=n>y_f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_y_f2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-458 name=__codelineno-0-458></a>
<a id=__codelineno-0-459 name=__codelineno-0-459></a>        <span class=n>smallest_distance_f1_f2</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span>
<a id=__codelineno-0-460 name=__codelineno-0-460></a>            <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-461 name=__codelineno-0-461></a>            <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-462 name=__codelineno-0-462></a>            <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span>
<a id=__codelineno-0-463 name=__codelineno-0-463></a>            <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a id=__codelineno-0-464 name=__codelineno-0-464></a>        <span class=p>)</span>
<a id=__codelineno-0-465 name=__codelineno-0-465></a>        <span class=n>less_than_array_f1_f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_f1_f2</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span>
<a id=__codelineno-0-466 name=__codelineno-0-466></a>            <span class=nb>int</span>
<a id=__codelineno-0-467 name=__codelineno-0-467></a>        <span class=p>)</span>
<a id=__codelineno-0-468 name=__codelineno-0-468></a>        <span class=n>f1_f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_f1_f2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-469 name=__codelineno-0-469></a>
<a id=__codelineno-0-470 name=__codelineno-0-470></a>        <span class=n>smallest_distance_f2</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span><span class=n>f2</span><span class=p>,</span> <span class=n>f2</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
<a id=__codelineno-0-471 name=__codelineno-0-471></a>        <span class=n>less_than_array_f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_f2</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-472 name=__codelineno-0-472></a>        <span class=n>f2_f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_f2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-473 name=__codelineno-0-473></a>        <span class=n>arr</span> <span class=o>=</span> <span class=n>psi</span><span class=p>(</span><span class=n>y_f2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>psi</span><span class=p>(</span><span class=n>f1_f2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=n>psi</span><span class=p>(</span><span class=n>f2_f2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-474 name=__codelineno-0-474></a>        <span class=n>vp_estimation</span> <span class=o>=</span> <span class=n>psi</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>arr</span><span class=p>)])</span>
<a id=__codelineno-0-475 name=__codelineno-0-475></a>        <span class=k>return</span> <span class=n>vp_estimation</span>
<a id=__codelineno-0-476 name=__codelineno-0-476></a>
<a id=__codelineno-0-477 name=__codelineno-0-477></a>    <span class=k>def</span><span class=w> </span><span class=nf>tolerance_estimator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-0-478 name=__codelineno-0-478></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Tolerance Estimation for mutual independence test.</span>
<a id=__codelineno-0-479 name=__codelineno-0-479></a>
<a id=__codelineno-0-480 name=__codelineno-0-480></a><span class=sd>        Finds the conditioned mutual information between $y$ and $f1$ given $f2$.</span>
<a id=__codelineno-0-481 name=__codelineno-0-481></a>
<a id=__codelineno-0-482 name=__codelineno-0-482></a><span class=sd>        This code is based on Matlab Entropic Regression package.</span>
<a id=__codelineno-0-483 name=__codelineno-0-483></a><span class=sd>        https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-484 name=__codelineno-0-484></a>
<a id=__codelineno-0-485 name=__codelineno-0-485></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-486 name=__codelineno-0-486></a><span class=sd>        ----------</span>
<a id=__codelineno-0-487 name=__codelineno-0-487></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=sd>            The source signal.</span>
<a id=__codelineno-0-489 name=__codelineno-0-489></a>
<a id=__codelineno-0-490 name=__codelineno-0-490></a><span class=sd>        Returns</span>
<a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=sd>        -------</span>
<a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>        tol : float</span>
<a id=__codelineno-0-493 name=__codelineno-0-493></a><span class=sd>            The tolerance value given q.</span>
<a id=__codelineno-0-494 name=__codelineno-0-494></a>
<a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>        References</span>
<a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>        ----------</span>
<a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>        - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=sd>            Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>            Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-502 name=__codelineno-0-502></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-503 name=__codelineno-0-503></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-506 name=__codelineno-0-506></a>
<a id=__codelineno-0-507 name=__codelineno-0-507></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-508 name=__codelineno-0-508></a>        <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-509 name=__codelineno-0-509></a>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span><span class=p>):</span>
<a id=__codelineno-0-510 name=__codelineno-0-510></a>            <span class=n>mutual_information_output</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span>
<a id=__codelineno-0-511 name=__codelineno-0-511></a>                <span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span>
<a id=__codelineno-0-512 name=__codelineno-0-512></a>            <span class=p>)(</span><span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>rng</span><span class=o>.</span><span class=n>permutation</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
<a id=__codelineno-0-513 name=__codelineno-0-513></a>
<a id=__codelineno-0-514 name=__codelineno-0-514></a>            <span class=n>ksg_estimation</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mutual_information_output</span><span class=p>)</span>
<a id=__codelineno-0-515 name=__codelineno-0-515></a>
<a id=__codelineno-0-516 name=__codelineno-0-516></a>        <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>)</span>
<a id=__codelineno-0-517 name=__codelineno-0-517></a>        <span class=n>tol</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>q</span><span class=p>)</span>
<a id=__codelineno-0-518 name=__codelineno-0-518></a>        <span class=k>return</span> <span class=n>tol</span>
<a id=__codelineno-0-519 name=__codelineno-0-519></a>
<a id=__codelineno-0-520 name=__codelineno-0-520></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Fit polynomial NARMAX model using AOLS algorithm.</span>
<a id=__codelineno-0-522 name=__codelineno-0-522></a>
<a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>        The &#39;fit&#39; function allows a friendly usage by the user.</span>
<a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>        Given two arguments, x and y, fit training data.</span>
<a id=__codelineno-0-525 name=__codelineno-0-525></a>
<a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>        The Entropic Regression algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>        https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-528 name=__codelineno-0-528></a>
<a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-530 name=__codelineno-0-530></a><span class=sd>        ----------</span>
<a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>        X : ndarray of floats</span>
<a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>            The input data to be used in the training process.</span>
<a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-534 name=__codelineno-0-534></a><span class=sd>            The output data to be used in the training process.</span>
<a id=__codelineno-0-535 name=__codelineno-0-535></a>
<a id=__codelineno-0-536 name=__codelineno-0-536></a><span class=sd>        Returns</span>
<a id=__codelineno-0-537 name=__codelineno-0-537></a><span class=sd>        -------</span>
<a id=__codelineno-0-538 name=__codelineno-0-538></a><span class=sd>        model : ndarray of int</span>
<a id=__codelineno-0-539 name=__codelineno-0-539></a><span class=sd>            The model code representation.</span>
<a id=__codelineno-0-540 name=__codelineno-0-540></a><span class=sd>        theta : array-like of shape = number_of_model_elements</span>
<a id=__codelineno-0-541 name=__codelineno-0-541></a><span class=sd>            The estimated parameters of the model.</span>
<a id=__codelineno-0-542 name=__codelineno-0-542></a>
<a id=__codelineno-0-543 name=__codelineno-0-543></a><span class=sd>        References</span>
<a id=__codelineno-0-544 name=__codelineno-0-544></a><span class=sd>        ----------</span>
<a id=__codelineno-0-545 name=__codelineno-0-545></a><span class=sd>        - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-546 name=__codelineno-0-546></a><span class=sd>            Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-547 name=__codelineno-0-547></a><span class=sd>            Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-548 name=__codelineno-0-548></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-549 name=__codelineno-0-549></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-550 name=__codelineno-0-550></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-551 name=__codelineno-0-551></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-552 name=__codelineno-0-552></a><span class=sd>        - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-553 name=__codelineno-0-553></a><span class=sd>            Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-554 name=__codelineno-0-554></a>
<a id=__codelineno-0-555 name=__codelineno-0-555></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-556 name=__codelineno-0-556></a>        <span class=k>if</span> <span class=n>y</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-557 name=__codelineno-0-557></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;y cannot be None&quot;</span><span class=p>)</span>
<a id=__codelineno-0-558 name=__codelineno-0-558></a>
<a id=__codelineno-0-559 name=__codelineno-0-559></a>        <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_max_lag</span><span class=p>()</span>
<a id=__codelineno-0-560 name=__codelineno-0-560></a>        <span class=n>lagged_data</span> <span class=o>=</span> <span class=n>build_lagged_matrix</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=p>)</span>
<a id=__codelineno-0-561 name=__codelineno-0-561></a>
<a id=__codelineno-0-562 name=__codelineno-0-562></a>        <span class=n>reg_matrix</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
<a id=__codelineno-0-563 name=__codelineno-0-563></a>            <span class=n>lagged_data</span><span class=p>,</span>
<a id=__codelineno-0-564 name=__codelineno-0-564></a>            <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>,</span>
<a id=__codelineno-0-565 name=__codelineno-0-565></a>            <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span>
<a id=__codelineno-0-566 name=__codelineno-0-566></a>            <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-0-567 name=__codelineno-0-567></a>            <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=p>,</span>
<a id=__codelineno-0-568 name=__codelineno-0-568></a>            <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-569 name=__codelineno-0-569></a>        <span class=p>)</span>
<a id=__codelineno-0-570 name=__codelineno-0-570></a>
<a id=__codelineno-0-571 name=__codelineno-0-571></a>        <span class=k>if</span> <span class=n>X</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-572 name=__codelineno-0-572></a>            <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=n>num_features</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-0-573 name=__codelineno-0-573></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-574 name=__codelineno-0-574></a>            <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># just to create the regressor space base</span>
<a id=__codelineno-0-575 name=__codelineno-0-575></a>
<a id=__codelineno-0-576 name=__codelineno-0-576></a>        <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_space</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span><span class=p>)</span>
<a id=__codelineno-0-577 name=__codelineno-0-577></a>
<a id=__codelineno-0-578 name=__codelineno-0-578></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>90</span><span class=p>:</span>
<a id=__codelineno-0-579 name=__codelineno-0-579></a>            <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span>
<a id=__codelineno-0-580 name=__codelineno-0-580></a>                <span class=s2>&quot;Given the higher number of possible regressors&quot;</span>
<a id=__codelineno-0-581 name=__codelineno-0-581></a>                <span class=sa>f</span><span class=s2>&quot; (</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>), the Entropic Regression&quot;</span>
<a id=__codelineno-0-582 name=__codelineno-0-582></a>                <span class=s2>&quot; algorithm may take long time to run. Consider reducing the&quot;</span>
<a id=__codelineno-0-583 name=__codelineno-0-583></a>                <span class=s2>&quot; number of regressors &quot;</span><span class=p>,</span>
<a id=__codelineno-0-584 name=__codelineno-0-584></a>                <span class=n>stacklevel</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-585 name=__codelineno-0-585></a>            <span class=p>)</span>
<a id=__codelineno-0-586 name=__codelineno-0-586></a>
<a id=__codelineno-0-587 name=__codelineno-0-587></a>        <span class=n>y_full</span> <span class=o>=</span> <span class=n>y</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-588 name=__codelineno-0-588></a>        <span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=p>:]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-589 name=__codelineno-0-589></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-590 name=__codelineno-0-590></a>        <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-591 name=__codelineno-0-591></a>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span><span class=p>):</span>
<a id=__codelineno-0-592 name=__codelineno-0-592></a>            <span class=n>mutual_information_output</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span>
<a id=__codelineno-0-593 name=__codelineno-0-593></a>                <span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span>
<a id=__codelineno-0-594 name=__codelineno-0-594></a>            <span class=p>)(</span><span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>rng</span><span class=o>.</span><span class=n>permutation</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
<a id=__codelineno-0-595 name=__codelineno-0-595></a>            <span class=n>ksg_estimation</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mutual_information_output</span><span class=p>)</span>
<a id=__codelineno-0-596 name=__codelineno-0-596></a>
<a id=__codelineno-0-597 name=__codelineno-0-597></a>        <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-598 name=__codelineno-0-598></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>q</span><span class=p>)</span>
<a id=__codelineno-0-599 name=__codelineno-0-599></a>        <span class=bp>self</span><span class=o>.</span><span class=n>estimated_tolerance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span>
<a id=__codelineno-0-600 name=__codelineno-0-600></a>        <span class=n>success</span> <span class=o>=</span> <span class=kc>False</span>
<a id=__codelineno-0-601 name=__codelineno-0-601></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span><span class=p>:</span>
<a id=__codelineno-0-602 name=__codelineno-0-602></a>            <span class=n>selected_terms</span><span class=p>,</span> <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>entropic_regression_forward</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-603 name=__codelineno-0-603></a>
<a id=__codelineno-0-604 name=__codelineno-0-604></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>success</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span><span class=p>:</span>
<a id=__codelineno-0-605 name=__codelineno-0-605></a>            <span class=n>selected_terms</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])))</span>
<a id=__codelineno-0-606 name=__codelineno-0-606></a>
<a id=__codelineno-0-607 name=__codelineno-0-607></a>        <span class=n>selected_terms_backward</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>entropic_regression_backward</span><span class=p>(</span>
<a id=__codelineno-0-608 name=__codelineno-0-608></a>            <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>],</span> <span class=n>y</span><span class=p>,</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)))</span>
<a id=__codelineno-0-609 name=__codelineno-0-609></a>        <span class=p>)</span>
<a id=__codelineno-0-610 name=__codelineno-0-610></a>
<a id=__codelineno-0-611 name=__codelineno-0-611></a>        <span class=n>final_model</span> <span class=o>=</span> <span class=n>selected_terms</span><span class=p>[</span><span class=n>selected_terms_backward</span><span class=p>]</span>
<a id=__codelineno-0-612 name=__codelineno-0-612></a>        <span class=c1># re-check for the constant term (add it to the estimated indices)</span>
<a id=__codelineno-0-613 name=__codelineno-0-613></a>        <span class=k>if</span> <span class=mi>0</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>final_model</span><span class=p>:</span>
<a id=__codelineno-0-614 name=__codelineno-0-614></a>            <span class=n>final_model</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=n>final_model</span><span class=p>])</span>
<a id=__codelineno-0-615 name=__codelineno-0-615></a>
<a id=__codelineno-0-616 name=__codelineno-0-616></a>        <span class=n>repetition</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>)</span>
<a id=__codelineno-0-617 name=__codelineno-0-617></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=p>,</span> <span class=n>Polynomial</span><span class=p>):</span>
<a id=__codelineno-0-618 name=__codelineno-0-618></a>            <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=p>[</span><span class=n>final_model</span><span class=p>,</span> <span class=p>:]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-619 name=__codelineno-0-619></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-620 name=__codelineno-0-620></a>            <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
<a id=__codelineno-0-621 name=__codelineno-0-621></a>                <span class=n>np</span><span class=o>.</span><span class=n>tile</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=p>[</span><span class=mi>1</span><span class=p>:,</span> <span class=p>:],</span> <span class=p>(</span><span class=n>repetition</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
<a id=__codelineno-0-622 name=__codelineno-0-622></a>                <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-623 name=__codelineno-0-623></a>            <span class=p>)</span>
<a id=__codelineno-0-624 name=__codelineno-0-624></a>            <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=p>[</span><span class=n>final_model</span><span class=p>,</span> <span class=p>:]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-625 name=__codelineno-0-625></a>
<a id=__codelineno-0-626 name=__codelineno-0-626></a>        <span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimator</span><span class=o>.</span><span class=n>optimize</span><span class=p>(</span>
<a id=__codelineno-0-627 name=__codelineno-0-627></a>            <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>final_model</span><span class=p>],</span> <span class=n>y_full</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=p>:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-628 name=__codelineno-0-628></a>        <span class=p>)</span>
<a id=__codelineno-0-629 name=__codelineno-0-629></a>        <span class=k>if</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>theta</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>h</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span>
<a id=__codelineno-0-630 name=__codelineno-0-630></a>            <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>1</span>
<a id=__codelineno-0-631 name=__codelineno-0-631></a>        <span class=p>):</span>
<a id=__codelineno-0-632 name=__codelineno-0-632></a>            <span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>theta</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-633 name=__codelineno-0-633></a>            <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span><span class=p>[</span><span class=mi>1</span><span class=p>:,</span> <span class=p>:]</span>
<a id=__codelineno-0-634 name=__codelineno-0-634></a>            <span class=n>final_model</span> <span class=o>=</span> <span class=n>final_model</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-635 name=__codelineno-0-635></a>
<a id=__codelineno-0-636 name=__codelineno-0-636></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_terms</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span>
<a id=__codelineno-0-637 name=__codelineno-0-637></a>            <span class=bp>self</span><span class=o>.</span><span class=n>theta</span>
<a id=__codelineno-0-638 name=__codelineno-0-638></a>        <span class=p>)</span>  <span class=c1># the number of terms we selected (necessary in the &#39;results&#39; methods)</span>
<a id=__codelineno-0-639 name=__codelineno-0-639></a>        <span class=bp>self</span><span class=o>.</span><span class=n>err</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_terms</span> <span class=o>*</span> <span class=p>[</span>
<a id=__codelineno-0-640 name=__codelineno-0-640></a>            <span class=mi>0</span>
<a id=__codelineno-0-641 name=__codelineno-0-641></a>        <span class=p>]</span>  <span class=c1># just to use the `results` method. Will be changed in next update.</span>
<a id=__codelineno-0-642 name=__codelineno-0-642></a>        <span class=bp>self</span><span class=o>.</span><span class=n>pivv</span> <span class=o>=</span> <span class=n>final_model</span>
<a id=__codelineno-0-643 name=__codelineno-0-643></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-0-644 name=__codelineno-0-644></a>
<a id=__codelineno-0-645 name=__codelineno-0-645></a>    <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-0-646 name=__codelineno-0-646></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return the predicted values given an input.</span>
<a id=__codelineno-0-647 name=__codelineno-0-647></a>
<a id=__codelineno-0-648 name=__codelineno-0-648></a><span class=sd>        The predict function allows a friendly usage by the user.</span>
<a id=__codelineno-0-649 name=__codelineno-0-649></a><span class=sd>        Given a previously trained model, predict values given</span>
<a id=__codelineno-0-650 name=__codelineno-0-650></a><span class=sd>        a new set of data.</span>
<a id=__codelineno-0-651 name=__codelineno-0-651></a>
<a id=__codelineno-0-652 name=__codelineno-0-652></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-653 name=__codelineno-0-653></a><span class=sd>        ----------</span>
<a id=__codelineno-0-654 name=__codelineno-0-654></a><span class=sd>        X : ndarray of floats</span>
<a id=__codelineno-0-655 name=__codelineno-0-655></a><span class=sd>            The input data to be used in the prediction process.</span>
<a id=__codelineno-0-656 name=__codelineno-0-656></a><span class=sd>        y : ndarray of floats</span>
<a id=__codelineno-0-657 name=__codelineno-0-657></a><span class=sd>            The output data to be used in the prediction process.</span>
<a id=__codelineno-0-658 name=__codelineno-0-658></a><span class=sd>        steps_ahead : int (default = None)</span>
<a id=__codelineno-0-659 name=__codelineno-0-659></a><span class=sd>            The user can use free run simulation, one-step ahead prediction</span>
<a id=__codelineno-0-660 name=__codelineno-0-660></a><span class=sd>            and n-step ahead prediction.</span>
<a id=__codelineno-0-661 name=__codelineno-0-661></a><span class=sd>        forecast_horizon : int, default=None</span>
<a id=__codelineno-0-662 name=__codelineno-0-662></a><span class=sd>            The number of predictions over the time.</span>
<a id=__codelineno-0-663 name=__codelineno-0-663></a>
<a id=__codelineno-0-664 name=__codelineno-0-664></a><span class=sd>        Returns</span>
<a id=__codelineno-0-665 name=__codelineno-0-665></a><span class=sd>        -------</span>
<a id=__codelineno-0-666 name=__codelineno-0-666></a><span class=sd>        yhat : ndarray of floats</span>
<a id=__codelineno-0-667 name=__codelineno-0-667></a><span class=sd>            The predicted values of the model.</span>
<a id=__codelineno-0-668 name=__codelineno-0-668></a>
<a id=__codelineno-0-669 name=__codelineno-0-669></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-670 name=__codelineno-0-670></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=p>,</span> <span class=n>Polynomial</span><span class=p>):</span>
<a id=__codelineno-0-671 name=__codelineno-0-671></a>            <span class=k>if</span> <span class=n>steps_ahead</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-672 name=__codelineno-0-672></a>                <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-673 name=__codelineno-0-673></a>                <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-674 name=__codelineno-0-674></a>                <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-675 name=__codelineno-0-675></a>            <span class=k>if</span> <span class=n>steps_ahead</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-676 name=__codelineno-0-676></a>                <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_one_step_ahead_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-677 name=__codelineno-0-677></a>                <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-678 name=__codelineno-0-678></a>                <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-679 name=__codelineno-0-679></a>
<a id=__codelineno-0-680 name=__codelineno-0-680></a>            <span class=n>check_positive_int</span><span class=p>(</span><span class=n>steps_ahead</span><span class=p>,</span> <span class=s2>&quot;steps_ahead&quot;</span><span class=p>)</span>
<a id=__codelineno-0-681 name=__codelineno-0-681></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_n_step_ahead_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=n>steps_ahead</span><span class=p>)</span>
<a id=__codelineno-0-682 name=__codelineno-0-682></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-683 name=__codelineno-0-683></a>            <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-684 name=__codelineno-0-684></a>
<a id=__codelineno-0-685 name=__codelineno-0-685></a>        <span class=k>if</span> <span class=n>steps_ahead</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-686 name=__codelineno-0-686></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_basis_function_predict</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-687 name=__codelineno-0-687></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-688 name=__codelineno-0-688></a>            <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-689 name=__codelineno-0-689></a>        <span class=k>if</span> <span class=n>steps_ahead</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-690 name=__codelineno-0-690></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_one_step_ahead_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-691 name=__codelineno-0-691></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-692 name=__codelineno-0-692></a>            <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-693 name=__codelineno-0-693></a>
<a id=__codelineno-0-694 name=__codelineno-0-694></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_basis_function_n_step_prediction</span><span class=p>(</span>
<a id=__codelineno-0-695 name=__codelineno-0-695></a>            <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=n>steps_ahead</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=n>forecast_horizon</span>
<a id=__codelineno-0-696 name=__codelineno-0-696></a>        <span class=p>)</span>
<a id=__codelineno-0-697 name=__codelineno-0-697></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-698 name=__codelineno-0-698></a>        <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-699 name=__codelineno-0-699></a>
<a id=__codelineno-0-700 name=__codelineno-0-700></a>    <span class=k>def</span><span class=w> </span><span class=nf>_one_step_ahead_prediction</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-0-701 name=__codelineno-0-701></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform the 1-step-ahead prediction of a model.</span>
<a id=__codelineno-0-702 name=__codelineno-0-702></a>
<a id=__codelineno-0-703 name=__codelineno-0-703></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-704 name=__codelineno-0-704></a><span class=sd>        ----------</span>
<a id=__codelineno-0-705 name=__codelineno-0-705></a><span class=sd>        y : array-like of shape = max_lag</span>
<a id=__codelineno-0-706 name=__codelineno-0-706></a><span class=sd>            Initial conditions values of the model</span>
<a id=__codelineno-0-707 name=__codelineno-0-707></a><span class=sd>            to start recursive process.</span>
<a id=__codelineno-0-708 name=__codelineno-0-708></a><span class=sd>        x : ndarray of floats of shape = n_samples</span>
<a id=__codelineno-0-709 name=__codelineno-0-709></a><span class=sd>            Vector with input values to be used in model simulation.</span>
<a id=__codelineno-0-710 name=__codelineno-0-710></a>
<a id=__codelineno-0-711 name=__codelineno-0-711></a><span class=sd>        Returns</span>
<a id=__codelineno-0-712 name=__codelineno-0-712></a><span class=sd>        -------</span>
<a id=__codelineno-0-713 name=__codelineno-0-713></a><span class=sd>        yhat : ndarray of floats</span>
<a id=__codelineno-0-714 name=__codelineno-0-714></a><span class=sd>               The 1-step-ahead predicted values of the model.</span>
<a id=__codelineno-0-715 name=__codelineno-0-715></a>
<a id=__codelineno-0-716 name=__codelineno-0-716></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-717 name=__codelineno-0-717></a>        <span class=n>lagged_data</span> <span class=o>=</span> <span class=n>build_lagged_matrix</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=p>)</span>
<a id=__codelineno-0-718 name=__codelineno-0-718></a>
<a id=__codelineno-0-719 name=__codelineno-0-719></a>        <span class=n>x_base</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span>
<a id=__codelineno-0-720 name=__codelineno-0-720></a>            <span class=n>lagged_data</span><span class=p>,</span>
<a id=__codelineno-0-721 name=__codelineno-0-721></a>            <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>,</span>
<a id=__codelineno-0-722 name=__codelineno-0-722></a>            <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span>
<a id=__codelineno-0-723 name=__codelineno-0-723></a>            <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-0-724 name=__codelineno-0-724></a>            <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=p>,</span>
<a id=__codelineno-0-725 name=__codelineno-0-725></a>            <span class=n>predefined_regressors</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>pivv</span><span class=p>[:</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>final_model</span><span class=p>)],</span>
<a id=__codelineno-0-726 name=__codelineno-0-726></a>        <span class=p>)</span>
<a id=__codelineno-0-727 name=__codelineno-0-727></a>
<a id=__codelineno-0-728 name=__codelineno-0-728></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_one_step_ahead_prediction</span><span class=p>(</span><span class=n>x_base</span><span class=p>)</span>
<a id=__codelineno-0-729 name=__codelineno-0-729></a>        <span class=k>return</span> <span class=n>yhat</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-730 name=__codelineno-0-730></a>
<a id=__codelineno-0-731 name=__codelineno-0-731></a>    <span class=k>def</span><span class=w> </span><span class=nf>_n_step_ahead_prediction</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=p>):</span>
<a id=__codelineno-0-732 name=__codelineno-0-732></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform the n-steps-ahead prediction of a model.</span>
<a id=__codelineno-0-733 name=__codelineno-0-733></a>
<a id=__codelineno-0-734 name=__codelineno-0-734></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-735 name=__codelineno-0-735></a><span class=sd>        ----------</span>
<a id=__codelineno-0-736 name=__codelineno-0-736></a><span class=sd>        y : array-like of shape = max_lag</span>
<a id=__codelineno-0-737 name=__codelineno-0-737></a><span class=sd>            Initial conditions values of the model</span>
<a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=sd>            to start recursive process.</span>
<a id=__codelineno-0-739 name=__codelineno-0-739></a><span class=sd>        x : ndarray of floats of shape = n_samples</span>
<a id=__codelineno-0-740 name=__codelineno-0-740></a><span class=sd>            Vector with input values to be used in model simulation.</span>
<a id=__codelineno-0-741 name=__codelineno-0-741></a>
<a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=sd>        Returns</span>
<a id=__codelineno-0-743 name=__codelineno-0-743></a><span class=sd>        -------</span>
<a id=__codelineno-0-744 name=__codelineno-0-744></a><span class=sd>        yhat : ndarray of floats</span>
<a id=__codelineno-0-745 name=__codelineno-0-745></a><span class=sd>               The n-steps-ahead predicted values of the model.</span>
<a id=__codelineno-0-746 name=__codelineno-0-746></a>
<a id=__codelineno-0-747 name=__codelineno-0-747></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-748 name=__codelineno-0-748></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_n_step_ahead_prediction</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=p>)</span>
<a id=__codelineno-0-749 name=__codelineno-0-749></a>        <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-750 name=__codelineno-0-750></a>
<a id=__codelineno-0-751 name=__codelineno-0-751></a>    <span class=k>def</span><span class=w> </span><span class=nf>_model_prediction</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-0-752 name=__codelineno-0-752></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform the infinity steps-ahead simulation of a model.</span>
<a id=__codelineno-0-753 name=__codelineno-0-753></a>
<a id=__codelineno-0-754 name=__codelineno-0-754></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=sd>        ----------</span>
<a id=__codelineno-0-756 name=__codelineno-0-756></a><span class=sd>        y_initial : array-like of shape = max_lag</span>
<a id=__codelineno-0-757 name=__codelineno-0-757></a><span class=sd>            Number of initial conditions values of output</span>
<a id=__codelineno-0-758 name=__codelineno-0-758></a><span class=sd>            to start recursive process.</span>
<a id=__codelineno-0-759 name=__codelineno-0-759></a><span class=sd>        x : ndarray of floats of shape = n_samples</span>
<a id=__codelineno-0-760 name=__codelineno-0-760></a><span class=sd>            Vector with input values to be used in model simulation.</span>
<a id=__codelineno-0-761 name=__codelineno-0-761></a>
<a id=__codelineno-0-762 name=__codelineno-0-762></a><span class=sd>        Returns</span>
<a id=__codelineno-0-763 name=__codelineno-0-763></a><span class=sd>        -------</span>
<a id=__codelineno-0-764 name=__codelineno-0-764></a><span class=sd>        yhat : ndarray of floats</span>
<a id=__codelineno-0-765 name=__codelineno-0-765></a><span class=sd>               The predicted values of the model.</span>
<a id=__codelineno-0-766 name=__codelineno-0-766></a>
<a id=__codelineno-0-767 name=__codelineno-0-767></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-768 name=__codelineno-0-768></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;NARMAX&quot;</span><span class=p>,</span> <span class=s2>&quot;NAR&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-769 name=__codelineno-0-769></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_narmax_predict</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-770 name=__codelineno-0-770></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span> <span class=o>==</span> <span class=s2>&quot;NFIR&quot;</span><span class=p>:</span>
<a id=__codelineno-0-771 name=__codelineno-0-771></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nfir_predict</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>)</span>
<a id=__codelineno-0-772 name=__codelineno-0-772></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-773 name=__codelineno-0-773></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-774 name=__codelineno-0-774></a>                <span class=sa>f</span><span class=s2>&quot;model_type must be NARMAX, NAR or NFIR. Got </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-775 name=__codelineno-0-775></a>            <span class=p>)</span>
<a id=__codelineno-0-776 name=__codelineno-0-776></a>
<a id=__codelineno-0-777 name=__codelineno-0-777></a>    <span class=k>def</span><span class=w> </span><span class=nf>_narmax_predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=p>):</span>
<a id=__codelineno-0-778 name=__codelineno-0-778></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>y_initial</span><span class=p>)</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>:</span>
<a id=__codelineno-0-779 name=__codelineno-0-779></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-780 name=__codelineno-0-780></a>                <span class=s2>&quot;Insufficient initial condition elements! Expected at least&quot;</span>
<a id=__codelineno-0-781 name=__codelineno-0-781></a>                <span class=sa>f</span><span class=s2>&quot; </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=si>}</span><span class=s2> elements.&quot;</span>
<a id=__codelineno-0-782 name=__codelineno-0-782></a>            <span class=p>)</span>
<a id=__codelineno-0-783 name=__codelineno-0-783></a>
<a id=__codelineno-0-784 name=__codelineno-0-784></a>        <span class=k>if</span> <span class=n>x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-785 name=__codelineno-0-785></a>            <span class=n>forecast_horizon</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-786 name=__codelineno-0-786></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-787 name=__codelineno-0-787></a>            <span class=n>forecast_horizon</span> <span class=o>=</span> <span class=n>forecast_horizon</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span>
<a id=__codelineno-0-788 name=__codelineno-0-788></a>
<a id=__codelineno-0-789 name=__codelineno-0-789></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span> <span class=o>==</span> <span class=s2>&quot;NAR&quot;</span><span class=p>:</span>
<a id=__codelineno-0-790 name=__codelineno-0-790></a>            <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-791 name=__codelineno-0-791></a>
<a id=__codelineno-0-792 name=__codelineno-0-792></a>        <span class=n>y_output</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_narmax_predict</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-793 name=__codelineno-0-793></a>        <span class=k>return</span> <span class=n>y_output</span>
<a id=__codelineno-0-794 name=__codelineno-0-794></a>
<a id=__codelineno-0-795 name=__codelineno-0-795></a>    <span class=k>def</span><span class=w> </span><span class=nf>_nfir_predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>):</span>
<a id=__codelineno-0-796 name=__codelineno-0-796></a>        <span class=n>y_output</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_nfir_predict</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>)</span>
<a id=__codelineno-0-797 name=__codelineno-0-797></a>        <span class=k>return</span> <span class=n>y_output</span>
<a id=__codelineno-0-798 name=__codelineno-0-798></a>
<a id=__codelineno-0-799 name=__codelineno-0-799></a>    <span class=k>def</span><span class=w> </span><span class=nf>_basis_function_predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-0-800 name=__codelineno-0-800></a>        <span class=k>if</span> <span class=n>x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-801 name=__codelineno-0-801></a>            <span class=n>forecast_horizon</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-802 name=__codelineno-0-802></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-803 name=__codelineno-0-803></a>            <span class=n>forecast_horizon</span> <span class=o>=</span> <span class=n>forecast_horizon</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span>
<a id=__codelineno-0-804 name=__codelineno-0-804></a>
<a id=__codelineno-0-805 name=__codelineno-0-805></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span> <span class=o>==</span> <span class=s2>&quot;NAR&quot;</span><span class=p>:</span>
<a id=__codelineno-0-806 name=__codelineno-0-806></a>            <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-807 name=__codelineno-0-807></a>
<a id=__codelineno-0-808 name=__codelineno-0-808></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_basis_function_predict</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y_initial</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-809 name=__codelineno-0-809></a>        <span class=k>return</span> <span class=n>yhat</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-810 name=__codelineno-0-810></a>
<a id=__codelineno-0-811 name=__codelineno-0-811></a>    <span class=k>def</span><span class=w> </span><span class=nf>_basis_function_n_step_prediction</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=p>):</span>
<a id=__codelineno-0-812 name=__codelineno-0-812></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform the n-steps-ahead prediction of a model.</span>
<a id=__codelineno-0-813 name=__codelineno-0-813></a>
<a id=__codelineno-0-814 name=__codelineno-0-814></a><span class=sd>        Parameters</span>
<a id=__codelineno-0-815 name=__codelineno-0-815></a><span class=sd>        ----------</span>
<a id=__codelineno-0-816 name=__codelineno-0-816></a><span class=sd>        y : array-like of shape = max_lag</span>
<a id=__codelineno-0-817 name=__codelineno-0-817></a><span class=sd>            Initial conditions values of the model</span>
<a id=__codelineno-0-818 name=__codelineno-0-818></a><span class=sd>            to start recursive process.</span>
<a id=__codelineno-0-819 name=__codelineno-0-819></a><span class=sd>        x : ndarray of floats of shape = n_samples</span>
<a id=__codelineno-0-820 name=__codelineno-0-820></a><span class=sd>            Vector with input values to be used in model simulation.</span>
<a id=__codelineno-0-821 name=__codelineno-0-821></a>
<a id=__codelineno-0-822 name=__codelineno-0-822></a><span class=sd>        Returns</span>
<a id=__codelineno-0-823 name=__codelineno-0-823></a><span class=sd>        -------</span>
<a id=__codelineno-0-824 name=__codelineno-0-824></a><span class=sd>        yhat : ndarray of floats</span>
<a id=__codelineno-0-825 name=__codelineno-0-825></a><span class=sd>               The n-steps-ahead predicted values of the model.</span>
<a id=__codelineno-0-826 name=__codelineno-0-826></a>
<a id=__codelineno-0-827 name=__codelineno-0-827></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-828 name=__codelineno-0-828></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>:</span>
<a id=__codelineno-0-829 name=__codelineno-0-829></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-830 name=__codelineno-0-830></a>                <span class=s2>&quot;Insufficient initial condition elements! Expected at least&quot;</span>
<a id=__codelineno-0-831 name=__codelineno-0-831></a>                <span class=sa>f</span><span class=s2>&quot; </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=si>}</span><span class=s2> elements.&quot;</span>
<a id=__codelineno-0-832 name=__codelineno-0-832></a>            <span class=p>)</span>
<a id=__codelineno-0-833 name=__codelineno-0-833></a>
<a id=__codelineno-0-834 name=__codelineno-0-834></a>        <span class=k>if</span> <span class=n>x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-835 name=__codelineno-0-835></a>            <span class=n>forecast_horizon</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-0-836 name=__codelineno-0-836></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-837 name=__codelineno-0-837></a>            <span class=n>forecast_horizon</span> <span class=o>=</span> <span class=n>forecast_horizon</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span>
<a id=__codelineno-0-838 name=__codelineno-0-838></a>
<a id=__codelineno-0-839 name=__codelineno-0-839></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_basis_function_n_step_prediction</span><span class=p>(</span>
<a id=__codelineno-0-840 name=__codelineno-0-840></a>            <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=p>,</span> <span class=n>forecast_horizon</span>
<a id=__codelineno-0-841 name=__codelineno-0-841></a>        <span class=p>)</span>
<a id=__codelineno-0-842 name=__codelineno-0-842></a>        <span class=k>return</span> <span class=n>yhat</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-843 name=__codelineno-0-843></a>
<a id=__codelineno-0-844 name=__codelineno-0-844></a>    <span class=k>def</span><span class=w> </span><span class=nf>_basis_function_n_steps_horizon</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=p>):</span>
<a id=__codelineno-0-845 name=__codelineno-0-845></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>_basis_function_n_steps_horizon</span><span class=p>(</span>
<a id=__codelineno-0-846 name=__codelineno-0-846></a>            <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=p>,</span> <span class=n>forecast_horizon</span>
<a id=__codelineno-0-847 name=__codelineno-0-847></a>        <span class=p>)</span>
<a id=__codelineno-0-848 name=__codelineno-0-848></a>        <span class=k>return</span> <span class=n>yhat</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.conditional_mutual_information class="doc doc-heading"> <code class="highlight language-python"><span class=n>conditional_mutual_information</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.conditional_mutual_information class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Find the conditional mutual information.</p> <p>Finds the conditioned mutual information between <span class=arithmatex>\(y\)</span> and <span class=arithmatex>\(f1\)</span> given <span class=arithmatex>\(f2\)</span>.</p> <p>This code is based on Matlab Entropic Regression package. <a href=https://github.com/almomaa/ERFit-Package>https://github.com/almomaa/ERFit-Package</a></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The source signal.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>f1</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The destination signal.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>f2</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The condition set.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>vp_estimation</code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The conditioned mutual information.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li>Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic Regression Beats the Outliers Problem in Nonlinear System Identification. Chaos 30, 013107 (2020).</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=k>def</span><span class=w> </span><span class=nf>conditional_mutual_information</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>):</span>
<a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Find the conditional mutual information.</span>
<a id=__codelineno-0-408 name=__codelineno-0-408></a>
<a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>    Finds the conditioned mutual information between $y$ and $f1$ given $f2$.</span>
<a id=__codelineno-0-410 name=__codelineno-0-410></a>
<a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>    This code is based on Matlab Entropic Regression package.</span>
<a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>    https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-413 name=__codelineno-0-413></a>
<a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>    ----------</span>
<a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-417 name=__codelineno-0-417></a><span class=sd>        The source signal.</span>
<a id=__codelineno-0-418 name=__codelineno-0-418></a><span class=sd>    f1 : ndarray of floats</span>
<a id=__codelineno-0-419 name=__codelineno-0-419></a><span class=sd>        The destination signal.</span>
<a id=__codelineno-0-420 name=__codelineno-0-420></a><span class=sd>    f2 : ndarray of floats</span>
<a id=__codelineno-0-421 name=__codelineno-0-421></a><span class=sd>        The condition set.</span>
<a id=__codelineno-0-422 name=__codelineno-0-422></a>
<a id=__codelineno-0-423 name=__codelineno-0-423></a><span class=sd>    Returns</span>
<a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=sd>    -------</span>
<a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=sd>    vp_estimation : float</span>
<a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>        The conditioned mutual information.</span>
<a id=__codelineno-0-427 name=__codelineno-0-427></a>
<a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>    References</span>
<a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>    ----------</span>
<a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>    - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-431 name=__codelineno-0-431></a><span class=sd>        Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=sd>        Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-436 name=__codelineno-0-436></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-437 name=__codelineno-0-437></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-438 name=__codelineno-0-438></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-439 name=__codelineno-0-439></a>
<a id=__codelineno-0-440 name=__codelineno-0-440></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-441 name=__codelineno-0-441></a>    <span class=n>joint_space</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-442 name=__codelineno-0-442></a>    <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
<a id=__codelineno-0-443 name=__codelineno-0-443></a>        <span class=n>cdist</span><span class=p>(</span><span class=n>joint_space</span><span class=p>,</span> <span class=n>joint_space</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<a id=__codelineno-0-444 name=__codelineno-0-444></a>    <span class=p>)</span>
<a id=__codelineno-0-445 name=__codelineno-0-445></a>    <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>smallest_distance</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=p>:],</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-446 name=__codelineno-0-446></a>    <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=n>idx</span><span class=p>]</span>
<a id=__codelineno-0-447 name=__codelineno-0-447></a>    <span class=n>epsilon</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-448 name=__codelineno-0-448></a>    <span class=c1># Find number of points from (y,f2), (f1,f2), and (f2,f2) that lies withing the</span>
<a id=__codelineno-0-449 name=__codelineno-0-449></a>    <span class=c1># k^{th} nearest neighbor distance from each point of themselves.</span>
<a id=__codelineno-0-450 name=__codelineno-0-450></a>    <span class=n>smallest_distance_y_f2</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span>
<a id=__codelineno-0-451 name=__codelineno-0-451></a>        <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-452 name=__codelineno-0-452></a>        <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-453 name=__codelineno-0-453></a>        <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span>
<a id=__codelineno-0-454 name=__codelineno-0-454></a>        <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a id=__codelineno-0-455 name=__codelineno-0-455></a>    <span class=p>)</span>
<a id=__codelineno-0-456 name=__codelineno-0-456></a>    <span class=n>less_than_array_y_f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_y_f2</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-457 name=__codelineno-0-457></a>    <span class=n>y_f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_y_f2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-458 name=__codelineno-0-458></a>
<a id=__codelineno-0-459 name=__codelineno-0-459></a>    <span class=n>smallest_distance_f1_f2</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span>
<a id=__codelineno-0-460 name=__codelineno-0-460></a>        <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-461 name=__codelineno-0-461></a>        <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
<a id=__codelineno-0-462 name=__codelineno-0-462></a>        <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span>
<a id=__codelineno-0-463 name=__codelineno-0-463></a>        <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a id=__codelineno-0-464 name=__codelineno-0-464></a>    <span class=p>)</span>
<a id=__codelineno-0-465 name=__codelineno-0-465></a>    <span class=n>less_than_array_f1_f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_f1_f2</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span>
<a id=__codelineno-0-466 name=__codelineno-0-466></a>        <span class=nb>int</span>
<a id=__codelineno-0-467 name=__codelineno-0-467></a>    <span class=p>)</span>
<a id=__codelineno-0-468 name=__codelineno-0-468></a>    <span class=n>f1_f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_f1_f2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-469 name=__codelineno-0-469></a>
<a id=__codelineno-0-470 name=__codelineno-0-470></a>    <span class=n>smallest_distance_f2</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span><span class=n>f2</span><span class=p>,</span> <span class=n>f2</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
<a id=__codelineno-0-471 name=__codelineno-0-471></a>    <span class=n>less_than_array_f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_f2</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-472 name=__codelineno-0-472></a>    <span class=n>f2_f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_f2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-473 name=__codelineno-0-473></a>    <span class=n>arr</span> <span class=o>=</span> <span class=n>psi</span><span class=p>(</span><span class=n>y_f2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>psi</span><span class=p>(</span><span class=n>f1_f2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=n>psi</span><span class=p>(</span><span class=n>f2_f2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-474 name=__codelineno-0-474></a>    <span class=n>vp_estimation</span> <span class=o>=</span> <span class=n>psi</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>)</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>arr</span><span class=p>)])</span>
<a id=__codelineno-0-475 name=__codelineno-0-475></a>    <span class=k>return</span> <span class=n>vp_estimation</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_backward class="doc doc-heading"> <code class="highlight language-python"><span class=n>entropic_regression_backward</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>piv</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_backward class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Entropic Regression Backward Greedy Feature Elimination.</p> <p>This algorithm is based on the Matlab package available on: <a href=https://github.com/almomaa/ERFit-Package>https://github.com/almomaa/ERFit-Package</a></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>reg_matrix</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The input data to be used in the prediction process.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The output data to be used in the prediction process.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>piv</code> </td> <td> <code>ndarray of ints</code> </td> <td> <div class=doc-md-description> <p>The set of indices to investigate</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>piv</code></td> <td> <code>ndarray of ints</code> </td> <td> <div class=doc-md-description> <p>The set of remaining indices after the Backward Greedy Feature Elimination.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=k>def</span><span class=w> </span><span class=nf>entropic_regression_backward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>piv</span><span class=p>):</span>
<a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Entropic Regression Backward Greedy Feature Elimination.</span>
<a id=__codelineno-0-286 name=__codelineno-0-286></a>
<a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>    This algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-288 name=__codelineno-0-288></a><span class=sd>    https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-289 name=__codelineno-0-289></a>
<a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=sd>    ----------</span>
<a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>    reg_matrix : ndarray of floats</span>
<a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>        The input data to be used in the prediction process.</span>
<a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>        The output data to be used in the prediction process.</span>
<a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=sd>    piv : ndarray of ints</span>
<a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>        The set of indices to investigate</span>
<a id=__codelineno-0-298 name=__codelineno-0-298></a>
<a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>    Returns</span>
<a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>    -------</span>
<a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>    piv : ndarray of ints</span>
<a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>        The set of remaining indices after the</span>
<a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>        Backward Greedy Feature Elimination.</span>
<a id=__codelineno-0-304 name=__codelineno-0-304></a>
<a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-306 name=__codelineno-0-306></a>    <span class=n>min_value</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
<a id=__codelineno-0-307 name=__codelineno-0-307></a>    <span class=n>piv</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>piv</span><span class=p>)</span>
<a id=__codelineno-0-308 name=__codelineno-0-308></a>    <span class=n>ix</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-309 name=__codelineno-0-309></a>    <span class=k>while</span> <span class=p>(</span><span class=n>min_value</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>piv</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=n>initial_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>piv</span><span class=p>)),</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span>
<a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>initial_array</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
<a id=__codelineno-0-312 name=__codelineno-0-312></a>            <span class=k>if</span> <span class=n>piv</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[]:</span>  <span class=c1># if you want to keep any regressor</span>
<a id=__codelineno-0-313 name=__codelineno-0-313></a>                <span class=n>rem</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>setdiff1d</span><span class=p>(</span><span class=n>piv</span><span class=p>,</span> <span class=n>piv</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
<a id=__codelineno-0-314 name=__codelineno-0-314></a>                <span class=n>f1</span> <span class=o>=</span> <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>piv</span><span class=p>]</span> <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>piv</span><span class=p>])</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-315 name=__codelineno-0-315></a>                <span class=n>f2</span> <span class=o>=</span> <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>rem</span><span class=p>]</span> <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>rem</span><span class=p>])</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-316 name=__codelineno-0-316></a>                <span class=n>initial_array</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional_mutual_information</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)</span>
<a id=__codelineno-0-317 name=__codelineno-0-317></a>
<a id=__codelineno-0-318 name=__codelineno-0-318></a>        <span class=n>ix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmin</span><span class=p>(</span><span class=n>initial_array</span><span class=p>)</span>
<a id=__codelineno-0-319 name=__codelineno-0-319></a>        <span class=n>min_value</span> <span class=o>=</span> <span class=n>initial_array</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>ix</span><span class=p>]</span>
<a id=__codelineno-0-320 name=__codelineno-0-320></a>        <span class=n>piv</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>piv</span><span class=p>,</span> <span class=n>ix</span><span class=p>)</span>
<a id=__codelineno-0-321 name=__codelineno-0-321></a>
<a id=__codelineno-0-322 name=__codelineno-0-322></a>    <span class=k>return</span> <span class=n>piv</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_forward class="doc doc-heading"> <code class="highlight language-python"><span class=n>entropic_regression_forward</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.entropic_regression_forward class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Entropic Regression Forward Greedy Feature Selection.</p> <p>This algorithm is based on the Matlab package available on: <a href=https://github.com/almomaa/ERFit-Package>https://github.com/almomaa/ERFit-Package</a></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>reg_matrix</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The input data to be used in the prediction process.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The output data to be used in the prediction process.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>selected_terms</code></td> <td> <code>ndarray of ints</code> </td> <td> <div class=doc-md-description> <p>The set of selected regressors after the Forward Greedy Feature Selection.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>success</code></td> <td> <code><span title=boolean>boolean</span></code> </td> <td> <div class=doc-md-description> <p>Indicate if the forward selection succeed. If high degree of uncertainty is detected, and many parameters are selected, the success flag will be set to false. Then, the backward elimination will be applied for all indices.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=k>def</span><span class=w> </span><span class=nf>entropic_regression_forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Entropic Regression Forward Greedy Feature Selection.</span>
<a id=__codelineno-0-326 name=__codelineno-0-326></a>
<a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>    This algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>    https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-329 name=__codelineno-0-329></a>
<a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>    ----------</span>
<a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>    reg_matrix : ndarray of floats</span>
<a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>        The input data to be used in the prediction process.</span>
<a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-335 name=__codelineno-0-335></a><span class=sd>        The output data to be used in the prediction process.</span>
<a id=__codelineno-0-336 name=__codelineno-0-336></a>
<a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>    Returns</span>
<a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>    -------</span>
<a id=__codelineno-0-339 name=__codelineno-0-339></a><span class=sd>    selected_terms : ndarray of ints</span>
<a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>        The set of selected regressors after the</span>
<a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        Forward Greedy Feature Selection.</span>
<a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>    success : boolean</span>
<a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>        Indicate if the forward selection succeed.</span>
<a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>        If high degree of uncertainty is detected, and many parameters are</span>
<a id=__codelineno-0-345 name=__codelineno-0-345></a><span class=sd>        selected, the success flag will be set to false. Then, the</span>
<a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>        backward elimination will be applied for all indices.</span>
<a id=__codelineno-0-347 name=__codelineno-0-347></a>
<a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-349 name=__codelineno-0-349></a>    <span class=n>success</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-350 name=__codelineno-0-350></a>    <span class=n>ix</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-351 name=__codelineno-0-351></a>    <span class=n>selected_terms</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=n>reg_matrix_columns</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])))</span>
<a id=__codelineno-0-353 name=__codelineno-0-353></a>    <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tolerance_estimator</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-354 name=__codelineno-0-354></a>    <span class=n>ksg_max</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span><span class=p>)(</span>
<a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=n>y</span><span class=p>,</span> <span class=n>reg_matrix</span> <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>)</span> <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-356 name=__codelineno-0-356></a>    <span class=p>)</span>
<a id=__codelineno-0-357 name=__codelineno-0-357></a>    <span class=n>stop_criteria</span> <span class=o>=</span> <span class=kc>False</span>
<a id=__codelineno-0-358 name=__codelineno-0-358></a>    <span class=k>while</span> <span class=n>stop_criteria</span> <span class=ow>is</span> <span class=kc>False</span><span class=p>:</span>
<a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=n>selected_terms</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ravel</span><span class=p>(</span>
<a id=__codelineno-0-360 name=__codelineno-0-360></a>            <span class=p>[</span><span class=o>*</span><span class=n>selected_terms</span><span class=p>,</span> <span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>ix</span><span class=p>]])]</span>
<a id=__codelineno-0-361 name=__codelineno-0-361></a>        <span class=p>)</span>
<a id=__codelineno-0-362 name=__codelineno-0-362></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-363 name=__codelineno-0-363></a>            <span class=n>ksg_local</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span><span class=p>)(</span>
<a id=__codelineno-0-364 name=__codelineno-0-364></a>                <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-0-365 name=__codelineno-0-365></a>                <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>]</span>
<a id=__codelineno-0-366 name=__codelineno-0-366></a>                <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>])</span>
<a id=__codelineno-0-367 name=__codelineno-0-367></a>                <span class=o>@</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-0-368 name=__codelineno-0-368></a>            <span class=p>)</span>
<a id=__codelineno-0-369 name=__codelineno-0-369></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-370 name=__codelineno-0-370></a>            <span class=n>ksg_local</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span><span class=p>)(</span>
<a id=__codelineno-0-371 name=__codelineno-0-371></a>                <span class=n>y</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-372 name=__codelineno-0-372></a>            <span class=p>)</span>
<a id=__codelineno-0-373 name=__codelineno-0-373></a>
<a id=__codelineno-0-374 name=__codelineno-0-374></a>        <span class=n>initial_vector</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>)</span>
<a id=__codelineno-0-375 name=__codelineno-0-375></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
<a id=__codelineno-0-376 name=__codelineno-0-376></a>            <span class=k>if</span> <span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>selected_terms</span><span class=p>:</span>
<a id=__codelineno-0-377 name=__codelineno-0-377></a>                <span class=n>f1</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-378 name=__codelineno-0-378></a>                    <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=p>[</span><span class=o>*</span><span class=n>selected_terms</span><span class=p>,</span> <span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>i</span><span class=p>]]]</span>
<a id=__codelineno-0-379 name=__codelineno-0-379></a>                    <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=p>[</span><span class=o>*</span><span class=n>selected_terms</span><span class=p>,</span> <span class=n>reg_matrix_columns</span><span class=p>[</span><span class=n>i</span><span class=p>]]])</span>
<a id=__codelineno-0-380 name=__codelineno-0-380></a>                    <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-381 name=__codelineno-0-381></a>                <span class=p>)</span>
<a id=__codelineno-0-382 name=__codelineno-0-382></a>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-383 name=__codelineno-0-383></a>                    <span class=n>f2</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-384 name=__codelineno-0-384></a>                        <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>]</span>
<a id=__codelineno-0-385 name=__codelineno-0-385></a>                        <span class=o>@</span> <span class=n>pinv</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>])</span>
<a id=__codelineno-0-386 name=__codelineno-0-386></a>                        <span class=o>@</span> <span class=n>y</span>
<a id=__codelineno-0-387 name=__codelineno-0-387></a>                    <span class=p>)</span>
<a id=__codelineno-0-388 name=__codelineno-0-388></a>                <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-389 name=__codelineno-0-389></a>                    <span class=n>f2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-390 name=__codelineno-0-390></a>                <span class=n>vp_estimation</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional_mutual_information</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)</span>
<a id=__codelineno-0-391 name=__codelineno-0-391></a>                <span class=n>initial_vector</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>vp_estimation</span>
<a id=__codelineno-0-392 name=__codelineno-0-392></a>            <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-393 name=__codelineno-0-393></a>                <span class=k>continue</span>
<a id=__codelineno-0-394 name=__codelineno-0-394></a>
<a id=__codelineno-0-395 name=__codelineno-0-395></a>        <span class=n>ix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanargmax</span><span class=p>(</span><span class=n>initial_vector</span><span class=p>)</span>
<a id=__codelineno-0-396 name=__codelineno-0-396></a>        <span class=n>max_value</span> <span class=o>=</span> <span class=n>initial_vector</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>ix</span><span class=p>]</span>
<a id=__codelineno-0-397 name=__codelineno-0-397></a>
<a id=__codelineno-0-398 name=__codelineno-0-398></a>        <span class=k>if</span> <span class=p>(</span><span class=n>ksg_max</span> <span class=o>-</span> <span class=n>ksg_local</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>)</span> <span class=ow>or</span> <span class=p>(</span><span class=n>max_value</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span><span class=p>):</span>
<a id=__codelineno-0-399 name=__codelineno-0-399></a>            <span class=n>stop_criteria</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-400 name=__codelineno-0-400></a>        <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>([</span><span class=mi>8</span><span class=p>,</span> <span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]):</span>
<a id=__codelineno-0-401 name=__codelineno-0-401></a>            <span class=n>success</span> <span class=o>=</span> <span class=kc>False</span>
<a id=__codelineno-0-402 name=__codelineno-0-402></a>            <span class=n>stop_criteria</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-403 name=__codelineno-0-403></a>
<a id=__codelineno-0-404 name=__codelineno-0-404></a>    <span class=k>return</span> <span class=n>selected_terms</span><span class=p>,</span> <span class=n>success</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.fit class="doc doc-heading"> <code class="highlight language-python"><span class=n>fit</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.fit class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Fit polynomial NARMAX model using AOLS algorithm.</p> <p>The 'fit' function allows a friendly usage by the user. Given two arguments, x and y, fit training data.</p> <p>The Entropic Regression algorithm is based on the Matlab package available on: <a href=https://github.com/almomaa/ERFit-Package>https://github.com/almomaa/ERFit-Package</a></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The input data to be used in the training process.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The output data to be used in the training process.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>model</code></td> <td> <code>ndarray of int</code> </td> <td> <div class=doc-md-description> <p>The model code representation.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>theta</code></td> <td> <code>array-like of shape = number_of_model_elements</code> </td> <td> <div class=doc-md-description> <p>The estimated parameters of the model.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li>Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic Regression Beats the Outliers Problem in Nonlinear System Identification. Chaos 30, 013107 (2020).</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Fit polynomial NARMAX model using AOLS algorithm.</span>
<a id=__codelineno-0-522 name=__codelineno-0-522></a>
<a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>    The &#39;fit&#39; function allows a friendly usage by the user.</span>
<a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>    Given two arguments, x and y, fit training data.</span>
<a id=__codelineno-0-525 name=__codelineno-0-525></a>
<a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>    The Entropic Regression algorithm is based on the Matlab package available on:</span>
<a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>    https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-528 name=__codelineno-0-528></a>
<a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-530 name=__codelineno-0-530></a><span class=sd>    ----------</span>
<a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>    X : ndarray of floats</span>
<a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>        The input data to be used in the training process.</span>
<a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-534 name=__codelineno-0-534></a><span class=sd>        The output data to be used in the training process.</span>
<a id=__codelineno-0-535 name=__codelineno-0-535></a>
<a id=__codelineno-0-536 name=__codelineno-0-536></a><span class=sd>    Returns</span>
<a id=__codelineno-0-537 name=__codelineno-0-537></a><span class=sd>    -------</span>
<a id=__codelineno-0-538 name=__codelineno-0-538></a><span class=sd>    model : ndarray of int</span>
<a id=__codelineno-0-539 name=__codelineno-0-539></a><span class=sd>        The model code representation.</span>
<a id=__codelineno-0-540 name=__codelineno-0-540></a><span class=sd>    theta : array-like of shape = number_of_model_elements</span>
<a id=__codelineno-0-541 name=__codelineno-0-541></a><span class=sd>        The estimated parameters of the model.</span>
<a id=__codelineno-0-542 name=__codelineno-0-542></a>
<a id=__codelineno-0-543 name=__codelineno-0-543></a><span class=sd>    References</span>
<a id=__codelineno-0-544 name=__codelineno-0-544></a><span class=sd>    ----------</span>
<a id=__codelineno-0-545 name=__codelineno-0-545></a><span class=sd>    - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-546 name=__codelineno-0-546></a><span class=sd>        Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-547 name=__codelineno-0-547></a><span class=sd>        Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-548 name=__codelineno-0-548></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-549 name=__codelineno-0-549></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-550 name=__codelineno-0-550></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-551 name=__codelineno-0-551></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-552 name=__codelineno-0-552></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-553 name=__codelineno-0-553></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-554 name=__codelineno-0-554></a>
<a id=__codelineno-0-555 name=__codelineno-0-555></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-556 name=__codelineno-0-556></a>    <span class=k>if</span> <span class=n>y</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-557 name=__codelineno-0-557></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;y cannot be None&quot;</span><span class=p>)</span>
<a id=__codelineno-0-558 name=__codelineno-0-558></a>
<a id=__codelineno-0-559 name=__codelineno-0-559></a>    <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_max_lag</span><span class=p>()</span>
<a id=__codelineno-0-560 name=__codelineno-0-560></a>    <span class=n>lagged_data</span> <span class=o>=</span> <span class=n>build_lagged_matrix</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=p>)</span>
<a id=__codelineno-0-561 name=__codelineno-0-561></a>
<a id=__codelineno-0-562 name=__codelineno-0-562></a>    <span class=n>reg_matrix</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
<a id=__codelineno-0-563 name=__codelineno-0-563></a>        <span class=n>lagged_data</span><span class=p>,</span>
<a id=__codelineno-0-564 name=__codelineno-0-564></a>        <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>,</span>
<a id=__codelineno-0-565 name=__codelineno-0-565></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ylag</span><span class=p>,</span>
<a id=__codelineno-0-566 name=__codelineno-0-566></a>        <span class=bp>self</span><span class=o>.</span><span class=n>xlag</span><span class=p>,</span>
<a id=__codelineno-0-567 name=__codelineno-0-567></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_type</span><span class=p>,</span>
<a id=__codelineno-0-568 name=__codelineno-0-568></a>        <span class=n>predefined_regressors</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-569 name=__codelineno-0-569></a>    <span class=p>)</span>
<a id=__codelineno-0-570 name=__codelineno-0-570></a>
<a id=__codelineno-0-571 name=__codelineno-0-571></a>    <span class=k>if</span> <span class=n>X</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-572 name=__codelineno-0-572></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=n>num_features</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-0-573 name=__codelineno-0-573></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-574 name=__codelineno-0-574></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># just to create the regressor space base</span>
<a id=__codelineno-0-575 name=__codelineno-0-575></a>
<a id=__codelineno-0-576 name=__codelineno-0-576></a>    <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_space</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_inputs</span><span class=p>)</span>
<a id=__codelineno-0-577 name=__codelineno-0-577></a>
<a id=__codelineno-0-578 name=__codelineno-0-578></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>90</span><span class=p>:</span>
<a id=__codelineno-0-579 name=__codelineno-0-579></a>        <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span>
<a id=__codelineno-0-580 name=__codelineno-0-580></a>            <span class=s2>&quot;Given the higher number of possible regressors&quot;</span>
<a id=__codelineno-0-581 name=__codelineno-0-581></a>            <span class=sa>f</span><span class=s2>&quot; (</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>), the Entropic Regression&quot;</span>
<a id=__codelineno-0-582 name=__codelineno-0-582></a>            <span class=s2>&quot; algorithm may take long time to run. Consider reducing the&quot;</span>
<a id=__codelineno-0-583 name=__codelineno-0-583></a>            <span class=s2>&quot; number of regressors &quot;</span><span class=p>,</span>
<a id=__codelineno-0-584 name=__codelineno-0-584></a>            <span class=n>stacklevel</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-585 name=__codelineno-0-585></a>        <span class=p>)</span>
<a id=__codelineno-0-586 name=__codelineno-0-586></a>
<a id=__codelineno-0-587 name=__codelineno-0-587></a>    <span class=n>y_full</span> <span class=o>=</span> <span class=n>y</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-588 name=__codelineno-0-588></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=p>:]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-589 name=__codelineno-0-589></a>    <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-590 name=__codelineno-0-590></a>    <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-591 name=__codelineno-0-591></a>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span><span class=p>):</span>
<a id=__codelineno-0-592 name=__codelineno-0-592></a>        <span class=n>mutual_information_output</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span>
<a id=__codelineno-0-593 name=__codelineno-0-593></a>            <span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span>
<a id=__codelineno-0-594 name=__codelineno-0-594></a>        <span class=p>)(</span><span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>rng</span><span class=o>.</span><span class=n>permutation</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
<a id=__codelineno-0-595 name=__codelineno-0-595></a>        <span class=n>ksg_estimation</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mutual_information_output</span><span class=p>)</span>
<a id=__codelineno-0-596 name=__codelineno-0-596></a>
<a id=__codelineno-0-597 name=__codelineno-0-597></a>    <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-598 name=__codelineno-0-598></a>    <span class=bp>self</span><span class=o>.</span><span class=n>tol</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>q</span><span class=p>)</span>
<a id=__codelineno-0-599 name=__codelineno-0-599></a>    <span class=bp>self</span><span class=o>.</span><span class=n>estimated_tolerance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tol</span>
<a id=__codelineno-0-600 name=__codelineno-0-600></a>    <span class=n>success</span> <span class=o>=</span> <span class=kc>False</span>
<a id=__codelineno-0-601 name=__codelineno-0-601></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span><span class=p>:</span>
<a id=__codelineno-0-602 name=__codelineno-0-602></a>        <span class=n>selected_terms</span><span class=p>,</span> <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>entropic_regression_forward</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-603 name=__codelineno-0-603></a>
<a id=__codelineno-0-604 name=__codelineno-0-604></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>success</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>skip_forward</span><span class=p>:</span>
<a id=__codelineno-0-605 name=__codelineno-0-605></a>        <span class=n>selected_terms</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>reg_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])))</span>
<a id=__codelineno-0-606 name=__codelineno-0-606></a>
<a id=__codelineno-0-607 name=__codelineno-0-607></a>    <span class=n>selected_terms_backward</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>entropic_regression_backward</span><span class=p>(</span>
<a id=__codelineno-0-608 name=__codelineno-0-608></a>        <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>selected_terms</span><span class=p>],</span> <span class=n>y</span><span class=p>,</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_terms</span><span class=p>)))</span>
<a id=__codelineno-0-609 name=__codelineno-0-609></a>    <span class=p>)</span>
<a id=__codelineno-0-610 name=__codelineno-0-610></a>
<a id=__codelineno-0-611 name=__codelineno-0-611></a>    <span class=n>final_model</span> <span class=o>=</span> <span class=n>selected_terms</span><span class=p>[</span><span class=n>selected_terms_backward</span><span class=p>]</span>
<a id=__codelineno-0-612 name=__codelineno-0-612></a>    <span class=c1># re-check for the constant term (add it to the estimated indices)</span>
<a id=__codelineno-0-613 name=__codelineno-0-613></a>    <span class=k>if</span> <span class=mi>0</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>final_model</span><span class=p>:</span>
<a id=__codelineno-0-614 name=__codelineno-0-614></a>        <span class=n>final_model</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=n>final_model</span><span class=p>])</span>
<a id=__codelineno-0-615 name=__codelineno-0-615></a>
<a id=__codelineno-0-616 name=__codelineno-0-616></a>    <span class=n>repetition</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>reg_matrix</span><span class=p>)</span>
<a id=__codelineno-0-617 name=__codelineno-0-617></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=p>,</span> <span class=n>Polynomial</span><span class=p>):</span>
<a id=__codelineno-0-618 name=__codelineno-0-618></a>        <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=p>[</span><span class=n>final_model</span><span class=p>,</span> <span class=p>:]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-619 name=__codelineno-0-619></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-620 name=__codelineno-0-620></a>        <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
<a id=__codelineno-0-621 name=__codelineno-0-621></a>            <span class=n>np</span><span class=o>.</span><span class=n>tile</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=p>[</span><span class=mi>1</span><span class=p>:,</span> <span class=p>:],</span> <span class=p>(</span><span class=n>repetition</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
<a id=__codelineno-0-622 name=__codelineno-0-622></a>            <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-623 name=__codelineno-0-623></a>        <span class=p>)</span>
<a id=__codelineno-0-624 name=__codelineno-0-624></a>        <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>regressor_code</span><span class=p>[</span><span class=n>final_model</span><span class=p>,</span> <span class=p>:]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-625 name=__codelineno-0-625></a>
<a id=__codelineno-0-626 name=__codelineno-0-626></a>    <span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimator</span><span class=o>.</span><span class=n>optimize</span><span class=p>(</span>
<a id=__codelineno-0-627 name=__codelineno-0-627></a>        <span class=n>reg_matrix</span><span class=p>[:,</span> <span class=n>final_model</span><span class=p>],</span> <span class=n>y_full</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span> <span class=p>:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-628 name=__codelineno-0-628></a>    <span class=p>)</span>
<a id=__codelineno-0-629 name=__codelineno-0-629></a>    <span class=k>if</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>theta</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>h</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span>
<a id=__codelineno-0-630 name=__codelineno-0-630></a>        <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>1</span>
<a id=__codelineno-0-631 name=__codelineno-0-631></a>    <span class=p>):</span>
<a id=__codelineno-0-632 name=__codelineno-0-632></a>        <span class=bp>self</span><span class=o>.</span><span class=n>theta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>theta</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-633 name=__codelineno-0-633></a>        <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>final_model</span><span class=p>[</span><span class=mi>1</span><span class=p>:,</span> <span class=p>:]</span>
<a id=__codelineno-0-634 name=__codelineno-0-634></a>        <span class=n>final_model</span> <span class=o>=</span> <span class=n>final_model</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
<a id=__codelineno-0-635 name=__codelineno-0-635></a>
<a id=__codelineno-0-636 name=__codelineno-0-636></a>    <span class=bp>self</span><span class=o>.</span><span class=n>n_terms</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span>
<a id=__codelineno-0-637 name=__codelineno-0-637></a>        <span class=bp>self</span><span class=o>.</span><span class=n>theta</span>
<a id=__codelineno-0-638 name=__codelineno-0-638></a>    <span class=p>)</span>  <span class=c1># the number of terms we selected (necessary in the &#39;results&#39; methods)</span>
<a id=__codelineno-0-639 name=__codelineno-0-639></a>    <span class=bp>self</span><span class=o>.</span><span class=n>err</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_terms</span> <span class=o>*</span> <span class=p>[</span>
<a id=__codelineno-0-640 name=__codelineno-0-640></a>        <span class=mi>0</span>
<a id=__codelineno-0-641 name=__codelineno-0-641></a>    <span class=p>]</span>  <span class=c1># just to use the `results` method. Will be changed in next update.</span>
<a id=__codelineno-0-642 name=__codelineno-0-642></a>    <span class=bp>self</span><span class=o>.</span><span class=n>pivv</span> <span class=o>=</span> <span class=n>final_model</span>
<a id=__codelineno-0-643 name=__codelineno-0-643></a>    <span class=k>return</span> <span class=bp>self</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.mutual_information_knn class="doc doc-heading"> <code class="highlight language-python"><span class=n>mutual_information_knn</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.mutual_information_knn class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Find the mutual information.</p> <p>Finds the mutual information between <span class=arithmatex>\(x\)</span> and <span class=arithmatex>\(y\)</span> given <span class=arithmatex>\(z\)</span>.</p> <p>This code is based on Matlab Entropic Regression package.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The source signal.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>y_perm</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The destination signal.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ksg_estimation</code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The conditioned mutual information.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li>Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic Regression Beats the Outliers Problem in Nonlinear System Identification. Chaos 30, 013107 (2020).</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=k>def</span><span class=w> </span><span class=nf>mutual_information_knn</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>):</span>
<a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Find the mutual information.</span>
<a id=__codelineno-0-235 name=__codelineno-0-235></a>
<a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>    Finds the mutual information between $x$ and $y$ given $z$.</span>
<a id=__codelineno-0-237 name=__codelineno-0-237></a>
<a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=sd>    This code is based on Matlab Entropic Regression package.</span>
<a id=__codelineno-0-239 name=__codelineno-0-239></a>
<a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>    ----------</span>
<a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>        The source signal.</span>
<a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>    y_perm : ndarray of floats</span>
<a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>        The destination signal.</span>
<a id=__codelineno-0-246 name=__codelineno-0-246></a>
<a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>    Returns</span>
<a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>    -------</span>
<a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>    ksg_estimation : float</span>
<a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>        The conditioned mutual information.</span>
<a id=__codelineno-0-251 name=__codelineno-0-251></a>
<a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>    References</span>
<a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>    ----------</span>
<a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=sd>    - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-255 name=__codelineno-0-255></a><span class=sd>        Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>        Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-257 name=__codelineno-0-257></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-261 name=__codelineno-0-261></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-262 name=__codelineno-0-262></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-263 name=__codelineno-0-263></a>
<a id=__codelineno-0-264 name=__codelineno-0-264></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=n>joint_space</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-266 name=__codelineno-0-266></a>    <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
<a id=__codelineno-0-267 name=__codelineno-0-267></a>        <span class=n>cdist</span><span class=p>(</span><span class=n>joint_space</span><span class=p>,</span> <span class=n>joint_space</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
<a id=__codelineno-0-268 name=__codelineno-0-268></a>    <span class=p>)</span>
<a id=__codelineno-0-269 name=__codelineno-0-269></a>    <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>smallest_distance</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=p>:],</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=n>smallest_distance</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=n>idx</span><span class=p>]</span>
<a id=__codelineno-0-271 name=__codelineno-0-271></a>    <span class=n>epsilon</span> <span class=o>=</span> <span class=n>smallest_distance</span><span class=p>[:,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=n>smallest_distance_y</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
<a id=__codelineno-0-273 name=__codelineno-0-273></a>    <span class=n>less_than_array_nx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_y</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-274 name=__codelineno-0-274></a>    <span class=n>nx</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_nx</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-275 name=__codelineno-0-275></a>    <span class=n>smallest_distance_y_perm</span> <span class=o>=</span> <span class=n>cdist</span><span class=p>(</span><span class=n>y_perm</span><span class=p>,</span> <span class=n>y_perm</span><span class=p>,</span> <span class=s2>&quot;minkowski&quot;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>p</span><span class=p>)</span>
<a id=__codelineno-0-276 name=__codelineno-0-276></a>    <span class=n>less_than_array_ny</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>((</span><span class=n>smallest_distance_y_perm</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>))</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<a id=__codelineno-0-277 name=__codelineno-0-277></a>    <span class=n>ny</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>less_than_array_ny</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-278 name=__codelineno-0-278></a>    <span class=n>arr</span> <span class=o>=</span> <span class=n>psi</span><span class=p>(</span><span class=n>nx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>psi</span><span class=p>(</span><span class=n>ny</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-279 name=__codelineno-0-279></a>    <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-280 name=__codelineno-0-280></a>        <span class=n>psi</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>)</span> <span class=o>+</span> <span class=n>psi</span><span class=p>(</span><span class=n>y</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>arr</span><span class=p>)])</span>
<a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=p>)</span>
<a id=__codelineno-0-282 name=__codelineno-0-282></a>    <span class=k>return</span> <span class=n>ksg_estimation</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.predict class="doc doc-heading"> <code class="highlight language-python"><span class=n>predict</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.predict class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return the predicted values given an input.</p> <p>The predict function allows a friendly usage by the user. Given a previously trained model, predict values given a new set of data.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>X</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The input data to be used in the prediction process.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The output data to be used in the prediction process.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>steps_ahead</code> </td> <td> <code><span title=int>int</span>(default=None)</code> </td> <td> <div class=doc-md-description> <p>The user can use free run simulation, one-step ahead prediction and n-step ahead prediction.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>forecast_horizon</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of predictions over the time.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>yhat</code></td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The predicted values of the model.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-645 name=__codelineno-0-645></a><span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>X</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-0-646 name=__codelineno-0-646></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the predicted values given an input.</span>
<a id=__codelineno-0-647 name=__codelineno-0-647></a>
<a id=__codelineno-0-648 name=__codelineno-0-648></a><span class=sd>    The predict function allows a friendly usage by the user.</span>
<a id=__codelineno-0-649 name=__codelineno-0-649></a><span class=sd>    Given a previously trained model, predict values given</span>
<a id=__codelineno-0-650 name=__codelineno-0-650></a><span class=sd>    a new set of data.</span>
<a id=__codelineno-0-651 name=__codelineno-0-651></a>
<a id=__codelineno-0-652 name=__codelineno-0-652></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-653 name=__codelineno-0-653></a><span class=sd>    ----------</span>
<a id=__codelineno-0-654 name=__codelineno-0-654></a><span class=sd>    X : ndarray of floats</span>
<a id=__codelineno-0-655 name=__codelineno-0-655></a><span class=sd>        The input data to be used in the prediction process.</span>
<a id=__codelineno-0-656 name=__codelineno-0-656></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-657 name=__codelineno-0-657></a><span class=sd>        The output data to be used in the prediction process.</span>
<a id=__codelineno-0-658 name=__codelineno-0-658></a><span class=sd>    steps_ahead : int (default = None)</span>
<a id=__codelineno-0-659 name=__codelineno-0-659></a><span class=sd>        The user can use free run simulation, one-step ahead prediction</span>
<a id=__codelineno-0-660 name=__codelineno-0-660></a><span class=sd>        and n-step ahead prediction.</span>
<a id=__codelineno-0-661 name=__codelineno-0-661></a><span class=sd>    forecast_horizon : int, default=None</span>
<a id=__codelineno-0-662 name=__codelineno-0-662></a><span class=sd>        The number of predictions over the time.</span>
<a id=__codelineno-0-663 name=__codelineno-0-663></a>
<a id=__codelineno-0-664 name=__codelineno-0-664></a><span class=sd>    Returns</span>
<a id=__codelineno-0-665 name=__codelineno-0-665></a><span class=sd>    -------</span>
<a id=__codelineno-0-666 name=__codelineno-0-666></a><span class=sd>    yhat : ndarray of floats</span>
<a id=__codelineno-0-667 name=__codelineno-0-667></a><span class=sd>        The predicted values of the model.</span>
<a id=__codelineno-0-668 name=__codelineno-0-668></a>
<a id=__codelineno-0-669 name=__codelineno-0-669></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-670 name=__codelineno-0-670></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>basis_function</span><span class=p>,</span> <span class=n>Polynomial</span><span class=p>):</span>
<a id=__codelineno-0-671 name=__codelineno-0-671></a>        <span class=k>if</span> <span class=n>steps_ahead</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-672 name=__codelineno-0-672></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-673 name=__codelineno-0-673></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-674 name=__codelineno-0-674></a>            <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-675 name=__codelineno-0-675></a>        <span class=k>if</span> <span class=n>steps_ahead</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-676 name=__codelineno-0-676></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_one_step_ahead_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-677 name=__codelineno-0-677></a>            <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-678 name=__codelineno-0-678></a>            <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-679 name=__codelineno-0-679></a>
<a id=__codelineno-0-680 name=__codelineno-0-680></a>        <span class=n>check_positive_int</span><span class=p>(</span><span class=n>steps_ahead</span><span class=p>,</span> <span class=s2>&quot;steps_ahead&quot;</span><span class=p>)</span>
<a id=__codelineno-0-681 name=__codelineno-0-681></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_n_step_ahead_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=n>steps_ahead</span><span class=p>)</span>
<a id=__codelineno-0-682 name=__codelineno-0-682></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-683 name=__codelineno-0-683></a>        <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-684 name=__codelineno-0-684></a>
<a id=__codelineno-0-685 name=__codelineno-0-685></a>    <span class=k>if</span> <span class=n>steps_ahead</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-686 name=__codelineno-0-686></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_basis_function_predict</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=n>forecast_horizon</span><span class=p>)</span>
<a id=__codelineno-0-687 name=__codelineno-0-687></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-688 name=__codelineno-0-688></a>        <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-689 name=__codelineno-0-689></a>    <span class=k>if</span> <span class=n>steps_ahead</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-690 name=__codelineno-0-690></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_one_step_ahead_prediction</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-0-691 name=__codelineno-0-691></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-692 name=__codelineno-0-692></a>        <span class=k>return</span> <span class=n>yhat</span>
<a id=__codelineno-0-693 name=__codelineno-0-693></a>
<a id=__codelineno-0-694 name=__codelineno-0-694></a>    <span class=n>yhat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_basis_function_n_step_prediction</span><span class=p>(</span>
<a id=__codelineno-0-695 name=__codelineno-0-695></a>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>steps_ahead</span><span class=o>=</span><span class=n>steps_ahead</span><span class=p>,</span> <span class=n>forecast_horizon</span><span class=o>=</span><span class=n>forecast_horizon</span>
<a id=__codelineno-0-696 name=__codelineno-0-696></a>    <span class=p>)</span>
<a id=__codelineno-0-697 name=__codelineno-0-697></a>    <span class=n>yhat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>y</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_lag</span><span class=p>],</span> <span class=n>yhat</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-698 name=__codelineno-0-698></a>    <span class=k>return</span> <span class=n>yhat</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=sysidentpy.model_structure_selection.entropic_regression.ER.tolerance_estimator class="doc doc-heading"> <code class="highlight language-python"><span class=n>tolerance_estimator</span><span class=p>(</span><span class=n>y</span><span class=p>)</span></code> <a href=#sysidentpy.model_structure_selection.entropic_regression.ER.tolerance_estimator class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Tolerance Estimation for mutual independence test.</p> <p>Finds the conditioned mutual information between <span class=arithmatex>\(y\)</span> and <span class=arithmatex>\(f1\)</span> given <span class=arithmatex>\(f2\)</span>.</p> <p>This code is based on Matlab Entropic Regression package. <a href=https://github.com/almomaa/ERFit-Package>https://github.com/almomaa/ERFit-Package</a></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>y</code> </td> <td> <code>ndarray of floats</code> </td> <td> <div class=doc-md-description> <p>The source signal.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tol</code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The tolerance value given q.</p> </div> </td> </tr> </tbody> </table> <details class=references open> <summary>References</summary> <ul> <li>Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic Regression Beats the Outliers Problem in Nonlinear System Identification. Chaos 30, 013107 (2020).</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> <li>Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger. Estimating mutual information. Physical Review E, 69:066-138,2004</li> </ul> </details> <details class=quote> <summary>Source code in <code>sysidentpy/model_structure_selection/entropic_regression.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-477 name=__codelineno-0-477></a><span class=k>def</span><span class=w> </span><span class=nf>tolerance_estimator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-0-478 name=__codelineno-0-478></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Tolerance Estimation for mutual independence test.</span>
<a id=__codelineno-0-479 name=__codelineno-0-479></a>
<a id=__codelineno-0-480 name=__codelineno-0-480></a><span class=sd>    Finds the conditioned mutual information between $y$ and $f1$ given $f2$.</span>
<a id=__codelineno-0-481 name=__codelineno-0-481></a>
<a id=__codelineno-0-482 name=__codelineno-0-482></a><span class=sd>    This code is based on Matlab Entropic Regression package.</span>
<a id=__codelineno-0-483 name=__codelineno-0-483></a><span class=sd>    https://github.com/almomaa/ERFit-Package</span>
<a id=__codelineno-0-484 name=__codelineno-0-484></a>
<a id=__codelineno-0-485 name=__codelineno-0-485></a><span class=sd>    Parameters</span>
<a id=__codelineno-0-486 name=__codelineno-0-486></a><span class=sd>    ----------</span>
<a id=__codelineno-0-487 name=__codelineno-0-487></a><span class=sd>    y : ndarray of floats</span>
<a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=sd>        The source signal.</span>
<a id=__codelineno-0-489 name=__codelineno-0-489></a>
<a id=__codelineno-0-490 name=__codelineno-0-490></a><span class=sd>    Returns</span>
<a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=sd>    -------</span>
<a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>    tol : float</span>
<a id=__codelineno-0-493 name=__codelineno-0-493></a><span class=sd>        The tolerance value given q.</span>
<a id=__codelineno-0-494 name=__codelineno-0-494></a>
<a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>    References</span>
<a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>    ----------</span>
<a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>    - Abd AlRahman R. AlMomani, Jie Sun, and Erik Bollt. How Entropic</span>
<a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=sd>        Regression Beats the Outliers Problem in Nonlinear System</span>
<a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>        Identification. Chaos 30, 013107 (2020).</span>
<a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-502 name=__codelineno-0-502></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-503 name=__codelineno-0-503></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>    - Alexander Kraskov, Harald St¨ogbauer, and Peter Grassberger.</span>
<a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>        Estimating mutual information. Physical Review E, 69:066-138,2004</span>
<a id=__codelineno-0-506 name=__codelineno-0-506></a>
<a id=__codelineno-0-507 name=__codelineno-0-507></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-508 name=__codelineno-0-508></a>    <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-509 name=__codelineno-0-509></a>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_perm</span><span class=p>):</span>
<a id=__codelineno-0-510 name=__codelineno-0-510></a>        <span class=n>mutual_information_output</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span>
<a id=__codelineno-0-511 name=__codelineno-0-511></a>            <span class=bp>self</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutual_information_estimator</span>
<a id=__codelineno-0-512 name=__codelineno-0-512></a>        <span class=p>)(</span><span class=n>y</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>rng</span><span class=o>.</span><span class=n>permutation</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
<a id=__codelineno-0-513 name=__codelineno-0-513></a>
<a id=__codelineno-0-514 name=__codelineno-0-514></a>        <span class=n>ksg_estimation</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mutual_information_output</span><span class=p>)</span>
<a id=__codelineno-0-515 name=__codelineno-0-515></a>
<a id=__codelineno-0-516 name=__codelineno-0-516></a>    <span class=n>ksg_estimation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>)</span>
<a id=__codelineno-0-517 name=__codelineno-0-517></a>    <span class=n>tol</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=n>ksg_estimation</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>q</span><span class=p>)</span>
<a id=__codelineno-0-518 name=__codelineno-0-518></a>    <span class=k>return</span> <span class=n>tol</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Voltar ao topo </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Rodapé> <a href=../uofr/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: UOFR"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Anterior </span> <div class=md-ellipsis> UOFR </div> </div> </a> <a href=../neural-narx/ class="md-footer__link md-footer__link--next" aria-label="Próximo: Neural NARX"> <div class=md-footer__title> <span class=md-footer__direction> Próximo </span> <div class=md-ellipsis> Neural NARX </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2016 - 2025 Wilson Rocha </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/wilsonrljr target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/sysidentpy/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> <a href=https://twitter.com/wilsonrljr target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "content.code.annotate", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}}</script> <script src=../../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../../../overrides/assets/js/katex.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js></script> <script src=../../../../overrides/assets/vendor/js/prism.js></script> <script src=https://cdn.jsdelivr.net/npm/apexcharts></script> <script src=../../../../overrides/assets/js/chart-example.js></script> <script src=../../../../overrides/assets/js/scripts.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>